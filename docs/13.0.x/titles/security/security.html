<!DOCTYPE html>
<html lang="en">
<head><meta name="robots" content="noindex">
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Infinispan Security Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="canonical" href="https://infinispan.org/docs/stable/titles/security/security.html">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.1/themes/default/style.min.css">
<link rel="stylesheet" href="../../css/css.css">
<link rel="stylesheet" href="/assets/css/clipboard.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.1/jstree.min.js"></script>
<script src="../../js/js.js"></script>
<script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
<script src="/assets/javascript/copy.js" type="text/javascript"></script>
<style>
.hidden {
    display: none;
}

.switch {
    border-width: 1px 1px 0 1px;
    border-style: solid;
    border-color: #7a2518;
    display: inline-block;
}

.switch--item {
    padding: 10px;
    background-color: #ffffff;
    color: #7a2518;
    display: inline-block;
    cursor: pointer;
}

.switch--item.selected {
    background-color: #7a2519;
    color: #ffffff;
}

</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
<script type="text/javascript">
function addBlockSwitches() {
    $('.primary').each(function() {
        primary = $(this);
        createSwitchItem(primary, createBlockSwitch(primary)).item.addClass("selected");
        primary.children('.title').remove();
    });
    $('.secondary').each(function(idx, node) {
        secondary = $(node);
        primary = findPrimary(secondary);
        switchItem = createSwitchItem(secondary, primary.children('.switch'));
        switchItem.content.addClass('hidden');
        findPrimary(secondary).append(switchItem.content);
        secondary.remove();
    });
}

function createBlockSwitch(primary) {
    blockSwitch = $('<div class="switch"></div>');
    primary.prepend(blockSwitch);
    return blockSwitch;
}

function findPrimary(secondary) {
    candidate = secondary.prev();
    while (!candidate.is('.primary')) {
        candidate = candidate.prev();
    }
    return candidate;
}

function createSwitchItem(block, blockSwitch) {
    blockName = block.children('.title').text();
    content = block.children('.content').first().append(block.next('.colist'));
    item = $('<div class="switch--item">' + blockName + '</div>');
    item.on('click', '', content, function(e) {
        $(this).addClass('selected');
        $(this).siblings().removeClass('selected');
        e.data.siblings('.content').addClass('hidden');
        e.data.removeClass('hidden');
    });
    blockSwitch.append(item);
    return {'item': item, 'content': content};
}

$(addBlockSwitches);

</script>

</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Infinispan Security Guide</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#security">1. Infinispan Security</a></li>
<li><a href="#security-authorization">2. Configuring user roles and permissions</a>
<ul class="sectlevel2">
<li><a href="#security-authorization_security-authorization">2.1. Security authorization</a>
<ul class="sectlevel3">
<li><a href="#user-roles-permissions_security-authorization">2.1.1. User roles and permissions</a></li>
<li><a href="#user-permissions_security-authorization">2.1.2. Permissions</a>
<ul class="sectlevel4">
<li><a href="#cache_manager_permissions">Cache Manager permissions</a></li>
<li><a href="#cache_permissions">Cache permissions</a></li>
</ul>
</li>
<li><a href="#role-mappers_security-authorization">2.1.3. Role mappers</a>
<ul class="sectlevel4">
<li><a href="#cluster_role_mappers">Cluster role mappers</a></li>
<li><a href="#identity_role_mappers">Identity role mappers</a></li>
<li><a href="#commonname_role_mappers">CommonName role mappers</a></li>
<li><a href="#custom_role_mappers">Custom role mappers</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#acl-cache_security-authorization">2.2. Access control list (ACL) cache</a></li>
<li><a href="#customizing-authorization_security-authorization">2.3. Customizing roles and permissions</a></li>
<li><a href="#configuring-cache-authorization_security-authorization">2.4. Configuring caches with security authorization</a></li>
<li><a href="#disabling-authorization_security-authorization">2.5. Disabling security authorization</a></li>
<li><a href="#configuring-authorization-programmatically_security-authorization">2.6. Programmatically configuring authorization</a></li>
<li><a href="#code-execution-security-authorization_security-authorization">2.7. Code execution with security authorization</a></li>
</ul>
</li>
<li><a href="#security-realms">3. Security realms</a>
<ul class="sectlevel2">
<li><a href="#creating-security-realms_security-realms">3.1. Creating security realms</a></li>
<li><a href="#setting-up-kerberos-identities_security-realms">3.2. Setting up Kerberos identities</a></li>
<li><a href="#property-security-realms_security-realms">3.3. Property realms</a></li>
<li><a href="#ldap-security-realms_security-realms">3.4. LDAP realms</a>
<ul class="sectlevel3">
<li><a href="#ldap-realm-principal-rewriting_security-realms">3.4.1. LDAP realm principal re-writing</a></li>
</ul>
</li>
<li><a href="#token-security-realms_security-realms">3.5. Token realms</a></li>
<li><a href="#trust-store-security-realms_security-realms">3.6. Trust store realms</a></li>
<li><a href="#distributed-security-realms_security-realms">3.7. Distributed security realms</a></li>
</ul>
</li>
<li><a href="#authentication-mechanisms">4. Endpoint authentication mechanisms</a>
<ul class="sectlevel2">
<li><a href="#server-authentication_endpoint-authentication">4.1. Infinispan Server authentication</a></li>
<li><a href="#configuring-server-authentication_endpoint-authentication">4.2. Configuring Infinispan Server authentication mechanisms</a>
<ul class="sectlevel3">
<li><a href="#disabling-authentication_endpoint-authentication">4.2.1. Disabling authentication</a></li>
</ul>
</li>
<li><a href="#server-endpoint-authentication-mechanisms_endpoint-authentication">4.3. Infinispan Server authentication mechanisms</a>
<ul class="sectlevel3">
<li><a href="#sasl-authentication-mechanisms_endpoint-authentication">4.3.1. SASL authentication mechanisms</a></li>
<li><a href="#sasl-quality-of-protection_endpoint-authentication">4.3.2. SASL quality of protection (QoP)</a></li>
<li><a href="#sasl-policies-hot-rod-authentication_endpoint-authentication">4.3.3. SASL policies</a></li>
<li><a href="#rest-authentication-mechanisms_endpoint-authentication">4.3.4. HTTP authentication mechanisms</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#configuring-encryption">5. Configuring TLS/SSL encryption</a>
<ul class="sectlevel2">
<li><a href="#configuring-server-keystores_endpoint-security">5.1. Configuring Infinispan Server keystores</a>
<ul class="sectlevel3">
<li><a href="#generating-server-keystores_endpoint-security">5.1.1. Generating Infinispan Server keystores</a></li>
<li><a href="#configuring-ssl-engine_endpoint-security">5.1.2. Configuring TLS versions and cipher suites</a></li>
</ul>
</li>
<li><a href="#configuring-server-fips_endpoint-security">5.2. Configuring Infinispan Server on a system with FIPS 140-2 compliant cryptography</a>
<ul class="sectlevel3">
<li><a href="#configuring_the_pkcs11_cryptographic_provider">5.2.1. Configuring the PKCS11 cryptographic provider</a></li>
<li><a href="#configuring_the_bouncy_castle_fips_cryptographic_provider">5.2.2. Configuring the Bouncy Castle FIPS cryptographic provider</a></li>
</ul>
</li>
<li><a href="#configuring-client-certificate-authentication_endpoint-security">5.3. Configuring client certificate authentication</a></li>
<li><a href="#configuring-client-certificate-authorization_endpoint-security">5.4. Configuring authorization with client certificates</a></li>
</ul>
</li>
<li><a href="#credential-keystores">6. Storing Infinispan Server credentials in keystores</a>
<ul class="sectlevel2">
<li><a href="#setting-up-credential-keystores_credential-keystores">6.1. Setting up credential keystores</a></li>
<li><a href="#credential-keystore-configuration_credential-keystores">6.2. Credential keystore configuration</a></li>
</ul>
</li>
<li><a href="#secure-cluster-transport">7. Encrypting cluster transport</a>
<ul class="sectlevel2">
<li><a href="#securing-cluster-transport-tls-identities_secure-cluster-transport">7.1. Securing cluster transport with TLS identities</a></li>
<li><a href="#jgroups-encryption-protocols_secure-cluster-transport">7.2. JGroups encryption protocols</a></li>
<li><a href="#configuring-jgroups-asym-encrypt_secure-cluster-transport">7.3. Securing cluster transport with asymmetric encryption</a></li>
<li><a href="#configuring-jgroups-sym-encrypt_secure-cluster-transport">7.4. Securing cluster transport with symmetric encryption</a></li>
</ul>
</li>
<li><a href="#ports_protocols">8. Infinispan ports and protocols</a>
<ul class="sectlevel2">
<li><a href="#server-ports-protocols_network">8.1. Infinispan Server ports and protocols</a>
<ul class="sectlevel3">
<li><a href="#configuring-firewalls_network">8.1.1. Configuring network firewalls for Infinispan traffic</a></li>
</ul>
</li>
<li><a href="#jgroups-ports_network">8.2. TCP and UDP ports for cluster traffic</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Securing the environment and restricting access to clusters is of critical importance for any deployment that stores sensitive data.
This guide provides information and security best practices to help you protect Infinispan caches against network intrusion and unauthorized access.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="security"><a class="anchor" href="#security"></a>1. Infinispan Security</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Infinispan provides security for components as well as data across different layers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Within the core library to provide role-based access control (RBAC) to CacheManagers, Cache instances, and stored data.</p>
</li>
<li>
<p>Over remote protocols to authenticate client requests and encrypt network traffic.</p>
</li>
<li>
<p>Across nodes in clusters to authenticate new cluster members and encrypt the cluster transport.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Infinispan core library uses standard Java security libraries such as
JAAS, JSSE, JCA, JCE, and SASL to ease integration and improve compatibility
with custom applications and container environments. For this reason, the
Infinispan core library provides only interfaces and a set of basic
implementations.</p>
</div>
<div class="paragraph">
<p>Infinispan servers support a wide range of security standards and mechanisms
to readily integrate with enterprise-level security frameworks.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="security-authorization"><a class="anchor" href="#security-authorization"></a>2. Configuring user roles and permissions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Authorization is a security feature that requires users to have certain permissions before they can access caches or interact with Infinispan resources.
You assign roles to users that provide different levels of permissions, from read-only access to full, super user privileges.</p>
</div>
<div class="sect2">
<h3 id="security-authorization_security-authorization"><a class="anchor" href="#security-authorization_security-authorization"></a>2.1. Security authorization</h3>
<div class="paragraph">
<p>Infinispan authorization secures your deployment by restricting user access.</p>
</div>
<div class="paragraph">
<p>User applications or clients must belong to a role that is assigned with sufficient permissions before they can perform operations on Cache Managers or caches.</p>
</div>
<div class="paragraph">
<p>For example, you configure authorization on a specific cache instance so that invoking <code>Cache.get()</code> requires an identity to be assigned a role with read permission while <code>Cache.put()</code> requires a role with write permission.</p>
</div>
<div class="paragraph">
<p>In this scenario, if a user application or client with the <code>io</code> role attempts to write an entry, Infinispan denies the request and throws a security exception.
If a user application or client with the <code>writer</code> role sends a write request, Infinispan validates authorization and issues a token for subsequent operations.</p>
</div>
<div class="paragraph">
<div class="title">Identities</div>
<p>Identities are security Principals of type <code>java.security.Principal</code>.
Subjects, implemented with the <code>javax.security.auth.Subject</code> class, represent a group of security Principals.
In other words, a Subject represents a user and all groups to which it belongs.</p>
</div>
<div class="paragraph">
<div class="title">Identities to roles</div>
<p>Infinispan uses role mappers so that security principals correspond to roles,
which you assign one or more permissions.</p>
</div>
<div class="paragraph">
<p>The following image illustrates how security principals correspond to roles:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../topics/images/SecurityRolesPermissions.svg" alt="Roles/Permissions mapping">
</div>
</div>
<div class="sect3">
<h4 id="user-roles-permissions_security-authorization"><a class="anchor" href="#user-roles-permissions_security-authorization"></a>2.1.1. User roles and permissions</h4>
<div class="paragraph">
<p>Infinispan includes a default set of roles that grant users with permissions to access data and interact with Infinispan resources.</p>
</div>
<div class="paragraph">
<p><code>ClusterRoleMapper</code> is the default mechanism that Infinispan uses to associate security principals to authorization roles.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>ClusterRoleMapper</code> matches principal names to role names.
A user named <code>admin</code> gets <code>admin</code> permissions automatically, a user named <code>deployer</code> gets <code>deployer</code> permissions, and so on.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Role</th>
<th class="tableblock halign-left valign-top">Permissions</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>admin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Superuser with all permissions including control of the Cache Manager lifecycle.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deployer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL_READ, ALL_WRITE, LISTEN, EXEC, MONITOR, CREATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can create and delete Infinispan resources in addition to <code>application</code> permissions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL_READ, ALL_WRITE, LISTEN, EXEC, MONITOR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Has read and write access to Infinispan resources in addition to <code>observer</code> permissions. Can also listen to events and execute server tasks and scripts.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>observer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL_READ, MONITOR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Has read access to Infinispan resources in addition to <code>monitor</code> permissions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>monitor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MONITOR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can view statistics via JMX and the <code>metrics</code> endpoint.</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<div class="title">Reference</div>
<ul>
<li>
<p><a href="https://docs.jboss.org/infinispan/13.0/apidocs">org.infinispan.security.AuthorizationPermission Enumeration</a></p>
</li>
<li>
<p><a href="https://docs.jboss.org/infinispan/13.0/configdocs/">Infinispan configuration schema reference</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="user-permissions_security-authorization"><a class="anchor" href="#user-permissions_security-authorization"></a>2.1.2. Permissions</h4>
<div class="paragraph">
<p>Authorization roles have different permissions with varying levels of access to Infinispan.
Permissions let you restrict user access to both Cache Managers and caches.</p>
</div>
<div class="sect4">
<h5 id="cache_manager_permissions"><a class="anchor" href="#cache_manager_permissions"></a>Cache Manager permissions</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Permission</th>
<th class="tableblock halign-left valign-top">Function</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONFIGURATION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>defineConfiguration</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines new cache configurations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LISTEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>addListener</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Registers listeners against a Cache Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LIFECYCLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stop</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stops the Cache Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CREATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>createCache</code>, <code>removeCache</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create and remove container resources  such as caches, counters, schemas, and scripts.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MONITOR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getStats</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows access to JMX statistics and the <code>metrics</code> endpoint.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Includes all Cache Manager permissions.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="cache_permissions"><a class="anchor" href="#cache_permissions"></a>Cache permissions</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Permission</th>
<th class="tableblock halign-left valign-top">Function</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">READ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get</code>, <code>contains</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieves entries from a cache.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WRITE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>put</code>, <code>putIfAbsent</code>, <code>replace</code>, <code>remove</code>, <code>evict</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Writes, replaces, removes, evicts data in a cache.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXEC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>distexec</code>, <code>streams</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows code execution against a cache.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LISTEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>addListener</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Registers listeners against a cache.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BULK_READ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>keySet</code>, <code>values</code>, <code>entrySet</code>, <code>query</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Executes bulk retrieve operations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BULK_WRITE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>clear</code>, <code>putAll</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Executes bulk write operations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LIFECYCLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>start</code>, <code>stop</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Starts and stops a cache.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADMIN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getVersion</code>, <code>addInterceptor*</code>, <code>removeInterceptor</code>, <code>getInterceptorChain</code>, <code>getEvictionManager</code>, <code>getComponentRegistry</code>, <code>getDistributionManager</code>, <code>getAuthorizationManager</code>, <code>evict</code>, <code>getRpcManager</code>, <code>getCacheConfiguration</code>, <code>getCacheManager</code>, <code>getInvocationContextContainer</code>, <code>setAvailability</code>, <code>getDataContainer</code>, <code>getStats</code>, <code>getXAResource</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows access to underlying components and internal structures.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MONITOR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getStats</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows access to JMX statistics and the <code>metrics</code> endpoint.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Includes all cache permissions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL_READ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Combines the READ and BULK_READ permissions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL_WRITE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Combines the WRITE and BULK_WRITE permissions.</p></td>
</tr>
</tbody>
</table>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.jboss.org/infinispan/13.0/apidocs/org/infinispan/security/package-summary.html">Infinispan Security API</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="role-mappers_security-authorization"><a class="anchor" href="#role-mappers_security-authorization"></a>2.1.3. Role mappers</h4>
<div class="paragraph">
<p>Infinispan includes a <code>PrincipalRoleMapper</code> API that maps security Principals in a Subject to authorization roles that you can assign to users.</p>
</div>
<div class="sect4">
<h5 id="cluster_role_mappers"><a class="anchor" href="#cluster_role_mappers"></a>Cluster role mappers</h5>
<div class="paragraph">
<p><code>ClusterRoleMapper</code> uses a persistent replicated cache to dynamically store principal-to-role mappings for the default roles and permissions.</p>
</div>
<div class="paragraph">
<p>By default uses the Principal name as the role name and implements <code>org.infinispan.security.MutableRoleMapper</code> which exposes methods to change role mappings at runtime.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java class: <code>org.infinispan.security.mappers.ClusterRoleMapper</code></p>
</li>
<li>
<p>Declarative configuration: <code>&lt;cluster-role-mapper /&gt;</code></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="identity_role_mappers"><a class="anchor" href="#identity_role_mappers"></a>Identity role mappers</h5>
<div class="paragraph">
<p><code>IdentityRoleMapper</code> uses the Principal name as the role name.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java class: <code>org.infinispan.security.mappers.IdentityRoleMapper</code></p>
</li>
<li>
<p>Declarative configuration: <code>&lt;identity-role-mapper /&gt;</code></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="commonname_role_mappers"><a class="anchor" href="#commonname_role_mappers"></a>CommonName role mappers</h5>
<div class="paragraph">
<p><code>CommonNameRoleMapper</code> uses the Common Name (CN) as the role name if the
Principal name is a Distinguished Name (DN).</p>
</div>
<div class="paragraph">
<p>For example this DN, <code>cn=managers,ou=people,dc=example,dc=com</code>, maps to the <code>managers</code> role.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java class: <code>org.infinispan.security.mappers.CommonRoleMapper</code></p>
</li>
<li>
<p>Declarative configuration: <code>&lt;common-name-role-mapper /&gt;</code></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="custom_role_mappers"><a class="anchor" href="#custom_role_mappers"></a>Custom role mappers</h5>
<div class="paragraph">
<p>Custom role mappers are implementations of <code>org.infinispan.security.PrincipalRoleMapper</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Declarative configuration: <code>&lt;custom-role-mapper class="my.custom.RoleMapper" /&gt;</code></p>
</li>
</ul>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.jboss.org/infinispan/13.0/apidocs/org/infinispan/security/package-summary.html">Infinispan Security API</a></p>
</li>
<li>
<p><a href="https://docs.jboss.org/infinispan/13.0/apidocs/org/infinispan/security/PrincipalRoleMapper.html">org.infinispan.security.PrincipalRoleMapper</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="acl-cache_security-authorization"><a class="anchor" href="#acl-cache_security-authorization"></a>2.2. Access control list (ACL) cache</h3>
<div class="paragraph">
<p>Infinispan caches roles that you grant to users internally for optimal performance.
Whenever you grant or deny roles to users, Infinispan flushes the ACL cache to ensure user permissions are applied correctly.</p>
</div>
<div class="paragraph">
<p>If necessary, you can disable the ACL cache or configure it with the <code>cache-size</code> and <code>cache-timeout</code> attributes.</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;infinispan&gt;</span>
  <span class="tag">&lt;cache-container</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">acl-cache-configuration</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;security</span> <span class="attribute-name">cache-size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1000</span><span class="delimiter">&quot;</span></span>
              <span class="attribute-name">cache-timeout</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">300000</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;authorization</span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/security&gt;</span>
  <span class="tag">&lt;/cache-container&gt;</span>
<span class="tag">&lt;/infinispan&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">infinispan</span><span class="delimiter">&quot;</span></span> : {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cache-container</span><span class="delimiter">&quot;</span></span> : {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">acl-cache-configuration</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span> : {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">cache-size</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">1000</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">cache-timeout</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">300000</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">authorization</span><span class="delimiter">&quot;</span></span> : {}
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">infinispan</span>:
  <span class="key">cacheContainer</span>:
    <span class="key">name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">acl-cache-configuration</span><span class="delimiter">&quot;</span></span>
    <span class="key">security</span>:
      <span class="key">cache-size</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">1000</span><span class="delimiter">&quot;</span></span>
      <span class="key">cache-timeout</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">300000</span><span class="delimiter">&quot;</span></span>
      <span class="key">authorization</span>: <span class="string"><span class="content">~</span></span></code></pre>
</div>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.jboss.org/infinispan/13.0/configdocs/">Infinispan configuration schema reference</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="customizing-authorization_security-authorization"><a class="anchor" href="#customizing-authorization_security-authorization"></a>2.3. Customizing roles and permissions</h3>
<div class="paragraph">
<p>You can customize authorization settings in your Infinispan configuration to use role mappers with different combinations of roles and permissions.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Declare a role mapper and a set of custom roles and permissions in the Cache Manager configuration.</p>
</li>
<li>
<p>Configure authorization for caches to restrict access based on user roles.</p>
</li>
</ol>
</div>
<h4 id="custom_roles_and_permissions_configuration" class="discrete">Custom roles and permissions configuration</h4>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;infinispan&gt;</span>
  <span class="tag">&lt;cache-container</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">custom-authorization</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;security&gt;</span>
      <span class="tag">&lt;authorization&gt;</span>
        <span class="comment">&lt;!-- Declare a role mapper that associates a security principal
             to each role. --&gt;</span>
        <span class="tag">&lt;identity-role-mapper</span> <span class="tag">/&gt;</span>
        <span class="comment">&lt;!-- Specify user roles and corresponding permissions. --&gt;</span>
        <span class="tag">&lt;role</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">admin</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">permissions</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ALL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;role</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">reader</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">permissions</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">READ</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;role</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">writer</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">permissions</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WRITE</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;role</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">supervisor</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">permissions</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">READ WRITE EXEC</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/authorization&gt;</span>
    <span class="tag">&lt;/security&gt;</span>
  <span class="tag">&lt;/cache-container&gt;</span>
<span class="tag">&lt;/infinispan&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">infinispan</span><span class="delimiter">&quot;</span></span> : {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cache-container</span><span class="delimiter">&quot;</span></span> : {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">custom-authorization</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span> : {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">authorization</span><span class="delimiter">&quot;</span></span> : {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">identity-role-mapper</span><span class="delimiter">&quot;</span></span> : <span class="value">null</span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">roles</span><span class="delimiter">&quot;</span></span> : {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">reader</span><span class="delimiter">&quot;</span></span> : {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">role</span><span class="delimiter">&quot;</span></span> : {
                <span class="key"><span class="delimiter">&quot;</span><span class="content">permissions</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">READ</span><span class="delimiter">&quot;</span></span>
              }
            },
            <span class="key"><span class="delimiter">&quot;</span><span class="content">admin</span><span class="delimiter">&quot;</span></span> : {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">role</span><span class="delimiter">&quot;</span></span> : {
                <span class="key"><span class="delimiter">&quot;</span><span class="content">permissions</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">ALL</span><span class="delimiter">&quot;</span></span>
              }
            },
            <span class="key"><span class="delimiter">&quot;</span><span class="content">writer</span><span class="delimiter">&quot;</span></span> : {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">role</span><span class="delimiter">&quot;</span></span> : {
                <span class="key"><span class="delimiter">&quot;</span><span class="content">permissions</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">WRITE</span><span class="delimiter">&quot;</span></span>
              }
            },
            <span class="key"><span class="delimiter">&quot;</span><span class="content">supervisor</span><span class="delimiter">&quot;</span></span> : {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">role</span><span class="delimiter">&quot;</span></span> : {
                <span class="key"><span class="delimiter">&quot;</span><span class="content">permissions</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">READ WRITE EXEC</span><span class="delimiter">&quot;</span></span>
              }
            }
          }
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">infinispan</span>:
  <span class="key">cacheContainer</span>:
    <span class="key">name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">custom-authorization</span><span class="delimiter">&quot;</span></span>
    <span class="key">security</span>:
      <span class="key">authorization</span>:
        <span class="key">identityRoleMapper</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">null</span><span class="delimiter">&quot;</span></span>
        <span class="key">roles</span>:
          <span class="key">reader</span>:
            <span class="key">role</span>:
              <span class="key">permissions</span>:
                - <span class="string"><span class="delimiter">&quot;</span><span class="content">READ</span><span class="delimiter">&quot;</span></span>
          <span class="key">admin</span>:
            <span class="key">role</span>:
              <span class="key">permissions</span>:
                - <span class="string"><span class="delimiter">&quot;</span><span class="content">ALL</span><span class="delimiter">&quot;</span></span>
          <span class="key">writer</span>:
            <span class="key">role</span>:
              <span class="key">permissions</span>:
                - <span class="string"><span class="delimiter">&quot;</span><span class="content">WRITE</span><span class="delimiter">&quot;</span></span>
          <span class="key">supervisor</span>:
            <span class="key">role</span>:
              <span class="key">permissions</span>:
                - <span class="string"><span class="delimiter">&quot;</span><span class="content">READ</span><span class="delimiter">&quot;</span></span>
                - <span class="string"><span class="delimiter">&quot;</span><span class="content">WRITE</span><span class="delimiter">&quot;</span></span>
                - <span class="string"><span class="delimiter">&quot;</span><span class="content">EXEC</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuring-cache-authorization_security-authorization"><a class="anchor" href="#configuring-cache-authorization_security-authorization"></a>2.4. Configuring caches with security authorization</h3>
<div class="paragraph">
<p>Use authorization in your cache configuration to restrict user access.
Before they can read or write cache entries, or create and delete caches, users must have a role with a sufficient level of permission.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Ensure the <code>authorization</code> element is included in the <code>security</code> section of the <code>cache-container</code> configuration.</p>
<div class="paragraph">
<p>Infinispan enables security authorization in the Cache Manager by default and provides a global set of roles and permissions for caches.</p>
</div>
</li>
<li>
<p>If necessary, declare custom roles and permissions in the Cache Manager configuration.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Open your cache configuration for editing.</p>
</li>
<li>
<p>Add the <code>authorization</code> element to caches to restrict user access based on their roles and permissions.</p>
</li>
<li>
<p>Save the changes to your configuration.</p>
</li>
</ol>
</div>
<h4 id="authorization_configuration" class="discrete">Authorization configuration</h4>
<div class="paragraph">
<p>The following configuration shows how to use implicit authorization configuration with default roles and permissions:</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;distributed-cache&gt;</span>
  <span class="tag">&lt;security&gt;</span>
    <span class="comment">&lt;!-- Inherit authorization settings from the cache-container. --&gt;</span> <span class="tag">&lt;authorization</span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/security&gt;</span>
<span class="tag">&lt;/distributed-cache&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">distributed-cache</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">authorization</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">enabled</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">distributedCache</span>:
  <span class="key">security</span>:
    <span class="key">authorization</span>:
      <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span></code></pre>
</div>
</div>
<h4 id="custom_roles_and_permissions" class="discrete">Custom roles and permissions</h4>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;distributed-cache&gt;</span>
  <span class="tag">&lt;security&gt;</span>
    <span class="tag">&lt;authorization</span> <span class="attribute-name">roles</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">admin supervisor</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/security&gt;</span>
<span class="tag">&lt;/distributed-cache&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">distributed-cache</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">authorization</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">enabled</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">roles</span><span class="delimiter">&quot;</span></span>: [<span class="string"><span class="delimiter">&quot;</span><span class="content">admin</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">supervisor</span><span class="delimiter">&quot;</span></span>]
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">distributedCache</span>:
  <span class="key">security</span>:
    <span class="key">authorization</span>:
      <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span>
      <span class="key">roles</span>: <span class="string"><span class="content">[&quot;admin&quot;,&quot;supervisor&quot;]</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="disabling-authorization_security-authorization"><a class="anchor" href="#disabling-authorization_security-authorization"></a>2.5. Disabling security authorization</h3>
<div class="paragraph">
<p>In local development environments you can disable authorization so that users do not need roles and permissions.
Disabling security authorization means that any user can access data and interact with Infinispan resources.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Open your Infinispan configuration for editing.</p>
</li>
<li>
<p>Remove any <code>authorization</code> elements from the <code>security</code> configuration for the Cache Manager.</p>
</li>
<li>
<p>Remove any <code>authorization</code> configuration from your caches.</p>
</li>
<li>
<p>Save the changes to your configuration.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="configuring-authorization-programmatically_security-authorization"><a class="anchor" href="#configuring-authorization-programmatically_security-authorization"></a>2.6. Programmatically configuring authorization</h3>
<div class="paragraph">
<p>When using embedded caches, you can configure authorization with the <code>GlobalSecurityConfigurationBuilder</code> and <code>ConfigurationBuilder</code> classes.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Construct a <code>GlobalConfigurationBuilder</code> that enables authorization, specifies a role mapper, and defines a set of roles and permissions.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">GlobalConfigurationBuilder global = <span class="keyword">new</span> GlobalConfigurationBuilder();
global
   .security()
      .authorization().enable() <i class="conum" data-value="1"></i><b>(1)</b>
         .principalRoleMapper(<span class="keyword">new</span> IdentityRoleMapper()) <i class="conum" data-value="2"></i><b>(2)</b>
         .role(<span class="string"><span class="delimiter">&quot;</span><span class="content">admin</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="3"></i><b>(3)</b>
            .permission(AuthorizationPermission.ALL)
         .role(<span class="string"><span class="delimiter">&quot;</span><span class="content">reader</span><span class="delimiter">&quot;</span></span>)
            .permission(AuthorizationPermission.READ)
         .role(<span class="string"><span class="delimiter">&quot;</span><span class="content">writer</span><span class="delimiter">&quot;</span></span>)
            .permission(AuthorizationPermission.WRITE)
         .role(<span class="string"><span class="delimiter">&quot;</span><span class="content">supervisor</span><span class="delimiter">&quot;</span></span>)
            .permission(AuthorizationPermission.READ)
            .permission(AuthorizationPermission.WRITE)
            .permission(AuthorizationPermission.EXEC);</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enables Infinispan authorization for the Cache Manager.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Specifies an implementation of <code>PrincipalRoleMapper</code> that maps Principals
to roles.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Defines roles and their associated permissions.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Enable authorization in the <code>ConfigurationBuilder</code> for caches to restrict access based on user roles.</p>
<div class="listingblock">
<div class="content">
<pre>ConfigurationBuilder config = new ConfigurationBuilder();
config
   .security()
      .authorization()
         .enable(); <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Implicitly adds all roles from the global configuration.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you do not want to apply all roles to a cache, explicitly define the roles
that are authorized for caches as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ConfigurationBuilder config = new ConfigurationBuilder();
config
   .security()
      .authorization()
         .enable()
         .role("admin") <i class="conum" data-value="1"></i><b>(1)</b>
         .role("supervisor")
         .role("reader");</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Defines authorized roles for the cache. In this example, users who have the <code>writer</code> role only are not authorized for the "secured" cache. Infinispan denies any access requests from those users.</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.jboss.org/infinispan/13.0/apidocs/org/infinispan/configuration/global/GlobalSecurityConfigurationBuilder.html">org.infinispan.configuration.global.GlobalSecurityConfigurationBuilder</a></p>
</li>
<li>
<p><a href="https://docs.jboss.org/infinispan/13.0/apidocs/org/infinispan/configuration/cache/ConfigurationBuilder.html">org.infinispan.configuration.cache.ConfigurationBuilder</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="code-execution-security-authorization_security-authorization"><a class="anchor" href="#code-execution-security-authorization_security-authorization"></a>2.7. Code execution with security authorization</h3>
<div class="paragraph">
<p>When you configure security authorization for embedded caches and then construct a <code>DefaultCacheManager</code>, it returns a <code>SecureCache</code> that checks the security context before invoking any operations.
A <code>SecureCache</code> also ensures that applications cannot retrieve lower-level insecure objects such as <code>DataContainer</code>.
For this reason, you must execute code with an identity that has the required authorization.</p>
</div>
<div class="paragraph">
<p>In Java, executing code with a specific identity usually means wrapping the code to be executed within a <code>PrivilegedAction</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.infinispan.security.Security</span>;

<span class="predefined-type">Security</span>.doAs(subject, <span class="keyword">new</span> <span class="predefined-type">PrivilegedExceptionAction</span>&lt;<span class="predefined-type">Void</span>&gt;() {
<span class="directive">public</span> <span class="predefined-type">Void</span> run() <span class="directive">throws</span> <span class="exception">Exception</span> {
    cache.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">key</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>);
}
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>With Java 8, you can simplify the preceding call as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Security</span>.doAs(mySubject, <span class="predefined-type">PrivilegedAction</span>&lt;<span class="predefined-type">String</span>&gt;() -&gt; cache.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">key</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding call uses the <code>Security.doAs()</code> method instead of <code>Subject.doAs()</code>.
You can use either method with Infinispan, however <code>Security.doAs()</code> provides better performance.</p>
</div>
<div class="paragraph">
<p>If you need the current Subject, use the following call to retrieve it from the Infinispan context or from the AccessControlContext:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Security</span>.getSubject();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="security-realms"><a class="anchor" href="#security-realms"></a>3. Security realms</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Security realms integrate Infinispan Server deployments with the network protocols and infrastructure in your environment that control access and verify user identities.</p>
</div>
<div class="sect2">
<h3 id="creating-security-realms_security-realms"><a class="anchor" href="#creating-security-realms_security-realms"></a>3.1. Creating security realms</h3>
<div class="paragraph">
<p>Add security realms to Infinispan Server configuration to control access to deployments.
You can add one or more security realm to your configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When you add security realms to your configuration, Infinispan Server automatically enables the matching authentication mechanisms for the Hot Rod and REST endpoints.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Add socket bindings to your Infinispan Server configuration as required.</p>
</li>
<li>
<p>Create keystores, or have a PEM file, to configure the security realm with TLS/SSL encryption.</p>
<div class="paragraph">
<p>Infinispan Server can also generate keystores at startup.</p>
</div>
</li>
<li>
<p>Provision the resources or services that the security realm configuration relies on.<br>
For example, if you add a token realm, you need to provision OAuth services.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This procedure demonstrates how to configure multiple property realms.
Before you begin, you need to create properties files that add users and assign permissions with the Command Line Interface (CLI).
Use the <code class="command">user create</code> commands as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>user create &lt;username&gt; -p &lt;changeme&gt; -g &lt;role&gt; \
     --users-file=application-users.properties \
     --groups-file=application-groups.properties

user create &lt;username&gt; -p &lt;changeme&gt; -g &lt;role&gt; \
     --users-file=management-users.properties \
     --groups-file=management-groups.properties</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Run <code class="command">user create --help</code> for examples and more information.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Adding credentials to a properties realm with the CLI creates the user only on the server instance to which you are connected.
You must manually synchronize credentials in a properties realm to each node in the cluster.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Open your Infinispan Server configuration for editing.</p>
</li>
<li>
<p>Use the <code>security-realms</code> element in the <code>security</code> configuration to contain create multiple security realms.</p>
</li>
<li>
<p>Add a security realm with the <code>security-realm</code> element and give it a unique name with the <code>name</code> attribute.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Do not add special characters, such as hyphens (<code>-</code>) or ampersands (<code>&amp;</code>), to security realm names.
Infinispan Server endpoints can become unreachable if security realm names contain special characters.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To follow the example, create one security realm named <code>ApplicationRealm</code> and another named <code>ManagementRealm</code>.</p>
</div>
</li>
<li>
<p>Provide the TLS/SSL identify for Infinispan Server with the <code>server-identities</code> element and configure a keystore as required.</p>
</li>
<li>
<p>Specify the type of security realm by adding one the following elements or fields:</p>
<div class="ulist">
<ul>
<li>
<p><code>properties-realm</code></p>
</li>
<li>
<p><code>ldap-realm</code></p>
</li>
<li>
<p><code>token-realm</code></p>
</li>
<li>
<p><code>truststore-realm</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Specify properties for the type of security realm you are configuring as appropriate.</p>
<div class="paragraph">
<p>To follow the example, specify the <code>*.properties</code> files you created with the CLI using the <code>path</code> attribute on the <code>user-properties</code> and <code>group-properties</code> elements or fields.</p>
</div>
</li>
<li>
<p>If you add multiple different types of security realm to your configuration, include the <code>distributed-realm</code> element or field so that Infinispan Server uses the realms in combination with each other.</p>
</li>
<li>
<p>Configure Infinispan Server endpoints to use the security realm with the with the <code>security-realm</code> attribute.</p>
</li>
<li>
<p>Save the changes to your configuration.</p>
</li>
</ol>
</div>
<h4 id="multiple_property_realms" class="discrete">Multiple property realms</h4>
<div class="paragraph">
<p>The following configuration shows how you can configure multiple security realms in XML, JSON, or YAML format:</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;security&gt;</span>
    <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ApplicationRealm</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;properties-realm</span> <span class="attribute-name">groups-attribute</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          <span class="tag">&lt;user-properties</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application-users.properties</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;group-properties</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application-groups.properties</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/properties-realm&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ManagementRealm</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;properties-realm</span> <span class="attribute-name">groups-attribute</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          <span class="tag">&lt;user-properties</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">management-users.properties</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;group-properties</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">management-groups.properties</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/properties-realm&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
    <span class="tag">&lt;/security-realms&gt;</span>
  <span class="tag">&lt;/security&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realms</span><span class="delimiter">&quot;</span></span>: [{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ManagementRealm</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">properties-realm</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">groups-attribute</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">user-properties</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">digest-realm-name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ManagementRealm</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">management-users.properties</span><span class="delimiter">&quot;</span></span>
          },
          <span class="key"><span class="delimiter">&quot;</span><span class="content">group-properties</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">management-groups.properties</span><span class="delimiter">&quot;</span></span>
          }
        }
      }, {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ApplicationRealm</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">properties-realm</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">groups-attribute</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">user-properties</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">digest-realm-name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ApplicationRealm</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application-users.properties</span><span class="delimiter">&quot;</span></span>
          },
          <span class="key"><span class="delimiter">&quot;</span><span class="content">group-properties</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application-groups.properties</span><span class="delimiter">&quot;</span></span>
          }
        }
      }]
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">security</span>:
    <span class="key">securityRealms</span>:
      - <span class="string"><span class="content">name: &quot;ManagementRealm&quot;</span></span>
        <span class="key">propertiesRealm</span>:
          <span class="key">groupsAttribute</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>
          <span class="key">userProperties</span>:
            <span class="key">digestRealmName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ManagementRealm</span><span class="delimiter">&quot;</span></span>
            <span class="key">path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">management-users.properties</span><span class="delimiter">&quot;</span></span>
          <span class="key">groupProperties</span>:
            <span class="key">path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">management-groups.properties</span><span class="delimiter">&quot;</span></span>
      - <span class="string"><span class="content">name: &quot;ApplicationRealm&quot;</span></span>
        <span class="key">propertiesRealm</span>:
          <span class="key">groupsAttribute</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>
          <span class="key">userProperties</span>:
            <span class="key">digestRealmName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ApplicationRealm</span><span class="delimiter">&quot;</span></span>
            <span class="key">path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application-users.properties</span><span class="delimiter">&quot;</span></span>
          <span class="key">groupProperties</span>:
            <span class="key">path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application-groups.properties</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="setting-up-kerberos-identities_security-realms"><a class="anchor" href="#setting-up-kerberos-identities_security-realms"></a>3.2. Setting up Kerberos identities</h3>
<div class="paragraph">
<p>Add Kerberos identities to a security realm in your Infinispan Server configuration to use <em>keytab</em> files that contain service principal names and encrypted keys, derived from Kerberos passwords.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Have Kerberos service account principals.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><em>keytab</em> files can contain both user and service account principals.
However, Infinispan Server uses service account principals only which means it can provide identity to clients and allow clients to authenticate with Kerberos servers.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In most cases, you create unique principals for the Hot Rod and REST endpoints.
For example, if you have a "datagrid" server in the "INFINISPAN.ORG" domain you should create the following service principals:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hotrod/datagrid@INFINISPAN.ORG</code> identifies the Hot Rod service.</p>
</li>
<li>
<p><code>HTTP/datagrid@INFINISPAN.ORG</code> identifies the REST service.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create keytab files for the Hot Rod and REST services.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Linux</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>ktutil
ktutil:  addent -password -p datagrid@INFINISPAN.ORG -k 1 -e aes256-cts
Password for datagrid@INFINISPAN.ORG: [enter your password]
ktutil:  wkt http.keytab
ktutil:  quit</code></pre>
</div>
</div>
</dd>
<dt class="hdlist1">Microsoft Windows</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>ktpass -princ HTTP/datagrid@INFINISPAN.ORG -pass * -mapuser INFINISPAN\USER_NAME
ktab -k http.keytab -a HTTP/datagrid@INFINISPAN.ORG</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>Copy the keytab files to the <code>server/conf</code> directory of your Infinispan Server installation.</p>
</li>
<li>
<p>Open your Infinispan Server configuration for editing.</p>
</li>
<li>
<p>Add a <code>server-identities</code> definition to the Infinispan server security realm.</p>
</li>
<li>
<p>Specify the location of keytab files that provide service principals to Hot Rod and REST connectors.</p>
</li>
<li>
<p>Name the Kerberos service principals.</p>
</li>
<li>
<p>Save the changes to your configuration.</p>
</li>
</ol>
</div>
<h4 id="kerberos_identity_configuration" class="discrete">Kerberos identity configuration</h4>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;security&gt;</span>
    <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">kerberos-realm</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;server-identities&gt;</span>
          <span class="comment">&lt;!-- Specifies a keytab file that provides a Kerberos identity. --&gt;</span>
          <span class="comment">&lt;!-- Names the Kerberos service principal for the Hot Rod endpoint. --&gt;</span>
          <span class="comment">&lt;!-- The required=&quot;true&quot; attribute specifies that the keytab file must be present when the server starts. --&gt;</span>
          <span class="tag">&lt;kerberos</span> <span class="attribute-name">keytab-path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod.keytab</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">principal</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod/datagrid@INFINISPAN.ORG</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">required</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="comment">&lt;!-- Specifies a keytab file and names the Kerberos service principal for the REST endpoint. --&gt;</span>
          <span class="tag">&lt;kerberos</span> <span class="attribute-name">keytab-path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http.keytab</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">principal</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">HTTP/localhost@INFINISPAN.ORG</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">required</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/server-identities&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
    <span class="tag">&lt;/security-realms&gt;</span>
  <span class="tag">&lt;/security&gt;</span>
  <span class="tag">&lt;endpoints&gt;</span>
    <span class="tag">&lt;endpoint</span> <span class="attribute-name">socket-binding</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>
              <span class="attribute-name">security-realm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">KerberosRealm</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
     <span class="tag">&lt;hotrod-connector&gt;</span>
        <span class="tag">&lt;authentication&gt;</span>
           <span class="tag">&lt;sasl</span> <span class="attribute-name">server-name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">datagrid</span><span class="delimiter">&quot;</span></span>
                 <span class="attribute-name">server-principal</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod/datagrid@INFINISPAN.ORG</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/authentication&gt;</span>
     <span class="tag">&lt;/hotrod-connector&gt;</span>
     <span class="tag">&lt;rest-connector&gt;</span>
       <span class="tag">&lt;authentication</span> <span class="attribute-name">server-principal</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">HTTP/localhost@INFINISPAN.ORG</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
     <span class="tag">&lt;/rest-connector&gt;</span>
   <span class="tag">&lt;/endpoint&gt;</span>
  <span class="tag">&lt;/endpoints&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realms</span><span class="delimiter">&quot;</span></span>: [{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">KerberosRealm</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">server-identities</span><span class="delimiter">&quot;</span></span>: [{
          <span class="key"><span class="delimiter">&quot;</span><span class="content">kerberos</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">principal</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod/datagrid@INFINISPAN.ORG</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">keytab-path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod.keytab</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>
          },
          <span class="key"><span class="delimiter">&quot;</span><span class="content">kerberos</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">principal</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">HTTP/localhost@INFINISPAN.ORG</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">keytab-path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http.keytab</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>
          }
        }]
      }]
    },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">endpoints</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">endpoint</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">socket-binding</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realm</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">KerberosRealm</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">hotrod-connector</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">authentication</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realm</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">kerberos-realm</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">sasl</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">server-name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">datagrid</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">server-principal</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod/datagrid@INFINISPAN.ORG</span><span class="delimiter">&quot;</span></span>
            }
          }
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">rest-connector</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">authentication</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">server-principal</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">HTTP/localhost@INFINISPAN.ORG</span><span class="delimiter">&quot;</span></span>
          }
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">security</span>:
    <span class="key">securityRealms</span>:
      - <span class="string"><span class="content">name: &quot;KerberosRealm&quot;</span></span>
        <span class="key">serverIdentities</span>:
          - <span class="string"><span class="content">kerberos:</span><span class="content">
              principal: &quot;hotrod/datagrid@INFINISPAN.ORG&quot;
              keytabPath: &quot;hotrod.keytab&quot;
              required: &quot;true&quot;</span></span>
          - <span class="string"><span class="content">kerberos:</span><span class="content">
              principal: &quot;HTTP/localhost@INFINISPAN.ORG&quot;
              keytabPath: &quot;http.keytab&quot;
              required: &quot;true&quot;</span></span>
  <span class="key">endpoints</span>:
    <span class="key">endpoint</span>:
      <span class="key">socketBinding</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>
      <span class="key">securityRealm</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">KerberosRealm</span><span class="delimiter">&quot;</span></span>
      <span class="key">hotrodConnector</span>:
        <span class="key">authentication</span>:
          <span class="key">sasl</span>:
            <span class="key">serverName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">datagrid</span><span class="delimiter">&quot;</span></span>
            <span class="key">serverPrincipal</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod/datagrid@INFINISPAN.ORG</span><span class="delimiter">&quot;</span></span>
      <span class="key">restConnector</span>:
        <span class="key">authentication</span>:
          <span class="key">securityRealm</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">KerberosRealm</span><span class="delimiter">&quot;</span></span>
          <span class="key">serverPrincipal&quot;</span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">HTTP/localhost@INFINISPAN.ORG</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="property-security-realms_security-realms"><a class="anchor" href="#property-security-realms_security-realms"></a>3.3. Property realms</h3>
<div class="paragraph">
<p>Property realms use property files to define users and groups.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>users.properties</code> contains Infinispan user credentials.
Passwords can be pre-digested with the <code>DIGEST-MD5</code> and <code>DIGEST</code> authentication mechanisms.</p>
</li>
<li>
<p><code>groups.properties</code> associates users with roles and permissions.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Properties files contain headers that associate them with security realms in Infinispan Server configuration.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">users.properties</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code>myuser=a_password
user2=another_password</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">groups.properties</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code>myuser=supervisor,reader,writer
user2=supervisor</code></pre>
</div>
</div>
<h4 id="property_realm_configuration" class="discrete">Property realm configuration</h4>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;security&gt;</span>
    <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="comment">&lt;!-- groups-attribute configures the &quot;groups.properties&quot; file to contain security authorization roles. --&gt;</span>
        <span class="tag">&lt;properties-realm</span> <span class="attribute-name">groups-attribute</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          <span class="tag">&lt;user-properties</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">users.properties</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">plain-text</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;group-properties</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">groups.properties</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/properties-realm&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
    <span class="tag">&lt;/security-realms&gt;</span>
  <span class="tag">&lt;/security&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realms</span><span class="delimiter">&quot;</span></span>: [{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">properties-realm</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">groups-attribute</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">user-properties</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">digest-realm-name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">users.properties</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">relative-to</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">plain-text</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>
          },
          <span class="key"><span class="delimiter">&quot;</span><span class="content">group-properties</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">groups.properties</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">relative-to</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>
          }
        }
      }]
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">security</span>:
    <span class="key">securityRealms</span>:
      - <span class="string"><span class="content">name: &quot;default&quot;</span></span>
        <span class="key">propertiesRealm</span>:
          <span class="comment"># groupsAttribute configures the &quot;groups.properties&quot; file</span>
          <span class="comment"># to contain security authorization roles.</span>
          <span class="key">groupsAttribute</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>
          <span class="key">userProperties</span>:
            <span class="key">digestRealmName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>
            <span class="key">path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">users.properties</span><span class="delimiter">&quot;</span></span>
            <span class="key">relative-to</span>: <span class="string"><span class="content">'infinispan.server.config.path'</span></span>
            <span class="key">plainText</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>
          <span class="key">groupProperties</span>:
            <span class="key">path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">groups.properties</span><span class="delimiter">&quot;</span></span>
            <span class="key">relative-to</span>: <span class="string"><span class="content">'infinispan.server.config.path'</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ldap-security-realms_security-realms"><a class="anchor" href="#ldap-security-realms_security-realms"></a>3.4. LDAP realms</h3>
<div class="paragraph">
<p>LDAP realms connect to LDAP servers, such as OpenLDAP, Red Hat Directory
Server, Apache Directory Server, or Microsoft Active Directory, to authenticate
users and obtain membership information.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>LDAP servers can have different entry layouts, depending on the type of server and deployment.
It is beyond the scope of this document to provide examples for all possible configurations.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The principal for LDAP connections must have necessary privileges to perform
LDAP queries and access specific attributes.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As an alternative to verifying user credentials with the <code>direct-verification</code> attribute, you can specify an LDAP attribute that validates passwords with the <code>user-password-mapper</code> element.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You cannot use endpoint authentication mechanisms that perform hashing with the <code>direct-verification</code> attribute.</p>
</div>
<div class="paragraph">
<p>Because Active Directory does not expose the <code>password</code> attribute you can use the <code>direct-verification</code> attribute only and not the <code>user-password-mapper</code> element.
As a result you must use the <code>BASIC</code> authentication mechanism with the REST endpoint and <code>PLAIN</code> with the Hot Rod endpoint to integrate with Active Directory Server.
A more secure alternative is to use Kerberos, which allows the <code>SPNEGO</code>, <code>GSSAPI</code>, and <code>GS2-KRB5</code> authentication mechanisms.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>rdn-identifier</code> attribute specifies an LDAP attribute that finds the user entry based on a provided identifier, which is typically a username; for example, the <code>uid</code> or <code>sAMAccountName</code> attribute.
Add <code>search-recursive="true"</code> to the configuration to search the directory recursively.
By default, the search for the user entry uses the <code>(rdn_identifier={0})</code> filter.
Specify a different filter with the <code>filter-name</code> attribute.</p>
</div>
<div class="paragraph">
<p>The <code>attribute-mapping</code> element retrieves all the groups of which the user is a member. There are typically two ways in which membership information is stored:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Under group entries that usually have class <code>groupOfNames</code> in the <code>member</code> attribute. In this case, you can use an attribute filter as in the preceding example configuration. This filter searches for entries that match the supplied filter, which locates groups with a <code>member</code> attribute equal to the user&#8217;s DN. The filter then extracts the group entry&#8217;s CN as specified by <code>from</code>, and adds it to the user&#8217;s <code>Roles</code>.</p>
</li>
<li>
<p>In the user entry in the <code>memberOf</code> attribute. In this case you should use an attribute reference such as the following:</p>
<div class="paragraph">
<p><code>&lt;attribute-reference reference="memberOf" from="cn" to="Roles" /&gt;</code></p>
</div>
<div class="paragraph">
<p>This reference gets all <code>memberOf</code> attributes from the user&#8217;s entry, extracts the CN as specified by <code>from</code>, and adds them to the user&#8217;s <code>Roles</code>.</p>
</div>
</li>
</ul>
</div>
<h4 id="ldap_realm_configuration" class="discrete">LDAP realm configuration</h4>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;security&gt;</span>
    <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">LdapRealm</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="comment">&lt;!-- Specifies connection properties. --&gt;</span>
        <span class="tag">&lt;ldap-realm</span> <span class="attribute-name">url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ldap://my-ldap-server:10389</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">principal</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">uid=admin,ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">credential</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">strongPassword</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">connection-timeout</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3000</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">read-timeout</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">30000</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">connection-pooling</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">referral-mode</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ignore</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">page-size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">30</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">direct-verification</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          <span class="comment">&lt;!-- Defines how principals are mapped to LDAP entries. --&gt;</span>
          <span class="tag">&lt;identity-mapping</span> <span class="attribute-name">rdn-identifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">uid</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">search-dn</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">search-recursive</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="comment">&lt;!-- Retrieves all the groups of which the user is a member. --&gt;</span>
            <span class="tag">&lt;attribute-mapping&gt;</span>
              <span class="tag">&lt;attribute</span> <span class="attribute-name">from</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cn</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">filter</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">(</span><span class="entity">&amp;amp;</span><span class="content">(objectClass=groupOfNames)(member={1}))</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">filter-dn</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ou=Roles,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/attribute-mapping&gt;</span>
          <span class="tag">&lt;/identity-mapping&gt;</span>
        <span class="tag">&lt;/ldap-realm&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
    <span class="tag">&lt;/security-realms&gt;</span>
  <span class="tag">&lt;/security&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realms</span><span class="delimiter">&quot;</span></span>: [{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">LdapRealm</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">ldap-realm</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ldap://my-ldap-server:10389</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">principal</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">uid=admin,ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">credential</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">strongPassword</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">connection-timeout</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">3000</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">read-timeout</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">30000</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">connection-pooling</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">referral-mode</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ignore</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">page-size</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">30</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">direct-verification</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">identity-mapping</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">rdn-identifier</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">uid</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">search-dn</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">search-recursive</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">attribute-mapping</span><span class="delimiter">&quot;</span></span>: [{
              <span class="key"><span class="delimiter">&quot;</span><span class="content">from</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">cn</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">to</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">filter</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">(&amp;(objectClass=groupOfNames)(member={1}))</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">filter-dn</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ou=Roles,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>
            }]
          }
        }
      }]
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">security</span>:
    <span class="key">securityRealms</span>:
      - <span class="string"><span class="content">name: LdapRealm</span></span>
        <span class="key">ldapRealm</span>:
          <span class="key">url</span>: <span class="string"><span class="content">'ldap://my-ldap-server:10389'</span></span>
          <span class="key">principal</span>: <span class="string"><span class="content">'uid=admin,ou=People,dc=infinispan,dc=org'</span></span>
          <span class="key">credential</span>: <span class="string"><span class="content">strongPassword</span></span>
          <span class="key">connectionTimeout</span>: <span class="string"><span class="content">'3000'</span></span>
          <span class="key">readTimeout</span>: <span class="string"><span class="content">'30000'</span></span>
          <span class="key">connectionPooling</span>: <span class="string"><span class="content">true</span></span>
          <span class="key">referralMode</span>: <span class="string"><span class="content">ignore</span></span>
          <span class="key">pageSize</span>: <span class="string"><span class="content">'30'</span></span>
          <span class="key">directVerification</span>: <span class="string"><span class="content">true</span></span>
          <span class="key">identityMapping</span>:
            <span class="key">rdnIdentifier</span>: <span class="string"><span class="content">uid</span></span>
            <span class="key">searchDn</span>: <span class="string"><span class="content">'ou=People,dc=infinispan,dc=org'</span></span>
            <span class="key">searchRecursive</span>: <span class="string"><span class="content">false</span></span>
            <span class="key">attributeMapping</span>:
              - <span class="string"><span class="content">filter: '(&amp;(objectClass=groupOfNames)(member={1}))'</span></span>
                <span class="key">filterDn</span>: <span class="string"><span class="content">'ou=Roles,dc=infinispan,dc=org'</span></span>
                <span class="key">from</span>: <span class="string"><span class="content">cn</span></span>
                <span class="key">to</span>: <span class="string"><span class="content">Roles</span></span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="ldap-realm-principal-rewriting_security-realms"><a class="anchor" href="#ldap-realm-principal-rewriting_security-realms"></a>3.4.1. LDAP realm principal re-writing</h4>
<div class="paragraph">
<p>SASL authentication mechanisms such as <code>GSSAPI</code>, <code>GS2-KRB5</code> and <code>Negotiate</code> include a username that needs to be <em>cleaned up</em> before you can use
it to search LDAP directories.</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;security&gt;</span>
    <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">LdapRealm</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;ldap-realm</span> <span class="attribute-name">url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ldap://${org.infinispan.test.host.address}:10389</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">principal</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">uid=admin,ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">credential</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">strongPassword</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          <span class="tag">&lt;name-rewriter&gt;</span>
            <span class="comment">&lt;!-- Defines a rewriter that extracts the username from the principal using a regular expression. --&gt;</span>
            <span class="tag">&lt;regex-principal-transformer</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">domain-remover</span><span class="delimiter">&quot;</span></span>
                                         <span class="attribute-name">pattern</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">(.*)@INFINISPAN\.ORG</span><span class="delimiter">&quot;</span></span>
                                         <span class="attribute-name">replacement</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">$1</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;/name-rewriter&gt;</span>
          <span class="tag">&lt;identity-mapping</span> <span class="attribute-name">rdn-identifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">uid</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">search-dn</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;attribute-mapping&gt;</span>
              <span class="tag">&lt;attribute</span> <span class="attribute-name">from</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cn</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">filter</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">(</span><span class="entity">&amp;amp;</span><span class="content">(objectClass=groupOfNames)(member={1}))</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">filter-dn</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ou=Roles,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/attribute-mapping&gt;</span>
            <span class="tag">&lt;user-password-mapper</span> <span class="attribute-name">from</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">userPassword</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;/identity-mapping&gt;</span>
        <span class="tag">&lt;/ldap-realm&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
    <span class="tag">&lt;/security-realms&gt;</span>
  <span class="tag">&lt;/security&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realms</span><span class="delimiter">&quot;</span></span>: [{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">LdapRealm</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">ldap-realm</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">principal</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">uid=admin,ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ldap://${org.infinispan.test.host.address}:10389</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">credential</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">strongPassword</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">name-rewriter</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">regex-principal-transformer</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">pattern</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">(.*)@INFINISPAN</span><span class="char">\\</span><span class="content">.ORG</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">replacement</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">$1</span><span class="delimiter">&quot;</span></span>
            }
          },
          <span class="key"><span class="delimiter">&quot;</span><span class="content">identity-mapping</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">rdn-identifier</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">uid</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">search-dn</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">attribute-mapping</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">attribute</span><span class="delimiter">&quot;</span></span>: {
                <span class="key"><span class="delimiter">&quot;</span><span class="content">filter</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">(&amp;(objectClass=groupOfNames)(member={1}))</span><span class="delimiter">&quot;</span></span>,
                <span class="key"><span class="delimiter">&quot;</span><span class="content">filter-dn</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ou=Roles,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>,
                <span class="key"><span class="delimiter">&quot;</span><span class="content">from</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">cn</span><span class="delimiter">&quot;</span></span>,
                <span class="key"><span class="delimiter">&quot;</span><span class="content">to</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>
              }
            },
            <span class="key"><span class="delimiter">&quot;</span><span class="content">user-password-mapper</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">from</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">userPassword</span><span class="delimiter">&quot;</span></span>
            }
          }
        }
      }]
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">security</span>:
    <span class="key">securityRealms</span>:
      - <span class="string"><span class="content">name: &quot;LdapRealm&quot;</span></span>
        <span class="key">ldapRealm</span>:
          <span class="key">principal</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">uid=admin,ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>
          <span class="key">url</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ldap://${org.infinispan.test.host.address}:10389</span><span class="delimiter">&quot;</span></span>
          <span class="key">credential</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">strongPassword</span><span class="delimiter">&quot;</span></span>
          <span class="key">nameRewriter</span>:
            <span class="key">regexPrincipalTransformer</span>:
              <span class="key">pattern</span>: <span class="string"><span class="content">(.*)@INFINISPAN\.ORG</span></span>
              <span class="key">replacement</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">$1</span><span class="delimiter">&quot;</span></span>
          <span class="key">identityMapping</span>:
            <span class="key">rdnIdentifier</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">uid</span><span class="delimiter">&quot;</span></span>
            <span class="key">searchDn</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>
            <span class="key">attributeMapping</span>:
              <span class="key">attribute</span>:
                <span class="key">filter</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">(&amp;(objectClass=groupOfNames)(member={1}))</span><span class="delimiter">&quot;</span></span>
                <span class="key">filterDn</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ou=Roles,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>
                <span class="key">from</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">cn</span><span class="delimiter">&quot;</span></span>
                <span class="key">to</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>
            <span class="key">userPasswordMapper</span>:
              <span class="key">from</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">userPassword</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="token-security-realms_security-realms"><a class="anchor" href="#token-security-realms_security-realms"></a>3.5. Token realms</h3>
<div class="paragraph">
<p>Token realms use external services to validate tokens and require providers
that are compatible with RFC-7662 (OAuth2 Token Introspection), such as
KeyCloak.</p>
</div>
<h4 id="token_realm_configuration" class="discrete">Token realm configuration</h4>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;security&gt;</span>
    <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TokenRealm</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="comment">&lt;!-- Specifies the URL of the authentication server. --&gt;</span>
        <span class="tag">&lt;token-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">token</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">auth-server-url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://oauth-server/auth/</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          <span class="comment">&lt;!-- Specifies the URL of the token introspection endpoint. --&gt;</span>
          <span class="tag">&lt;oauth2-introspection</span> <span class="attribute-name">introspection-url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://oauth-server/auth/realms/infinispan/protocol/openid-connect/token/introspect</span><span class="delimiter">&quot;</span></span>
                                <span class="attribute-name">client-id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan-server</span><span class="delimiter">&quot;</span></span>
                                <span class="attribute-name">client-secret</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1fdca4ec-c416-47e0-867a-3d471af7050f</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/token-realm&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
    <span class="tag">&lt;/security-realms&gt;</span>
  <span class="tag">&lt;/security&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realms</span><span class="delimiter">&quot;</span></span>: [{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">TokenRealm</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">token-realm</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">auth-server-url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">https://oauth-server/auth/</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">oauth2-introspection</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">client-id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan-server</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">client-secret</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">1fdca4ec-c416-47e0-867a-3d471af7050f</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">introspection-url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">https://oauth-server/auth/realms/infinispan/protocol/openid-connect/token/introspect</span><span class="delimiter">&quot;</span></span>
          }
        }
      }]
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">security</span>:
    <span class="key">securityRealms</span>:
      - <span class="string"><span class="content">name: &quot;TokenRealm&quot;</span></span>
        <span class="key">tokenRealm</span>:
          <span class="key">authServerUrl</span>: <span class="string"><span class="content">'https://oauth-server/auth/'</span></span>
          <span class="key">oauth2Introspection</span>:
            <span class="key">clientId</span>: <span class="string"><span class="content">infinispan-server</span></span>
            <span class="key">clientSecret</span>: <span class="string"><span class="content">'1fdca4ec-c416-47e0-867a-3d471af7050f'</span></span>
            <span class="key">introspectionUrl</span>: <span class="string"><span class="content">'https://oauth-server/auth/realms/infinispan/protocol/openid-connect/token/introspect'</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trust-store-security-realms_security-realms"><a class="anchor" href="#trust-store-security-realms_security-realms"></a>3.6. Trust store realms</h3>
<div class="paragraph">
<p>Trust store realms use certificates, or certificates chains, that verify Infinispan Server and client identities when they negotiate connections.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Keystores</dt>
<dd>
<p>Contain server certificates that provide a Infinispan Server identity to clients. If you configure a keystore with server certificates, Infinispan Server encrypts traffic using industry standard SSL/TLS protocols.</p>
</dd>
<dt class="hdlist1">Trust stores</dt>
<dd>
<p>Contain client certificates, or certificate chains, that clients present to Infinispan Server. Client trust stores are optional and allow Infinispan Server to perform client certificate authentication.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<div class="title">Client certificate authentication</div>
<p>You must add the <code>require-ssl-client-auth="true"</code> attribute to the endpoint configuration if you want Infinispan Server to validate or authenticate client certificates.</p>
</div>
<h4 id="trust_store_realm_configuration" class="discrete">Trust store realm configuration</h4>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;security&gt;</span>
    <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TrustStoreRealm</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;server-identities&gt;</span>
          <span class="tag">&lt;ssl&gt;</span>
            <span class="comment">&lt;!-- Provides an SSL/TLS identity with a keystore that contains server certificates. --&gt;</span>
            <span class="tag">&lt;keystore</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">keystore-password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">alias</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="comment">&lt;!-- Configures a trust store that contains client certificates or part of a certificate chain. --&gt;</span>
            <span class="tag">&lt;truststore</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">trust.p12</span><span class="delimiter">&quot;</span></span>
                        <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>
                        <span class="attribute-name">password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;/ssl&gt;</span>
        <span class="tag">&lt;/server-identities&gt;</span>
        <span class="comment">&lt;!-- Authenticates client certificates against the trust store. If you configure this, the trust store must contain the public certificates for all clients. --&gt;</span>
        <span class="tag">&lt;truststore-realm</span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
    <span class="tag">&lt;/security-realms&gt;</span>
  <span class="tag">&lt;/security&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realms</span><span class="delimiter">&quot;</span></span>: [{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">TrustStoreRealm</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">server-identities</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">ssl</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">keystore</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">relative-to</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">keystore-password</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">alias</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>
            },
            <span class="key"><span class="delimiter">&quot;</span><span class="content">truststore</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">trust.p12</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">relative-to</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
            }
          }
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">truststore-realm</span><span class="delimiter">&quot;</span></span>: {}
      }]
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">security</span>:
    <span class="key">securityRealms</span>:
      - <span class="string"><span class="content">name: &quot;TrustStoreRealm&quot;</span></span>
        <span class="key">serverIdentities</span>:
          <span class="key">ssl</span>:
            <span class="key">keystore</span>:
              <span class="key">path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span>
              <span class="key">relative-to</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>
              <span class="key">keystore-password</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
              <span class="key">alias</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>
            <span class="key">truststore</span>:
              <span class="key">path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">trust.p12</span><span class="delimiter">&quot;</span></span>
              <span class="key">relative-to</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>
              <span class="key">password</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
        <span class="key">truststoreRealm</span>: <span class="string"><span class="content">~</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="distributed-security-realms_security-realms"><a class="anchor" href="#distributed-security-realms_security-realms"></a>3.7. Distributed security realms</h3>
<div class="paragraph">
<p>Distributed realms combine multiple different types of security realms.
When users attempt to access the Hot Rod or REST endpoints, Infinispan Server uses each security realm in turn until it finds one that can perform the authentication.</p>
</div>
<h4 id="distributed_realm_configuration" class="discrete">Distributed realm configuration</h4>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;security&gt;</span>
    <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">DistributedRealm</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;ldap-realm</span> <span class="attribute-name">url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ldap://my-ldap-server:10389</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">principal</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">uid=admin,ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">credential</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">strongPassword</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          <span class="tag">&lt;identity-mapping</span> <span class="attribute-name">rdn-identifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">uid</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">search-dn</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">search-recursive</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;attribute-mapping&gt;</span>
              <span class="tag">&lt;attribute</span> <span class="attribute-name">from</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cn</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">filter</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">(</span><span class="entity">&amp;amp;</span><span class="content">(objectClass=groupOfNames)(member={1}))</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">filter-dn</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ou=Roles,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/attribute-mapping&gt;</span>
          <span class="tag">&lt;/identity-mapping&gt;</span>
        <span class="tag">&lt;/ldap-realm&gt;</span>
        <span class="tag">&lt;properties-realm</span> <span class="attribute-name">groups-attribute</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          <span class="tag">&lt;user-properties</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">users.properties</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;group-properties</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">groups.properties</span><span class="delimiter">&quot;</span></span>
                            <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/properties-realm&gt;</span>
        <span class="tag">&lt;distributed-realm</span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
    <span class="tag">&lt;/security-realms&gt;</span>
  <span class="tag">&lt;/security&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realms</span><span class="delimiter">&quot;</span></span>: [{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">DistributedRealm</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">ldap-realm</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">principal</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">uid=admin,ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ldap://my-ldap-server:10389</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">credential</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">strongPassword</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">identity-mapping</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">rdn-identifier</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">uid</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">search-dn</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">search-recursive</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">attribute-mapping</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">attribute</span><span class="delimiter">&quot;</span></span>: {
                <span class="key"><span class="delimiter">&quot;</span><span class="content">filter</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">(&amp;(objectClass=groupOfNames)(member={1}))</span><span class="delimiter">&quot;</span></span>,
                <span class="key"><span class="delimiter">&quot;</span><span class="content">filter-dn</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ou=Roles,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>,
                <span class="key"><span class="delimiter">&quot;</span><span class="content">from</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">cn</span><span class="delimiter">&quot;</span></span>,
                <span class="key"><span class="delimiter">&quot;</span><span class="content">to</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>
              }
            }
          }
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">properties-realm</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">groups-attribute</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">user-properties</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">digest-realm-name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">DistributedRealm</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">users.properties</span><span class="delimiter">&quot;</span></span>
          },
          <span class="key"><span class="delimiter">&quot;</span><span class="content">group-properties</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">groups.properties</span><span class="delimiter">&quot;</span></span>
          }
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">distributed-realm</span><span class="delimiter">&quot;</span></span>: {}
      }]
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">security</span>:
    <span class="key">securityRealms</span>:
      - <span class="string"><span class="content">name: &quot;DistributedRealm&quot;</span></span>
        <span class="key">ldapRealm</span>:
          <span class="key">principal</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">uid=admin,ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>
          <span class="key">url</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ldap://my-ldap-server:10389</span><span class="delimiter">&quot;</span></span>
          <span class="key">credential</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">strongPassword</span><span class="delimiter">&quot;</span></span>
          <span class="key">identityMapping</span>:
            <span class="key">rdnIdentifier</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">uid</span><span class="delimiter">&quot;</span></span>
            <span class="key">searchDn</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>
            <span class="key">searchRecursive</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span>
            <span class="key">attributeMapping</span>:
              <span class="key">attribute</span>:
                <span class="key">filter</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">(&amp;(objectClass=groupOfNames)(member={1}))</span><span class="delimiter">&quot;</span></span>
                <span class="key">filterDn</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ou=Roles,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>
                <span class="key">from</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">cn</span><span class="delimiter">&quot;</span></span>
                <span class="key">to</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>
        <span class="key">propertiesRealm</span>:
          <span class="key">groupsAttribute</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>
          <span class="key">userProperties</span>:
            <span class="key">digestRealmName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">DistributedRealm</span><span class="delimiter">&quot;</span></span>
            <span class="key">path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">users.properties</span><span class="delimiter">&quot;</span></span>
          <span class="key">groupProperties</span>:
            <span class="key">path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">groups.properties</span><span class="delimiter">&quot;</span></span>
        <span class="key">distributedRealm</span>: <span class="string"><span class="content">~</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="authentication-mechanisms"><a class="anchor" href="#authentication-mechanisms"></a>4. Endpoint authentication mechanisms</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Infinispan Server can use custom SASL and HTTP authentication mechanisms for Hot Rod and REST endpoints.</p>
</div>
<div class="sect2">
<h3 id="server-authentication_endpoint-authentication"><a class="anchor" href="#server-authentication_endpoint-authentication"></a>4.1. Infinispan Server authentication</h3>
<div class="paragraph">
<p>Authentication restricts user access to endpoints as well as the Infinispan Console and Command Line Interface (CLI).</p>
</div>
<div class="paragraph">
<p>Infinispan Server includes a "default" security realm that enforces user authentication.
Default authentication uses a property realm with user credentials stored in the <code>server/conf/users.properties</code> file.
Infinispan Server also enables security authorization by default so you must assign users with permissions stored in the <code>server/conf/groups.properties</code> file.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Use the <code class="command">user create</code> command with the Command Line Interface (CLI) to add users and assign permissions.
Run <code class="command">user create --help</code> for examples and more information.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="configuring-server-authentication_endpoint-authentication"><a class="anchor" href="#configuring-server-authentication_endpoint-authentication"></a>4.2. Configuring Infinispan Server authentication mechanisms</h3>
<div class="paragraph">
<p>You can explicitly configure Hot Rod and REST endpoints to use specific authentication mechanisms.
Configuring authentication mechanisms is required only if you need to explicitly override the default mechanisms for a security realm.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Each <code>endpoint</code> section in your configuration must include <code>hotrod-connector</code> and <code>rest-connector</code> elements or fields.
For example, if you explicitly declare a <code>hotrod-connector</code> you must also declare a <code>rest-connector</code> even if it does not configure an authentication mechanism.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Add security realms to your Infinispan Server configuration as required.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Open your Infinispan Server configuration for editing.</p>
</li>
<li>
<p>Add an <code>endpoint</code> element or field and specify the security realm that it uses with the <code>security-realm</code> attribute.</p>
</li>
<li>
<p>Add a <code>hotrod-connector</code> element or field to configure the Hot Rod endpoint.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Add an <code>authentication</code> element or field.</p>
</li>
<li>
<p>Specify SASL authentication mechanisms for the Hot Rod endpoint to use with the <code>sasl mechanisms</code> attribute.</p>
</li>
<li>
<p>If applicable, specify SASL quality of protection settings with the <code>qop</code> attribute.</p>
</li>
<li>
<p>Specify the Infinispan Server identity with the <code>server-name</code> attribute if necessary.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Add a <code>rest-connector</code> element or field to configure the REST endpoint.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Add an <code>authentication</code> element or field.</p>
</li>
<li>
<p>Specify HTTP authentication mechanisms for the REST endpoint to use with the <code>mechanisms</code> attribute.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Save the changes to your configuration.</p>
</li>
</ol>
</div>
<h4 id="authentication_mechanism_configuration" class="discrete">Authentication mechanism configuration</h4>
<div class="paragraph">
<p>The following configuration specifies SASL mechanisms for the Hot Rod endpoint to use for authentication:</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;endpoints&gt;</span>
    <span class="tag">&lt;endpoint</span> <span class="attribute-name">socket-binding</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>
              <span class="attribute-name">security-realm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">my-realm</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;hotrod-connector&gt;</span>
        <span class="tag">&lt;authentication&gt;</span>
           <span class="tag">&lt;sasl</span> <span class="attribute-name">mechanisms</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SCRAM-SHA-512 SCRAM-SHA-384 SCRAM-SHA-256</span>
                             <span class="content">SCRAM-SHA-1 DIGEST-SHA-512 DIGEST-SHA-384</span>
                             <span class="content">DIGEST-SHA-256 DIGEST-SHA DIGEST-MD5 PLAIN</span><span class="delimiter">&quot;</span></span>
                 <span class="attribute-name">server-name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan</span><span class="delimiter">&quot;</span></span>
                 <span class="attribute-name">qop</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">auth</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/authentication&gt;</span>
      <span class="tag">&lt;/hotrod-connector&gt;</span>
      <span class="tag">&lt;rest-connector&gt;</span>
        <span class="tag">&lt;authentication</span> <span class="attribute-name">mechanisms</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">DIGEST BASIC</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/rest-connector&gt;</span>
    <span class="tag">&lt;/endpoint&gt;</span>
  <span class="tag">&lt;/endpoints&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">endpoints</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">endpoint</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">socket-binding</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realm</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my-realm</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">hotrod-connector</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">authentication</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realm</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">sasl</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">server-name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">mechanisms</span><span class="delimiter">&quot;</span></span>: [<span class="string"><span class="delimiter">&quot;</span><span class="content">SCRAM-SHA-512</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">SCRAM-SHA-384</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">SCRAM-SHA-256</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">SCRAM-SHA-1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">DIGEST-SHA-512</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">DIGEST-SHA-384</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">DIGEST-SHA-256</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">DIGEST-SHA</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">DIGEST-MD5</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">PLAIN</span><span class="delimiter">&quot;</span></span>],
              <span class="key"><span class="delimiter">&quot;</span><span class="content">qop</span><span class="delimiter">&quot;</span></span>: [<span class="string"><span class="delimiter">&quot;</span><span class="content">auth</span><span class="delimiter">&quot;</span></span>]
            }
          }
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">rest-connector</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">authentication</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">mechanisms</span><span class="delimiter">&quot;</span></span>: [<span class="string"><span class="delimiter">&quot;</span><span class="content">DIGEST</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">BASIC</span><span class="delimiter">&quot;</span></span>],
            <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realm</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>
          }
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json"><span class="error">s</span><span class="error">e</span><span class="error">r</span><span class="error">v</span><span class="error">e</span><span class="error">r</span>:
  <span class="error">e</span><span class="error">n</span><span class="error">d</span><span class="error">p</span><span class="error">o</span><span class="error">i</span><span class="error">n</span><span class="error">t</span><span class="error">s</span>:
    <span class="error">e</span><span class="error">n</span><span class="error">d</span><span class="error">p</span><span class="error">o</span><span class="error">i</span><span class="error">n</span><span class="error">t</span>:
      <span class="error">s</span><span class="error">o</span><span class="error">c</span><span class="error">k</span><span class="error">e</span><span class="error">t</span><span class="error">B</span><span class="error">i</span><span class="error">n</span><span class="error">d</span><span class="error">i</span><span class="error">n</span><span class="error">g</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>
      <span class="error">s</span><span class="error">e</span><span class="error">c</span><span class="error">u</span><span class="error">r</span><span class="error">i</span><span class="error">t</span><span class="error">y</span><span class="error">R</span><span class="error">e</span><span class="error">a</span><span class="error">l</span><span class="error">m</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my-realm</span><span class="delimiter">&quot;</span></span>
      <span class="error">h</span><span class="error">o</span><span class="error">t</span><span class="error">r</span><span class="error">o</span><span class="error">d</span><span class="error">C</span><span class="error">o</span><span class="error">n</span><span class="error">n</span><span class="error">e</span><span class="error">c</span><span class="error">t</span><span class="error">o</span><span class="error">r</span>:
        <span class="error">a</span><span class="error">u</span><span class="error">t</span><span class="error">h</span><span class="error">e</span><span class="error">n</span><span class="error">t</span><span class="error">i</span><span class="error">c</span><span class="error">a</span><span class="error">t</span><span class="error">i</span><span class="error">o</span><span class="error">n</span>:
          <span class="error">s</span><span class="error">e</span><span class="error">c</span><span class="error">u</span><span class="error">r</span><span class="error">i</span><span class="error">t</span><span class="error">y</span><span class="error">R</span><span class="error">e</span><span class="error">a</span><span class="error">l</span><span class="error">m</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>
          <span class="error">s</span><span class="error">a</span><span class="error">s</span><span class="error">l</span>:
            <span class="error">s</span><span class="error">e</span><span class="error">r</span><span class="error">v</span><span class="error">e</span><span class="error">r</span><span class="error">N</span><span class="error">a</span><span class="error">m</span><span class="error">e</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan</span><span class="delimiter">&quot;</span></span>
            <span class="error">m</span><span class="error">e</span><span class="error">c</span><span class="error">h</span><span class="error">a</span><span class="error">n</span><span class="error">i</span><span class="error">s</span><span class="error">m</span><span class="error">s</span>:
              <span class="error">-</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">SCRAM-SHA-512</span><span class="delimiter">&quot;</span></span>
              <span class="error">-</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">SCRAM-SHA-384</span><span class="delimiter">&quot;</span></span>
              <span class="error">-</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">SCRAM-SHA-256</span><span class="delimiter">&quot;</span></span>
              <span class="error">-</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">SCRAM-SHA-1</span><span class="delimiter">&quot;</span></span>
              <span class="error">-</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">DIGEST-SHA-512</span><span class="delimiter">&quot;</span></span>
              <span class="error">-</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">DIGEST-SHA-384</span><span class="delimiter">&quot;</span></span>
              <span class="error">-</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">DIGEST-SHA-256</span><span class="delimiter">&quot;</span></span>
              <span class="error">-</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">DIGEST-SHA</span><span class="delimiter">&quot;</span></span>
              <span class="error">-</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">DIGEST-MD5</span><span class="delimiter">&quot;</span></span>
              <span class="error">-</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">PLAIN</span><span class="delimiter">&quot;</span></span>
            <span class="error">q</span><span class="error">o</span><span class="error">p</span>:
              <span class="error">-</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">auth</span><span class="delimiter">&quot;</span></span>
      <span class="error">r</span><span class="error">e</span><span class="error">s</span><span class="error">t</span><span class="error">C</span><span class="error">o</span><span class="error">n</span><span class="error">n</span><span class="error">e</span><span class="error">c</span><span class="error">t</span><span class="error">o</span><span class="error">r</span>:
        <span class="error">a</span><span class="error">u</span><span class="error">t</span><span class="error">h</span><span class="error">e</span><span class="error">n</span><span class="error">t</span><span class="error">i</span><span class="error">c</span><span class="error">a</span><span class="error">t</span><span class="error">i</span><span class="error">o</span><span class="error">n</span>:
          <span class="error">m</span><span class="error">e</span><span class="error">c</span><span class="error">h</span><span class="error">a</span><span class="error">n</span><span class="error">i</span><span class="error">s</span><span class="error">m</span><span class="error">s</span>:
            <span class="error">-</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">DIGEST</span><span class="delimiter">&quot;</span></span>
            <span class="error">-</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">BASIC</span><span class="delimiter">&quot;</span></span>
          <span class="error">s</span><span class="error">e</span><span class="error">c</span><span class="error">u</span><span class="error">r</span><span class="error">i</span><span class="error">t</span><span class="error">y</span><span class="error">R</span><span class="error">e</span><span class="error">a</span><span class="error">l</span><span class="error">m</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="disabling-authentication_endpoint-authentication"><a class="anchor" href="#disabling-authentication_endpoint-authentication"></a>4.2.1. Disabling authentication</h4>
<div class="paragraph">
<p>In local development environments or on isolated networks you can configure Infinispan to allow unauthenticated client requests.
When you disable user authentication you should also disable authorization in your Infinispan security configuration.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Open your Infinispan Server configuration for editing.</p>
</li>
<li>
<p>Remove the <code>security-realm</code> attribute from the <code>endpoints</code> element or field.</p>
</li>
<li>
<p>Remove any <code>authorization</code> elements from the <code>security</code> configuration for the <code>cache-container</code> and each cache configuration.</p>
</li>
<li>
<p>Save the changes to your configuration.</p>
</li>
</ol>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;endpoints</span> <span class="attribute-name">socket-binding</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">endpoints</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">endpoint</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">socket-binding</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json"><span class="error">s</span><span class="error">e</span><span class="error">r</span><span class="error">v</span><span class="error">e</span><span class="error">r</span>:
  <span class="error">e</span><span class="error">n</span><span class="error">d</span><span class="error">p</span><span class="error">o</span><span class="error">i</span><span class="error">n</span><span class="error">t</span><span class="error">s</span>:
    <span class="error">e</span><span class="error">n</span><span class="error">d</span><span class="error">p</span><span class="error">o</span><span class="error">i</span><span class="error">n</span><span class="error">t</span>:
      <span class="error">s</span><span class="error">o</span><span class="error">c</span><span class="error">k</span><span class="error">e</span><span class="error">t</span><span class="error">B</span><span class="error">i</span><span class="error">n</span><span class="error">d</span><span class="error">i</span><span class="error">n</span><span class="error">g</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="server-endpoint-authentication-mechanisms_endpoint-authentication"><a class="anchor" href="#server-endpoint-authentication-mechanisms_endpoint-authentication"></a>4.3. Infinispan Server authentication mechanisms</h3>
<div class="paragraph">
<p>Infinispan Server automatically configures endpoints with authentication mechanisms that match your security realm configuration.
For example, if you add a Kerberos security realm then Infinispan Server enables the <code>GSSAPI</code> and <code>GS2-KRB5</code> authentication mechanisms for the Hot Rod endpoint.</p>
</div>
<div class="paragraph">
<div class="title">Hot Rod endpoints</div>
<p>Infinispan Server enables the following SASL authentication mechanisms for Hot Rod endpoints when your configuration includes the corresponding security realm:</p>
</div>
<table class="tableblock frame-all grid-all stripes-even fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Security realm</th>
<th class="tableblock halign-left valign-top">SASL authentication mechanism</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property realms and LDAP realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCRAM-*, DIGEST-*, <code>SCRAM-*</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OAUTHBEARER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Trust realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXTERNAL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kerberos identities</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GSSAPI, GS2-KRB5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSL/TLS identities</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLAIN</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">REST endpoints</div>
<p>Infinispan Server enables the following HTTP authentication mechanisms for REST endpoints when your configuration includes the corresponding security realm:</p>
</div>
<table class="tableblock frame-all grid-all stripes-even fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Security realm</th>
<th class="tableblock halign-left valign-top">HTTP authentication mechanism</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property realms and LDAP realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DIGEST</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BEARER_TOKEN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Trust realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT_CERT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kerberos identities</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SPNEGO</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSL/TLS identities</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BASIC</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="sasl-authentication-mechanisms_endpoint-authentication"><a class="anchor" href="#sasl-authentication-mechanisms_endpoint-authentication"></a>4.3.1. SASL authentication mechanisms</h4>
<div class="paragraph">
<p>Infinispan Server supports the following SASL authentications mechanisms with Hot Rod endpoints:</p>
</div>
<table class="tableblock frame-all grid-all stripes-even fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Authentication mechanism</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Security realm type</th>
<th class="tableblock halign-left valign-top">Related details</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PLAIN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses credentials in plain-text format. You should use <code>PLAIN</code> authentication with encrypted connections only.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property realms and LDAP realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Similar to the <code>BASIC</code> HTTP mechanism.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DIGEST-*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses hashing algorithms and nonce values. Hot Rod connectors support <code>DIGEST-MD5</code>, <code>DIGEST-SHA</code>, <code>DIGEST-SHA-256</code>, <code>DIGEST-SHA-384</code>, and <code>DIGEST-SHA-512</code> hashing algorithms, in order of strength.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property realms and LDAP realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Similar to the <code>Digest</code> HTTP mechanism.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SCRAM-*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses <em>salt</em> values in addition to hashing algorithms and nonce values. Hot Rod connectors support <code>SCRAM-SHA</code>, <code>SCRAM-SHA-256</code>, <code>SCRAM-SHA-384</code>, and <code>SCRAM-SHA-512</code> hashing algorithms, in order of strength.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property realms and LDAP realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Similar to the <code>Digest</code> HTTP mechanism.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GSSAPI</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses Kerberos tickets and requires a Kerberos Domain Controller. You must add a corresponding <code>kerberos</code> server identity in the realm configuration. In most cases, you also specify an <code>ldap-realm</code> to provide user membership information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kerberos realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Similar to the <code>SPNEGO</code> HTTP mechanism.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GS2-KRB5</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses Kerberos tickets and requires a Kerberos Domain Controller. You must add a corresponding <code>kerberos</code> server identity in the realm configuration. In most cases, you also specify an <code>ldap-realm</code> to provide user membership information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kerberos realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Similar to the <code>SPNEGO</code> HTTP mechanism.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EXTERNAL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses client certificates.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Trust store realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Similar to the <code>CLIENT_CERT</code> HTTP mechanism.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>OAUTHBEARER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses OAuth tokens and requires a <code>token-realm</code> configuration.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Similar to the <code>BEARER_TOKEN</code> HTTP mechanism.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sasl-quality-of-protection_endpoint-authentication"><a class="anchor" href="#sasl-quality-of-protection_endpoint-authentication"></a>4.3.2. SASL quality of protection (QoP)</h4>
<div class="paragraph">
<p>If SASL mechanisms support integrity and privacy protection (QoP) settings, you can add them to your Hot Rod endpoint configuration with the <code>qop</code> attribute.</p>
</div>
<table class="tableblock frame-all grid-all stripes-even fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">QoP setting</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>auth</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication only.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>auth-int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication with integrity protection.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>auth-conf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication with integrity and privacy protection.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sasl-policies-hot-rod-authentication_endpoint-authentication"><a class="anchor" href="#sasl-policies-hot-rod-authentication_endpoint-authentication"></a>4.3.3. SASL policies</h4>
<div class="paragraph">
<p>SASL policies provide fine-grain control over Hot Rod authentication mechanisms.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Infinispan cache authorization restricts access to caches based on roles and
permissions.
Configure cache authorization and then set <code>&lt;no-anonymous value=false /&gt;</code> to allow anonymous login and delegate access logic to cache authorization.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stripes-even fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Policy</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>forward-secrecy</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use only SASL mechanisms that support forward secrecy between sessions. This means that breaking into one session does not automatically provide information for breaking into future sessions.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pass-credentials</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use only SASL mechanisms that require client credentials.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>no-plain-text</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Do not use SASL mechanisms that are susceptible to simple plain passive attacks.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>no-active</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Do not use SASL mechanisms that are susceptible to active, non-dictionary, attacks.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>no-dictionary</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Do not use SASL mechanisms that are susceptible to passive dictionary attacks.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>no-anonymous</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Do not use SASL mechanisms that accept anonymous logins.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
</tbody>
</table>
<h5 id="sasl_policy_configuration" class="discrete">SASL policy configuration</h5>
<div class="paragraph">
<p>In the following configuration the Hot Rod endpoint uses the <code>GSSAPI</code> mechanism for authentication because it is the only mechanism that complies with all SASL policies:</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;endpoints&gt;</span>
    <span class="tag">&lt;endpoint</span> <span class="attribute-name">socket-binding</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>
              <span class="attribute-name">security-realm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;hotrod-connector&gt;</span>
        <span class="tag">&lt;authentication&gt;</span>
          <span class="tag">&lt;sasl</span> <span class="attribute-name">mechanisms</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PLAIN DIGEST-MD5 GSSAPI EXTERNAL</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">server-name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">qop</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">auth</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">policy</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">no-active no-plain-text</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/authentication&gt;</span>
      <span class="tag">&lt;/hotrod-connector&gt;</span>
      <span class="tag">&lt;rest-connector</span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/endpoint&gt;</span>
  <span class="tag">&lt;/endpoints&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">endpoints</span><span class="delimiter">&quot;</span></span> : {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">endpoint</span><span class="delimiter">&quot;</span></span> : {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">socket-binding</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realm</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">hotrod-connector</span><span class="delimiter">&quot;</span></span> : {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">authentication</span><span class="delimiter">&quot;</span></span> : {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">sasl</span><span class="delimiter">&quot;</span></span> : {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">server-name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">mechanisms</span><span class="delimiter">&quot;</span></span> : [ <span class="string"><span class="delimiter">&quot;</span><span class="content">PLAIN</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">DIGEST-MD5</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">GSSAPI</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">EXTERNAL</span><span class="delimiter">&quot;</span></span> ],
              <span class="key"><span class="delimiter">&quot;</span><span class="content">qop</span><span class="delimiter">&quot;</span></span> : [ <span class="string"><span class="delimiter">&quot;</span><span class="content">auth</span><span class="delimiter">&quot;</span></span> ],
              <span class="key"><span class="delimiter">&quot;</span><span class="content">policy</span><span class="delimiter">&quot;</span></span> : [ <span class="string"><span class="delimiter">&quot;</span><span class="content">no-active</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">no-plain-text</span><span class="delimiter">&quot;</span></span> ]
            }
          }
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">rest-connector</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">endpoints</span>:
    <span class="key">endpoint</span>:
      <span class="key">socketBinding</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>
      <span class="key">securityRealm</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>
      <span class="key">hotrodConnector</span>:
        <span class="key">authentication</span>:
          <span class="key">sasl</span>:
            <span class="key">serverName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan</span><span class="delimiter">&quot;</span></span>
            <span class="key">mechanisms</span>:
              - <span class="string"><span class="delimiter">&quot;</span><span class="content">PLAIN</span><span class="delimiter">&quot;</span></span>
              - <span class="string"><span class="delimiter">&quot;</span><span class="content">DIGEST-MD5</span><span class="delimiter">&quot;</span></span>
              - <span class="string"><span class="delimiter">&quot;</span><span class="content">GSSAPI</span><span class="delimiter">&quot;</span></span>
              - <span class="string"><span class="delimiter">&quot;</span><span class="content">EXTERNAL</span><span class="delimiter">&quot;</span></span>
            <span class="key">qop</span>:
              - <span class="string"><span class="delimiter">&quot;</span><span class="content">auth</span><span class="delimiter">&quot;</span></span>
            <span class="key">policy</span>:
              - <span class="string"><span class="delimiter">&quot;</span><span class="content">no-active</span><span class="delimiter">&quot;</span></span>
              - <span class="string"><span class="delimiter">&quot;</span><span class="content">no-plain-text</span><span class="delimiter">&quot;</span></span>
      <span class="key">restConnector</span>: <span class="string"><span class="content">~</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest-authentication-mechanisms_endpoint-authentication"><a class="anchor" href="#rest-authentication-mechanisms_endpoint-authentication"></a>4.3.4. HTTP authentication mechanisms</h4>
<div class="paragraph">
<p>Infinispan Server supports the following HTTP authentication mechanisms with REST endpoints:</p>
</div>
<table class="tableblock frame-all grid-all stripes-even fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Authentication mechanism</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Security realm type</th>
<th class="tableblock halign-left valign-top">Related details</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BASIC</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses credentials in plain-text format. You should use <code>BASIC</code> authentication with encrypted connections only.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property realms and LDAP realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Corresponds to the <code>Basic</code> HTTP authentication scheme and is similar to the <code>PLAIN</code> SASL mechanism.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DIGEST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses hashing algorithms and nonce values. REST connectors support <code>SHA-512</code>, <code>SHA-256</code> and <code>MD5</code> hashing algorithms.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property realms and LDAP realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Corresponds to the <code>Digest</code> HTTP authentication scheme and is similar to <code>DIGEST-*</code> SASL mechanisms.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SPNEGO</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses Kerberos tickets and requires a Kerberos Domain Controller. You must add a corresponding <code>kerberos</code> server identity in the realm configuration. In most cases, you also specify an <code>ldap-realm</code> to provide user membership information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kerberos realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Corresponds to the <code>Negotiate</code> HTTP authentication scheme and is similar to the <code>GSSAPI</code> and <code>GS2-KRB5</code> SASL mechanisms.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BEARER_TOKEN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses OAuth tokens and requires a <code>token-realm</code> configuration.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Corresponds to the <code>Bearer</code> HTTP authentication scheme and is similar to <code>OAUTHBEARER</code> SASL mechanism.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CLIENT_CERT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses client certificates.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Trust store realms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Similar to the <code>EXTERNAL</code> SASL mechanism.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-encryption"><a class="anchor" href="#configuring-encryption"></a>5. Configuring TLS/SSL encryption</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can secure Infinispan Server connections using SSL/TLS encryption by configuring a keystore that contains public and private keys for Infinispan.
You can also configure client certificate authentication if you require mutual TLS.</p>
</div>
<div class="sect2">
<h3 id="configuring-server-keystores_endpoint-security"><a class="anchor" href="#configuring-server-keystores_endpoint-security"></a>5.1. Configuring Infinispan Server keystores</h3>
<div class="paragraph">
<p>Add keystores to Infinispan Server and configure it to present SSL/TLS certificates that verify its identity to clients.
If a security realm contains TLS/SSL identities, it encrypts any connections to Infinispan Server endpoints that use that security realm.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Create a keystore that contains certificates, or certificate chains, for Infinispan Server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Infinispan Server supports the following keystore formats: JKS, JCEKS, PKCS12/PFX and PEM.
BKS, BCFKS, and UBER are also supported if the <a href="https://www.bouncycastle.org/">Bouncy Castle</a> library is present.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In production environments, server certificates should be signed by a trusted Certificate Authority, either Root or Intermediate CA.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can use PEM files as keystores if they contain both of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A private key in PKCS#1 or PKCS#8 format.</p>
</li>
<li>
<p>One or more certificates.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You should also configure PEM file keystores with an empty password (<code>password=""</code>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Open your Infinispan Server configuration for editing.</p>
</li>
<li>
<p>Add the keystore that contains SSL/TLS identities for Infinispan Server to the <code>$ISPN_HOME/server/conf</code> directory.</p>
</li>
<li>
<p>Add a <code>server-identities</code> definition to the Infinispan Server security realm.</p>
</li>
<li>
<p>Specify the keystore file name with the <code>path</code> attribute.</p>
</li>
<li>
<p>Provide the keystore password and certificate alias with the <code>keystore-password</code> and <code>alias</code> attributes.</p>
</li>
<li>
<p>Save the changes to your configuration.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Next steps</div>
<p>Configure clients with a trust store so they can verify SSL/TLS identities for Infinispan Server.</p>
</div>
<h4 id="keystore_configuration" class="discrete">Keystore configuration</h4>
<div class="listingblock">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;security&gt;</span>
    <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;server-identities&gt;</span>
          <span class="tag">&lt;ssl&gt;</span>
            <span class="comment">&lt;!-- Adds a keystore that contains server certificates that provide SSL/TLS identities to clients. --&gt;</span>
            <span class="tag">&lt;keystore</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">alias</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">my-server</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;/ssl&gt;</span>
        <span class="tag">&lt;/server-identities&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
    <span class="tag">&lt;/security-realms&gt;</span>
  <span class="tag">&lt;/security&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realms</span><span class="delimiter">&quot;</span></span>: [{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">server-identities</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">ssl</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">keystore</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">alias</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my-server</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
            }
          }
        }
      }]
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">security</span>:
    <span class="key">securityRealms</span>:
      - <span class="string"><span class="content">name: &quot;default&quot;</span></span>
        <span class="key">serverIdentities</span>:
          <span class="key">ssl</span>:
            <span class="key">keystore</span>:
              <span class="key">alias</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my-server</span><span class="delimiter">&quot;</span></span>
              <span class="key">path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span>
              <span class="key">password</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="../hotrod_java/hotrod_java.html#configuring-hotrod-encryption_hotrod-client-configuration">Configuring Hot Rod client encryption</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="generating-server-keystores_endpoint-security"><a class="anchor" href="#generating-server-keystores_endpoint-security"></a>5.1.1. Generating Infinispan Server keystores</h4>
<div class="paragraph">
<p>Configure Infinispan Server to automatically generate keystores at startup.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Automatically generated keystores:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Should not be used in production environments.</p>
</li>
<li>
<p>Are generated whenever necessary; for example, while obtaining the first connection from a client.</p>
</li>
<li>
<p>Contain certificates that you can use directly in Hot Rod clients.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Open your Infinispan Server configuration for editing.</p>
</li>
<li>
<p>Include the <code>generate-self-signed-certificate-host</code> attribute for the <code>keystore</code> element in the server configuration.</p>
</li>
<li>
<p>Specify a hostname for the server certificate as the value.</p>
</li>
<li>
<p>Save the changes to your configuration.</p>
</li>
</ol>
</div>
<h5 id="generated_keystore_configuration" class="discrete">Generated keystore configuration</h5>
<div class="listingblock">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;security&gt;</span>
    <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">GeneratedKeystore</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;server-identities&gt;</span>
          <span class="tag">&lt;ssl&gt;</span>
            <span class="comment">&lt;!-- Generates a keystore that includes a self-signed certificate with the specified hostname. --&gt;</span>
            <span class="tag">&lt;keystore</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">alias</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">generate-self-signed-certificate-host</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;/ssl&gt;</span>
        <span class="tag">&lt;/server-identities&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
    <span class="tag">&lt;/security-realms&gt;</span>
  <span class="tag">&lt;/security&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realms</span><span class="delimiter">&quot;</span></span>: [{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">GeneratedKeystore</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">server-identities</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">ssl</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">keystore</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">alias</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">generate-self-signed-certificate-host</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
            }
          }
        }
      }]
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">security</span>:
    <span class="key">securityRealms</span>:
      - <span class="string"><span class="content">name: &quot;GeneratedKeystore&quot;</span></span>
        <span class="key">serverIdentities</span>:
          <span class="key">ssl</span>:
            <span class="key">keystore</span>:
              <span class="key">alias</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>
              <span class="key">generateSelfSignedCertificateHost</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span>
              <span class="key">path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span>
              <span class="key">password</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configuring-ssl-engine_endpoint-security"><a class="anchor" href="#configuring-ssl-engine_endpoint-security"></a>5.1.2. Configuring TLS versions and cipher suites</h4>
<div class="paragraph">
<p>When using SSL/TLS encryption to secure your deployment, you can configure Infinispan Server to use specific versions of the TLS protocol as well as specific cipher suites within the protocol.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Open your Infinispan Server configuration for editing.</p>
</li>
<li>
<p>Add the <code>engine</code> element to the SSL configuration for Infinispan Server.</p>
</li>
<li>
<p>Configure Infinispan to use one or more TLS versions with the <code>enabled-protocols</code> attribute.</p>
<div class="paragraph">
<p>Infinispan Server supports TLS version 1.2 and 1.3 by default.
If appropriate you can set <code>TLSv1.3</code> only to restrict the security protocol for client connections.
Infinispan does not recommend enabling <code>TLSv1.1</code> because it is an older protocol with limited support and provides weak security.
You should never enable any version of TLS older than 1.1.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you modify the SSL <code>engine</code> configuration for Infinispan Server you must explicitly configure TLS versions with the <code>enabled-protocols</code> attribute.
Omitting the <code>enabled-protocols</code> attribute allows any TLS version.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;engine</span> <span class="attribute-name">enabled-protocols</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TLSv1.3 TLSv1.2</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Configure Infinispan to use one or more cipher suites with the <code>enabled-ciphersuites</code> attribute (for TLSv1.2 and below) and the <code>enabled-ciphersuites-tls13</code> attribute (for TLSv1.3).</p>
<div class="paragraph">
<p>You must ensure that you set a cipher suite that supports any protocol features you plan to use; for example <code>HTTP/2 ALPN</code>.</p>
</div>
</li>
<li>
<p>Save the changes to your configuration.</p>
</li>
</ol>
</div>
<h5 id="ssl_engine_configuration" class="discrete">SSL engine configuration</h5>
<div class="listingblock">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;security&gt;</span>
    <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;server-identities&gt;</span>
          <span class="tag">&lt;ssl&gt;</span>
            <span class="tag">&lt;keystore</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">alias</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="comment">&lt;!-- Configures Infinispan Server to use specific TLS versions and cipher suites. --&gt;</span>
            <span class="tag">&lt;engine</span> <span class="attribute-name">enabled-protocols</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TLSv1.3 TLSv1.2</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">enabled-ciphersuites</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TLS_AES_256_GCM_SHA384,TLS_AES_128_GCM_SHA256</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">enabled-ciphersuites-tls13</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TLS_AES_256_GCM_SHA384</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;/ssl&gt;</span>
        <span class="tag">&lt;/server-identities&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
    <span class="tag">&lt;/security-realms&gt;</span>
  <span class="tag">&lt;/security&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realms</span><span class="delimiter">&quot;</span></span>: [{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">server-identities</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">ssl</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">keystore</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">alias</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
            },
            <span class="key"><span class="delimiter">&quot;</span><span class="content">engine</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">enabled-protocols</span><span class="delimiter">&quot;</span></span>: [<span class="string"><span class="delimiter">&quot;</span><span class="content">TLSv1.3</span><span class="delimiter">&quot;</span></span>],
              <span class="key"><span class="delimiter">&quot;</span><span class="content">enabled-ciphersuites</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">TLS_AES_256_GCM_SHA384,TLS_AES_128_GCM_SHA256</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">enabled-ciphersuites-tls13</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">TLS_AES_256_GCM_SHA384</span><span class="delimiter">&quot;</span></span>
            }
          }
        }
      }]
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">security</span>:
    <span class="key">securityRealms</span>:
      - <span class="string"><span class="content">name: &quot;default&quot;</span></span>
        <span class="key">serverIdentities</span>:
          <span class="key">ssl</span>:
            <span class="key">keystore</span>:
              <span class="key">alias</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>
              <span class="key">path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span>
              <span class="key">password</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
            <span class="key">engine</span>:
              <span class="key">enabledProtocols</span>:
                - <span class="string"><span class="delimiter">&quot;</span><span class="content">TLSv1.3</span><span class="delimiter">&quot;</span></span>
              <span class="key">enabledCiphersuites</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">TLS_AES_256_GCM_SHA384,TLS_AES_128_GCM_SHA256</span><span class="delimiter">&quot;</span></span>
              <span class="key">enabledCiphersuitesTls13</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">TLS_AES_256_GCM_SHA384</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuring-server-fips_endpoint-security"><a class="anchor" href="#configuring-server-fips_endpoint-security"></a>5.2. Configuring Infinispan Server on a system with FIPS 140-2 compliant cryptography</h3>
<div class="paragraph">
<p>FIPS (Federal Information Processing Standards) are standards and guidelines for US federal computer systems.
Although FIPS are developed for use by the US federal government, many in the private sector voluntarily use these standards.</p>
</div>
<div class="paragraph">
<p>FIPS 140-2 defines security requirements for cryptographic modules.
You can configure your Infinispan Server to use encryption ciphers that adhere to the FIPS 140-2 specification by using alternative JDK security providers.</p>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/17/security/pkcs11-reference-guide1.html">Java PKCS#11 cryptographic provider</a></p>
</li>
<li>
<p><a href="https://www.bouncycastle.org/fips_faq.html">The Legion of the Bouncy Castle cryptographic provider</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="configuring_the_pkcs11_cryptographic_provider"><a class="anchor" href="#configuring_the_pkcs11_cryptographic_provider"></a>5.2.1. Configuring the PKCS11 cryptographic provider</h4>
<div class="paragraph">
<p>You can configure the PKCS11 cryptographic provider by specifying the PKCS11 keystore with the <code>SunPKCS11-NSS-FIPS</code> provider.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Configure your system for FIPS mode. You can check if your system has FIPS Mode enabled by issuing the <code>fips-mode-setup --check</code> command in your Infinispan command-line Interface (CLI)</p>
</li>
<li>
<p>Initialize the system-wide NSS database by using the <code>certutil</code> tool.</p>
</li>
<li>
<p>Install the JDK with the <code>java.security</code> file configured to enable the <code>SunPKCS11</code> provider. This provider points to the NSS database and the SSL provider.</p>
</li>
<li>
<p>Install a certificate in the NSS database.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The OpenSSL provider requires a private key, but you cannot retrieve a private key from the PKCS#11 store.
FIPS blocks the export of unencrypted keys from a FIPS-compliant cryptographic module, so you cannot use the OpenSSL provider for TLS when in FIPS mode.
You can disable the OpenSSL provider at startup with the <code>-Dorg.infinispan.openssl=false</code> argument.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Open your Infinispan Server configuration for editing.</p>
</li>
<li>
<p>Add a <code>server-identities</code> definition to the Infinispan Server security realm.</p>
</li>
<li>
<p>Specify the PKCS11 keystore with the <code>SunPKCS11-NSS-FIPS</code> provider.</p>
</li>
<li>
<p>Save the changes to your configuration.</p>
</li>
</ol>
</div>
<h5 id="keystore_configuration_2" class="discrete">Keystore configuration</h5>
<div class="listingblock">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;security&gt;</span>
      <span class="tag">&lt;security-realms&gt;</span>
         <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;server-identities&gt;</span>
               <span class="tag">&lt;ssl&gt;</span>
                  <span class="comment">&lt;!-- Adds a keystore that reads certificates from the NSS database. --&gt;</span>
                  <span class="tag">&lt;keystore</span> <span class="attribute-name">provider</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SunPKCS11-NSS-FIPS</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PKCS11</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
               <span class="tag">&lt;/ssl&gt;</span>
            <span class="tag">&lt;/server-identities&gt;</span>
         <span class="tag">&lt;/security-realm&gt;</span>
      <span class="tag">&lt;/security-realms&gt;</span>
   <span class="tag">&lt;/security&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realms</span><span class="delimiter">&quot;</span></span>: [{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">server-identities</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">ssl</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">keystore</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">provider</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SunPKCS11-NSS-FIPS</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">PKCS11</span><span class="delimiter">&quot;</span></span>
            }
          }
        }
      }]
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">security</span>:
    <span class="key">securityRealms</span>:
      - <span class="string"><span class="content">name: &quot;default&quot;</span></span>
        <span class="key">serverIdentities</span>:
          <span class="key">ssl</span>:
            <span class="key">keystore</span>:
              <span class="key">provider</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SunPKCS11-NSS-FIPS</span><span class="delimiter">&quot;</span></span>
              <span class="key">type</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">PKCS11</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configuring_the_bouncy_castle_fips_cryptographic_provider"><a class="anchor" href="#configuring_the_bouncy_castle_fips_cryptographic_provider"></a>5.2.2. Configuring the Bouncy Castle FIPS cryptographic provider</h4>
<div class="paragraph">
<p>You can configure the Bouncy Castle FIPS (Federal Information Processing Standards) cryptographic provider in your Infinispan server&#8217;s configuration.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Configure your system for FIPS mode. You can check if your system has FIPS Mode enabled by issuing the <code>fips-mode-setup --check</code> command in your Infinispan command-line Interface (CLI).</p>
</li>
<li>
<p>Create a keystore in BCFKS format that contains a certificate.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Download the Bouncy Castle FIPS JAR file, and add the file to the <code>server/lib</code> directory of your Infinispan Server installation.</p>
</li>
<li>
<p>To install Bouncy Castle, issue the <code>install</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>[disconnected]&gt; install org.bouncycastle:bc-fips:1.0.2.3</code></pre>
</div>
</div>
</li>
<li>
<p>Open your Infinispan Server configuration for editing.</p>
</li>
<li>
<p>Add a <code>server-identities</code> definition to the Infinispan Server security realm.</p>
</li>
<li>
<p>Specify the BCFKS keystore with the <code>BCFIPS</code> provider.</p>
</li>
<li>
<p>Save the changes to your configuration.</p>
</li>
</ol>
</div>
<h5 id="keystore_configuration_3" class="discrete">Keystore configuration</h5>
<div class="listingblock">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;security&gt;</span>
      <span class="tag">&lt;security-realms&gt;</span>
         <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;server-identities&gt;</span>
               <span class="tag">&lt;ssl&gt;</span>
                  <span class="comment">&lt;!-- Adds a keystore that reads certificates from the BCFKS keystore. --&gt;</span>
                  <span class="tag">&lt;keystore</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server.bcfks</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">alias</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">provider</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">BCFIPS</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">BCFKS</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
               <span class="tag">&lt;/ssl&gt;</span>
            <span class="tag">&lt;/server-identities&gt;</span>
         <span class="tag">&lt;/security-realm&gt;</span>
      <span class="tag">&lt;/security-realms&gt;</span>
   <span class="tag">&lt;/security&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realms</span><span class="delimiter">&quot;</span></span>: [{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">server-identities</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">ssl</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">keystore</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server.bcfks</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">alias</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">provider</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">BCFIPS</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">BCFKS</span><span class="delimiter">&quot;</span></span>
            }
          }
        }
      }]
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">security</span>:
    <span class="key">securityRealms</span>:
      - <span class="string"><span class="content">name: &quot;default&quot;</span></span>
        <span class="key">serverIdentities</span>:
          <span class="key">ssl</span>:
            <span class="key">keystore</span>:
              <span class="key">path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server.bcfks</span><span class="delimiter">&quot;</span></span>
              <span class="key">password</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
              <span class="key">alias</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>
              <span class="key">provider</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">BCFIPS</span><span class="delimiter">&quot;</span></span>
              <span class="key">type</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">BCFKS</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuring-client-certificate-authentication_endpoint-security"><a class="anchor" href="#configuring-client-certificate-authentication_endpoint-security"></a>5.3. Configuring client certificate authentication</h3>
<div class="paragraph">
<p>Configure Infinispan Server to use mutual TLS to secure client connections.</p>
</div>
<div class="paragraph">
<p>You can configure Infinispan to verify client identities from certificates in a trust store in two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Require a trust store that contains only the signing certificate, which is typically a Certificate Authority (CA). Any client that presents a certificate signed by the CA can connect to Infinispan.</p>
</li>
<li>
<p>Require a trust store that contains all client certificates in addition to the signing certificate. Only clients that present a signed certificate that is present in the trust store can connect to Infinispan.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Alternatively to providing trust stores you can use shared system certificates.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Create a client trust store that contains either the CA certificate or all public certificates.</p>
</li>
<li>
<p>Create a keystore for Infinispan Server and configure an SSL/TLS identity.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>PEM files can be used as trust stores provided they contain one or more certificates.
These trust stores should be configured with an empty password: <code>password=""</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Open your Infinispan Server configuration for editing.</p>
</li>
<li>
<p>Add the <code>require-ssl-client-auth="true"</code> parameter to your <code>endpoints</code> configuration.</p>
</li>
<li>
<p>Add the client trust store to the <code>$ISPN_HOME/server/conf</code> directory.</p>
</li>
<li>
<p>Specify the <code>path</code> and <code>password</code> attributes for the <code>truststore</code> element in the Infinispan Server security realm configuration.</p>
</li>
<li>
<p>Add the <code>&lt;truststore-realm/&gt;</code> element to the security realm if you want Infinispan Server to authenticate each client certificate.</p>
</li>
<li>
<p>Save the changes to your configuration.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Next steps</div>
<ul>
<li>
<p>Set up authorization with client certificates in the Infinispan Server configuration if you control access with security roles and permissions.</p>
</li>
<li>
<p>Configure clients to negotiate SSL/TLS connections with Infinispan Server.</p>
</li>
</ul>
</div>
<h4 id="client_certificate_authentication_configuration" class="discrete">Client certificate authentication configuration</h4>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;security&gt;</span>
    <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TrustStoreRealm</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;server-identities&gt;</span>
          <span class="tag">&lt;ssl&gt;</span>
            <span class="comment">&lt;!-- Provides an SSL/TLS identity with a keystore that
                 contains server certificates. --&gt;</span>
            <span class="tag">&lt;keystore</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">keystore-password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">alias</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="comment">&lt;!-- Configures a trust store that contains client certificates
                 or part of a certificate chain. --&gt;</span>
            <span class="tag">&lt;truststore</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">trust.p12</span><span class="delimiter">&quot;</span></span>
                        <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>
                        <span class="attribute-name">password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;/ssl&gt;</span>
        <span class="tag">&lt;/server-identities&gt;</span>
        <span class="comment">&lt;!-- Authenticates client certificates against the trust store. If you configure this, the trust store must contain the public certificates for all clients. --&gt;</span>
        <span class="tag">&lt;truststore-realm</span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
    <span class="tag">&lt;/security-realms&gt;</span>
  <span class="tag">&lt;/security&gt;</span>
  <span class="tag">&lt;endpoints&gt;</span>
    <span class="tag">&lt;endpoint</span> <span class="attribute-name">socket-binding</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>
              <span class="attribute-name">security-realm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">trust-store-realm</span><span class="delimiter">&quot;</span></span>
              <span class="attribute-name">require-ssl-client-auth</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;hotrod-connector&gt;</span>
        <span class="tag">&lt;authentication&gt;</span>
          <span class="tag">&lt;sasl</span> <span class="attribute-name">mechanisms</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">EXTERNAL</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">server-name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">qop</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">auth</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/authentication&gt;</span>
      <span class="tag">&lt;/hotrod-connector&gt;</span>
      <span class="tag">&lt;rest-connector&gt;</span>
        <span class="tag">&lt;authentication</span> <span class="attribute-name">mechanisms</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CLIENT_CERT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/rest-connector&gt;</span>
    <span class="tag">&lt;/endpoint&gt;</span>
  <span class="tag">&lt;/endpoints&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realms</span><span class="delimiter">&quot;</span></span>: [{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">TrustStoreRealm</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">server-identities</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">ssl</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">keystore</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">relative-to</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">keystore-password</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">alias</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>
            },
            <span class="key"><span class="delimiter">&quot;</span><span class="content">truststore</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">trust.p12</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">relative-to</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
            }
          }
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">truststore-realm</span><span class="delimiter">&quot;</span></span>: {}
      }]
    },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">endpoints</span><span class="delimiter">&quot;</span></span>: [{
      <span class="key"><span class="delimiter">&quot;</span><span class="content">socket-binding</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realm</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">TrustStoreRealm</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">require-ssl-client-auth</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">connectors</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">hotrod</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">hotrod-connector</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">authentication</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">sasl</span><span class="delimiter">&quot;</span></span>: {
                <span class="key"><span class="delimiter">&quot;</span><span class="content">mechanisms</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">EXTERNAL</span><span class="delimiter">&quot;</span></span>,
                <span class="key"><span class="delimiter">&quot;</span><span class="content">server-name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan</span><span class="delimiter">&quot;</span></span>,
                <span class="key"><span class="delimiter">&quot;</span><span class="content">qop</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">auth</span><span class="delimiter">&quot;</span></span>
              }
            }
          },
          <span class="key"><span class="delimiter">&quot;</span><span class="content">rest</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">rest-connector</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">authentication</span><span class="delimiter">&quot;</span></span>: {
                <span class="key"><span class="delimiter">&quot;</span><span class="content">mechanisms</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">CLIENT_CERT</span><span class="delimiter">&quot;</span></span>
              }
            }
          }
        }
      }
    }]
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">security</span>:
    <span class="key">securityRealms</span>:
      - <span class="string"><span class="content">name: &quot;TrustStoreRealm&quot;</span></span>
        <span class="key">serverIdentities</span>:
          <span class="key">ssl</span>:
            <span class="key">keystore</span>:
              <span class="key">path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span>
              <span class="key">relative-to</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>
              <span class="key">keystore-password</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
              <span class="key">alias</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>
            <span class="key">truststore</span>:
              <span class="key">path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">trust.p12</span><span class="delimiter">&quot;</span></span>
              <span class="key">relative-to</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>
              <span class="key">password</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
        <span class="key">truststoreRealm</span>: <span class="string"><span class="content">~</span></span>
  <span class="key">endpoints</span>:
    <span class="key">socketBinding</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>
    <span class="key">securityRealm</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">trust-store-realm</span><span class="delimiter">&quot;</span></span>
    <span class="key">requireSslClientAuth</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>
    <span class="key">connectors</span>:
      - <span class="string"><span class="content">hotrod:</span><span class="content">
          hotrodConnector:
            authentication:
              sasl:
                mechanisms: &quot;EXTERNAL&quot;
                serverName: &quot;infinispan&quot;
                qop: &quot;auth&quot;</span></span>
      - <span class="string"><span class="content">rest:</span><span class="content">
          restConnector:
            authentication:
              mechanisms: &quot;CLIENT_CERT&quot;</span></span></code></pre>
</div>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="../hotrod_java/hotrod_java.html#configuring-hotrod-encryption_hotrod-client-configuration">Configuring Hot Rod client encryption</a></p>
</li>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/security_guide/sec-shared-system-certificates">Using Shared System Certificates</a> (Red Hat Enterprise Linux 7 Security Guide)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="configuring-client-certificate-authorization_endpoint-security"><a class="anchor" href="#configuring-client-certificate-authorization_endpoint-security"></a>5.4. Configuring authorization with client certificates</h3>
<div class="paragraph">
<p>Enabling client certificate authentication means you do not need to specify Infinispan user credentials in client configuration, which means you must associate roles with the Common Name (CN) field in the client certificate(s).</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Provide clients with a Java keystore that contains either their public certificates or part of the certificate chain, typically a public CA certificate.</p>
</li>
<li>
<p>Configure Infinispan Server to perform client certificate authentication.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Open your Infinispan Server configuration for editing.</p>
</li>
<li>
<p>Enable the <code>common-name-role-mapper</code> in the security authorization configuration.</p>
</li>
<li>
<p>Assign the Common Name (<code>CN</code>) from the client certificate a role with the appropriate permissions.</p>
</li>
<li>
<p>Save the changes to your configuration.</p>
</li>
</ol>
</div>
<h4 id="client_certificate_authorization_configuration" class="discrete">Client certificate authorization configuration</h4>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;infinispan&gt;</span>
  <span class="tag">&lt;cache-container</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">certificate-authentication</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">statistics</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;security&gt;</span>
      <span class="tag">&lt;authorization&gt;</span>
        <span class="comment">&lt;!-- Declare a role mapper that associates the common name (CN) field in client certificate trust stores with authorization roles. --&gt;</span>
        <span class="tag">&lt;common-name-role-mapper</span><span class="tag">/&gt;</span>
        <span class="comment">&lt;!-- In this example, if a client certificate contains `CN=Client1` then clients with matching certificates get ALL permissions. --&gt;</span>
        <span class="tag">&lt;role</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Client1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">permissions</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ALL</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/authorization&gt;</span>
    <span class="tag">&lt;/security&gt;</span>
  <span class="tag">&lt;/cache-container&gt;</span>
<span class="tag">&lt;/infinispan&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">infinispan</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cache-container</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">certificate-authentication</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">authorization</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">common-name-role-mapper</span><span class="delimiter">&quot;</span></span>: <span class="value">null</span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">roles</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">Client1</span><span class="delimiter">&quot;</span></span>: {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">role</span><span class="delimiter">&quot;</span></span>: {
                <span class="key"><span class="delimiter">&quot;</span><span class="content">permissions</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ALL</span><span class="delimiter">&quot;</span></span>
              }
            }
          }
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">infinispan</span>:
  <span class="key">cacheContainer</span>:
    <span class="key">name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">certificate-authentication</span><span class="delimiter">&quot;</span></span>
    <span class="key">security</span>:
      <span class="key">authorization</span>:
        <span class="key">commonNameRoleMapper</span>: <span class="string"><span class="content">~</span></span>
        <span class="key">roles</span>:
          <span class="key">Client1</span>:
            <span class="key">role</span>:
              <span class="key">permissions</span>:
                - <span class="string"><span class="delimiter">&quot;</span><span class="content">ALL</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="credential-keystores"><a class="anchor" href="#credential-keystores"></a>6. Storing Infinispan Server credentials in keystores</h2>
<div class="sectionbody">
<div class="paragraph">
<p>External services require credentials to authenticate with Infinispan Server.
To protect sensitive text strings such as passwords, add them to a credential keystore rather than directly in Infinispan Server configuration files.</p>
</div>
<div class="paragraph">
<p>You can then configure Infinispan Server to decrypt passwords for establishing connections with services such as databases or LDAP directories.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Plain-text passwords in <code>$ISPN_HOME/server/conf</code> are unencrypted.
Any user account with read access to the host filesystem can view plain-text passwords.</p>
</div>
<div class="paragraph">
<p>While credential keystores are password-protected store encrypted passwords, any user account with write access to the host filesystem can tamper with the keystore itself.</p>
</div>
<div class="paragraph">
<p>To completely secure Infinispan Server credentials, you should grant read-write access only to user accounts that can configure and run Infinispan Server.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="setting-up-credential-keystores_credential-keystores"><a class="anchor" href="#setting-up-credential-keystores_credential-keystores"></a>6.1. Setting up credential keystores</h3>
<div class="paragraph">
<p>Create keystores that encrypt credential for Infinispan Server access.</p>
</div>
<div class="paragraph">
<p>A credential keystore contains at least one alias that is associated with an encrypted password.
After you create a keystore, you specify the alias in a connection configuration such as a database connection pool.
Infinispan Server then decrypts the password for that alias from the keystore when the service attempts authentication.</p>
</div>
<div class="paragraph">
<p>You can create as many credential keystores with as many aliases as required.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Open a terminal in <code>$ISPN_HOME</code>.</p>
</li>
<li>
<p>Create a keystore and add credentials to it with the <code class="command">credentials</code> command.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By default, keystores are of type PKCS12.
Run <code class="command">help credentials</code> for details on changing keystore defaults.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following example shows how to create a keystore that contains an alias of "dbpassword" for the password "changeme".
When you create a keystore you also specify a password for the keystore with the <code>-p</code> argument.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Linux</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>bin/cli.sh credentials add dbpassword -c changeme -p &quot;secret1234!&quot;</code></pre>
</div>
</div>
</dd>
<dt class="hdlist1">Microsoft Windows</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>bin\cli.bat credentials add dbpassword -c changeme -p &quot;secret1234!&quot;</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>Check that the alias is added to the keystore.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>bin/cli.sh credentials ls -p &quot;secret1234!&quot;
dbpassword</code></pre>
</div>
</div>
</li>
<li>
<p>Configure Infinispan to use the credential keystore.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Specify the name and location of the credential keystore in the <code>credential-stores</code> configuration.</p>
</li>
<li>
<p>Provide the credential keystore and alias in the <code>credential-reference</code> configuration.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Attributes in the <code>credential-reference</code> configuration are optional.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>store</code> is required only if you have multiple keystores.</p>
</li>
<li>
<p><code>alias</code> is required only if the keystore contains multiple aliases.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="credential-keystore-configuration_credential-keystores"><a class="anchor" href="#credential-keystore-configuration_credential-keystores"></a>6.2. Credential keystore configuration</h3>
<div class="paragraph">
<p>This topic provides examples of credential keystores in Infinispan Server configuration.</p>
</div>
<h4 id="credential_keystores" class="discrete">Credential keystores</h4>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;security&gt;</span>
    <span class="comment">&lt;!-- Uses a keystore to manage server credentials. --&gt;</span>
    <span class="tag">&lt;credential-stores&gt;</span>
      <span class="comment">&lt;!-- Specifies the name and filesystem location of a keystore. --&gt;</span>
      <span class="tag">&lt;credential-store</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">credentials</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">credentials.pfx</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="comment">&lt;!-- Specifies the password for the credential keystore. --&gt;</span>
        <span class="tag">&lt;clear-text-credential</span> <span class="attribute-name">clear-text</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secret1234!</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/credential-store&gt;</span>
    <span class="tag">&lt;/credential-stores&gt;</span>
  <span class="tag">&lt;/security&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">credential-stores</span><span class="delimiter">&quot;</span></span>: [{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">credentials</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">credentials.pfx</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">clear-text-credential</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">clear-text</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret1234!</span><span class="delimiter">&quot;</span></span>
        }
      }]
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">security</span>:
    <span class="key">credentialStores</span>:
      - <span class="string"><span class="content">name: credentials</span></span>
        <span class="key">path</span>: <span class="string"><span class="content">credentials.pfx</span></span>
        <span class="key">clearTextCredential</span>:
          <span class="key">clearText</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret1234!</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<h4 id="datasource_connections" class="discrete">Datasource connections</h4>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;data-sources&gt;</span>
    <span class="tag">&lt;data-source</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">postgres</span><span class="delimiter">&quot;</span></span>
                 <span class="attribute-name">jndi-name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jdbc/postgres</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="comment">&lt;!-- Specifies the database username in the connection factory. --&gt;</span>
      <span class="tag">&lt;connection-factory</span> <span class="attribute-name">driver</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.postgresql.Driver</span><span class="delimiter">&quot;</span></span>
                          <span class="attribute-name">username</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">dbuser</span><span class="delimiter">&quot;</span></span>
                          <span class="attribute-name">url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${org.infinispan.server.test.postgres.jdbcUrl}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="comment">&lt;!-- Specifies the credential keystore that contains an encrypted password and the alias for it. --&gt;</span>
        <span class="tag">&lt;credential-reference</span> <span class="attribute-name">store</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">credentials</span><span class="delimiter">&quot;</span></span>
                              <span class="attribute-name">alias</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">dbpassword</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/connection-factory&gt;</span>
      <span class="tag">&lt;connection-pool</span> <span class="attribute-name">max-size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">10</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">min-size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">background-validation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1000</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">idle-removal</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">initial-size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">leak-detection</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">10000</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/data-source&gt;</span>
  <span class="tag">&lt;/data-sources&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">data-sources</span><span class="delimiter">&quot;</span></span>: [{
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">postgres</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">jndi-name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">jdbc/postgres</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">connection-factory</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">driver</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">org.postgresql.Driver</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">dbuser</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">${org.infinispan.server.test.postgres.jdbcUrl}</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">credential-reference</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">store</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">credentials</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">alias</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">dbpassword</span><span class="delimiter">&quot;</span></span>
        }
      }
    }]
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">dataSources</span>:
    - <span class="string"><span class="content">name: postgres</span></span>
      <span class="key">jndiName</span>: <span class="string"><span class="content">jdbc/postgres</span></span>
      <span class="key">connectionFactory</span>:
        <span class="key">driver</span>: <span class="string"><span class="content">org.postgresql.Driver</span></span>
        <span class="key">username</span>: <span class="string"><span class="content">dbuser</span></span>
        <span class="key">url</span>: <span class="string"><span class="content">'${org.infinispan.server.test.postgres.jdbcUrl}'</span></span>
        <span class="key">credentialReference</span>:
          <span class="key">store</span>: <span class="string"><span class="content">credentials</span></span>
          <span class="key">alias</span>: <span class="string"><span class="content">dbpassword</span></span></code></pre>
</div>
</div>
<h4 id="ldap_connections" class="discrete">LDAP connections</h4>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;security&gt;</span>
    <span class="tag">&lt;credential-stores&gt;</span>
      <span class="tag">&lt;credential-store</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">credentials</span><span class="delimiter">&quot;</span></span>
                        <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">credentials.pfx</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;clear-text-credential</span> <span class="attribute-name">clear-text</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secret1234!</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/credential-store&gt;</span>
    <span class="tag">&lt;/credential-stores&gt;</span>
    <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="comment">&lt;!-- Specifies the LDAP principal in the connection factory. --&gt;</span>
        <span class="tag">&lt;ldap-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ldap</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ldap://my-ldap-server:10389</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">principal</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">uid=admin,ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          <span class="comment">&lt;!-- Specifies the credential keystore that contains an encrypted password and the alias for it. --&gt;</span>
          <span class="tag">&lt;credential-reference</span> <span class="attribute-name">store</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">credentials</span><span class="delimiter">&quot;</span></span>
                                <span class="attribute-name">alias</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ldappassword</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/ldap-realm&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
    <span class="tag">&lt;/security-realms&gt;</span>
  <span class="tag">&lt;/security&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">credential-stores</span><span class="delimiter">&quot;</span></span>: [{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">credentials</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">credentials.pfx</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">clear-text-credential</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">clear-text</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret1234!</span><span class="delimiter">&quot;</span></span>
        }
      }],
      <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realms</span><span class="delimiter">&quot;</span></span>: [{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">ldap-realm</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ldap</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ldap://my-ldap-server:10389</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">principal</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">uid=admin,ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">credential-reference</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">store</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">credentials</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">alias</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ldappassword</span><span class="delimiter">&quot;</span></span>
          }
        }
      }]
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span class="key">server</span>:
  <span class="key">security</span>:
    <span class="key">credentialStores</span>:
      - <span class="string"><span class="content">name: credentials</span></span>
        <span class="key">path</span>: <span class="string"><span class="content">credentials.pfx</span></span>
        <span class="key">clearTextCredential</span>:
          <span class="key">clearText</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret1234!</span><span class="delimiter">&quot;</span></span>
    <span class="key">securityRealms</span>:
      - <span class="string"><span class="content">name: &quot;default&quot;</span></span>
        <span class="key">ldapRealm</span>:
          <span class="key">name</span>: <span class="string"><span class="content">ldap</span></span>
          <span class="key">url</span>: <span class="string"><span class="content">'ldap://my-ldap-server:10389'</span></span>
          <span class="key">principal</span>: <span class="string"><span class="content">'uid=admin,ou=People,dc=infinispan,dc=org'</span></span>
          <span class="key">credentialReference</span>:
            <span class="key">store</span>: <span class="string"><span class="content">credentials</span></span>
            <span class="key">alias</span>: <span class="string"><span class="content">ldappassword</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="secure-cluster-transport"><a class="anchor" href="#secure-cluster-transport"></a>7. Encrypting cluster transport</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Secure cluster transport so that nodes communicate with encrypted messages.
You can also configure Infinispan clusters to perform certificate authentication so that only nodes with valid identities can join.</p>
</div>
<div class="sect2">
<h3 id="securing-cluster-transport-tls-identities_secure-cluster-transport"><a class="anchor" href="#securing-cluster-transport-tls-identities_secure-cluster-transport"></a>7.1. Securing cluster transport with TLS identities</h3>
<div class="paragraph">
<p>Add SSL/TLS identities to a Infinispan Server security realm and use them to secure cluster transport.
Nodes in the Infinispan Server cluster then exchange SSL/TLS certificates to encrypt JGroups messages, including RELAY messages if you configure cross-site replication.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Install a Infinispan Server cluster.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a TLS keystore that contains a single certificate to identify Infinispan Server.</p>
<div class="paragraph">
<p>You can also use a PEM file if it contains a private key in PKCS#1 or PKCS#8 format, a certificate, and has an empty password: <code>password=""</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the certificate in the keystore is not signed by a public certificate authority (CA) then you must also create a trust store that contains either the signing certificate or the public key.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Add the keystore to the <code>$ISPN_HOME/server/conf</code> directory.</p>
</li>
<li>
<p>Add the keystore to a new security realm in your Infinispan Server configuration.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You should create dedicated keystores and security realms so that Infinispan Server endpoints do not use the same security realm as cluster transport.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;server</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:13.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;security&gt;</span>
    <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cluster-transport</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;server-identities&gt;</span>
          <span class="tag">&lt;ssl&gt;</span>
            <span class="comment">&lt;!-- Adds a keystore that contains a certificate that provides SSL/TLS identity to encrypt cluster transport. --&gt;</span>
            <span class="tag">&lt;keystore</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server.pfx</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">alias</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;/ssl&gt;</span>
        <span class="tag">&lt;/server-identities&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
    <span class="tag">&lt;/security-realms&gt;</span>
  <span class="tag">&lt;/security&gt;</span>
<span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
</li>
<li>
<p>Configure cluster transport to use the security realm by specifying the name of the security realm with the <code>server:security-realm</code> attribute.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;infinispan&gt;</span>
  <span class="tag">&lt;cache-container&gt;</span>
    <span class="tag">&lt;transport</span> <span class="attribute-name">server:security-realm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cluster-transport</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/cache-container&gt;</span>
<span class="tag">&lt;/infinispan&gt;</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Verification</div>
<p>When you start Infinispan Server, the following log message indicates that the cluster is using the security realm for cluster transport:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>[org.infinispan.SERVER] ISPN080060: SSL Transport using realm &lt;security_realm_name&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="jgroups-encryption-protocols_secure-cluster-transport"><a class="anchor" href="#jgroups-encryption-protocols_secure-cluster-transport"></a>7.2. JGroups encryption protocols</h3>
<div class="paragraph">
<p>To secure cluster traffic, you can configure Infinispan nodes to encrypt JGroups message payloads with secret keys.</p>
</div>
<div class="paragraph">
<p>Infinispan nodes can obtain secret keys from either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The coordinator node (asymmetric encryption).</p>
</li>
<li>
<p>A shared keystore (symmetric encryption).</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Retrieving secret keys from coordinator nodes</div>
<p>You configure asymmetric encryption by adding the <code>ASYM_ENCRYPT</code> protocol to a JGroups stack in your Infinispan configuration.
This allows Infinispan clusters to generate and distribute secret keys.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When using asymmetric encryption, you should also provide keystores so that nodes can perform certificate authentication and securely exchange secret keys.
This protects your cluster from man-in-the-middle (MitM) attacks.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Asymmetric encryption secures cluster traffic as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The first node in the Infinispan cluster, the coordinator node, generates a secret key.</p>
</li>
<li>
<p>A joining node performs certificate authentication with the coordinator to mutually verify identity.</p>
</li>
<li>
<p>The joining node requests the secret key from the coordinator node. That request includes the public key for the joining node.</p>
</li>
<li>
<p>The coordinator node encrypts the secret key with the public key and returns it to the joining node.</p>
</li>
<li>
<p>The joining node decrypts and installs the secret key.</p>
</li>
<li>
<p>The node joins the cluster, encrypting and decrypting messages with the secret key.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Retrieving secret keys from shared keystores</div>
<p>You configure symmetric encryption by adding the <code>SYM_ENCRYPT</code> protocol to a JGroups stack in your Infinispan configuration.
This allows Infinispan clusters to obtain secret keys from keystores that you provide.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Nodes install the secret key from a keystore on the Infinispan classpath at startup.</p>
</li>
<li>
<p>Node join clusters, encrypting and decrypting messages with the secret key.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Comparison of asymmetric and symmetric encryption</div>
<p><code>ASYM_ENCRYPT</code> with certificate authentication provides an additional layer of encryption in comparison with <code>SYM_ENCRYPT</code>.
You provide keystores that encrypt the requests to coordinator nodes for the secret key.
Infinispan automatically generates that secret key and handles cluster traffic, while letting you specify when to generate secret keys.
For example, you can configure clusters to generate new secret keys when nodes leave.
This ensures that nodes cannot bypass certificate authentication and join with old keys.</p>
</div>
<div class="paragraph">
<p><code>SYM_ENCRYPT</code>, on the other hand, is faster than <code>ASYM_ENCRYPT</code> because nodes do not need to exchange keys with the cluster coordinator.
A potential drawback to <code>SYM_ENCRYPT</code> is that there is no configuration to automatically generate new secret keys when cluster membership changes.
Users are responsible for generating and distributing the secret keys that nodes use to encrypt cluster traffic.</p>
</div>
</div>
<div class="sect2">
<h3 id="configuring-jgroups-asym-encrypt_secure-cluster-transport"><a class="anchor" href="#configuring-jgroups-asym-encrypt_secure-cluster-transport"></a>7.3. Securing cluster transport with asymmetric encryption</h3>
<div class="paragraph">
<p>Configure Infinispan clusters to generate and distribute secret keys that encrypt JGroups messages.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a keystore with certificate chains that enables Infinispan to verify node identity.</p>
</li>
<li>
<p>Place the keystore on the classpath for each node in the cluster.</p>
<div class="paragraph">
<p>For Infinispan Server, you put the keystore in the $ISPN_HOME directory.</p>
</div>
</li>
<li>
<p>Add the <code>SSL_KEY_EXCHANGE</code> and <code>ASYM_ENCRYPT</code> protocols to a JGroups stack in your Infinispan configuration, as in the following example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;infinispan&gt;</span>
  <span class="tag">&lt;jgroups&gt;</span>
    <span class="comment">&lt;!-- Creates a secure JGroups stack named &quot;encrypt-tcp&quot; that extends the default TCP stack. --&gt;</span>
    <span class="tag">&lt;stack</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">encrypt-tcp</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">extends</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">tcp</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="comment">&lt;!-- Adds a keystore that nodes use to perform certificate authentication. --&gt;</span>
      <span class="comment">&lt;!-- Uses the stack.combine and stack.position attributes to insert SSL_KEY_EXCHANGE into the default TCP stack after VERIFY_SUSPECT. --&gt;</span>
      <span class="tag">&lt;SSL_KEY_EXCHANGE</span> <span class="attribute-name">keystore_name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mykeystore.jks</span><span class="delimiter">&quot;</span></span>
                        <span class="attribute-name">keystore_password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">changeit</span><span class="delimiter">&quot;</span></span>
                        <span class="attribute-name">stack.combine</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INSERT_AFTER</span><span class="delimiter">&quot;</span></span>
                        <span class="attribute-name">stack.position</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">VERIFY_SUSPECT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="comment">&lt;!-- Configures ASYM_ENCRYPT --&gt;</span>
      <span class="comment">&lt;!-- Uses the stack.combine and stack.position attributes to insert ASYM_ENCRYPT into the default TCP stack before pbcast.NAKACK2. --&gt;</span>
      <span class="comment">&lt;!-- The use_external_key_exchange = &quot;true&quot; attribute configures nodes to use the `SSL_KEY_EXCHANGE` protocol for certificate authentication. --&gt;</span>
      <span class="tag">&lt;ASYM_ENCRYPT</span> <span class="attribute-name">asym_keylength</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2048</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">asym_algorithm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">RSA</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">change_key_on_coord_leave</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">change_key_on_leave</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">use_external_key_exchange</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">stack.combine</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INSERT_BEFORE</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">stack.position</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pbcast.NAKACK2</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/stack&gt;</span>
  <span class="tag">&lt;/jgroups&gt;</span>
  <span class="tag">&lt;cache-container</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">statistics</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="comment">&lt;!-- Configures the cluster to use the JGroups stack. --&gt;</span>
    <span class="tag">&lt;transport</span> <span class="attribute-name">cluster</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${infinispan.cluster.name}</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">stack</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">encrypt-tcp</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">node-name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${infinispan.node.name:}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/cache-container&gt;</span>
<span class="tag">&lt;/infinispan&gt;</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Verification</div>
<p>When you start your Infinispan cluster, the following log message indicates that the cluster is using the secure JGroups stack:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>[org.infinispan.CLUSTER] ISPN000078: Starting JGroups channel cluster with stack &lt;encrypted_stack_name&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan nodes can join the cluster only if they use <code>ASYM_ENCRYPT</code> and can obtain the secret key from the coordinator node.
Otherwise the following message is written to Infinispan logs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>[org.jgroups.protocols.ASYM_ENCRYPT] &lt;hostname&gt;: received message without encrypt header from &lt;hostname&gt;; dropping it</code></pre>
</div>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="http://www.jgroups.org/manual4/index.html">JGroups 4 Manual</a></p>
</li>
<li>
<p><a href="http://www.jgroups.org/schema/jgroups-4.2.xsd">JGroups 4.2 Schema</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="configuring-jgroups-sym-encrypt_secure-cluster-transport"><a class="anchor" href="#configuring-jgroups-sym-encrypt_secure-cluster-transport"></a>7.4. Securing cluster transport with symmetric encryption</h3>
<div class="paragraph">
<p>Configure Infinispan clusters to encrypt JGroups messages with secret keys from keystores that you provide.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a keystore that contains a secret key.</p>
</li>
<li>
<p>Place the keystore on the classpath for each node in the cluster.</p>
<div class="paragraph">
<p>For Infinispan Server, you put the keystore in the $ISPN_HOME directory.</p>
</div>
</li>
<li>
<p>Add the <code>SYM_ENCRYPT</code> protocol to a JGroups stack in your Infinispan configuration.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;infinispan&gt;</span>
  <span class="tag">&lt;jgroups&gt;</span>
    <span class="comment">&lt;!-- Creates a secure JGroups stack named &quot;encrypt-tcp&quot; that extends the default TCP stack. --&gt;</span>
    <span class="tag">&lt;stack</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">encrypt-tcp</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">extends</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">tcp</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="comment">&lt;!-- Adds a keystore from which nodes obtain secret keys. --&gt;</span>
      <span class="comment">&lt;!-- Uses the stack.combine and stack.position attributes to insert SYM_ENCRYPT into the default TCP stack after VERIFY_SUSPECT. --&gt;</span>
      <span class="tag">&lt;SYM_ENCRYPT</span> <span class="attribute-name">keystore_name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">myKeystore.p12</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">keystore_type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PKCS12</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">store_password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">changeit</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">key_password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">changeit</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">alias</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">myKey</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">stack.combine</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INSERT_AFTER</span><span class="delimiter">&quot;</span></span>
                   <span class="attribute-name">stack.position</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">VERIFY_SUSPECT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/stack&gt;</span>
  <span class="tag">&lt;/jgroups&gt;</span>
  <span class="tag">&lt;cache-container</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">statistics</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="comment">&lt;!-- Configures the cluster to use the JGroups stack. --&gt;</span>
    <span class="tag">&lt;transport</span> <span class="attribute-name">cluster</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${infinispan.cluster.name}</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">stack</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">encrypt-tcp</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">node-name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${infinispan.node.name:}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/cache-container&gt;</span>
<span class="tag">&lt;/infinispan&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Verification</div>
<p>When you start your Infinispan cluster, the following log message indicates that the cluster is using the secure JGroups stack:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>[org.infinispan.CLUSTER] ISPN000078: Starting JGroups channel cluster with stack &lt;encrypted_stack_name&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan nodes can join the cluster only if they use <code>SYM_ENCRYPT</code> and can obtain the secret key from the shared keystore.
Otherwise the following message is written to Infinispan logs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[org.jgroups.protocols.SYM_ENCRYPT] &lt;hostname&gt;: received message without encrypt header from &lt;hostname&gt;; dropping it</pre>
</div>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="http://www.jgroups.org/manual4/index.html">JGroups 4 Manual</a></p>
</li>
<li>
<p><a href="http://www.jgroups.org/schema/jgroups-4.2.xsd">JGroups 4.2 Schema</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ports_protocols"><a class="anchor" href="#ports_protocols"></a>8. Infinispan ports and protocols</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As Infinispan distributes data across your network and can establish
connections for external client requests, you should be aware of the ports and
protocols that Infinispan uses to handle network traffic.</p>
</div>
<div class="paragraph">
<p>If run Infinispan as a remote server then you might need to allow remote
clients through your firewall. Likewise, you should adjust ports that
Infinispan nodes use for cluster communication to prevent conflicts or network
issues.</p>
</div>
<div class="sect2">
<h3 id="server-ports-protocols_network"><a class="anchor" href="#server-ports-protocols_network"></a>8.1. Infinispan Server ports and protocols</h3>
<div class="paragraph">
<p>Infinispan Server provides network endpoints that allow client access with different protocols.</p>
</div>
<table class="tableblock frame-all grid-all stripes-even fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Port</th>
<th class="tableblock halign-left valign-top">Protocol</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>11222</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hot Rod and REST</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>11221</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Memcached (disabled by default)</p></td>
</tr>
</tbody>
</table>
<h4 id="single_port" class="discrete">Single port</h4>
<div class="paragraph">
<p>Infinispan Server exposes multiple protocols through a single TCP port, <code>11222</code>.
Handling multiple protocols with a single port simplifies configuration and reduces management complexity when deploying Infinispan clusters.
Using a single port also enhances security by minimizing the attack surface on the network.</p>
</div>
<div class="paragraph">
<p>Infinispan Server handles HTTP/1.1, HTTP/2, and Hot Rod protocol requests from clients via the single port in different ways.</p>
</div>
<div class="paragraph">
<div class="title">HTTP/1.1 upgrade headers</div>
<p>Client requests can include the <code>HTTP/1.1 upgrade</code> header field to initiate
HTTP/1.1 connections with Infinispan Server.
Client applications can then send the <code>Upgrade: protocol</code> header field, where <code>protocol</code> is a server endpoint.</p>
</div>
<div class="paragraph">
<div class="title">Application-Layer Protocol Negotiation (ALPN)/Transport Layer Security (TLS)</div>
<p>Client requests include Server Name Indication (SNI) mappings for Infinispan Server endpoints to negotiate protocols over a TLS connection.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Applications must use a TLS library that supports the ALPN extension.
Infinispan uses WildFly OpenSSL bindings for Java.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Automatic Hot Rod detection</div>
<p>Client requests that include Hot Rod headers automatically route to Hot Rod endpoints.</p>
</div>
<div class="sect3">
<h4 id="configuring-firewalls_network"><a class="anchor" href="#configuring-firewalls_network"></a>8.1.1. Configuring network firewalls for Infinispan traffic</h4>
<div class="paragraph">
<p>Adjust firewall rules to allow traffic between Infinispan Server and client applications.</p>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>On Red Hat Enterprise Linux (RHEL) workstations, for example, you can allow
traffic to port <code>11222</code> with firewalld as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code># firewall-cmd --add-port=11222/tcp --permanent
success
# firewall-cmd --list-ports | grep 11222
11222/tcp</code></pre>
</div>
</div>
<div class="paragraph">
<p>To configure firewall rules that apply across a network, you can use the
nftables utility.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="jgroups-ports_network"><a class="anchor" href="#jgroups-ports_network"></a>8.2. TCP and UDP ports for cluster traffic</h3>
<div class="paragraph">
<p>Infinispan uses the following ports for cluster transport messages:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Default Port</th>
<th class="tableblock halign-left valign-top">Protocol</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>7800</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP/UDP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JGroups cluster bind port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>46655</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UDP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JGroups multicast</p></td>
</tr>
</tbody>
</table>
<h4 id="cross_site_replication" class="discrete">Cross-site replication</h4>
<div class="paragraph">
<p>Infinispan uses the following ports for the JGroups RELAY2 protocol:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>7900</code></dt>
<dd>
<p>For Infinispan clusters running on Kubernetes.</p>
</dd>
<dt class="hdlist1"><code>7800</code></dt>
<dd>
<p>If using UDP for traffic between nodes and TCP for traffic between clusters.</p>
</dd>
<dt class="hdlist1"><code>7801</code></dt>
<dd>
<p>If using TCP for traffic between nodes and TCP for traffic between clusters.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-12-22 02:46:41 -0500
</div>
</div>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid currentColor;opacity:.35;padding:0 .5em 0 0}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains('stemblock')) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8601422-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>