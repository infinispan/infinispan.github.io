<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="generator" content="Asciidoctor 1.5.4"> <meta name="author" content="Manik Surtani, Mircea Markus, Galder Zamarreño, Pete Muir, and others from the Infinispan community"> <title>Upgrading Infinispan</title> <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"> <style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css"> <style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style> </head> <body class="book toc2 toc-left"> <div id="header"> <h1>Upgrading Infinispan</h1> <div class="details"> <span id="author" class="author">Manik Surtani, Mircea Markus, Galder Zamarreño, Pete Muir, and others from the Infinispan community</span><br> </div> <div id="toc" class="toc2"> <div id="toctitle">Table of Contents</div> <ul class="sectlevel1"> <li><a href="#_upgrading_from_8_x_to_8_1">1. Upgrading from 8.x to 8.1</a> <ul class="sectlevel2"> <li><a href="#_packaging_changes">1.1. Packaging changes</a> <ul class="sectlevel3"> <li><a href="#_cdi_module_split">1.1.1. CDI module split</a></li> <li><a href="#_spring_module_split">1.1.2. Spring module split</a></li> </ul> </li> <li><a href="#_spring_3_support_is_deprecated">1.2. Spring 3 support is deprecated</a></li> </ul> </li> <li><a href="#_upgrading_from_7_x_to_8_0">2. Upgrading from 7.x to 8.0</a> <ul class="sectlevel2"> <li><a href="#_configuration_changes">2.1. Configuration changes</a> <ul class="sectlevel3"> <li><a href="#_removal_of_async_marshalling">2.1.1. Removal of Async Marshalling</a></li> <li><a href="#_reenabling_of_isolation_level_configurations_in_server">2.1.2. Reenabling of isolation level configurations in server</a></li> <li><a href="#_subsystem_renaming_in_server">2.1.3. Subsystem renaming in server</a></li> <li><a href="#_server_domain_mode">2.1.4. Server domain mode</a></li> </ul> </li> </ul> </li> <li><a href="#_upgrading_from_6_0_to_7_0">3. Upgrading from 6.0 to 7.0</a> <ul class="sectlevel2"> <li><a href="#_api_changes">3.1. API Changes</a> <ul class="sectlevel3"> <li><a href="#_cache_loader">3.1.1. Cache Loader</a></li> <li><a href="#_cache_writer">3.1.2. Cache Writer</a></li> <li><a href="#_filters">3.1.3. Filters</a></li> </ul> </li> </ul> </li> <li><a href="#_upgrading_from_5_3_to_6_0">4. Upgrading from 5.3 to 6.0</a> <ul class="sectlevel2"> <li><a href="#_declarative_configuration">4.1. Declarative configuration</a></li> <li><a href="#_deprecated_api_removal">4.2. Deprecated API removal</a></li> </ul> </li> <li><a href="#_upgrading_from_5_2_to_5_3">5. Upgrading from 5.2 to 5.3</a> <ul class="sectlevel2"> <li><a href="#_declarative_configuration_2">5.1. Declarative configuration</a></li> </ul> </li> <li><a href="#_upgrading_from_5_1_to_5_2">6. Upgrading from 5.1 to 5.2</a> <ul class="sectlevel2"> <li><a href="#_declarative_configuration_3">6.1. Declarative configuration</a></li> <li><a href="#_transaction">6.2. Transaction</a></li> <li><a href="#_cache_loader_and_store_configuration">6.3. Cache Loader and Store configuration</a></li> <li><a href="#_virtual_nodes_and_segments">6.4. Virtual Nodes and Segments</a></li> </ul> </li> <li><a href="#_upgrading_from_5_0_to_5_1">7. Upgrading from 5.0 to 5.1</a> <ul class="sectlevel2"> <li><a href="#_api">7.1. API</a></li> <li><a href="#_eviction_and_expiration">7.2. Eviction and Expiration</a></li> <li><a href="#_transactions">7.3. Transactions</a></li> <li><a href="#_state_transfer">7.4. State transfer</a></li> <li><a href="#_configuration">7.5. Configuration</a></li> <li><a href="#_flags_and_classloaders">7.6. Flags and ClassLoaders</a></li> <li><a href="#_jgroups_bind_address">7.7. JGroups Bind Address</a></li> </ul> </li> </ul> </div> </div> <div id="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>This guide walks you through the process of upgrading Infinispan.</p> </div> </div> </div> <div class="sect1"> <h2 id="_upgrading_from_8_x_to_8_1"><a class="anchor" href="#_upgrading_from_8_x_to_8_1"></a>1. Upgrading from 8.x to 8.1</h2> <div class="sectionbody"> <div class="sect2"> <h3 id="_packaging_changes"><a class="anchor" href="#_packaging_changes"></a>1.1. Packaging changes</h3> <div class="sect3"> <h4 id="_cdi_module_split"><a class="anchor" href="#_cdi_module_split"></a>1.1.1. CDI module split</h4> <div class="paragraph"> <p>CDI module (GroupId:ArtifactId <code>org.infinispan:infinispan-cdi</code>) has been split into <code>org.infinispan:infinispan-cdi-embedded</code> and <code>org.infinispan:infinispan-cdi-remote</code>. Please make sure that you use proper artifact.</p> </div> </div> <div class="sect3"> <h4 id="_spring_module_split"><a class="anchor" href="#_spring_module_split"></a>1.1.2. Spring module split</h4> <div class="paragraph"> <p>Spring module (GroupId:ArtifactId <code>org.infinispan:infinispan-spring4</code>) has been split into <code>org.infinispan:infinispan-spring4-embedded</code> and <code>org.infinispan:infinispan-spring4-remote</code>. Please make sure that you use proper artifact.</p> </div> </div> </div> <div class="sect2"> <h3 id="_spring_3_support_is_deprecated"><a class="anchor" href="#_spring_3_support_is_deprecated"></a>1.2. Spring 3 support is deprecated</h3> <div class="paragraph"> <p>Spring 3 support (GroupId:ArtifactId <code>org.infinispan:infinispan-spring</code>) is deprecated. Please consider migrating into Spring 4 support.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_upgrading_from_7_x_to_8_0"><a class="anchor" href="#_upgrading_from_7_x_to_8_0"></a>2. Upgrading from 7.x to 8.0</h2> <div class="sectionbody"> <div class="sect2"> <h3 id="_configuration_changes"><a class="anchor" href="#_configuration_changes"></a>2.1. Configuration changes</h3> <div class="sect3"> <h4 id="_removal_of_async_marshalling"><a class="anchor" href="#_removal_of_async_marshalling"></a>2.1.1. Removal of Async Marshalling</h4> <div class="paragraph"> <p>Async marshalling has been entirely dropped since it was never reliable enough. The "async-marshalling" attribute has been removed from the 8.0 XML schema and will be ignored when parsing 7.x configuration files. The programmatic configuration methods related to asyncMarshalling/syncMarshalling are now deprecated and have no effect aside from producing a WARN message in the logs.</p> </div> </div> <div class="sect3"> <h4 id="_reenabling_of_isolation_level_configurations_in_server"><a class="anchor" href="#_reenabling_of_isolation_level_configurations_in_server"></a>2.1.2. Reenabling of isolation level configurations in server</h4> <div class="paragraph"> <p>Because of the inability to configure write skew in the server, the isolation level attribute was ignored and defaulted to READ_COMMITTED. Now, when enabling REPEATABLE_READ together with optimistic locking, write skew is enabled by default in local and synchronous configurations.</p> </div> </div> <div class="sect3"> <h4 id="_subsystem_renaming_in_server"><a class="anchor" href="#_subsystem_renaming_in_server"></a>2.1.3. Subsystem renaming in server</h4> <div class="paragraph"> <p>In order to avoid conflict and confusion with the similar subsystems in WildFly, we have renamed the following subsystems in server: * infinispan &#8594; datagrid-infinispan * jgroups &#8594; datagrid-jgroups * endpoint &#8594; datagrid-infinispan-endpoint</p> </div> </div> <div class="sect3"> <h4 id="_server_domain_mode"><a class="anchor" href="#_server_domain_mode"></a>2.1.4. Server domain mode</h4> <div class="paragraph"> <p>We no longer support the use of standalone mode for running clusters of servers. Domain mode (bin/domain.sh) should be used instead.</p> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_upgrading_from_6_0_to_7_0"><a class="anchor" href="#_upgrading_from_6_0_to_7_0"></a>3. Upgrading from 6.0 to 7.0</h2> <div class="sectionbody"> <div class="sect2"> <h3 id="_api_changes"><a class="anchor" href="#_api_changes"></a>3.1. API Changes</h3> <div class="sect3"> <h4 id="_cache_loader"><a class="anchor" href="#_cache_loader"></a>3.1.1. Cache Loader</h4> <div class="paragraph"> <p>To be more inline with JCache and java.util.collections interfaces we have changed the first argument type for the CacheLoader.load &amp; CacheLoader.contains methods to be Object from type K.</p> </div> </div> <div class="sect3"> <h4 id="_cache_writer"><a class="anchor" href="#_cache_writer"></a>3.1.2. Cache Writer</h4> <div class="paragraph"> <p>To be more inline with JCache and java.util.collections interfaces we have changed the first argument type for the CacheWriter.delete method to be Object from type K.</p> </div> </div> <div class="sect3"> <h4 id="_filters"><a class="anchor" href="#_filters"></a>3.1.3. Filters</h4> <div class="paragraph"> <p>Over time Infinispan added 2 interfaces with identical names and almost identical methods. The org.infinispan.notifications.KeyFilter and org.infinispan.persistence.spi.AdvancedCacheLoader$KeyFilter interfaces.</p> </div> <div class="paragraph"> <p>Both of these interfaces are used for the sole purpose of filtering an entry by it&#8217;s given key. Infinispan 7.0 has also introduced the KeyValueFilter which is similar to both but also can filter on the entries value and/or metadata.</p> </div> <div class="paragraph"> <p>As such all of these classes have been moved into a new package org.infinispan.filter and all of their related helper classes.</p> </div> <div class="paragraph"> <p>The new org.infinispan.filter.KeyFilter interface has replaced both of the previous interfaces and all previous references use the new interface.</p> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_upgrading_from_5_3_to_6_0"><a class="anchor" href="#_upgrading_from_5_3_to_6_0"></a>4. Upgrading from 5.3 to 6.0</h2> <div class="sectionbody"> <div class="sect2"> <h3 id="_declarative_configuration"><a class="anchor" href="#_declarative_configuration"></a>4.1. Declarative configuration</h3> <div class="paragraph"> <p>In order to use all of the latest features, make sure you change the namespace declaration at the top of your XML configuration files as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;infinispan</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:6.0 http://www.infinispan.org/schemas/infinispan-config-6.0.xsd</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:6.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   ...
<span class="tag">&lt;/infinispan&gt;</span></code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_deprecated_api_removal"><a class="anchor" href="#_deprecated_api_removal"></a>4.2. Deprecated API removal</h3> <div class="ulist"> <ul> <li> <p>Class <code>org.infinispan.persistence.remote.wrapperEntryWrapper</code>.</p> </li> <li> <p>Method <code>ObjectOutput startObjectOutput(OutputStream os, boolean isReentrant)</code> from class <code>org.infinispan.commons.marshall.StreamingMarshaller</code>.</p> </li> <li> <p>Method <code>CacheEntry getCacheEntry(Object key, EnumSet&lt;Flag&gt; explicitFlags, ClassLoader explicitClassLoader)</code> from class <code>org.infinispan.AdvancedCache</code>. Please use instead: <code>AdvanceCache.withFlags(Flag&#8230;&#8203; flags).with(ClassLoader classLoader).getCacheEntry(K key)</code>.</p> </li> <li> <p>Method <code>AtomicMap&lt;K, V&gt; getAtomicMap(Cache&lt;MK, ?&gt; cache, MK key, FlagContainer flagContainer)</code> from class <code>org.infinispan.atomic.AtomicMapLookup</code>. Please use instead <code>AtomicMapLookup.getAtomicMap(cache.getAdvancedCache().withFlags(Flag&#8230;&#8203; flags), MK key)</code>.</p> </li> <li> <p>Package <code>org.infinispan.config</code> (and all methods involving the old configuration classes). All methods removed has an overloaded method which receives the new configuration classes as parameters. Please refer to <a href="#_configuration">Configuration</a> for more information about the new configuration classes.</p> </li> </ul> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> This only affects the programmatic configuration. </td> </tr> </table> </div> <div class="ulist"> <ul> <li> <p>Class <code>org.infinispan.context.FlagContainer</code>.</p> </li> <li> <p>Method <code>boolean isLocal(Object key)</code> from class <code>org.infinispan.distribution.DistributionManager</code>. Please use instead <code>DistributionManager.getLocality(Object key)</code>.</p> </li> <li> <p>JMX operation <code>void setStatisticsEnabled(boolean enabled)</code> from class <code>org.infinispan.interceptors.TxInterceptor</code> Please use instead the <code>statisticsEnabled</code> attribute.</p> </li> <li> <p>Method <code>boolean delete(boolean synchronous)</code> from class <code>org.infinispan.io.GridFile</code>. Please use instead <code>GridFile.delete()</code>.</p> </li> <li> <p>JMX attribute <code>long getLocallyInterruptedTransactions()</code> from class <code>org.infinispan.util.concurrent.locks.DeadlockDetectingLockManager</code>.</p> </li> </ul> </div> </div> </div> </div> <div class="sect1"> <h2 id="_upgrading_from_5_2_to_5_3"><a class="anchor" href="#_upgrading_from_5_2_to_5_3"></a>5. Upgrading from 5.2 to 5.3</h2> <div class="sectionbody"> <div class="sect2"> <h3 id="_declarative_configuration_2"><a class="anchor" href="#_declarative_configuration_2"></a>5.1. Declarative configuration</h3> <div class="paragraph"> <p>In order to use all of the latest features, make sure you change the namespace declaration at the top of your XML configuration files as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;infinispan</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:5.2 http://www.infinispan.org/schemas/infinispan-config-5.2.xsd</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:5.3</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   ...
<span class="tag">&lt;/infinispan&gt;</span></code></pre> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_upgrading_from_5_1_to_5_2"><a class="anchor" href="#_upgrading_from_5_1_to_5_2"></a>6. Upgrading from 5.1 to 5.2</h2> <div class="sectionbody"> <div class="sect2"> <h3 id="_declarative_configuration_3"><a class="anchor" href="#_declarative_configuration_3"></a>6.1. Declarative configuration</h3> <div class="paragraph"> <p>In order to use all of the latest features, make sure you change the namespace declaration at the top of your XML configuration files as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;infinispan</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:5.2 http://www.infinispan.org/schemas/infinispan-config-5.2.xsd</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:5.2</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   ...
<span class="tag">&lt;/infinispan&gt;</span></code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_transaction"><a class="anchor" href="#_transaction"></a>6.2. Transaction</h3> <div class="paragraph"> <p>The default transaction enlistment model has changed ( <a href="https://issues.jboss.org/browse/ISPN-1284">ISPN-1284</a> ) from <a href="http://docs.oracle.com/javase/6/docs/api/javax/transaction/xa/XAResource.html"><code>XAResource</code></a> to <a href="http://docs.oracle.com/javaee/6/api/javax/transaction/Synchronization.html"><code>Synchronization</code></a>. Also now, if the <code>XAResource</code> enlistment is used, then <a href="../user_guide/user_guide.html#_transaction_recovery">recovery</a> is enabled by default.</p> </div> <div class="paragraph"> <p>In practical terms, if you were using the default values, this should not cause any backward compatibility issues but an increase in performance of about 5-7%. However in order to use the old configuration defaults, you need to configure the following:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;transaction</span> <span class="attribute-name">useSynchronization</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;recovery</span> <span class="attribute-name">enabled</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/transaction&gt;</span></code></pre> </div> </div> <div class="paragraph"> <p>or the programmatic configuration equivalent:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java">ConfigurationBuilder builder = <span class="keyword">new</span> ConfigurationBuilder();
builder.transaction().useSynchronization(<span class="predefined-constant">false</span>).recovery().enabled(<span class="predefined-constant">false</span>)</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_cache_loader_and_store_configuration"><a class="anchor" href="#_cache_loader_and_store_configuration"></a>6.3. Cache Loader and Store configuration</h3> <div class="paragraph"> <p>Cache Loader and Store configuration has changed greatly in Infinispan 5.2. Please refer to the <a href="../user_guide/user_guide.html#_cache_loaders_and_stores">Cache Loaders and Stores</a> documentation.</p> </div> </div> <div class="sect2"> <h3 id="_virtual_nodes_and_segments"><a class="anchor" href="#_virtual_nodes_and_segments"></a>6.4. Virtual Nodes and Segments</h3> <div class="paragraph"> <p>The concept of Virtual Nodes doesn&#8217;t exist anymore in Infinispan 5.2 and has been replaced by Segments. Please refer to the <a href="../user_guide/user_guide.html#_clustering_modes">Clustering modes</a> documentation for details.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_upgrading_from_5_0_to_5_1"><a class="anchor" href="#_upgrading_from_5_0_to_5_1"></a>7. Upgrading from 5.0 to 5.1</h2> <div class="sectionbody"> <div class="sect2"> <h3 id="_api"><a class="anchor" href="#_api"></a>7.1. API</h3> <div class="paragraph"> <p>The cache and cache manager hierarchies have changed slightly in 5.1 with the introduction of <a href="https://docs.jboss.org/infinispan/5.1/apidocs/org/infinispan/api/BasicCache.html"><code>BasicCache</code></a> and <a href="https://docs.jboss.org/infinispan/5.1/apidocs/org/infinispan/api/BasicCacheContainer.html"><code>BasicCacheContainer</code></a> , which are parent classes of existing <a href="https://docs.jboss.org/infinispan/5.1/apidocs/org/infinispan/Cache.html"><code>Cache</code></a> and <a href="https://docs.jboss.org/infinispan/5.1/apidocs/org/infinispan/manager/CacheContainer.html"><code>CacheContainer</code></a> classes respectively. What&#8217;s important is that Hot Rod clients must now code against <code>BasicCache</code> and <code>BasicCacheContainer</code> rather than <code>Cache</code> and <code>CacheContainer</code>. So previous code that was written like this will no longer compile.</p> </div> <div class="listingblock"> <div class="title">WontCompile.java</div> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.infinispan.Cache</span>;
<span class="keyword">import</span> <span class="include">org.infinispan.manager.CacheContainer</span>;
<span class="keyword">import</span> <span class="include">org.infinispan.client.hotrod.RemoteCacheManager</span>;
...
CacheContainer cacheContainer = <span class="keyword">new</span> RemoteCacheManager();
Cache cache = cacheContainer.getCache();</code></pre> </div> </div> <div class="paragraph"> <p>Instead, if Hot Rod clients want to continue using interfaces higher up the hierarchy from the remote cache/container classes, they&#8217;ll have to write:</p> </div> <div class="listingblock"> <div class="title">Correct.java</div> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.infinispan.BasicCache</span>;
<span class="keyword">import</span> <span class="include">org.infinispan.manager.BasicCacheContainer</span>;
<span class="keyword">import</span> <span class="include">org.infinispan.client.hotrod.RemoteCacheManager</span>;
...
BasicCacheContainer cacheContainer = <span class="keyword">new</span> RemoteCacheManager();
BasicCache cache = cacheContainer.getCache();</code></pre> </div> </div> <div class="paragraph"> <p>However, previous code that interacted against the <code>RemoteCache</code> and <code>RemoteCacheManager</code> will work as it used to:</p> </div> <div class="listingblock"> <div class="title">AlsoCorrect.java</div> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.infinispan.client.hotrod.RemoteCache</span>;
<span class="keyword">import</span> <span class="include">org.infinispan.client.hotrod.RemoteCacheManager</span>;
...
RemoteCacheManager cacheContainer = <span class="keyword">new</span> RemoteCacheManager();
RemoteCache cache = cacheContainer.getCache();</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_eviction_and_expiration"><a class="anchor" href="#_eviction_and_expiration"></a>7.2. Eviction and Expiration</h3> <div class="ulist"> <ul> <li> <p>The eviction XML element no longer defines the <code>wakeUpInterval</code> attribute. This is now configured via the <code>expiration</code> element:</p> </li> </ul> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;expiration</span> <span class="attribute-name">wakeUpInterval</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">60000</span><span class="delimiter">&quot;</span></span><span class="attribute-name">...</span> <span class="tag">/&gt;</span></code></pre> </div> </div> <div class="paragraph"> <p>Eviction&#8217;s <code>maxEntries</code> is used as guide for the entire cache, but eviction happens on a per cache segment, so when the segment is full, the segment is evicted. That&#8217;s why <code>maxEntries</code> is a theoretical limit but in practical terms, it&#8217;ll be a bit less than that. This is done for performance reasons.</p> </div> </div> <div class="sect2"> <h3 id="_transactions"><a class="anchor" href="#_transactions"></a>7.3. Transactions</h3> <div class="ulist"> <ul> <li> <p>A cache marked as <code>TRANSACTIONAL</code> cannot be accessed outside of a transaction, and a <code>NON_TRANSACTIONAL</code> cache cannot be accessed within a transaction. In 5.0, a transactional cache would support non-transactional calls as well. This change was done to be in-line with expectations set out in <a href="https://github.com/jsr107">JSR-107</a> as well as to provide more consistent behavior.</p> </li> <li> <p>In 5.0, commit and rollback phases were asynchronous by default. Starting with 5.1, these are now synchronous by default, to provide the guarantees required by a single lock-owner model.</p> </li> </ul> </div> </div> <div class="sect2"> <h3 id="_state_transfer"><a class="anchor" href="#_state_transfer"></a>7.4. State transfer</h3> <div class="paragraph"> <p>One of the big changes we made in 5.1 was to use the same push-based state transfer we introduced in 5.0 both for rehashing in distributed mode and for state retrieval in replicated mode. We even borrow the consistent hash concept in replicated mode to transfer state from all previous cache members at once in order to speed up transfer.</p> </div> <div class="paragraph"> <p>As a consequence we&#8217;ve unified the state transfer configuration as well, there is now a <code>stateTransfer</code> element containing a simplified state transfer configuration. The corresponding attributes in the <code>stateRetrieval</code> and <code>hash</code> elements have been deprecated, as have been some attributes that are no longer used.</p> </div> </div> <div class="sect2"> <h3 id="_configuration"><a class="anchor" href="#_configuration"></a>7.5. Configuration</h3> <div class="paragraph"> <p>If you use XML to configure Infinispan, you shouldn&#8217;t notice any change, except a much faster startup, courtesy of the <a href="http://en.wikipedia.org/wiki/StAX">StAX</a> based parser. However, if you use programmatic configuration, read on for the important differences.</p> </div> <div class="paragraph"> <p>Configuration is now packaged in <code>org.infinispan.configuration</code>, and you must use a fluent, builder style:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Configuration</span> c1 = <span class="keyword">new</span> ConfigurationBuilder()
   <span class="comment">// Adjust any configuration defaults you want</span>
   .clustering()
      .l1()
         .disable()
      .mode(DIST_SYNC)
      .hash()
         .numOwners(<span class="integer">5</span>)
   .build();</code></pre> </div> </div> <div class="ulist"> <ul> <li> <p>The old javabean style configuration is now deprecated and will be removed in a later version.</p> </li> <li> <p>Configuration properties which can be safely changed at runtime are mutable, and all others are immutable.</p> </li> <li> <p>To copy a configuration, use the <code>read()</code> method on the builder, for example:</p> </li> </ul> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Configuration</span> c2 = <span class="keyword">new</span> ConfigurationBuilder()
   <span class="comment">// Read in C1 to provide defaults</span>
   .read(c1)
   .clustering()
      .l1()
         .enable()
   <span class="comment">// This cache is DIST_SYNC, will have 5 owners, with L1 cache enabled</span>
   .build();</code></pre> </div> </div> <div class="paragraph"> <p>This completely replaces the old system of defining a set of overrides on bean properties. Note that this means the behaviour of Infinispan configuration is somewhat different when used programmatically. Whilst before, you could define a default configuration, and any overrides would be applied on top of <em>your</em> defaults when defined, now you must explicitly read in your defaults to the builder. This allows for much greater flexibility in your code (you can have a as many "default" configurations as you want), and makes your code more explicit and type safe (finding references works).</p> </div> <div class="paragraph"> <p>The schema is unchanged from before. Infinispan 4.0 configurations are currently not being parsed. To upgrade, just change the schema definition from:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;infinispan</span>
     <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
     <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:4.1 http://www.infinispan.org/schemas/infinispan-config-4.1.xsd</span><span class="delimiter">&quot;</span></span>
     <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:4.1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span></code></pre> </div> </div> <div class="paragraph"> <p>to</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;infinispan</span>
     <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
     <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:5.1 http://www.infinispan.org/schemas/infinispan-config-5.1.xsd</span><span class="delimiter">&quot;</span></span>
     <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:5.1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span></code></pre> </div> </div> <div class="paragraph"> <p>The schema documentation has changed format, as it is now produced using the standard tool <code>xsddoc</code>. This should be a significant improvement, as better navigation is offered. Some elements and attributes are missing docs right now, we are working on adding this. As an added benefit, your IDE should now show documentation when an xsd referenced (as above)</p> </div> <div class="paragraph"> <p>We are in the process of adding in support for this configuration style for modules (such as cache stores). In the meantime, please use the old configuration or XML if you require support for cache store module configuration.</p> </div> </div> <div class="sect2"> <h3 id="_flags_and_classloaders"><a class="anchor" href="#_flags_and_classloaders"></a>7.6. Flags and ClassLoaders</h3> <div class="paragraph"> <p>The <code>Flags</code> and <code>ClassLoader</code> API has changed. In the past, the following would work:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"> cache.withFlags(f1, f2); cache.withClassLoader(cl); cache.put(k, v);</code></pre> </div> </div> <div class="paragraph"> <p>In 5.1.0, these <code>withX()</code> methods return a new instance and not the cache itself, so thread locals are avoided and the code above will not work. If used in a fluent manner however, things still work:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java">cache.withFlags(f1, f2).withClassLoader(cl).put(k, v);</code></pre> </div> </div> <div class="paragraph"> <p>The above pattern has always been the intention of this API anyway.</p> </div> </div> <div class="sect2"> <h3 id="_jgroups_bind_address"><a class="anchor" href="#_jgroups_bind_address"></a>7.7. JGroups Bind Address</h3> <div class="paragraph"> <p>Since upgrading to JGroups 3.x, <code>-Dbind.address</code> is ignored. This should be replaced with <code>-Djgroups.bind_addr</code>.</p> </div> </div> </div> </div> </div> <div id="footer"> <div id="footer-text"> Last updated 2016-04-12 17:44:13 CEST </div> </div> </body> </html>