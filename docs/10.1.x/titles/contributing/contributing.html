<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="generator" content="Asciidoctor 1.5.8"> <title>Contributing to Infinispan</title> <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"> <style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock pre.nowrap,.literalblock pre.nowrap pre,.listingblock pre.nowrap,.listingblock pre.nowrap pre{white-space:pre;word-wrap:normal}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #dddddf}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> <style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style> <link rel="canonical" href="http://infinispan.org/docs/stable/contributing/contributing.html"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.1/themes/default/style.min.css"> <link rel="stylesheet" href="../../css/css.css"> <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.1/jstree.min.js"></script> <script src="../../js/js.js"></script> </head> <body class="book toc2 toc-left"> <div id="header"> <h1>Contributing to Infinispan</h1> <div id="toc" class="toc2"> <div id="toctitle">Table of Contents</div> <ul class="sectlevel1"> <li><a href="#contributing">1. The Basics</a> <ul class="sectlevel2"> <li><a href="#pre_requisites">1.1. Pre-requisites</a></li> <li><a href="#java_compatibility">1.2. Java compatibility</a></li> <li><a href="#issue_management">1.3. Issue Management</a> <ul class="sectlevel3"> <li><a href="#reporting_issues">1.3.1. Reporting Issues</a></li> <li><a href="#versioning_guidelines">1.3.2. Versioning Guidelines</a></li> </ul> </li> <li><a href="#version_control">1.4. Version control</a> <ul class="sectlevel3"> <li><a href="#setting_up_your_ide">1.4.1. Setting up your IDE</a> <ul class="sectlevel4"> <li><a href="#eclipse">Eclipse</a></li> <li><a href="#intellij_idea">IntelliJ IDEA</a> <ul class="sectlevel5"> <li><a href="#importing">Importing</a></li> <li><a href="#compiler_settings">Compiler settings</a></li> <li><a href="#scala_plugin">Scala Plugin</a></li> <li><a href="#code_style">Code Style</a></li> </ul> </li> </ul> </li> </ul> </li> <li><a href="#builds">1.5. Builds</a> <ul class="sectlevel3"> <li><a href="#continuous_integration">1.5.1. Continuous Integration</a></li> </ul> </li> <li><a href="#testing">1.6. Testing</a></li> <li><a href="#communicating_with_other_infinispan_contributors">1.7. Communicating with other Infinispan contributors</a></li> <li><a href="#style_requirements">1.8. Style Requirements</a> <ul class="sectlevel3"> <li><a href="#spelling">1.8.1. Spelling</a></li> <li><a href="#check_in_comments">1.8.2. Check-in comments</a></li> </ul> </li> <li><a href="#logging">1.9. Logging</a></li> </ul> </li> <li><a href="#source_control">2. Source Control</a> <ul class="sectlevel2"> <li><a href="#prerequisites">2.1. Prerequisites</a></li> <li><a href="#repositories">2.2. Repositories</a></li> <li><a href="#roles">2.3. Roles</a> <ul class="sectlevel3"> <li><a href="#contributor">2.3.1. Contributor</a> <ul class="sectlevel4"> <li><a href="#creating_a_pull_request_on_github">Creating a pull request on GitHub</a> <ul class="sectlevel5"> <li><a href="#a_worked_example">A worked example</a></li> </ul> </li> <li><a href="#multi_step_coordination_between_developers_using_forked_repositories">Multi-step coordination between developers using forked repositories</a> <ul class="sectlevel5"> <li><a href="#a_worked_example_2">A worked example</a></li> </ul> </li> </ul> </li> <li><a href="#project_admin">2.3.2. Project Admin</a> <ul class="sectlevel4"> <li><a href="#handling_pull_requests">Handling pull requests</a> <ul class="sectlevel5"> <li><a href="#possible_trouble_handling_pull_requests">Possible trouble handling pull requests</a></li> </ul> </li> <li><a href="#cutting_releases">Cutting releases</a></li> </ul> </li> <li><a href="#release_branches">2.3.3. Release branches</a></li> <li><a href="#topic_branches">2.3.4. Topic branches</a> <ul class="sectlevel4"> <li><a href="#topic_branches_affecting_more_than_one_release_branch">Topic Branches Affecting More Than One Release Branch</a></li> </ul> </li> <li><a href="#comments">2.3.5. Comments</a></li> <li><a href="#commits">2.3.6. Commits</a></li> </ul> </li> <li><a href="#keeping_your_repo_in_sync_with_upstream">2.4. Keeping your repo in sync with upstream</a> <ul class="sectlevel3"> <li><a href="#if_you_have_cloned_upstream">2.4.1. If you have cloned upstream</a> <ul class="sectlevel4"> <li><a href="#updating_topic_branches">Updating topic branches</a></li> </ul> </li> <li><a href="#link_ifyouhaveforkedupstream">2.4.2. If you have forked upstream</a> <ul class="sectlevel4"> <li><a href="#updating_topic_branches_2">Updating topic branches</a></li> </ul> </li> </ul> </li> <li><a href="#tips_on_enhancing_git">2.5. Tips on enhancing git</a> <ul class="sectlevel3"> <li><a href="#completions">2.5.1. Completions</a></li> <li><a href="#terminal_colors">2.5.2. Terminal colors</a></li> <li><a href="#aliases">2.5.3. Aliases</a></li> <li><a href="#visual_history">2.5.4. Visual History</a></li> <li><a href="#visual_diff_and_merge_tools">2.5.5. Visual diff and merge tools</a></li> <li><a href="#choosing_an_editor">2.5.6. Choosing an Editor</a></li> <li><a href="#shell_prompt">2.5.7. Shell prompt</a></li> </ul> </li> </ul> </li> <li><a href="#building_infinispan">3. Building Infinispan</a> <ul class="sectlevel2"> <li><a href="#requirements">3.1. Requirements</a></li> <li><a href="#maven">3.2. Maven</a> <ul class="sectlevel3"> <li><a href="#quick_command_reference">3.2.1. Quick command reference</a></li> <li><a href="#publishing_releases_to_maven">3.2.2. Publishing releases to Maven</a> <ul class="sectlevel4"> <li><a href="#publishing_snapshots">Publishing snapshots</a></li> <li><a href="#publishing_releases">Publishing releases</a></li> </ul> </li> <li><a href="#the_maven_archetypes">3.2.3. The Maven Archetypes</a> <ul class="sectlevel4"> <li><a href="#starting_a_new_project">Starting a new project</a> <ul class="sectlevel5"> <li><a href="#exploring_your_new_project">Exploring your new project</a></li> <li><a href="#on_the_command_line">On the command line&#8230;&#8203;</a></li> </ul> </li> <li><a href="#writing_a_test_case_for_infinispan">Writing a test case for Infinispan</a> <ul class="sectlevel5"> <li><a href="#on_the_command_line_2">On the command line&#8230;&#8203;</a></li> <li><a href="#available_profiles">Available profiles</a></li> </ul> </li> <li><a href="#contributing_tests_back_to_infinispan">Contributing tests back to Infinispan</a></li> <li><a href="#checking_coding_style">Checking coding style</a></li> <li><a href="#versions">Versions</a></li> <li><a href="#source_code">Source Code</a></li> </ul> </li> </ul> </li> </ul> </li> <li><a href="#api_commons_and_core">4. API, Commons and Core</a> <ul class="sectlevel2"> <li><a href="#api">4.1. API</a></li> <li><a href="#commons">4.2. Commons</a></li> <li><a href="#core">4.3. Core</a></li> </ul> </li> <li><a href="#running_and_writing_tests">5. Running and Writing Tests</a> <ul class="sectlevel2"> <li><a href="#running_the_tests">5.1. Running the tests</a> <ul class="sectlevel3"> <li><a href="#specifying_which_tests_to_run">5.1.1. Specifying which tests to run</a></li> <li><a href="#skipping_the_test_run">5.1.2. Skipping the test run</a></li> <li><a href="#debugging_thread_leaks">5.1.3. Debugging thread leaks</a></li> <li><a href="#running_tests_using_parameters">5.1.4. Running tests using <code>@Parameters</code></a></li> <li><a href="#enabling_trace_in_test_logs">5.1.5. Enabling TRACE in test logs</a></li> <li><a href="#running_tests_with_jdk_8">5.1.6. Running tests with JDK 8</a></li> <li><a href="#enabling_code_coverage_generation">5.1.7. Enabling code coverage generation</a></li> </ul> </li> <li><a href="#test_groups">5.2. Test groups</a> <ul class="sectlevel3"> <li><a href="#which_group_should_i_use">5.2.1. Which group should I use?</a></li> </ul> </li> <li><a href="#test_permutations">5.3. Test permutations</a> <ul class="sectlevel3"> <li><a href="#running_permutations_manually_or_in_an_ide">5.3.1. Running permutations manually or in an IDE</a></li> </ul> </li> <li><a href="#the_parallel_test_suite">5.4. The Parallel Test Suite</a> <ul class="sectlevel3"> <li><a href="#tips_for_writing_and_debugging_parallel_tests">5.4.1. Tips for writing and debugging parallel tests</a></li> </ul> </li> </ul> </li> <li><a href="#helping_others_out">6. Helping Others Out</a></li> <li><a href="#adding_configuration">7. Adding Configuration</a> <ul class="sectlevel2"> <li><a href="#adding_a_property">7.1. Adding a property</a></li> <li><a href="#adding_a_group">7.2. Adding a group</a></li> <li><a href="#dont_forget_to_update_the_xsd_and_xsd_test">7.3. Don&#8217;t forget to update the XSD and XSD test</a></li> <li><a href="#bridging_to_the_old_configuration">7.4. Bridging to the old configuration</a></li> </ul> </li> <li><a href="#documentation_guidelines">8. Documentation Guidelines</a> <ul class="sectlevel2"> <li><a href="#documentation_guidelines_source_files">8.1. Working with Documentation Source Files</a></li> <li><a href="#documentation_guidelines_style_guide">8.2. Style Guide</a></li> <li><a href="#documentation_guidelines_format_reference">8.3. AsciiDoc Format Reference</a></li> <li><a href="#documentation_guidelines_general">8.4. General Guidelines</a></li> <li><a href="#documentation_guidelines_section_ids">8.5. Section IDs</a></li> <li><a href="#documentation_guidelines_xrefs">8.6. Cross References</a></li> <li><a href="#documentation_guidelines_images">8.7. Diagrams, Screenshots, and Other Media</a> <ul class="sectlevel3"> <li><a href="#documentation_guidelines_images_include">8.7.1. Including Images</a></li> </ul> </li> <li><a href="#documentation_guidelines_code_blocks">8.8. Code Samples</a></li> </ul> </li> </ul> </div> </div> <div id="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Feel like contributing to Infinispan? This guide will help you set up your environment, walk you through best practices, and help you debug, improve and add features to Infinispan.</p> </div> </div> </div> <div class="sect1"> <h2 id="contributing"><a class="anchor" href="#contributing"></a>1. The Basics</h2> <div class="sectionbody"> <div class="paragraph"> <p>In this chapter we quickly walk through the basics on contributing; future chapters go into more depth.</p> </div> <div class="sect2"> <h3 id="pre_requisites"><a class="anchor" href="#pre_requisites"></a>1.1. Pre-requisites</h3> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Java 11</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Infinispan is baselined on Java 8 but needs to be built with Java 11 (we build with OpenJDK)</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Maven 3.5</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The Infinispan build uses Maven, and you should be using at least Maven 3.5</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Git</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The Infinispan source code is stored in Git.</p></td> </tr> </tbody> </table> </div> <div class="sect2"> <h3 id="java_compatibility"><a class="anchor" href="#java_compatibility"></a>1.2. Java compatibility</h3> <div class="paragraph"> <p>Infinispan can run with Java 8 or greater. However it <strong>must</strong> be compiled at least with Java 11.</p> </div> </div> <div class="sect2"> <h3 id="issue_management"><a class="anchor" href="#issue_management"></a>1.3. Issue Management</h3> <div class="paragraph"> <p>Infinispan uses JIRA for issue management, hosted on <a href="http://issues.jboss.org/browse/ISPN">issues.jboss.org</a>. You can log in using your jboss.org username and password.</p> </div> <div class="sect3"> <h4 id="reporting_issues"><a class="anchor" href="#reporting_issues"></a>1.3.1. Reporting Issues</h4> <div class="paragraph"> <p>If you need to create a new issue then follow these steps.</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Choose between</p> <div class="ulist"> <ul> <li> <p><em>Feature Request</em> if you want to request an enhancement or new feature for Infinispan</p> </li> <li> <p><em>Bug</em> if you have discovered an issue</p> </li> <li> <p><em>Task</em> if you wish to request a documentation, sample or process (e.g. build system) enhancement or issue</p> </li> </ul> </div> </li> <li> <p>Then enter a <em>Summary</em> , describing briefly the problem - please try to be descriptive!</p> </li> <li> <p>You should <strong>not</strong> set <em>Priority</em>.</p> </li> <li> <p>Now, enter the version you are reporting an issue against in the <em>Affects Version</em> field, and leave the <em>Fix Version</em> field blank.</p> </li> <li> <p>In the <em>Environment</em> text area, provide as much detail as possible about your environment (e.g. Java runtime and version, operating system, any network topology which is relevant).</p> </li> <li> <p>In the <em>Description</em> field enter a detailed description of your problem or request.</p> </li> <li> <p>If the issue has been discussed on the forums or the mailing list, enter a reference in the <em>Forum Reference</em> field</p> </li> <li> <p>Finally, hit <em>Create</em></p> </li> </ol> </div> </div> <div class="sect3"> <h4 id="versioning_guidelines"><a class="anchor" href="#versioning_guidelines"></a>1.3.2. Versioning Guidelines</h4> <div class="admonitionblock warning"> <table> <tr> <td class="icon"> <i class="fa icon-warning" title="Warning"></i> </td> <td class="content"> <div class="literalblock"> <div class="content"> <pre>Only {brandname} contributors should set the _Fix Version_ field.</pre> </div> </div> </td> </tr> </table> </div> <div class="paragraph"> <p>When setting the <em>Fix Version</em> field for bugs and issues in JIRA, the following guidelines apply: Version numbers are defined as <code>${major}.${minor}.${micro}.${modifier}</code>. For example, <code>4.1.0.Beta1</code> would be:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">major</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">minor</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">micro</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">modifier</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Beta1</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>If the issue relates to a <em>Task</em> or <em>Feature Request</em>, please ensure that the <code>.Final</code> version is included in the <em>Fixed In</em> field. For example, a new feature should contain <code>4.1.0.Beta1</code>, <code>4.1.0.Final</code> if it is new for 4.1.0 and was first made public in beta1. For example, see <a href="https://issues.jboss.org/browse/ISPN-299">ISPN-299</a> .</p> </div> <div class="paragraph"> <p>If the issue relates to a bug which affected a previous Final version, then the <em>Fixed In</em> field should also contain the Final version which contains the fix, in addition to any Alpha, Beta or CR release. For example, see <a href="https://issues.jboss.org/browse/ISPN-546">ISPN-546</a>. If the issue pertains to a bug in the current release, then the Final version should not be in the <em>Fixed In</em> field. For example, a bug found in 4.1.0.Alpha2 (but not in 4.1.0.Alpha1) should be marked as fixed in 4.1.0.Alpha3, but not in 4.1.0.Final. For example, see <a href="https://issues.jboss.org/browse/ISPN-416">ISPN-416</a>.</p> </div> </div> </div> <div class="sect2"> <h3 id="version_control"><a class="anchor" href="#version_control"></a>1.4. Version control</h3> <div class="paragraph"> <p>Infinispan uses <a href="http://git-scm.com">git</a>, hosted on <a href="http://github.com">GitHub</a>, for version control. You can find the upstream git repository at <a href="https://github.com/infinispan" class="bare">https://github.com/infinispan</a>. To clone the repository:</p> </div> <div class="listingblock"> <div class="content"> <pre>$ git clone git@github.com:infinispan/infinispan.git</pre> </div> </div> <div class="paragraph"> <p>or to clone your fork:</p> </div> <div class="listingblock"> <div class="content"> <pre>$ git clone git@github.com:YOUR_GITHB_USERNAME/infinispan.git</pre> </div> </div> <div class="sect3"> <h4 id="setting_up_your_ide"><a class="anchor" href="#setting_up_your_ide"></a>1.4.1. Setting up your IDE</h4> <div class="paragraph"> <p>Maven supports generating IDE configuration files for easy setup of a project. This is tested on Eclipse, IntelliJ IDEA and Netbeans.</p> </div> <div class="sect4"> <h5 id="eclipse"><a class="anchor" href="#eclipse"></a>Eclipse</h5> <div class="paragraph"> <p>Before we import the project, we need to clone the project as described above.</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Install the m2eclipse plugin if you have not already installed it. This is bundled with Eclipse from version "Indigo" 3.7. For older versions follow instructions on <a href="http://eclipse.org/m2e/" class="bare">http://eclipse.org/m2e/</a>.</p> </li> <li> <p>Import the Infinispan maven project. Select File &#8594; Import in your eclipse workbench. Select the Existing Maven Project importer.</p> <div class="imageblock"> <div class="content"> <img src="./../../topics/images/import_maven1.png" alt="import maven1"> </div> </div> </li> <li> <p>Select the root directory of your Infinispan checkout.</p> <div class="imageblock"> <div class="content"> <img src="./../../topics/images/import_maven2.png" alt="import maven2"> </div> </div> </li> <li> <p>Select Infinispan modules that you want to import.</p> </li> <li> <p>Finally, from Infinispan 5.0 onwards, annotation processing is used to allow log messages to be internationalized. This processing can be done directly from Eclipse as part of compilation but it requires some set up:</p> <div class="olist loweralpha"> <ol class="loweralpha" type="a"> <li> <p>Open the properties for infinispan-core and locate Annotation Processing</p> </li> <li> <p>Tick Enable project specific settings</p> </li> <li> <p>Enter <code>target/generated-sources/annotations</code> as the <code>Generated source</code> directory</p> <div class="imageblock"> <div class="content"> <img src="./../../topics/images/ann_proc_eclipse.png" alt="ann proc eclipse"> </div> </div> </li> </ol> </div> </li> <li> <p>Code Formatting. From the menu Window &#8594; Preferences &#8594; Java &#8594; Code Style &#8594; Formatter. Import <a href="https://raw.github.com/infinispan/infinispan/master/ide-settings/eclipse/formatter.xml">formatter.xml</a></p> </li> <li> <p>Code templates. From the menu Window &#8594; Preferences &#8594; Java &#8594; Code Style &#8594; Code Templates. Import <a href="https://raw.github.com/infinispan/infinispan/master/ide-settings/eclipse/codetemplates.xml">codetemplates.xml</a></p> </li> </ol> </div> <div class="paragraph"> <p>Some modules use Scala, if you plan contributing to one of these modules it&#8217;s worth installing the <a href="http://scala-ide.org/">Scala IDE</a>. After installing it you need to add "Scala Nature" to a few project of the projects (from the project context menu Configuration &#8594; Add Scala Nature), at the moment these projects are: . infinispan-server-core . infinispan-server-hotrod . infinispan-server-memcached . infinispan-server-rest</p> </div> </div> <div class="sect4"> <h5 id="intellij_idea"><a class="anchor" href="#intellij_idea"></a>IntelliJ IDEA</h5> <div class="sect5"> <h6 id="importing"><a class="anchor" href="#importing"></a>Importing</h6> <div class="paragraph"> <p>When you start <a href="http://www.jetbrains.com/idea/">IntelliJ IDEA</a>, you will be greeted by a screen as shown below:</p> </div> <div class="imageblock"> <div class="content"> <img src="./../../topics/images/idea-12-import.jpg" alt="idea 12 import"> </div> </div> <div class="paragraph"> <p>If you have already obtained a copy of the Infinispan sources via Github (see <em>'Source Control'</em>), then follow: <em>Import Project &#8594; /directory/to/downloaded/sources</em> . IntelliJ will automatically make use of Maven to import the project since it will detect a <code>pom.xml</code> file in the base directory.</p> </div> <div class="paragraph"> <p>If you have not obtained the sources already, you can use the Git integration in IntelliJ IDEA 12. Click on <em>Check out from Version Control &#8594; Github</em>. After entering your Github credentials, you will then be prompted to enter the git repository URL along with the location that you want to check out the source code to.</p> </div> <div class="imageblock"> <div class="content"> <img src="./../../topics/images/idea-12-git.png" alt="idea 12 git"> </div> </div> </div> <div class="sect5"> <h6 id="compiler_settings"><a class="anchor" href="#compiler_settings"></a>Compiler settings</h6> <div class="paragraph"> <p>From Infinispan 5.0 onwards, annotation processing is used to allow log messages to be internationalized. This processing can be done directly from IntelliJ as part of compilation but it requires some set up:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Go to Preferences &#8594; Compiler &#8594; Annotation Processor" and click on <em>Enable annotation processing</em></p> </li> <li> <p>Add an annotation processor with "Processor FQN Name" as <code>org.jboss.logging.LoggingToolsProcessor</code></p> </li> <li> <p>In "Processed Modules", add all modules except the root and the parent modules.</p> </li> </ol> </div> <div class="imageblock"> <div class="content"> <img src="./../../topics/images/idea-12-annotations.png" alt="idea 12 annotations"> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> There can sometimes be issues with the generated logging classes on rebuild (particularly when you switch Git branches). If these issues do crop up then simply run <code>mvn clean install -DskipTests</code> on the command line to clear them out. </td> </tr> </table> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> If you are running a multi-core environment (e.g. quad-core or above) then you can follow the instructions on making use of parallelized compilation in IntelliJ 12. Information on how to do this can be found <a href="http://blogs.jetbrains.com/idea/2012/12/intellij-idea-12-compiler-twice-as-fast/">here</a> . </td> </tr> </table> </div> </div> <div class="sect5"> <h6 id="scala_plugin"><a class="anchor" href="#scala_plugin"></a>Scala Plugin</h6> <div class="paragraph"> <p>You will need to download the Scala plugin for IntelliJ as well. This can be done in <em>Project Settings &#8594; Plugins &#8594; Browse Repositories</em>. Then run a search for 'Scala'. JetBrains themselves are the vendor for this plugin and more information on it can be found <a href="http://confluence.jetbrains.net/display/SCA/Scala+Plugin+for+IntelliJ+IDEA">here</a> .</p> </div> <div class="imageblock"> <div class="content"> <img src="./../../topics/images/idea-12-scala.png" alt="idea 12 scala"> </div> </div> <div class="paragraph"> <p>You will then have to configure the Scala plugin to use the Scala compiler for Scala files and the Java compiler for Java files. You can do this by going into <em>Settings &#8594; Compiler &#8594; Scala Compiler</em> . Be sure to add the Scala compiler bundle as shown in the screenshot below.</p> </div> <div class="imageblock"> <div class="content"> <img src="./../../topics/images/idea-12-scala2.png" alt="idea 12 scala2"> </div> </div> </div> <div class="sect5"> <h6 id="code_style"><a class="anchor" href="#code_style"></a>Code Style</h6> <div class="paragraph"> <p>Download the code style JAR file from <a href="https://github.com/infinispan/infinispan/blob/master/ide-settings/intellij/IntelliJ_IDEA_Code_Style.jar?raw=true">here</a> and import this into IntelliJ IDEA.</p> </div> </div> </div> </div> </div> <div class="sect2"> <h3 id="builds"><a class="anchor" href="#builds"></a>1.5. Builds</h3> <div class="paragraph"> <p>Infinispan uses <a href="http://maven.apache.org/">Maven</a> for builds. Make sure you have Maven 3 installed, and properly configured. For more information, read <a href="#_building_infinispan">the Maven chapter</a>.</p> </div> <div class="sect3"> <h4 id="continuous_integration"><a class="anchor" href="#continuous_integration"></a>1.5.1. Continuous Integration</h4> <div class="paragraph"> <p>Infinispan uses <a href="http://www.jetbrains.com/teamcity">TeamCity</a> for continuous integration. TeamCity polls GitHub for updates and runs whenever updates are available. You can check the status of the latest builds <a href="http://ci.infinispan.org/overview.html">here</a> .</p> </div> </div> </div> <div class="sect2"> <h3 id="testing"><a class="anchor" href="#testing"></a>1.6. Testing</h3> <div class="paragraph"> <p>Infinispan uses <a href="http://testng.org/doc/index.html">TestNG</a> for unit and functional tests, and all Infinispan tests are run in parallel. For more information see the chapter on the test suite; this chapter gives advice on writing tests which can safely execute in parallel.</p> </div> </div> <div class="sect2"> <h3 id="communicating_with_other_infinispan_contributors"><a class="anchor" href="#communicating_with_other_infinispan_contributors"></a>1.7. Communicating with other Infinispan contributors</h3> <div class="paragraph"> <p>Infinispan contributors use a mix of technologies to communicate. Visit <a href="http://infinispan.org/community/">this page</a> to learn more.</p> </div> </div> <div class="sect2"> <h3 id="style_requirements"><a class="anchor" href="#style_requirements"></a>1.8. Style Requirements</h3> <div class="paragraph"> <p>Infinispan uses the <a href="http://en.wikipedia.org/wiki/Indent_style#K.26R_style">K&amp;R code style</a> for all Java source files, with two exceptions:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>use 3 spaces instead of a tab character for indentations.</p> </li> <li> <p>braces start on the same line for class, interface and method declarations as well as code blocks.</p> </li> </ol> </div> <div class="paragraph"> <p>In addition, sure all <a href="http://en.wikipedia.org/wiki/Newline">new line characters</a> used must be LF (UNIX style line feeds). Most good IDEs allow you to set this, regardless of operating system used.</p> </div> <div class="paragraph"> <p>All patches or code committed must adhere to this style. Code style settings which can be imported into IntelliJ IDEA and Eclipse are committed in the project sources, in <a href="https://github.com/infinispan/infinispan/blob/master/ide-settings/">ide-settings</a> .</p> </div> <div class="sect3"> <h4 id="spelling"><a class="anchor" href="#spelling"></a>1.8.1. Spelling</h4> <div class="paragraph"> <p>Ensure correct spelling in code, comments, Javadocs, etc. (use <em>American English</em> spelling). It is recommended that you use a spellchecker plugin for your IDE.</p> </div> </div> <div class="sect3"> <h4 id="check_in_comments"><a class="anchor" href="#check_in_comments"></a>1.8.2. Check-in comments</h4> <div class="paragraph"> <p>Please ensure any commit comments use <a href="#_comments">this format</a> if related to a task or issue in JIRA. This helps JIRA pick out these checkins and display them on the issue, making it very useful for back/forward porting fixes. If your comment does not follow this format, your commit may not be merged into upstream.</p> </div> </div> </div> <div class="sect2"> <h3 id="logging"><a class="anchor" href="#logging"></a>1.9. Logging</h3> <div class="paragraph"> <p>Infinispan follows the JBoss logging standards, which can be found <a href="https://community.jboss.org/wiki/LoggingStandards">here</a> .</p> </div> <div class="paragraph"> <p>From Infinispan 5.0 onwards, Infinispan uses JBoss Logging to abstract over the logging backend. Infinispan supports localization of log message for categories of INFO or above as explained in <a href="http://community.jboss.org/docs/16738">the JBoss Logging guidelines</a> . As a developer, this means that for each INFO, WARN, ERROR and FATAL message your code emits, you need to modify the Log class in your module and add an explicit method for it with the right annotations.</p> </div> <div class="paragraph"> <p>For example:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@LogMessage</span>(level = INFO)
<span class="annotation">@Message</span>(value = <span class="string"><span class="delimiter">&quot;</span><span class="content">An informative message: %s - %s</span><span class="delimiter">&quot;</span></span>, id = <span class="integer">600</span>)
<span class="type">void</span> fiveTransactionsHaveCompleted(<span class="predefined-type">String</span> param1, <span class="predefined-type">String</span> param2);</code></pre> </div> </div> <div class="paragraph"> <p>And then, instead of calling <code>log.info(&#8230;&#8203;)</code>, you call the method, for example <code>log.fiveTransactionsHaveCompleted(param1, param2)</code>. If what you&#8217;re trying to log is an error or similar message and you want an exception to be logged as cause, simply use <code>@Cause</code> annotation:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@LogMessage</span>(level = ERROR)
<span class="annotation">@Message</span>(value = <span class="string"><span class="delimiter">&quot;</span><span class="content">An error message: %s</span><span class="delimiter">&quot;</span></span>, id = <span class="integer">600</span>)
<span class="type">void</span> anErrorMessage(<span class="predefined-type">String</span> param1, <span class="annotation">@Cause</span> <span class="exception">IllegalStateException</span> e);</code></pre> </div> </div> <div class="paragraph"> <p>The last thing to figure out is which id to give to the message. Each module that logs something in production code that could be internationalized has been given an id range, and so the messages should use an available id in the range for the module where the log call resides. Here are the id range assignments per module:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Module name</th> <th class="tableblock halign-left valign-top">Id range</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">core</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">1 - 1000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">tree</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">2001 - 3000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">bdbje cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">2001 - 3000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">cassandra cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">3001 - 4000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">hotrod client</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">4001 - 5000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">server core</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">5001 - 6000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">server hotrod</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">6001 - 7000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">cloud cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">7001 - 8000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">jdbc cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">8001 - 9000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">jdbm cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">9001 - 10000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">remote cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">10001 - 11000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">server memcached</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">11001 - 12000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">server rest</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">12001 - 13000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">server websocket</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">13001 - 14000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">query</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">14001 - 14800</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">query-dsl</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">14801 - 15000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">lucene directory</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">15001 - 16000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">&lt;no longer used&gt;</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">16001 - 17000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">cdi integration</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">17001 - 18000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">hbase cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">18001 - 19000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">cli interpreter</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">19001 - 20000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">cli client</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">20001 - 21000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">mongodb cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">21001 - 22000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">rest cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">22001 - 23000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">leveldb cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">23001 - 24000 [unused]</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">couchbase cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">24001 - 25000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">redis cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">25001 - 26000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">extended statistics</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">25001 - 26000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">infinispan directory provider</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">26001 - 27000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">tasks</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">27001 - 27500</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">scripting</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">27501 - 28000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">remote query server</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">28001 - 28500</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">object filter</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">28501 - 29000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">soft-index file store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">29001 - 29500</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">clustered counter</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">29501 - 30000</p></td> </tr> </tbody> </table> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> When editing the above table, remember to update the README-i18n.txt file in the project sources! </td> </tr> </table> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> You will need to enable annotation processing in order to be able to compile Infinispan and have the logger implementation generated. </td> </tr> </table> </div> </div> </div> </div> <div class="sect1"> <h2 id="source_control"><a class="anchor" href="#source_control"></a>2. Source Control</h2> <div class="sectionbody"> <div class="paragraph"> <p>In this chapter we discuss how to interact with Infinispan&#8217;s source control repository.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> As a convention, <em>upstream</em> is used as the name of the <a href="http://github.com/infinispan/infinispan" class="bare">http://github.com/infinispan/infinispan</a> repository. This repository is the canonical repository for Infinispan. We usually name <em>origin</em> the fork on <a href="https://github.com">GitHub</a> of each contributor. So the exact meaning of <em>origin</em> is relative to the developer: you could think of <em>origin</em> as your own fork. </td> </tr> </table> </div> <div class="sect2"> <h3 id="prerequisites"><a class="anchor" href="#prerequisites"></a>2.1. Prerequisites</h3> <div class="paragraph"> <p>This document assumes some working knowledge of git. We recommend Scott Chacon&#8217;s excellent <a href="http://progit.org/">Pro Git</a> as a valuable piece of background reading. The book is released under the Creative Commons license and can be downloaded in electronic form for free. At very least, we recommend that you read <a href="http://progit.org/book/ch2-0.html">Chapter 2</a>, <a href="http://progit.org/book/ch3-0.html">Chapter 3</a> and <a href="http://progit.org/book/ch5-0.html">Chapter 5</a> of <em>Pro Git</em> before proceeding.</p> </div> </div> <div class="sect2"> <h3 id="repositories"><a class="anchor" href="#repositories"></a>2.2. Repositories</h3> <div class="paragraph"> <p>Infinispan uses <a href="http://github.com/infinispan/infinispan" class="bare">http://github.com/infinispan/infinispan</a> as its canonical repository, and this repository contains the stable code on master as well as the maintenance branches for previous minor versions (e.g., 5.0.x, 4.2.x, 4.1.x, etc)</p> </div> <div class="paragraph"> <p>Typically, only <em>Project Admins</em> would be able to push to this repository while all else may clone or fork the repository.</p> </div> </div> <div class="sect2"> <h3 id="roles"><a class="anchor" href="#roles"></a>2.3. Roles</h3> <div class="paragraph"> <p>The project assumes one of 2 <em>roles</em> an individual may assume when interacting with the Infinispan codebase. The 2 roles here are:</p> </div> <div class="ulist"> <div class="title">Roles</div> <ul> <li> <p><em>Contributor</em></p> </li> <li> <p><em>Project Admin</em> (typically, no more than a small handful of people)</p> </li> </ul> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> None of the roles assume that you are a Red Hat employee. All it assumes is how much responsibility over the project has been granted to you. Typically, someone may be in more than one role at any given time, and puts on a different "hats" based on the task at hand. </td> </tr> </table> </div> <div class="sect3"> <h4 id="contributor"><a class="anchor" href="#contributor"></a>2.3.1. Contributor</h4> <div class="paragraph"> <p>A contributor will only ever submit patches via GitHub&#8217;s <em>pull request</em> mechanism.</p> </div> <div class="paragraph"> <p>Contributors should <em>always</em> fork the upstream project on GitHub and work off a clone of this fork.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> All Infinispan core developers are considered contributors and work off personal forks of the upstream repository. This allows for complex features to be developed in parallel without tripping up over one another. This process is certainly not restricted to just Infinispan core developers; any contributor should also participate in this manner. </td> </tr> </table> </div> <div class="sect4"> <h5 id="creating_a_pull_request_on_github"><a class="anchor" href="#creating_a_pull_request_on_github"></a>Creating a pull request on GitHub</h5> <div class="imageblock"> <div class="content"> <img src="./../../topics/images/git_wf_2.png" alt="git wf 2"> </div> </div> <div class="paragraph"> <p>In this workflow, the contributor forks the Infinispan upstream repository on GitHub, clones their fork, and makes changes to this private fork. When changes have been tested and are ready to be contributed back to the project, a <em>pull request</em> is issued via GitHub so that one of the <em>Project Administrators</em> can pull in the change.</p> </div> <div class="paragraph"> <div class="title">Topic Branches</div> <p>NOTE: It is desirable to work off a <em>topic branch</em>, even when using your own, forked repository. A topic branch is created for every feature or bug fix you do. Typically you would create one topic branch per issue, but if several patches are related it&#8217;s acceptable to have several commits in the same branch; however different changes should always be identified by different commits. </p> </div> <div class="paragraph"> <p>Before you push your work onto your fork of the repository on GitHub (your <em>origin</em>), it is often a good idea to review your commits. Consolidating them (squashing) or breaking them up as necessary and cleaning up commit messages should all be done while still working off your local clone. Also, prior to issuing a pull request, you should make sure you rebase your branch against the upstream branch you expect it to be merged into.  Also, only submit pull requests for your topic branch - not for your master!</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> The section on <em>Public Small Project</em> in <a href="http://progit.org/book/ch5-2.html">Chapter 5, Section 2</a> of Pro Git has more information on this style of workflow. </td> </tr> </table> </div> <div class="sect5"> <h6 id="a_worked_example"><a class="anchor" href="#a_worked_example"></a>A worked example</h6> <div class="olist arabic"> <ol class="arabic"> <li> <p>Make sure your master is synced up with upstream. See <a href="#link_ifyouhaveforkedupstream">this section</a> for how to do this</p> </li> <li> <p>Create new branch for your topic and switch to it. For the example issue, ISPN-1234:</p> <div class="literalblock"> <div class="content"> <pre>git checkout -b t_ISPN-12345 master</pre> </div> </div> </li> <li> <p>Do your work. Test. Repeat</p> </li> <li> <p>Commit your work on your topic branch</p> </li> <li> <p>Push your topic branch to GitHub. For example:</p> <div class="literalblock"> <div class="content"> <pre>git push origin t_ISPN-12345</pre> </div> </div> </li> <li> <p>Issue a pull request using the <a href="http://help.github.com/send-pull-requests/">GitHub pull request system</a></p> </li> <li> <p>Once your pull request has been applied upstream, delete the topic branch both locally and on your fork. For example:</p> <div class="literalblock"> <div class="content"> <pre>git branch -d t_ISPN-12345 &amp;&amp; git push origin :t_ISPN-12345</pre> </div> </div> </li> <li> <p>Sync with upstream again so that your changes now appear in your master branch</p> </li> </ol> </div> <div class="paragraph"> <p>If your topic branch has been open for a while and you are afraid changes upstream may clash with your changes, it makes sense to rebase your topic branch before you issue a pull request. To do this:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Sync your master branch with upstream</p> <div class="literalblock"> <div class="content"> <pre>git checkout master
git pull upstream master</pre> </div> </div> </li> <li> <p>Switch to your topic branch. For example:</p> <div class="literalblock"> <div class="content"> <pre>git checkout t_ISPN-12345</pre> </div> </div> </li> <li> <p>Rebase your topic branch against master:</p> <div class="literalblock"> <div class="content"> <pre>git rebase master</pre> </div> </div> </li> <li> <p>During the rebase process you might need to fix conflicts</p> </li> <li> <p>When you&#8217;re done test your code again.</p> </li> <li> <p>Push your rebased topic branch to your repo on GitHub (you will likely need to force this with the -f option).</p> <div class="literalblock"> <div class="content"> <pre>git push -f origin ISPN-12345</pre> </div> </div> </li> <li> <p>Continue your work on your topic branch.</p> </li> </ol> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> If you are sharing your forked Infinispan repo with others, then do not rebase! Use a merge instead. </td> </tr> </table> </div> </div> </div> <div class="sect4"> <h5 id="multi_step_coordination_between_developers_using_forked_repositories"><a class="anchor" href="#multi_step_coordination_between_developers_using_forked_repositories"></a>Multi-step coordination between developers using forked repositories</h5> <div class="paragraph"> <p>Sometimes a feature/task is rather complex to implement and requires competence from multiple areas of the projects. In such occasions it is not uncommon for developers to coordinate feature implementation using personal forks of Infinispan prior to finally issuing request to integrate into Infinispan main repository on GitHub.</p> </div> <div class="paragraph"> <p>For example, developer A using his personal Infinispan fork creates a topic branch T and completes as much work as he/she can before requesting for assistance from developer B. Developer A pushes topic T to his personal Infinispan fork where developer B picks it up and brings it down to his local repo. Developer B then in turn completes necessary work, commits his/her changes on branch T, and finally pushes back T to his own personal fork. After issuing request for pull to developer A, developer B waits for notification that developer A integrated his changes. This exchange can be repeated as much as it is necessary and can involve multiple developers.</p> </div> <div class="sect5"> <h6 id="a_worked_example_2"><a class="anchor" href="#a_worked_example_2"></a>A worked example</h6> <div class="paragraph"> <p>This example assumes that developer A and B have added each others Infinispan forked repositories with the <code>git add remote</code> command. For example, developer B would add developer A&#8217;s personal Infinispan fork repository with the command</p> </div> <div class="literalblock"> <div class="content"> <pre>git remote add devA https://github.com/developerA/infinispan.git</pre> </div> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Developer A starts implementing feature ISPN-244 and works on a local topic branch <code>t_ISPN244</code>. Developer A pushes <code>t_ISPN244</code> to personal Infinispan fork. For example:</p> <div class="literalblock"> <div class="content"> <pre>git push origin t_ISPN244</pre> </div> </div> </li> <li> <p>Developer B fetches branch <code>t_ISPN244</code> to local repository. For example:</p> <div class="literalblock"> <div class="content"> <pre>git fetch devA t_ispn244:my_t_ispn244</pre> </div> </div> </li> <li> <p>Developer B works on local branch <code>my_t_ispn244</code></p> </li> <li> <p>Developer B commits changes, pushes <code>my_t_ispn244</code> to own fork.</p> <div class="literalblock"> <div class="content"> <pre>git push origin my_t_ispn244</pre> </div> </div> </li> <li> <p>Developer B sends pull request to developer A to integrate changes from <code>my_t_ispn244</code> to <code>t_ispn244</code></p> </li> </ol> </div> </div> </div> </div> <div class="sect3"> <h4 id="project_admin"><a class="anchor" href="#project_admin"></a>2.3.2. Project Admin</h4> <div class="paragraph"> <p>Project Admins have a very limited role. Only Project Admins are allowed to push to upstream, and Project Admins <em>never</em> write any code directly on the upstream repository. All Project Admins do is pull in and merge changes from contributors (even if the "contributor" happens to be themselves) into upstream, perform code reviews and either commit or reject such changes.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> All Contributors who are also Project Admins are encouraged to not merge their own changes, to ensure that all changes are reviewed by someone else. </td> </tr> </table> </div> <div class="paragraph"> <p>This approach ensures Infinispan maintains quality on the main code source tree, and allows for important code reviews to take place again ensuring quality. Further, it ensures clean and easily traceable code history and makes sure that more than one person knows about the changes being performed.</p> </div> <div class="sect4"> <h5 id="handling_pull_requests"><a class="anchor" href="#handling_pull_requests"></a>Handling pull requests</h5> <div class="imageblock"> <div class="content"> <img src="./../../topics/images/git_wf_3.png" alt="git wf 3"> </div> </div> <div class="paragraph"> <p>Project Admins are also responsible for responding to pull requests. When pulling in changes from a forked repository, more than a single commit may be pulled in. Again, this should be done on a newly created working branch, code reviewed, tested and cleaned up as necessary.</p> </div> <div class="paragraph"> <p>If commits need to be altered - e.g., rebasing to squash or split commits, or to alter commit messages - it is often better to contact the Contributor and ask the Contributor to do so and re-issue the pull request, since doing so on the upstream repo could cause update issues for other contributors later on. If commits were altered or three-way merge was performed during a merge instead of fast-forward, it&#8217;s also a good idea to check the log to make sure that the resulting repository history looks OK:</p> </div> <div class="listingblock"> <div class="content"> <pre>$ git log --pretty=oneline --graph --abbrev-commit  # History messed up due to a bad merge
*   3005020 Merge branch 'ISPN-786' of git://github.com/Sanne/infinispan
|\ 
| * e757265 ISPN-786 Make dependency to log4j optional  &lt;-- Same with cb4e5d6 - unnecessary
* | cb4e5d6 ISPN-786 Make dependency to log4j optional  &lt;-- Cherry-picked commit by other admin
|/
* ...

$ git reset cb4e5d6  # revert the bad merge</pre> </div> </div> <div class="paragraph"> <p>It is therefore <em>strongly recommended</em> that you use the <a href="https://github.com/maniksurtani/githelpers/blob/master/project_admins/handle_pull_request"><code>handle_pull_request</code></a> script that ensures a clean merge. If you <em>still</em> wish to do this manually, please consider reading through the script first to get an idea of what needs to happen.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> More information on pulling changes from remote, forked repos can be found in <a href="http://progit.org/book/ch5-3.html">Chapter 5, Section 3</a> of Pro Git, under <em>Checking Out Remote Branches</em> . </td> </tr> </table> </div> <div class="sect5"> <h6 id="possible_trouble_handling_pull_requests"><a class="anchor" href="#possible_trouble_handling_pull_requests"></a>Possible trouble handling pull requests</h6> <div class="olist arabic"> <ol class="arabic"> <li> <p>If you have warnings about "Merge made by recursive" you have to fix it rebasing.</p> </li> <li> <p>If you have warnings about "non-fast-forward" you have to rebase.</p> </li> <li> <p>If you see "non-fast-forward updates were rejected" you <strong>must never</strong> use <code>--force</code> on upstream! It means that another patch was merged before you and you have to update your master again, and rebase again.</p> </li> <li> <p><code>--force</code> is allowed only in special maintenance circumstances. If you find you&#8217;re needing it to handle a pull request, then you&#8217;re doing it wrong, and the mistake might be a dangerous one! It&#8217;s like the good rule of never commit when you&#8217;re drunk (drunk coding, however, is allowed).</p> </li> </ol> </div> <div class="admonitionblock warning"> <table> <tr> <td class="icon"> <i class="fa icon-warning" title="Warning"></i> </td> <td class="content"> <div class="title">Never use <code>--force</code> on <code>git push</code></div> Using <code>--force</code> while pushing on a shared repository such as <em>upstream</em> you could effectively erase other committed patches. No one should ever use this option unless unanimously approved on the public mailing list: the most dangerous aspect of it is that nobody gets any notification if this happens, and we might think issues are solved but you silently removed the fix and it&#8217;s history from the repository. </td> </tr> </table> </div> </div> </div> <div class="sect4"> <h5 id="cutting_releases"><a class="anchor" href="#cutting_releases"></a>Cutting releases</h5> <div class="paragraph"> <p>Releases can only be cut by Project Admins, and must be done off a recently updated (<code>git fetch</code> and <code>git pull origin</code>) clone of the upstream repo. Infinispan&#8217;s <code>bin/release.py</code> script takes care of the rest.</p> </div> </div> </div> <div class="sect3"> <h4 id="release_branches"><a class="anchor" href="#release_branches"></a>2.3.3. Release branches</h4> <div class="paragraph"> <p>Infinispan has several main release branches. These are master (ongoing work on the current unstable release), and maintenance branches for previous minor releases (e.g., <code>5.0.x</code>, <code>4.2.x</code>, <code>4.1.x</code>). Work should never be committed directly to any of these release branches directly; topic branches should always be used for work, and these topic branches should be merged in using the process outlined above.</p> </div> </div> <div class="sect3"> <h4 id="topic_branches"><a class="anchor" href="#topic_branches"></a>2.3.4. Topic branches</h4> <div class="paragraph"> <p>Some of the biggest features of git are speed and efficiency of branching, and accuracy of merging. As a result, best practices involve making frequent use of branches. Creating several topic branches a day, even, should not be considered excessive, and working on several topic branches simultaneously again should be commonplace.</p> </div> <div class="paragraph"> <p><a href="http://progit.org/book/ch3-4.html">Chapter 3, Section 4</a> of Pro Git has a detailed discussion of topic branches. For Infinispan, it makes sense to create a topic branch and name it after the JIRA it corresponds to. (if it doesn&#8217;t correspond to a JIRA, a simple but descriptive name should be used).</p> </div> <div class="sect4"> <h5 id="topic_branches_affecting_more_than_one_release_branch"><a class="anchor" href="#topic_branches_affecting_more_than_one_release_branch"></a>Topic Branches Affecting More Than One Release Branch</h5> <div class="paragraph"> <p>Most topic branches will only affect a single release branch, e.g. features targeted at the current unstable release will only affect the master release branch. So a topic branch should be created based off master. However, occasionally, fixes may apply to both release branches 4.2.x as well as master. In this case, the following workflow should apply:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Create topic branch off 4.2.x. For example:</p> <div class="literalblock"> <div class="content"> <pre>git checkout -b &lt;topic&gt;_4.2.x 4.2.x</pre> </div> </div> </li> <li> <p>Create topic branch off master. For example:</p> <div class="literalblock"> <div class="content"> <pre>git checkout -b &lt;topic&gt;_master master</pre> </div> </div> </li> <li> <p>Do your work on <code>&lt;topic&gt;_master</code>, test and commit your fixes</p> </li> <li> <p>Switch to <code>&lt;topic&gt;_4.2.x</code>. For example:</p> <div class="literalblock"> <div class="content"> <pre>git checkout &lt;topic&gt;_4.2.x</pre> </div> </div> </li> <li> <p>Cherry-pick your commit from <code>&lt;topic&gt;_master</code> onto <code>&lt;topic&gt;_4.2.x</code>. For example:</p> <div class="literalblock"> <div class="content"> <pre>git cherry-pick &lt;commit_id&gt;</pre> </div> </div> </li> <li> <p>Test <code>&lt;topic&gt;_4.2.x</code> for correctness, modify as necessary</p> </li> <li> <p>Issue two separate pull requests for both branches</p> </li> </ol> </div> </div> </div> <div class="sect3"> <h4 id="comments"><a class="anchor" href="#comments"></a>2.3.5. Comments</h4> <div class="paragraph"> <p>It is <em>extremely important</em> that comments for each commit are clear and follow certain conventions. This allows for proper parsing of logs by git tools. Read <a href="http://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html">this article</a> on how to format comments for git and adhere to them. Further to the recommendations in the article, the short summary of the commit message should be in the following format:</p> </div> <div class="literalblock"> <div class="content"> <pre>ISPN-XXX Subject line of the JIRA in question</pre> </div> </div> <div class="paragraph"> <p>This can optionally be followed by a detailed explanation of the commit. Why it was done, how much of it was completed, etc. You may wish to express this as a list, for example:</p> </div> <div class="ulist"> <ul> <li> <p>Add a unit test</p> </li> <li> <p>Add more unit tests</p> </li> <li> <p>Fix regressions</p> </li> <li> <p>Solve major NP-Complete problems</p> </li> </ul> </div> <div class="paragraph"> <p>Make sure however to split separate concerns - especially if they are unrelated - in separate commits.</p> </div> </div> <div class="sect3"> <h4 id="commits"><a class="anchor" href="#commits"></a>2.3.6. Commits</h4> <div class="paragraph"> <p>Sometimes work on your topic branch may include several commits. For example, committing a test. Then committing another test. Then perhaps committing a fix. And perhaps fixing your own fix in the next commit&#8230;&#8203; Before issuing a pull request for this topic branch, consider cleaning up these commits. Interactive rebasing helps you squash several commits into a single commit, which is often more coherent to deal with for others merging in your work. <a href="http://progit.org/book/ch6-4.html">Chapter 6, Section 4</a> of Pro Git has details on how to squash commits and generally, clean up a series of commits before sharing this work with others. Note that you can also easily reorder them, just change the order of lines during the interactive rebase process.</p> </div> <div class="paragraph"> <p>Also, it is important to make sure you don&#8217;t accidentally commit files for which no real changes have happened, but rather, whitespace has been modified. This often happens with some IDEs. <code>git diff --check</code> should be run before you issue such a pull request, which will check for such "noise" commits and warn you accordingly. Such files should be reverted and not be committed to the branch.</p> </div> <div class="paragraph"> <p>Adhering to <a href="chapter-1-The_Basics.html#style_requirements">Infinispan&#8217;s code style</a> guidelines will help minimise "noise" commits. Project Admins are going to ask contributors to reformat their code if necessary.</p> </div> </div> </div> <div class="sect2"> <h3 id="keeping_your_repo_in_sync_with_upstream"><a class="anchor" href="#keeping_your_repo_in_sync_with_upstream"></a>2.4. Keeping your repo in sync with upstream</h3> <div class="sect3"> <h4 id="if_you_have_cloned_upstream"><a class="anchor" href="#if_you_have_cloned_upstream"></a>2.4.1. If you have cloned upstream</h4> <div class="paragraph"> <p>If you have a clone of the upstream, you may want to update it from time to time. Running:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ git fetch origin
$ git fetch origin --tags</pre> </div> </div> <div class="paragraph"> <p>will often do the trick. You could then pull the specific branches you would need to update:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ git checkout master
$ git pull origin master
$ git checkout 4.2.x
$ git pull origin 4.2.x</pre> </div> </div> <div class="sect4"> <h5 id="updating_topic_branches"><a class="anchor" href="#updating_topic_branches"></a>Updating topic branches</h5> <div class="paragraph"> <p>You should rebase your topic branches at this point so that they are up-to-date and when pulled by upstream, upstream can fast-forward the release branches:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ git checkout &lt;topic&gt;_master
$ git rebase master</pre> </div> </div> <div class="paragraph"> <p>and/or</p> </div> <div class="literalblock"> <div class="content"> <pre>$ git checkout topic_4.2.x
$ git rebase 4.2.x</pre> </div> </div> </div> </div> <div class="sect3"> <h4 id="link_ifyouhaveforkedupstream"><a class="anchor" href="#link_ifyouhaveforkedupstream"></a>2.4.2. If you have forked upstream</h4> <div class="paragraph"> <p>If you have a fork of upstream, you should probably define upstream as one of your remotes:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ git remote add upstream git://github.com/infinispan/infinispan.git</pre> </div> </div> <div class="paragraph"> <p>You should now be able to fetch and pull changes from upstream into your local repository, though you should make sure you have no uncommitted changes. (You <em>do</em> use topic branches, right?)</p> </div> <div class="literalblock"> <div class="content"> <pre>$ git fetch upstream
$ git fetch upstream --tags
$ git checkout master
$ git pull upstream master
$ git push origin master
$ git checkout 4.2.x
$ git pull upstream 4.2.x
$ git push origin 4.2.x</pre> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> A script can do this for you - have a look at <a href="https://github.com/maniksurtani/githelpers/blob/master/contributors/sync_with_upstream"><code>sync_with_upstream</code></a> . </td> </tr> </table> </div> <div class="sect4"> <h5 id="updating_topic_branches_2"><a class="anchor" href="#updating_topic_branches_2"></a>Updating topic branches</h5> <div class="paragraph"> <p>Again, you should rebase your topic branches at this point so that they are up-to-date and when pulled by upstream, upstream can fast-forward the release branches:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ git checkout topic_master
$ git rebase master</pre> </div> </div> <div class="paragraph"> <p>and/or</p> </div> <div class="literalblock"> <div class="content"> <pre>$ git checkout topic_4.2.x
$ git rebase 4.2.x</pre> </div> </div> <div class="paragraph"> <p>The <code>sync_with_upstream</code> script can do this for you if your topic branch naming conventions match the script.</p> </div> </div> </div> </div> <div class="sect2"> <h3 id="tips_on_enhancing_git"><a class="anchor" href="#tips_on_enhancing_git"></a>2.5. Tips on enhancing git</h3> <div class="sect3"> <h4 id="completions"><a class="anchor" href="#completions"></a>2.5.1. Completions</h4> <div class="paragraph"> <p>Save <a href="http://git.kernel.org/?p=git/git.git;a=blob_plain;f=contrib/completion/git-completion.bash;h=168669bbf79cb33c527a688fb906e276beadaf79;hb=HEAD">this script</a> as <code>~/.git-completion.bash</code> and in <code>~/.bash_profile</code>, add the following on one line:</p> </div> <div class="literalblock"> <div class="content"> <pre>source ~/.git-completion.bash</pre> </div> </div> <div class="paragraph"> <p>After logging out and back in again, typing <code>git</code> followed by <kbd>TAB</kbd> will give you a list of git commands, as would <code>git c</code> followed by <kbd>TAB</kbd>, etc. This even works for options, e.g. <code>git commit --</code> followed by <kbd>TAB</kbd>. The completions are even aware of your refs, so even <code>git checkout my_br</code> followed by <kbd>TAB</kbd> will complete to <code>git checkout my_branch</code>!</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> You get git autocompletion for free if you use <a href="http://zsh.sourceforge.net/">zsh</a> instead of bash. </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="terminal_colors"><a class="anchor" href="#terminal_colors"></a>2.5.2. Terminal colors</h4> <div class="paragraph"> <p>Add the following to your <code>~/.gitconfig</code></p> </div> <div class="listingblock"> <div class="title">~/.gitconfig</div> <div class="content"> <pre>  [color]
    ui = yes
  [color "branch"]
   current = yellow reverse
   local = yellow
   remote = green
  [color "diff"]
    meta = yellow bold
    frag = magenta bold
    old = red bold
    new = green bold
  [color "status"]
    added = yellow
    changed = green
    untracked = cyan</pre> </div> </div> </div> <div class="sect3"> <h4 id="aliases"><a class="anchor" href="#aliases"></a>2.5.3. Aliases</h4> <div class="paragraph"> <p>Some git commands are pretty long to type, especially with various switches. Aliases help you to map shortcuts to more complex commands. Again, For example, add the following to <code>~/.gitconfig</code>:</p> </div> <div class="listingblock"> <div class="title">~/.gitconfig</div> <div class="content"> <pre>[alias]
     co = checkout
     undo = reset --hard
     cb = checkout -b
     br = branch
     cp = cherry-pick
     st = status
     l = log --pretty=oneline --decorate --abbrev-commit
     lg = log --decorate --abbrev-commit
     last = log --decorate -1 -p --abbrev-commit
     ci = commit -a
     pom = push origin master
     graph = log --pretty=oneline --graph --abbrev-commit
     dt = difftool</pre> </div> </div> </div> <div class="sect3"> <h4 id="visual_history"><a class="anchor" href="#visual_history"></a>2.5.4. Visual History</h4> <div class="paragraph"> <p>Git ships with gitk, a GUI that visually represents a log. If you use Mac OS X, <a href="http://gitx.frim.nl/">GitX</a> is a good alternative. Try typing gitk or gitx in a git project directory. For Linux users, there are lots of alternatives: <em>gitk</em> , <em>gitg</em> , <em>giggle</em>, &#8230;&#8203; up to <em>egit</em> for Eclipse.</p> </div> </div> <div class="sect3"> <h4 id="visual_diff_and_merge_tools"><a class="anchor" href="#visual_diff_and_merge_tools"></a>2.5.5. Visual diff and merge tools</h4> <div class="paragraph"> <p>There are several options available, including <a href="http://kdiff3.sourceforge.net/">KDiff3</a>, <a href="http://meld.sourceforge.net/">meld</a> and Perforce&#8217;s <a href="http://www.perforce.com/perforce/products/merge.html">P4Merge</a> which are all either open source or available for free. See <a href="http://progit.org/book/ch7-1.html">this link</a> on setting these up (section under <em>External Merge and Diff Tools</em>)</p> </div> </div> <div class="sect3"> <h4 id="choosing_an_editor"><a class="anchor" href="#choosing_an_editor"></a>2.5.6. Choosing an Editor</h4> <div class="paragraph"> <p>You can customise the editor used by git editing <code>~/.gitconfig</code>. The following fires up <a href="http://code.google.com/p/macvim/">MacVIM</a> instead of the default vi editor:</p> </div> <div class="listingblock"> <div class="title">~/.gitconfig</div> <div class="content"> <pre>[core]
     editor = mvim -f</pre> </div> </div> <div class="paragraph"> <p>Alternatively, you could fire up TextMate or another editors of your choice.</p> </div> </div> <div class="sect3"> <h4 id="shell_prompt"><a class="anchor" href="#shell_prompt"></a>2.5.7. Shell prompt</h4> <div class="paragraph"> <p>You can change your bash shell prompt to print the current repository&#8217;s branch name. Add the following to your <code>~/.bashrc</code></p> </div> <div class="listingblock"> <div class="title">~/.bashrc</div> <div class="content"> <pre>function git_current_branch {
  git branch --no-color 2&gt; /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/[\1]/'
}

if [ "$PS1" ]; then
  PS1='[\u@\h:\W]$(git_current_branch)\$ '
fi</pre> </div> </div> <div class="paragraph"> <p>The resulting shell prompt will look like:</p> </div> <div class="literalblock"> <div class="content"> <pre>trustin@matrix:infinispan-4.2][4.2.x]$</pre> </div> </div> <div class="paragraph"> <p>If you&#8217;re a zsh user, you can get even more interesting branch information thanks to <a href="http://sebastiancelis.com/2009/nov/16/zsh-prompt-git-users/">this blog post</a> , such as:</p> </div> <div class="ulist"> <ul> <li> <p>whether your branch is dirty (<em>X</em>)</p> </li> <li> <p>whether it&#8217;s ahead of the remote(↑)</p> </li> <li> <p>whether it diverges with the remote (↕)</p> </li> <li> <p>whether it&#8217;s behind (↓)</p> </li> </ul> </div> <div class="paragraph"> <p>For example, the following prompt indicates that the current branch is 't_ispn775_master' and that it is behind remote:</p> </div> <div class="literalblock"> <div class="content"> <pre>[~/Go/code/infinispan.git]% (t_ispn775_master ↓)</pre> </div> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="building_infinispan"><a class="anchor" href="#building_infinispan"></a>3. Building Infinispan</h2> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan uses <a href="http://maven.apache.org/">Maven</a> as a build system.</p> </div> <div class="sect2"> <h3 id="requirements"><a class="anchor" href="#requirements"></a>3.1. Requirements</h3> <div class="ulist"> <ul> <li> <p>Java 11 or above</p> </li> <li> <p>Maven 3.5 or above</p> </li> </ul> </div> <div class="admonitionblock warning"> <table> <tr> <td class="icon"> <i class="fa icon-warning" title="Warning"></i> </td> <td class="content"> Make sure you follow the steps outlined in <a href="http://community.jboss.org/docs/15169">Maven Getting Started - Users</a> to set up your JBoss repository correctly. This step is <em>crucial</em> to ensure your Maven setup can locate JBoss artifacts! If you also want to test the EAP integration modules you should also add the appropriate <a href="http://maven.repository.redhat.com/">Enterprise Red Hat Maven Repository.</a> </td> </tr> </table> </div> </div> <div class="sect2"> <h3 id="maven"><a class="anchor" href="#maven"></a>3.2. Maven</h3> <div class="paragraph"> <p>The following is an example <code>settings.xml</code> to get you started:</p> </div> <div class="listingblock"> <div class="title">settings.xml</div> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;settings</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://maven.apache.org/SETTINGS/1.0.0</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://maven.apache.org/SETTINGS/1.0.0</span>
                      <span class="content">http://maven.apache.org/xsd/settings-1.0.0.xsd</span><span class="delimiter">&quot;</span></span> <span class="tag">&gt;</span>
  <span class="tag">&lt;localRepository</span><span class="tag">/&gt;</span>
  <span class="tag">&lt;interactiveMode</span><span class="tag">/&gt;</span>
  <span class="tag">&lt;usePluginRegistry</span><span class="tag">/&gt;</span>
  <span class="tag">&lt;offline</span><span class="tag">/&gt;</span>
  <span class="tag">&lt;proxies</span><span class="tag">/&gt;</span>
  <span class="tag">&lt;profiles&gt;</span>
    <span class="tag">&lt;profile&gt;</span>
      <span class="tag">&lt;id&gt;</span>jboss-public-repository<span class="tag">&lt;/id&gt;</span>
      <span class="tag">&lt;repositories&gt;</span>
        <span class="tag">&lt;repository&gt;</span>
          <span class="tag">&lt;id&gt;</span>jboss-public-repository-group<span class="tag">&lt;/id&gt;</span>
          <span class="tag">&lt;name&gt;</span>JBoss Public Maven Repository Group<span class="tag">&lt;/name&gt;</span>
          <span class="tag">&lt;url&gt;</span> https://repository.jboss.org/nexus/content/groups/public-jboss/ <span class="tag">&lt;/url&gt;</span>
          <span class="tag">&lt;layout&gt;</span>default<span class="tag">&lt;/layout&gt;</span>
          <span class="tag">&lt;releases&gt;</span>
            <span class="tag">&lt;enabled&gt;</span>true<span class="tag">&lt;/enabled&gt;</span>
            <span class="tag">&lt;updatePolicy&gt;</span>never<span class="tag">&lt;/updatePolicy&gt;</span>
          <span class="tag">&lt;/releases&gt;</span>
          <span class="tag">&lt;snapshots&gt;</span>
            <span class="tag">&lt;enabled&gt;</span>true<span class="tag">&lt;/enabled&gt;</span>
            <span class="tag">&lt;updatePolicy&gt;</span>never<span class="tag">&lt;/updatePolicy&gt;</span>
          <span class="tag">&lt;/snapshots&gt;</span>
        <span class="tag">&lt;/repository&gt;</span>
      <span class="tag">&lt;/repositories&gt;</span>
      <span class="tag">&lt;pluginRepositories&gt;</span>
        <span class="tag">&lt;pluginRepository&gt;</span>
          <span class="tag">&lt;id&gt;</span>jboss-public-repository-group<span class="tag">&lt;/id&gt;</span>
          <span class="tag">&lt;name&gt;</span>JBoss Public Maven Repository Group<span class="tag">&lt;/name&gt;</span>
          <span class="tag">&lt;url&gt;</span> https://repository.jboss.org/nexus/content/groups/public-jboss/ <span class="tag">&lt;/url&gt;</span>
          <span class="tag">&lt;layout&gt;</span>default<span class="tag">&lt;/layout&gt;</span>
          <span class="tag">&lt;releases&gt;</span>
            <span class="tag">&lt;enabled&gt;</span>true<span class="tag">&lt;/enabled&gt;</span>
            <span class="tag">&lt;updatePolicy&gt;</span>never<span class="tag">&lt;/updatePolicy&gt;</span>
          <span class="tag">&lt;/releases&gt;</span>
          <span class="tag">&lt;snapshots&gt;</span>
            <span class="tag">&lt;enabled&gt;</span>true<span class="tag">&lt;/enabled&gt;</span>
            <span class="tag">&lt;updatePolicy&gt;</span>never<span class="tag">&lt;/updatePolicy&gt;</span>
          <span class="tag">&lt;/snapshots&gt;</span>
        <span class="tag">&lt;/pluginRepository&gt;</span>
      <span class="tag">&lt;/pluginRepositories&gt;</span>
    <span class="tag">&lt;/profile&gt;</span>

    <span class="comment">&lt;!-- Include early access of application server and other products --&gt;</span>
    <span class="tag">&lt;profile&gt;</span>
      <span class="tag">&lt;id&gt;</span>redhat-earlyaccess-repository<span class="tag">&lt;/id&gt;</span>
        <span class="tag">&lt;repositories&gt;</span>
          <span class="tag">&lt;repository&gt;</span>
            <span class="tag">&lt;id&gt;</span>redhat-earlyaccess-repository-group<span class="tag">&lt;/id&gt;</span>
            <span class="tag">&lt;name&gt;</span>Red Hat early access repository<span class="tag">&lt;/name&gt;</span>
            <span class="tag">&lt;url&gt;</span> http://maven.repository.redhat.com/earlyaccess/all/ <span class="tag">&lt;/url&gt;</span>
            <span class="tag">&lt;layout&gt;</span>default<span class="tag">&lt;/layout&gt;</span>
            <span class="tag">&lt;releases&gt;</span>
              <span class="tag">&lt;enabled&gt;</span>true<span class="tag">&lt;/enabled&gt;</span>
              <span class="tag">&lt;updatePolicy&gt;</span>never<span class="tag">&lt;/updatePolicy&gt;</span>
            <span class="tag">&lt;/releases&gt;</span>
            <span class="tag">&lt;snapshots&gt;</span>
              <span class="tag">&lt;enabled&gt;</span>true<span class="tag">&lt;/enabled&gt;</span>
              <span class="tag">&lt;updatePolicy&gt;</span>never<span class="tag">&lt;/updatePolicy&gt;</span>
            <span class="tag">&lt;/snapshots&gt;</span>
          <span class="tag">&lt;/repository&gt;</span>
        <span class="tag">&lt;/repositories&gt;</span>
     <span class="tag">&lt;/profile&gt;</span>
  <span class="tag">&lt;/profiles&gt;</span>
  <span class="tag">&lt;activeProfiles&gt;</span>
    <span class="tag">&lt;activeProfile&gt;</span>jboss-public-repository<span class="tag">&lt;/activeProfile&gt;</span>
    <span class="tag">&lt;activeProfile&gt;</span>redhat-earlyaccess-repository<span class="tag">&lt;/activeProfile&gt;</span>
  <span class="tag">&lt;/activeProfiles&gt;</span>
<span class="tag">&lt;/settings&gt;</span></code></pre> </div> </div> <div class="sect3"> <h4 id="quick_command_reference"><a class="anchor" href="#quick_command_reference"></a>3.2.1. Quick command reference</h4> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> Maven places it&#8217;s output in <code>target/</code> </td> </tr> </table> </div> <table class="tableblock frame-all grid-all" style="width: 80%;"> <colgroup> <col style="width: 66.6666%;"> <col style="width: 33.3334%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Command</th> <th class="tableblock halign-left valign-top">Meaning</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn clean</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Cleans out any old builds and binaries</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn compile</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Compiles java source code</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn test</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Runs the TestNG unit test suite on the compiled code. Will also compile the tests. See the testing section below for more information on running different test groups. The default test group run is the "unit" group.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn package</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Packages the module as a JAR file, the resulting JAR file will be in target/</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn package -DskipTests</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Creates a JAR file without running tests</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn package -DskipTests -P minimal-distribution</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Creates a reduced version of the distribution with all modules,scripts&#8230;&#8203;etc but no javadoc or source code. This is very handy to quickly build the distribution in order to run some tests.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn install -DskipTests</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Installs the artifacts in your local repo for use by other projects/modules, including inter-module dependencies within the same project.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn install -P distribution</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">In addition to install, will also use Maven&#8217;s assembly plugin to build ZIP files for distribution (in target/distribution ). Contents of various distribution are controlled by the files in src/main/resources/assemblies .</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn deploy</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Builds and deploy the project to the JBoss snapshots repository.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn install -P-extras</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Avoids the extras profile disables the enforce plugin, generation of source jars and OSGI bundleconstruction, hence making builds run faster. Clearly, this option should not be used when making a release or publishing a snapshot.</p></td> </tr> </tbody> </table> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> For non-snapshot releases (e.g., alphas, betas, release candidates and final releases) you should use the <code>bin/release.py</code> script. </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="publishing_releases_to_maven"><a class="anchor" href="#publishing_releases_to_maven"></a>3.2.2. Publishing releases to Maven</h4> <div class="paragraph"> <p>To be able to publish releases to Maven, you need to have the following in your <code>settings.xml</code> file:</p> </div> <div class="listingblock"> <div class="title">settings.xml</div> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;settings&gt;</span>
  ...
  <span class="tag">&lt;servers&gt;</span>
    ...
    <span class="tag">&lt;server&gt;</span>
      <span class="tag">&lt;id&gt;</span>jboss-snapshots-repository<span class="tag">&lt;/id&gt;</span>
      <span class="tag">&lt;username&gt;</span>your JBoss.org username<span class="tag">&lt;/username&gt;</span>
      <span class="tag">&lt;password&gt;</span>your JBoss.org password<span class="tag">&lt;/password&gt;</span>

    <span class="tag">&lt;/server&gt;</span>
    <span class="tag">&lt;server&gt;</span>
      <span class="tag">&lt;id&gt;</span>jboss-releases-repository<span class="tag">&lt;/id&gt;</span>
      <span class="tag">&lt;username&gt;</span>your JBoss.org username<span class="tag">&lt;/username&gt;</span>
      <span class="tag">&lt;password&gt;</span>your JBoss.org password<span class="tag">&lt;/password&gt;</span>

    <span class="tag">&lt;/server&gt;</span>
    ...
  <span class="tag">&lt;/servers&gt;</span>
  ...
<span class="tag">&lt;/settings&gt;</span></code></pre> </div> </div> <div class="sect4"> <h5 id="publishing_snapshots"><a class="anchor" href="#publishing_snapshots"></a>Publishing snapshots</h5> <div class="paragraph"> <p>Simply running</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn clean deploy -DskipTests</pre> </div> </div> <div class="paragraph"> <p>in the Infinispan root directory will deploy a snapshot.</p> </div> </div> <div class="sect4"> <h5 id="publishing_releases"><a class="anchor" href="#publishing_releases"></a>Publishing releases</h5> <div class="paragraph"> <p>Use the <code>bin/release.py</code> script.</p> </div> </div> </div> <div class="sect3"> <h4 id="the_maven_archetypes"><a class="anchor" href="#the_maven_archetypes"></a>3.2.3. The Maven Archetypes</h4> <div class="paragraph"> <p>Infinispan currently has 2 separate Maven <a href="http://maven.apache.org/guides/introduction/introduction-to-archetypes.html">archetypes</a> you can use to create a skeleton project and get started using Infinispan. This is an easy way to get started using Infinispan as the archetype generates sample code, a sample Maven pom.xml with necessary dependencies, etc.</p> </div> <div class="paragraph"> <p>You don&#8217;t need to have any experience with or knowledge of Maven&#8217;s Archetypes to use this!  Just follow the simple steps below.</p> </div> <div class="sect4"> <h5 id="starting_a_new_project"><a class="anchor" href="#starting_a_new_project"></a>Starting a new project</h5> <div class="paragraph"> <p>Use the <code>newproject-archetype</code> project. The simple command below will get you started, and</p> </div> <div class="literalblock"> <div class="content"> <pre> $ mvn archetype:generate \
    -DarchetypeGroupId=org.infinispan.archetypes \
    -DarchetypeArtifactId=newproject-archetype \
    -DarchetypeVersion=1.0.5 \
    -DarchetypeRepository=http://repository.jboss.org/nexus/content/groups/public</pre> </div> </div> <div class="paragraph"> <p>You will be prompted for a few things, including the artifactId , groupId and version of your new project. And that&#8217;s it - you&#8217;re ready to go!</p> </div> <div class="sect5"> <h6 id="exploring_your_new_project"><a class="anchor" href="#exploring_your_new_project"></a>Exploring your new project</h6> <div class="paragraph"> <p>The skeleton project ships with a sample application class for interacting with Infinispan. You can open this new project in your IDE - most good IDEs such as IntelliJ and Eclipse allow you to import Maven projects, see <a href="https://www.jetbrains.com/idea/help/importing-project-from-maven-model.html">this guide</a> and <a href="http://m2eclipse.sonatype.org/">this guide</a>. Once you open your project in your IDE, you should examine the generated classes and read through the comments.</p> </div> </div> <div class="sect5"> <h6 id="on_the_command_line"><a class="anchor" href="#on_the_command_line"></a>On the command line&#8230;&#8203;</h6> <div class="paragraph"> <p>Try running</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn install -Prun</pre> </div> </div> <div class="paragraph"> <p>in your newly generated project. This runs the <code>main()</code> method in the generated application class.</p> </div> </div> </div> <div class="sect4"> <h5 id="writing_a_test_case_for_infinispan"><a class="anchor" href="#writing_a_test_case_for_infinispan"></a>Writing a test case for Infinispan</h5> <div class="paragraph"> <p>This archetype is useful if you wish to contribute a test to the Infinispan project and helps you get set up to use Infinispan&#8217;s testing harness and related tools. Use</p> </div> <div class="literalblock"> <div class="content"> <pre> $ mvn archetype:generate \
    -DarchetypeGroupId=org.infinispan.archetypes \
    -DarchetypeArtifactId=testcase-archetype \
    -DarchetypeVersion=1.0.5 \
    -DarchetypeRepository=http://repository.jboss.org/nexus/content/groups/public</pre> </div> </div> <div class="paragraph"> <p>As above, this will prompt you for project details and again as above, you should open this project in your IDE. Once you have done so, you will see some sample tests written for Infinispan making use of Infinispan&#8217;s test harness and testing tools along with extensive comments and links for further reading.</p> </div> <div class="sect5"> <h6 id="on_the_command_line_2"><a class="anchor" href="#on_the_command_line_2"></a>On the command line&#8230;&#8203;</h6> <div class="paragraph"> <p>Try running</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn test</pre> </div> </div> <div class="paragraph"> <p>in your newly generated project to run your tests. The generated project has a few different profiles you can use as well, using Maven&#8217;s -P flag. For example:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn test -Pudp</pre> </div> </div> </div> <div class="sect5"> <h6 id="available_profiles"><a class="anchor" href="#available_profiles"></a>Available profiles</h6> <div class="paragraph"> <p>The profiles available in the generated sample project are:</p> </div> <div class="ulist"> <ul> <li> <p>udp: use UDP for network communications rather than TCP</p> </li> <li> <p>tcp: use TCP for network communications rather than UDP</p> </li> <li> <p>jbosstm: Use the embedded <a href="http://www.jboss.org/jbosstm">JBoss Transaction Manager</a> rather than Infinispan&#8217;s embedded transaction manager</p> </li> </ul> </div> </div> </div> <div class="sect4"> <h5 id="contributing_tests_back_to_infinispan"><a class="anchor" href="#contributing_tests_back_to_infinispan"></a>Contributing tests back to Infinispan</h5> <div class="paragraph"> <p>If you have written a functional, unit or stress test for Infinispan and want to contribute this back to Infinispan, your best bet is to <a href="https://github.com/infinispan/infinispan">fork the Infinispan sources on GitHub</a>. The test you would have prototyped and tested in an isolated project created using this archetype can be simply dropped in to Infinispan&#8217;s test suite. Make your changes, add your test, prove that it fails even on Infinispan&#8217;s upstream source tree and issue a <a href="http://help.github.com/pull-requests/">pull request</a> .</p> </div> </div> <div class="sect4"> <h5 id="checking_coding_style"><a class="anchor" href="#checking_coding_style"></a>Checking coding style</h5> <div class="paragraph"> <p>If you have written any new code, it is highly recommended to validate formatting before submitting a Pull Request. This might be done by invoking:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn checkstyle:check</pre> </div> </div> </div> <div class="sect4"> <h5 id="versions"><a class="anchor" href="#versions"></a>Versions</h5> <div class="paragraph"> <p>The archetypes generate poms with dependencies to specific versions of Infinispan. You should edit these generated poms by hand to point to other versions of Infinispan that you are interested in.</p> </div> </div> <div class="sect4"> <h5 id="source_code"><a class="anchor" href="#source_code"></a>Source Code</h5> <div class="paragraph"> <p>The source code used to generate these archetypes are <a href="https://github.com/infinispan/infinispan-archetypes">on GitHub</a>. If you wish to enhance and contribute back to the project, fork away!</p> </div> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="api_commons_and_core"><a class="anchor" href="#api_commons_and_core"></a>4. API, Commons and Core</h2> <div class="sectionbody"> <div class="paragraph"> <p>In order to provide proper separation between public APIs, common utilities and the actual implementation of Infinispan, these are split into 3 Maven modules: <code>infinispan-api</code>, <code>infinispan-commons</code> and <code>infinispan-core</code>. This separation also makes sure that modules, such as the remote clients, don&#8217;t have to depend on infinispan-core and its transitive dependencies. The following paragraphs describe the role of each of these modules and give indication as to what goes where.</p> </div> <div class="sect2"> <h3 id="api"><a class="anchor" href="#api"></a>4.1. API</h3> <div class="paragraph"> <p>The <code>infinispan-api</code> module should only contain the public interfaces which can be used in any context (local, remote, etc). Any additions and/or modifications to this module <em>must</em> be discussed and approved by the core team beforehand. Ideally it should not contain any concrete classes: rare exceptions may be made for small, self-contained classes which need to be referenced from the API interfaces and for which the introduction of an interface would be deemed cumbersome.</p> </div> </div> <div class="sect2"> <h3 id="commons"><a class="anchor" href="#commons"></a>4.2. Commons</h3> <div class="paragraph"> <p>The <code>infinispan-commons</code> module contains utility classes which can be reused across other modules. Classes in infinispan-commons should be self-contained and not pull in any dependencies (apart from the existing <code>jboss-logging</code> and <code>infinispan-api</code>). They should also make no reference to configuration aspects specific to a particular environment.</p> </div> </div> <div class="sect2"> <h3 id="core"><a class="anchor" href="#core"></a>4.3. Core</h3> <div class="paragraph"> <p>The <code>infinispan-core</code> module contains the actual implementation used for local/embedded mode. When adding new functionality to the APIs, it is generally safe to start by putting them in <code>infinispan-core</code> and promoting them to <code>infinispan-api</code> only when it is deemed mature enough to do so and it makes sense across the various use-cases.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="running_and_writing_tests"><a class="anchor" href="#running_and_writing_tests"></a>5. Running and Writing Tests</h2> <div class="sectionbody"> <div class="paragraph"> <p>Tests are written using the <a href="http://testng.org/">TestNG</a> framework.</p> </div> <div class="sect2"> <h3 id="running_the_tests"><a class="anchor" href="#running_the_tests"></a>5.1. Running the tests</h3> <div class="paragraph"> <p>The default run executes all tests in the functional, unit, xsite, and arquillian groups. To just run the tests with txt and xml output the command is:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn test</pre> </div> </div> <div class="paragraph"> <p>Alternatively, you can execute the tests <em>and</em> generate a report with:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn surefire-report:report</pre> </div> </div> <div class="paragraph"> <p>If you are running the tests on a Unix-like operating system, the default limits per user are typically low. The Infinispan test suite creates a lot of processes/threads, thus you will have to increase your user&#8217;s limits and reboot the system to pick up the new values. Open up <code>/etc/security/limits.conf</code> and add the following lines replacing the user name with your username.</p> </div> <div class="listingblock"> <div class="title">/etc/security/limits.conf</div> <div class="content"> <pre> rhusar    soft    nofile    16384
 rhusar    hard    nofile    16384
 rhusar    soft    nproc     16384
 rhusar    hard    nproc     16384</pre> </div> </div> <div class="paragraph"> <p>We recommend running the tests on a machine with at least 4GB of RAM. Tests run in a forked JVM, so <code>MAVEN_OPTS</code> does not affect them. However, you may need to reduce the Maven JVM&#8217;s heap to run in 4GB of RAM by updating the <code>MAVEN_OPTS</code> environment variable, e.g.</p> </div> <div class="literalblock"> <div class="content"> <pre>$ export MAVEN_OPTS="-Xmx800m"</pre> </div> </div> <div class="sect3"> <h4 id="specifying_which_tests_to_run"><a class="anchor" href="#specifying_which_tests_to_run"></a>5.1.1. Specifying which tests to run</h4> <div class="paragraph"> <p>A single test can be executed using the test property. The value is the short name (not the fully qualified package name) of the test. For example:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn -Dtest=FqnTest test</pre> </div> </div> <div class="paragraph"> <p>Alternatively, if there is more than one test with a given classname in your test suite, you could provide the path to the test.</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn -Dtest=org/infinispan/api/MixedModeTest test</pre> </div> </div> <div class="paragraph"> <p>Patterns are also supported:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn -Dtest=org/infinispan/api/* test</pre> </div> </div> <div class="paragraph"> <p>Also, you can always pass your own Log4j configuration file via <code>-Dlog4.configuration</code> with your own logging settings.</p> </div> </div> <div class="sect3"> <h4 id="skipping_the_test_run"><a class="anchor" href="#skipping_the_test_run"></a>5.1.2. Skipping the test run</h4> <div class="paragraph"> <p>It is sometimes desirable to install the Infinispan package in your local repository without performing a full test run. To do this, simply use the <code>skipTests</code> property:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn -DskipTests install</pre> </div> </div> <div class="paragraph"> <p>Note that you should <em>never</em> use <code>-Dmaven.test.skip=true</code> since modules' test classes depend on other module test classes, and this will cause compilation errors.</p> </div> </div> <div class="sect3"> <h4 id="debugging_thread_leaks"><a class="anchor" href="#debugging_thread_leaks"></a>5.1.3. Debugging thread leaks</h4> <div class="paragraph"> <p>The Infinispan test suite uses TestNG/JUnit test listeners to find and report thread leaks. In order to debug thread leaks in the IDE, please add this listener to your default TestNG run configuration:</p> </div> <div class="literalblock"> <div class="content"> <pre>org.infinispan.commons.test.TestNGTestListener</pre> </div> </div> <div class="paragraph"> <p>If your IDE supports listeners in the JUnit run configuration (IntelliJ IDEA does not), add this listener:</p> </div> <div class="literalblock"> <div class="content"> <pre>org.infinispan.commons.test.JUnitTestListener</pre> </div> </div> <div class="paragraph"> <p>If your IDE does not support listeners in the JUnit run configuration, you can always add the listener to your class:</p> </div> <div class="literalblock"> <div class="content"> <pre>@Listeners(org.infinispan.commons.test.JUnitTestListener.class)</pre> </div> </div> <div class="paragraph"> <p>In order to make the leak report look like a test failure, modules using TestNG duplicate the check in a test, <code>TestNGSuiteChecksTest</code>. Including the test is not required to see the leak, but without it the failure looks more like a crash.</p> </div> </div> <div class="sect3"> <h4 id="running_tests_using_parameters"><a class="anchor" href="#running_tests_using_parameters"></a>5.1.4. Running tests using <code>@Parameters</code></h4> <div class="paragraph"> <p>If you want to execute tests relying on TestNG&#8217;s <code>@Parameters</code> from an IDE (such as Eclipse or IntelliJ IDEA), please read <a href="http://infinispan.blogspot.com/2009/06/executing-testng-tests-relying-on.html">this blog entry</a> .</p> </div> </div> <div class="sect3"> <h4 id="enabling_trace_in_test_logs"><a class="anchor" href="#enabling_trace_in_test_logs"></a>5.1.5. Enabling TRACE in test logs</h4> <div class="paragraph"> <p>When you run tests, you can get TRACE logging via using the <code>traceTests</code> profile</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn test -PtraceTests</pre> </div> </div> <div class="paragraph"> <p>ecuting this will generate a GZIP file called <code>trace-infinispan.log.gz</code>. This file is not fully closed, so to extract the log file, execute:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ gunzip -c trace-infinispan.log.gz &gt; trace-infinispan.log</pre> </div> </div> </div> <div class="sect3"> <h4 id="running_tests_with_jdk_8"><a class="anchor" href="#running_tests_with_jdk_8"></a>5.1.6. Running tests with JDK 8</h4> <div class="paragraph"> <p>While building requires at least JDK 11, the testsuite can be run with JDK 8. In order to do so, you should set the <code>JAVA8_HOME</code> environment variable to point to your JDK 8 installation, e.g.:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ export JAVA8_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64</pre> </div> </div> <div class="paragraph"> <p>And enable the <code>java8-test</code> maven profile:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn -Pjava8-test test</pre> </div> </div> </div> <div class="sect3"> <h4 id="enabling_code_coverage_generation"><a class="anchor" href="#enabling_code_coverage_generation"></a>5.1.7. Enabling code coverage generation</h4> <div class="paragraph"> <p>When you run tests, you can enable code coverage recorder for calculating and analysing the Infinispan code coverage. You can do this using <code>coverage</code> and <code>jacocoReport</code> profiles. As a code coverage evaluation tool, the JaCoCo is used.</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn test -Pcoverage -Dmaven.test.failure.ignore=true</pre> </div> </div> <div class="paragraph"> <p>Please note, that <code>-Dmaven.test.failure.ignore=true</code> is used for generating JaCoCo code coverage report, even if there are test failures.</p> </div> <div class="paragraph"> <p>Executing this will generate <code>jacoco.exec</code> file in each module&#8217;s <code>target/</code> directory. These are the JaCoCo execution data files, which contain full data about the specific module&#8217;s coverage.</p> </div> <div class="paragraph"> <p>As soon as the coverage execution command is finished, you will need to generate the JaCoCo report, which will merge the generated <code>jacoco.exec</code> files as well as will create the code coverage report.</p> </div> <div class="paragraph"> <p>For having the report in place, run the following command from your Infinispan home directory:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn install -pl parent -PjacocoReport</pre> </div> </div> <div class="paragraph"> <p>The <code>jacoco-html/</code> directory will be generated in Infinispan Home directory, which will contain the code coverage report.</p> </div> </div> </div> <div class="sect2"> <h3 id="test_groups"><a class="anchor" href="#test_groups"></a>5.2. Test groups</h3> <div class="paragraph"> <p>Each test should belong to one or more group. The group acts as a filter, and is used to select which tests are ran as part of the maven test lifecycle.</p> </div> <div class="sect3"> <h4 id="which_group_should_i_use"><a class="anchor" href="#which_group_should_i_use"></a>5.2.1. Which group should I use?</h4> <div class="paragraph"> <p>The following test groups are used by Infinispan.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> If your test does not fit into one of these groups, a new group should be added. </td> </tr> </table> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Test Group</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>unit</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Unit tests using stubs to isolate and test each major class in Infinispan. This is the default group run if no test group is specified</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>functional</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Tests which test the general functionality of Infinispan</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>jgroups</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Tests which need to send data on a JGroups Channel</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>transaction</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Tests which use a transaction manager</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>profiling</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Tests used for manual profiling, not meant for automated test runs</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>manual</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Other tests that are run manually</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Every test (except those not intended to be run by continuous integration) should at least be in the <strong>functional</strong> or <strong>unit</strong> groups, since these are the default test groups executed by Maven, and are run when preparing a release.</p> </div> </div> </div> <div class="sect2"> <h3 id="test_permutations"><a class="anchor" href="#test_permutations"></a>5.3. Test permutations</h3> <div class="paragraph"> <p>We use the term permutation to describe a test suite execution against a particular configuration. This allows us to test a variety of environments and configurations without rewriting the same basic test over and over again. For example, if we pass JVM parameter <code>-Dinfinispan.cluster.stack=udp</code> test suite is executed using UDP config.</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn -Dinfinispan.cluster.stack=udp test</pre> </div> </div> <div class="paragraph"> <p>Each permutation uses its own report directory, and its own html output file name. This allows you to execute multiple permutations without wiping the results from the previous run. Note that due to the way Maven operates, only one permutation can be executed per <code>mvn</code> invocation. So automating multiple runs requires shell scripting, or some other execution framework to make multiple calls to Maven.</p> </div> <div class="sect3"> <h4 id="running_permutations_manually_or_in_an_ide"><a class="anchor" href="#running_permutations_manually_or_in_an_ide"></a>5.3.1. Running permutations manually or in an IDE</h4> <div class="paragraph"> <p>Sometimes you want to run a test using settings other than the defaults (such as UDP for <code>jgroups</code> group tests or the EmbeddedTransactionManager for <code>transaction</code> group tests). This can be achieved by referring to the Maven POM file to figure out which system properties are passed in to the test when doing something different. For example to run a <code>jgroups</code> group test in your IDE using TCP instead of the default UDP, set <code>-Dinfinispan.cluster.stack=tcp</code>. Or, to use JBoss JTA (Arjuna TM) instead of the EmbeddedTransactionManager in a <code>transaction</code> group test, set <code>-Dinfinispan.test.jta.tm=jbosstm</code>. Please refer to the POM file for more properties and permutations.</p> </div> </div> </div> <div class="sect2"> <h3 id="the_parallel_test_suite"><a class="anchor" href="#the_parallel_test_suite"></a>5.4. The Parallel Test Suite</h3> <div class="paragraph"> <p>Infinispan runs its unit test suite in parallel; Infinispan tests are often IO rather than processor bound, so executing them in parallel offers significant speed up in executing the entire test suite.</p> </div> <div class="sect3"> <h4 id="tips_for_writing_and_debugging_parallel_tests"><a class="anchor" href="#tips_for_writing_and_debugging_parallel_tests"></a>5.4.1. Tips for writing and debugging parallel tests</h4> <div class="paragraph"> <p>There are a number of constraints and best practices that need to be followed in order to ensure correctness and keep the execution time to a minimum. If you follow these guidelines you will find your tests are more reliable:</p> </div> <div class="ulist"> <ul> <li> <p><em>Each test class is run in a single thread</em> There is no need to synchronize unit test&#8217;s fixture, as test methods will be run in sequence. However, multiple test classes are executed in parallel.</p> </li> <li> <p><em>Each test class must have an unique test name</em> As a convention, the name of the test should be the fully qualified class name of the test class with the <code>org.infinispan</code> prefix removed. For example, given a test class <code>org.infinispan.mypackage.MyTest</code> the name of the test should be <code>mypackage.MyTest</code>. This convention guarantees a unique name.</p> </li> </ul> </div> <div class="listingblock"> <div class="title">MyTest.java</div> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.infinispan.mypackage</span>;
<span class="annotation">@Test</span> (testName = <span class="string"><span class="delimiter">&quot;</span><span class="content">mypackage.MyTest</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyTest</span> { ... }</code></pre> </div> </div> <div class="ulist"> <ul> <li> <p>Use <code>TestCacheManagerFactory.createXyzCacheManager</code> and <strong>never</strong> create managers using <code>new DefaultCacheManager()</code>. This ensures that there are no conflicts on resources e.g. a cluster created by one test won&#8217;t interfere with a cluster created by another test.</p> </li> <li> <p>Where possible, extend <code>SingleCacheManagerTestorMultipleCacheManagersTest</code>. Tests inheriting from these template method classes will only create a cache/cluster once for all the test methods, rather than before each method. This helps keep the execution time down.</p> </li> <li> <p><strong>Never</strong> rely on <code>Thread.sleep()</code>. When running in heavily threaded environments this will most often not work. For example, if using ASYNC_REPL , don&#8217;t use a <code>sleep(someValue)</code> and expect the data will be replicated to another cache instance after this delay has elapsed. Instead, use a ReplicationListener (look up javadocs for more information on this class). Generally speaking, if you expect something will happen and you don&#8217;t have a guarantee when, a good approach is to try that expectation in a loop, several times, with an generous (5-10secs) timeout. For example:</p> </li> </ul> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">while</span> (Systet.currentTimeMillis() - startTime &lt; timeout) {
   <span class="keyword">if</span> (conditionMeet()) <span class="keyword">break</span>;
<span class="error"> </span><span class="error"> </span><span class="error"> </span><span class="predefined-type">Thread</span>.sleep(<span class="integer">50</span>);
}</code></pre> </div> </div> <div class="ulist"> <ul> <li> <p><code>Thread.sleep(10)</code> may not work in certain OS/JRE combos (e.g. Windows XP/Sun JRE 1.5). Use values grater than 10 for these statements, e.g. 50. Otherwise, a <code>System.currentTimeMillis()</code> might return same value when called before and after such a sleep statement.</p> </li> <li> <p>For each cache that is create with <code>TestCacheManagerFactory.createXyzCacheManager()</code> the test harness will allocate a unique JMX domain name which can be obtained through <code>CacheManager.getJmxDomain()</code>. This ensures that no JMX collisions will takes place between any tests executed in parallel. If you want to enforce a JMX domain name, this can be done by using one of the <code>TestCacheManagerFactory.createCacheManagerEnforceJmxDomain</code> methods. These methods must be used with care, and you are responsible for ensuring no domain name collisions happen when the parallel suite is executed.</p> </li> <li> <p>Use obscure words. Insert uncommon or obscure words into the cache that has been generated with a random word generator. In a multi-threaded environment like Infinispan&#8217;s testsuite, grepping for these words can greatly help the debugging process. You may find <a href="http://watchout4snakes.com/creativitytools/RandomWord/RandomWordPlus.aspx">this random word generator</a> useful.</p> </li> <li> <p>Use the test method name as the key. Grab the test method and use it as part of the cached key. You can dynamically grab the test method using code like this:</p> <div class="literalblock"> <div class="content"> <pre>Thread.currentThread().getStackTrace()(1).getMethodName()</pre> </div> </div> </li> </ul> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> Even though we&#8217;ve tried to reduce them to a minimum, intermittent failures might still appear from time to time. If you see such failures <em>in existing code</em> please report them in the issue tracker. </td> </tr> </table> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="helping_others_out"><a class="anchor" href="#helping_others_out"></a>6. Helping Others Out</h2> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan is reliant on the whole community helping each other out. Less experienced contributors are often able to help out answering the "newbie" questions, leaving more experienced contributors to handle the more complex questions.</p> </div> <div class="paragraph"> <p>Users are encouraged to follow the <a href="http://community.jboss.org/wiki/HowToAskAForumQuestion">How to ask a forum question</a> guide.</p> </div> <div class="paragraph"> <p>Forum discussions should be posed as questions (we encourage people to do this). Questions can be marked as answered, indicating to the community that they no longer require answering, allowing easy tracking of open questions. Open questions can <a href="http://community.jboss.org/en/infinispan?view=discussions#/?filter=open">be easily viewed using this filter</a>. Community members are encouraged to regularly view the open questions and answer any questions they can.</p> </div> <div class="paragraph"> <p>In order to track what questions are still open, you are encouraged to mark questions as "assumed answered" if you provide information that you think resolves the query and you don&#8217;t hear back to the contrary after a week or so.</p> </div> <div class="paragraph"> <p>Approximately every month, a member of the Infinispan team will go through any open questions for the past month and clear up any unanswered questions, either by chasing for an answer from core team, or by checking with the user if they require more info.</p> </div> </div> </div> <div class="sect1"> <h2 id="adding_configuration"><a class="anchor" href="#adding_configuration"></a>7. Adding Configuration</h2> <div class="sectionbody"> <div class="admonitionblock warning"> <table> <tr> <td class="icon"> <i class="fa icon-warning" title="Warning"></i> </td> <td class="content"> We still use the old configuration system internally within Infinispan. This makes things a little complicated. This will be switched out soon! For now, you need to also add your property to the old config system as well as the new. </td> </tr> </table> </div> <div class="paragraph"> <p>Note, these guides assume you are adding an element to the cache configuration, but apply equally to the global configuration.</p> </div> <div class="paragraph"> <p>Before you start adding a configuration property, identify whether you want to add a property to an existing configuration group/element, or whether you need to create a child object. We call the configuration group XXX in the steps below.</p> </div> <div class="sect2"> <h3 id="adding_a_property"><a class="anchor" href="#adding_a_property"></a>7.1. Adding a property</h3> <div class="olist arabic"> <ol class="arabic"> <li> <p>Add the property to the relevant XXXConfiguration class. Add a private final field, add a parameter to the constructor, and assign the value to the field in the constructor body. Add a accessor for the property. If the property should be mutable at runtime, then add a mutator as well. Most configuration properties are not mutable at runtime - if the configuration is runtime mutable, then Infinispan needs to take notice of this update whilst the cache is running (you can&#8217;t cache the value of the configuration in your implementation class). Mutators and accessors don&#8217;t use the classic JavaBean pattern of prepending accessors with "get" and mutators with "set". Instead, the name of the property is used for an accessor. A mutator is an overloaded version of the accessor which takes a parameter, the new value.</p> </li> <li> <p>Add the property to the matching XXXConfigurationBuilder. You&#8217;ll need to add a mutable field to the class, and initialise it to it&#8217;s default value in the field declaration. Add a mutator (following the above pattern).</p> </li> <li> <p>The <code>create()</code> method is called by the parent object in order to instantiate the XXXConfiguration object from the builder. Therefore, make sure to pass the value of the field in the builder to the XXXConfiguration object&#8217;s constructor here. Additionally, if you require a complex default (for example, the value of a configuration property is defaulted conditionally based on the value of some other configuration property), then this is the place to do this.</p> </li> <li> <p>The <code>validate()</code> method is called by the parent object to validate the values the user has passed in. This method may also be called directly by user code, should they wish to manually validate a configuration object. You should place any validation logic here related to your configuration property. If you need to "cross-validate" properties (validate the value of your property conditionally upon the value of another property), and the other property is on another builder object, increase the visibility of that other property field to "default", and reference it from this builder, by calling the <code>getBuilder()</code> method, which will gives you a handle on the root configuration builder.</p> </li> <li> <p>The final step is to add parsing logic to the <code>Parser</code> class. First, add the attribute to name to the <code>Attribute</code> enum (this class simply provides a mapping between the non-type-safe name of the attribute in XML and a type-safe reference to use in the parser). Locate the relevant <code>parseXXX()</code> method on the class, and add a case to the switch statement for the attribute. Call the builder mutator you created above, performing any XML related validation (you are unlikely to need this), and type conversion (using the static methods on the primitive wrapper classes, String class, or relevant enum class).</p> </li> </ol> </div> </div> <div class="sect2"> <h3 id="adding_a_group"><a class="anchor" href="#adding_a_group"></a>7.2. Adding a group</h3> <div class="paragraph"> <p>In some situations you may additionally want to add a configuration grouping object, represented in XML as an element. You might want to do this if you are adding a new area of functionality to Infinispan. Identify the location of the new configuration grouping object. It might be added to the root Configuration object, or it might be added to one it&#8217;s children, children&#8217;s children. We&#8217;ll call the parent YYY in the steps below. Create the XXXConfiguration object. Add any properties required following the guide for adding properties. The constructors visibility should be "default".</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Create the XXXConfigurationBuilder object. It should subclass the relevant configuration child builder – use the YYYConfigurationChildBuilder as the superclass. This will ensure that all builder methods that allow the user to "escape" are provided correctly (i.e provide access to other grouping elements), and also require you to provide a <code>create()</code> and <code>validate()</code> method. The constructor needs to take the the YYYConfigurationBuilder as an argument, and pass this to the superclass (this simply allows access to the root of the builder tree using the <code>getBuilder()</code> method).</p> </li> <li> <p>Follow the property adding guide to add any properties you need to the builder. The <code>create()</code> method needs to return a new instance of the XXXConfiguration object. Implement any validation needed in the <code>validate()</code> method.</p> </li> <li> <p>In the YYYConfiguration object, add your new configuration class as a private final field, add an accessor, and add initialiser assignment in the constructor</p> </li> </ol> </div> <div class="paragraph"> <p>` In the YYYConfigurationBuilder, add your new configuration builder as a private final field, and initialise it in the constructor with a new instance. Finally, add an accessor for it following the standard pattern discussed in the guide.</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>In the YYYConfigurationBuilder ensure that your validate method is called in it&#8217;s validate method, and that result of the XXXConfiguration instances' create method is passed to the constructor of YYYConfiguration.</p> </li> <li> <p>Finally, add this to the parser. First, add the element to the <code>Element</code> class, which provides a type safe representation of the element name in XML. In the <code>Parser</code> class, add a new <code>parseXXX</code> method, copying one of the others that most matches your requirements (parse methods either parse elements only - look for <code>ParseUtils.requireNoAttributes()</code>, attributes only – look for <code>ParseUtils.requireNoContent()</code> or a combination of both – look for an iterator over both elements and attributes). Add any attributes as discussed in the adding a property guide. Finally, wire this in by locating the <code>parseYYY()</code> method, and adding an element to the switch statement, that calls your new <code>parseXXX()</code> method.</p> </li> </ol> </div> </div> <div class="sect2"> <h3 id="dont_forget_to_update_the_xsd_and_xsd_test"><a class="anchor" href="#dont_forget_to_update_the_xsd_and_xsd_test"></a>7.3. Don&#8217;t forget to update the XSD and XSD test</h3> <div class="olist arabic"> <ol class="arabic"> <li> <p>Add your new elements or attributes to the XSD in <code>src/main/resources</code>.</p> </li> <li> <p>Update <code>src/test/resources/configs/all.xml</code> to include your new elements or attributes.</p> </li> </ol> </div> </div> <div class="sect2"> <h3 id="bridging_to_the_old_configuration"><a class="anchor" href="#bridging_to_the_old_configuration"></a>7.4. Bridging to the old configuration</h3> <div class="paragraph"> <p>Until we entirely swap out the old configuration you will need to add your property to the old configuration (no need to worry about JAXB mappings though!), and then add some code to the <code>LegacyConfigurationAdaptor</code> to adapt both ways. It&#8217;s fairly straightforward, just locate the relevant point in the <code>adapt()</code> method (near the configuration group you are using) and map from the legacy configuration to the new configuration, or vs versa. You will need to map both ways, in both adapt methods.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="documentation_guidelines"><a class="anchor" href="#documentation_guidelines"></a>8. Documentation Guidelines</h2> <div class="sectionbody"> <div class="paragraph"> <p>Welcome to Infinispan documentation. This is a place where anyone can contribute and share their knowledge.</p> </div> <div class="sect2"> <h3 id="documentation_guidelines_source_files"><a class="anchor" href="#documentation_guidelines_source_files"></a>8.1. Working with Documentation Source Files</h3> <div class="paragraph"> <p>All you need to do is fork Infinispan to edit the documentation source files. You can then submit your changes in a <em>pull request</em> as you would any other contribution to the project.</p> </div> <div class="paragraph"> <p>See the <code>README</code> file in the <em>documentation/src/main/asciidoc</em> directory for information on what you need to edit and build the documentation.</p> </div> </div> <div class="sect2"> <h3 id="documentation_guidelines_style_guide"><a class="anchor" href="#documentation_guidelines_style_guide"></a>8.2. Style Guide</h3> <div class="paragraph"> <p>Infinispan is the community project on which Red Hat Data Grid is based. For this reason, we follow <a href="https://redhat-documentation.github.io/">Guidelines for Red Hat Documentation</a>.</p> </div> <div class="paragraph"> <p>The <a href="http://asciidoctor.org/docs/asciidoc-writers-guide/">AsciiDoctor Writer&#8217;s Guide</a> also has some excellent resources on writing effective documentation.</p> </div> </div> <div class="sect2"> <h3 id="documentation_guidelines_format_reference"><a class="anchor" href="#documentation_guidelines_format_reference"></a>8.3. AsciiDoc Format Reference</h3> <div class="paragraph"> <p>Tips for which AsciiDoc markup to use when formatting text.</p> </div> <div class="dlist"> <dl> <dt class="hdlist1">Monospace (<code>`</code>)</dt> </dl> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Item</th> <th class="tableblock halign-left valign-top">Example</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">File names and paths</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The `/home/user/.bashrc` file &#8230;&#8203;</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Literal values</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If the value is `true` &#8230;&#8203;</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Configuration attributes</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Set the `enabled` attribute &#8230;&#8203;</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Java class names</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The `java.sql.Connection` class &#8230;&#8203;</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Java annotations</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The `@Clustered` annotation &#8230;&#8203;</p></td> </tr> </tbody> </table> <div class="dlist"> <dl> <dt class="hdlist1">Italics (<code>_</code>)</dt> </dl> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Item</th> <th class="tableblock halign-left valign-top">Example</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Guide titles</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">See the _Installation Guide_ &#8230;&#8203;</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Emphasis <em>(first occurrence of the term only)</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">_High availability_ refers to the &#8230;&#8203;</p></td> </tr> </tbody> </table> <div class="dlist"> <dl> <dt class="hdlist1">Bold (<code>*</code>)</dt> </dl> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Item</th> <th class="tableblock halign-left valign-top">Example</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">GUI items <em>(menus, buttons)</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Click the *Add* button and &#8230;&#8203;</p></td> </tr> </tbody> </table> <div class="dlist"> <dl> <dt class="hdlist1">Underline (<code><span class="underline">value</span></code>)</dt> </dl> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Item</th> <th class="tableblock halign-left valign-top">Example</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Default item in a multi-select</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">`yes\[.underline]#no#\maybe`</p></td> </tr> </tbody> </table> </div> <div class="sect2"> <h3 id="documentation_guidelines_general"><a class="anchor" href="#documentation_guidelines_general"></a>8.4. General Guidelines</h3> <div class="ulist"> <ul> <li> <p>Always use <code>{brandname}</code> to refer to the product. Never abbreviate the product name to something like "ISPN".</p> </li> <li> <p>Prefer active voice to passive voice.</p> </li> <li> <p>Use the second or third person, but never the first. Prefer second person singular to address the user directly.</p> </li> <li> <p>Always use the present tense. There are instances where future tense makes sense but do not mix tenses. Never use the past tense.</p> </li> <li> <p>Use American English spelling conventions.</p> </li> <li> <p>Avoid contractions. Use "do not" instead of "don&#8217;t".</p> </li> <li> <p>Terminate bulleted and numbered lists with periods (.) except for simple name lists.</p> </li> <li> <p>Avoid the word "simply" unless it clarifies.</p> </li> <li> <p>For substitution of <code>{attr}</code> in code blocks, use <code>[subs=+attributes]</code>.</p> </li> <li> <p>For styling of <code>*bold*</code> (<code><strong>bold</strong></code>) in code blocks, use <code>[subs=+quotes]</code>.</p> </li> <li> <p>Never use colloquialisms or slang in documentation.</p> </li> </ul> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 33.3333%;"> <col style="width: 33.3333%;"> <col style="width: 33.3334%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Item</th> <th class="tableblock halign-left valign-top">Use</th> <th class="tableblock halign-left valign-top">Do Not Use</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Root commands</p></td> <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"> <p>$ sudo</p> </div></div></td> <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"> <p>#</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Emphasis</p></td> <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"> <p>_yay_</p> </div></div></td> <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"> <p>*yay*</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Decimal integers &lt; 10</p></td> <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"> <p>four</p> </div></div></td> <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"> <p>4</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Decimal integers &gt;= 10</p></td> <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"> <p>12</p> </div></div></td> <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"> <p>twelve</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Hexadecimal integers (<em>always numeric, lowercase x</em>)</p></td> <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"> <p>0x123</p> </div></div></td> <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"> <p>0X13</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Number ranges (<em>always use numerals</em>)</p></td> <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"> <p>1-20</p> </div></div></td> <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"> <p>1-twenty</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Avoid Latin abbreviations</p></td> <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"> <p>that is</p> </div></div></td> <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"> <p>i.e.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">and so on</p></td> <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"> <p>etc.</p> </div></div></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">for example</p></td> <td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"> <p>e.g.</p> </div></div></td> </tr> </tbody> </table> <div class="dlist"> <dl> <dt class="hdlist1">Characters Per Line</dt> <dd> <p>Use a soft limit of 80 characters per line. This makes it easier to see changes in GitHub diffs, which are about 90 characters long.</p> </dd> <dt class="hdlist1">Asciidoc End of File</dt> <dd> <p>To avoid formatting issues, end <code>adoc</code> files with two empty lines.</p> </dd> <dt class="hdlist1">Notes and Admonitions</dt> <dd> <p>Encapsulate notes, tips, and warnings in brackets. Surround the text in four equals characters, as follows:</p> <div class="listingblock"> <div class="content"> <pre>[NOTE]
====
This is a note that you should read.
====</pre> </div> </div> </dd> </dl> </div> </div> <div class="sect2"> <h3 id="documentation_guidelines_section_ids"><a class="anchor" href="#documentation_guidelines_section_ids"></a>8.5. Section IDs</h3> <div class="paragraph"> <p>When creating anchors for section IDs, use the following format:</p> </div> <div class="paragraph"> <p><code>[[anchor_name]]</code></p> </div> <div class="paragraph"> <p>You should always use underscores (_) to delimit anchors. Do not use other characters such as dashes (-) or periods (.) to avoid issues at build time.</p> </div> <div class="paragraph"> <p>To create anchors for reusable content, use this format:</p> </div> <div class="paragraph"> <p><code>[id="same-as-section-heading-{context}"]</code></p> </div> <div class="paragraph"> <p>Learn more about content reuse in the <a href="https://redhat-documentation.github.io/modular-docs/#reusing-modules">Modular Documentation Reference Guide</a>.</p> </div> </div> <div class="sect2"> <h3 id="documentation_guidelines_xrefs"><a class="anchor" href="#documentation_guidelines_xrefs"></a>8.6. Cross References</h3> <div class="paragraph"> <p>To reference a section within the same book, use <code>link:#</code>:</p> </div> <div class="paragraph"> <p><code>link:#anchor_name[Link Text]</code></p> </div> </div> <div class="sect2"> <h3 id="documentation_guidelines_images"><a class="anchor" href="#documentation_guidelines_images"></a>8.7. Diagrams, Screenshots, and Other Media</h3> <div class="ulist"> <ul> <li> <p>Images should be saved as <strong>PNG</strong> or <strong>JPG</strong>, with a width of at least <strong>660 px</strong>, at <strong>110 dpi</strong>. Try to keep file size less than <strong>300 KB</strong>.</p> </li> <li> <p>Screenshots supplement the text, not replace it. <strong>Do not use images as the sole means to convey information or context</strong>.</p> </li> <li> <p><strong>Do not include any test or pre-release labels</strong>.</p> </li> <li> <p><strong>Do not include any personally identifying information</strong>.</p> </li> <li> <p>Capture just the part of the screen or window that users must focus on; <strong>do not include window headers in the final screenshots unless completely necessary</strong>.</p> </li> <li> <p>Crop screenshots to <strong>condense important information</strong> and limit empty GUI space and other inconsequential parts.</p> </li> <li> <p>All information in an image must be available in an alternative text format for accessibility (Section 508).</p> </li> <li> <p>Save all images under <code>documentation/src/main/asciidoc/${your_document}/images</code></p> </li> </ul> </div> <div class="sect3"> <h4 id="documentation_guidelines_images_include"><a class="anchor" href="#documentation_guidelines_images_include"></a>8.7.1. Including Images</h4> <div class="paragraph"> <p>Insert images using the <code>image::</code> or <code>image:</code> directive.</p> </div> <div class="ulist"> <ul> <li> <p>Example 1: Image title in title case (which automatically appends a Figure #).</p> <div class="listingblock"> <div class="content"> <pre>.Image Title
image::icon.png[Alt text, 50, 50]</pre> </div> </div> </li> <li> <p>Example 2: Inline image. Note, there is only one colon (:) used here.</p> <div class="listingblock"> <div class="content"> <pre>This is an inline image. image:icon.png[Alt text] Cool!</pre> </div> </div> </li> </ul> </div> </div> </div> <div class="sect2"> <h3 id="documentation_guidelines_code_blocks"><a class="anchor" href="#documentation_guidelines_code_blocks"></a>8.8. Code Samples</h3> <div class="paragraph"> <p>Include code samples in blocks such as the following:</p> </div> <div class="listingblock"> <div class="content"> <pre>  [source,java,options="nowrap"]
  .MyClass.java
  ----
  //some Java code
  ----</pre> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> <div class="paragraph"> <p>Include code samples that demonstrate an idea. To share reusable blocks of code or configuration files, store them in GitHub as a <a href="https://gist.github.com/">gist</a> and linking to them.</p> </div> </td> </tr> </table> </div> </div> </div> </div> </div> <div id="footer"> <div id="footer-text"> Last updated 2019-10-27 08:15:43 UTC </div> </div> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8601422-1', 'auto');
  ga('send', 'pageview');

</script> <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
});
</script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script> </body> </html>