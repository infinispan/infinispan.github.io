<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="generator" content="Asciidoctor 2.0.10"> <title>Deploying and Configuring Infinispan 10.1 Servers</title> <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"> <style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> <link rel="canonical" href="http://infinispan.org/docs/stable/user_guide/user_guide.html"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.1/themes/default/style.min.css"> <link rel="stylesheet" href="../../css/css.css"> <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.1/jstree.min.js"></script> <script src="../../js/js.js"></script> </head> <body class="book toc2 toc-left"> <div id="header"> <h1>Deploying and Configuring Infinispan 10.1 Servers</h1> <div id="toc" class="toc2"> <div id="toctitle">Table of Contents</div> <ul class="sectlevel1"> <li><a href="#start_server">1. Getting Started with Infinispan Server</a> <ul class="sectlevel2"> <li><a href="#infinispan_server_requirements">1.1. Infinispan Server Requirements</a></li> <li><a href="#downloading_server_distributions">1.2. Downloading Server Distributions</a></li> <li><a href="#installing_infinispan_server">1.3. Installing Infinispan Server</a></li> <li><a href="#server_quickstart">1.4. Running Infinispan Servers</a> <ul class="sectlevel3"> <li><a href="#starting_infinispan_servers">1.4.1. Starting Infinispan Servers</a></li> <li><a href="#verifying_infinispan_cluster_discovery">1.4.2. Verifying Infinispan Cluster Discovery</a></li> <li><a href="#cli_operations-server_quickstart">1.4.3. Performing Operations with the Infinispan CLI</a> <ul class="sectlevel4"> <li><a href="#starting_the_infinispan_cli">Starting the Infinispan CLI</a></li> <li><a href="#connecting_to_infinispan_servers">Connecting to Infinispan Servers</a></li> <li><a href="#creating_caches_from_templates">Creating Caches from Templates</a></li> <li><a href="#adding_cache_entries">Adding Cache Entries</a></li> <li><a href="#shutting_down_infinispan_servers">Shutting Down Infinispan Servers</a></li> </ul> </li> </ul> </li> </ul> </li> <li><a href="#configuring_networking">2. Configuring Infinispan Server Networking</a> <ul class="sectlevel2"> <li><a href="#server_interfaces-server">2.1. Server Interfaces</a> <ul class="sectlevel3"> <li><a href="#address_strategy">2.1.1. Address Strategy</a></li> <li><a href="#loopback_strategy">2.1.2. Loopback Strategy</a></li> <li><a href="#non_loopback_strategy">2.1.3. Non-Loopback Strategy</a></li> <li><a href="#network_address_strategy">2.1.4. Network Address Strategy</a></li> <li><a href="#any_address_strategy">2.1.5. Any Address Strategy</a></li> <li><a href="#link_local_strategy">2.1.6. Link Local Strategy</a></li> <li><a href="#site_local_strategy">2.1.7. Site Local Strategy</a></li> <li><a href="#match_host_strategy">2.1.8. Match Host Strategy</a></li> <li><a href="#match_interface_strategy">2.1.9. Match Interface Strategy</a></li> <li><a href="#match_address_strategy">2.1.10. Match Address Strategy</a></li> <li><a href="#fallback_strategy">2.1.11. Fallback Strategy</a></li> <li><a href="#changing_bind_address-server">2.1.12. Changing the Default Bind Address for Infinispan Servers</a></li> </ul> </li> <li><a href="#socket_bindings-server">2.2. Socket Bindings</a> <ul class="sectlevel3"> <li><a href="#configuring_port_offsets-server">2.2.1. Specifying Port Offsets</a></li> </ul> </li> <li><a href="#single_port">2.3. Infinispan Protocol Handling</a> <ul class="sectlevel3"> <li><a href="#configure_alpn">2.3.1. Configuring Clients for ALPN</a></li> </ul> </li> </ul> </li> <li><a href="#configuring_endpoints">3. Configuring Infinispan Server Endpoints</a> <ul class="sectlevel2"> <li><a href="#infinispan_endpoints">3.1. Infinispan Endpoints</a> <ul class="sectlevel3"> <li><a href="#hot_rod">3.1.1. Hot Rod</a></li> <li><a href="#rest">3.1.2. REST</a></li> <li><a href="#memcached">3.1.3. Memcached</a></li> <li><a href="#protocol_comparison">3.1.4. Protocol Comparison</a></li> </ul> </li> <li><a href="#endpoint_connectors">3.2. Endpoint Connectors</a> <ul class="sectlevel3"> <li><a href="#hot_rod_connectors">3.2.1. Hot Rod Connectors</a></li> <li><a href="#rest_connectors">3.2.2. REST Connectors</a></li> <li><a href="#memcached_connectors">3.2.3. Memcached Connectors</a></li> </ul> </li> </ul> </li> <li><a href="#monitoring">4. Monitoring Infinispan Servers</a> <ul class="sectlevel2"> <li><a href="#logs">4.1. Working with Infinispan Server Logs</a> <ul class="sectlevel3"> <li><a href="#infinispan_log_files">4.1.1. Infinispan Log Files</a></li> <li><a href="#configuring_infinispan_log_properties">4.1.2. Configuring Infinispan Log Properties</a> <ul class="sectlevel4"> <li><a href="#log_levels">Log Levels</a></li> <li><a href="#infinispan_log_categories">Infinispan Log Categories</a></li> <li><a href="#log_appenders">Log Appenders</a></li> <li><a href="#log_patterns">Log Patterns</a></li> <li><a href="#enabling_and_configuring_the_json_log_handler">Enabling and Configuring the JSON Log Handler</a></li> </ul> </li> <li><a href="#server_access_logs">4.1.3. Access Logs</a> <ul class="sectlevel4"> <li><a href="#enabling_access_logs">Enabling Access Logs</a></li> <li><a href="#access_log_properties">Access Log Properties</a></li> </ul> </li> </ul> </li> <li><a href="#server_health">4.2. Retrieving Server Health Statistics</a> <ul class="sectlevel3"> <li><a href="#accessing_the_health_api_via_jmx">4.2.1. Accessing the Health API via JMX</a></li> <li><a href="#accessing_the_health_api_via_rest">4.2.2. Accessing the Health API via REST</a></li> </ul> </li> <li><a href="#jmx_stats">4.3. Enabling and Collecting JMX Statistics</a> <ul class="sectlevel3"> <li><a href="#enable_statistics-server">4.3.1. Enabling JMX Statistics</a></li> <li><a href="#jmx_mbeans-server">4.3.2. Infinispan MBeans</a></li> <li><a href="#name_cache_managers-server">4.3.3. Naming Multiple Cache Managers</a></li> <li><a href="#register_mbeans-server">4.3.4. Registering MBeans In Custom MBean Servers</a></li> </ul> </li> <li><a href="#metric_endpoint">4.4. Collecting Infinispan Metrics</a></li> </ul> </li> <li><a href="#security">5. Securing Infinispan Servers</a> <ul class="sectlevel2"> <li><a href="#cache_authorization-server">5.1. Cache Authorization</a> <ul class="sectlevel3"> <li><a href="#authorization_config-server">5.1.1. Cache Authorization Configuration</a></li> </ul> </li> <li><a href="#server_realms">5.2. Defining Infinispan Server Security Realms</a> <ul class="sectlevel3"> <li><a href="#property_realm-server">5.2.1. Property Realms</a> <ul class="sectlevel4"> <li><a href="#user_tool-server">Adding Users to Property Realms</a></li> </ul> </li> <li><a href="#ldap_realm-server">5.2.2. LDAP Realms</a> <ul class="sectlevel4"> <li><a href="#ldap_realm_rewriting-server">LDAP Realm Principal Rewriting</a></li> </ul> </li> <li><a href="#trust_store_realm-server">5.2.3. Trust Store Realms</a></li> <li><a href="#token_realm-server">5.2.4. Token Realms</a></li> </ul> </li> <li><a href="#server_identity">5.3. Creating Infinispan Server Identities</a> <ul class="sectlevel3"> <li><a href="#ssl_identity-server">5.3.1. Setting Up SSL Identities</a> <ul class="sectlevel4"> <li><a href="#ssl_identity_config-server">SSL Identity Configuration</a></li> <li><a href="#generate_keystores-server">Automatically Generating Keystores</a></li> <li><a href="#ssl_engine-server">Tuning SSL Protocols and Cipher Suites</a></li> </ul> </li> <li><a href="#kerberos_identity-server">5.3.2. Setting Up Kerberos Identities</a> <ul class="sectlevel4"> <li><a href="#kerberos_identity_config-server">Kerberos Identity Configuration</a></li> </ul> </li> </ul> </li> <li><a href="#endpoint_authentication">5.4. Configuring Endpoint Authentication Mechanisms</a> <ul class="sectlevel3"> <li><a href="#configure_hotrod_endpoint_auth-server">5.4.1. Setting Up Hot Rod Authentication</a> <ul class="sectlevel4"> <li><a href="#hotrod_endpoint_auth_configuration-server">Hot Rod Authentication Configuration</a></li> <li><a href="#hotrod_endpoint_auth-server">Hot Rod Endpoint Authentication Mechanisms</a></li> <li><a href="#hotrod_endpoint_sasl_qop-server">SASL Quality of Protection (QoP)</a></li> <li><a href="#hotrod_endpoint_sasl_policies-server">SASL Policies</a></li> </ul> </li> <li><a href="#configure_rest_endpoint_auth-server">5.4.2. Setting Up REST Authentication</a> <ul class="sectlevel4"> <li><a href="#rest_endpoint_auth_configuration-server">REST Authentication Configuration</a></li> <li><a href="#rest_endpoint_auth-server">REST Endpoint Authentication Mechanisms</a></li> </ul> </li> </ul> </li> </ul> </li> <li><a href="#remote_server_execution">6. Remotely Executing Server-Side Tasks</a> <ul class="sectlevel2"> <li><a href="#server_tasks">6.1. Creating Server Tasks</a> <ul class="sectlevel3"> <li><a href="#tasks">6.1.1. Server Tasks</a></li> <li><a href="#server_tasks-server">6.1.2. Deploying Server Tasks to Infinispan Servers</a></li> </ul> </li> <li><a href="#server_scripts">6.2. Creating Server Scripts</a> <ul class="sectlevel3"> <li><a href="#scripts">6.2.1. Server Scripts</a> <ul class="sectlevel4"> <li><a href="#server_script_metdata">Script Metadata</a></li> <li><a href="#server_script_bindings">Script Bindings</a></li> <li><a href="#server_script_parameters">Script Parameters</a></li> </ul> </li> <li><a href="#adding_scripts_cli-server">6.2.2. Adding Scripts to Infinispan Servers</a></li> <li><a href="#add_script_hotrod">6.2.3. Programmatically Creating Scripts</a></li> </ul> </li> <li><a href="#running_tasks_scripts">6.3. Running Server-Side Tasks and Scripts</a> <ul class="sectlevel3"> <li><a href="#running_scripts_cli">6.3.1. Running Tasks and Scripts</a></li> <li><a href="#running_scripts_hotrod">6.3.2. Programmatically Running Scripts</a></li> <li><a href="#running_tasks_hotrod">6.3.3. Programmatically Running Tasks</a></li> </ul> </li> </ul> </li> <li><a href="#server_rolling_upgrade">7. Performing Rolling Upgrades</a> <ul class="sectlevel2"> <li><a href="#rolling_upgrades">7.1. Rolling Upgrades</a></li> <li><a href="#setting_up_target_clusters">7.2. Setting Up Target Clusters</a></li> <li><a href="#synchronizing_data_from_source_clusters">7.3. Synchronizing Data from Source Clusters</a></li> </ul> </li> </ul> </div> </div> <div id="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan server is a managed, distributed, and clusterable data grid that provides elastic scaling and high performance access to caches from multiple endpoints, such as Hot Rod and REST.</p> </div> </div> </div> <div class="sect1"> <h2 id="start_server"><a class="anchor" href="#start_server"></a>1. Getting Started with Infinispan Server</h2> <div class="sectionbody"> <div class="paragraph"> <p>Quickly set up Infinispan server and learn the basics.</p> </div> <div class="sect2"> <h3 id="infinispan_server_requirements"><a class="anchor" href="#infinispan_server_requirements"></a>1.1. Infinispan Server Requirements</h3> <div class="paragraph"> <p>Check host system requirements for the Infinispan server.</p> </div> <div class="paragraph"> <p>Infinispan server requires a Java Virtual Machine and supports:</p> </div> <div class="ulist"> <ul> <li> <p>Java 8</p> </li> <li> <p>Java 11</p> </li> </ul> </div> </div> <div class="sect2"> <h3 id="downloading_server_distributions"><a class="anchor" href="#downloading_server_distributions"></a>1.2. Downloading Server Distributions</h3> <div class="paragraph"> <p>The Infinispan server distribution is an archive of Java libraries (<code>JAR</code> files), configuration files, and a <code>data</code> directory.</p> </div> <div class="paragraph"> <div class="title">Procedure</div> <p>Download the Infinispan 10.1 server from <a href="https://infinispan.org/download/">Infinispan downloads</a>.</p> </div> <div class="paragraph"> <div class="title">Verification</div> <p>Use the checksum to verify the integrity of your download.</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Run the <code>sha1sum</code> command with the server download archive as the argument, for example:</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>$ sha1sum infinispan-server-${version}.zip</code></pre> </div> </div> </li> <li> <p>Compare with the <code>SHA-1</code> checksum value on the Infinispan downloads page.</p> </li> </ol> </div> <div class="paragraph"> <div class="title">Reference</div> <p><a href="https://github.com/infinispan/infinispan/blob/master/server/runtime/README.adoc">Infinispan Server README</a> describes the contents of the server distribution.</p> </div> </div> <div class="sect2"> <h3 id="installing_infinispan_server"><a class="anchor" href="#installing_infinispan_server"></a>1.3. Installing Infinispan Server</h3> <div class="paragraph"> <p>Extract the Infinispan server archive to any directory on your host.</p> </div> <div class="paragraph"> <div class="title">Procedure</div> <p>Use any extraction tool with the server archive, for example:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>$ unzip infinispan-server-${version}.zip</code></pre> </div> </div> <div class="paragraph"> <p>The resulting directory is your <code>$ISPN_HOME</code>.</p> </div> </div> <div class="sect2"> <h3 id="server_quickstart"><a class="anchor" href="#server_quickstart"></a>1.4. Running Infinispan Servers</h3> <div class="paragraph"> <p>Spin up Infinispan server instances that automatically form clusters. Learn how to create cache definitions to store your data.</p> </div> <div class="sect3"> <h4 id="starting_infinispan_servers"><a class="anchor" href="#starting_infinispan_servers"></a>1.4.1. Starting Infinispan Servers</h4> <div class="paragraph"> <p>Launch Infinispan server with the startup script.</p> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Open a terminal in <code>$ISPN_HOME</code>.</p> </li> <li> <p>Run the <code>server</code> script.</p> <div class="dlist"> <dl> <dt class="hdlist1">Linux</dt> <dd> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>$ bin/server.sh</code></pre> </div> </div> </dd> <dt class="hdlist1">Microsoft Windows</dt> <dd> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>bin\server.bat</code></pre> </div> </div> <div class="paragraph"> <p>The server gives you these messages when it starts:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>INFO  [org.infinispan.SERVER] (main) ISPN080004: Protocol SINGLE_PORT listening
on 127.0.0.1:11222
INFO  [org.infinispan.SERVER] (main) ISPN080001: Infinispan Server ${version}
started in 7453ms</code></pre> </div> </div> </dd> </dl> </div> </li> </ol> </div> <div class="paragraph"> <p><em>Hello Infinispan!</em></p> </div> <div class="ulist"> <ul> <li> <p>Open <code>127.0.0.1:11222</code> in any browser to see the Infinispan server welcome message.</p> </li> </ul> </div> <div class="paragraph"> <div class="title">Reference</div> <p><a href="https://github.com/infinispan/infinispan/blob/master/server/runtime/README.adoc">Infinispan Server README</a> describes command line arguments for the <code>server</code> script.</p> </div> </div> <div class="sect3"> <h4 id="verifying_infinispan_cluster_discovery"><a class="anchor" href="#verifying_infinispan_cluster_discovery"></a>1.4.2. Verifying Infinispan Cluster Discovery</h4> <div class="paragraph"> <p>Infinispan servers running on the same network discover each other with the <code>MPING</code> protocol.</p> </div> <div class="paragraph"> <p>This procedure shows you how to use Infinispan server command arguments to start two instances on the same host and verify that the cluster view forms.</p> </div> <div class="paragraph"> <div class="title">Prerequisites</div> <p>Start a Infinispan server.</p> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Install and run a new Infinispan server instance.</p> <div class="olist loweralpha"> <ol class="loweralpha" type="a"> <li> <p>Open a terminal in <code>$ISPN_HOME</code>.</p> </li> <li> <p>Copy the root directory to <code>server2</code>.</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>$ cp -r server server2</code></pre> </div> </div> </li> </ol> </div> </li> <li> <p>Specify a port offset and the location of the <code>server2</code> root directory.</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>$ bin/server.sh -o 100 -s server2</code></pre> </div> </div> </li> </ol> </div> <div class="paragraph"> <div class="title">Verification</div> <p>Running servers return the following messages when new servers join clusters:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>INFO  [org.infinispan.CLUSTER] (jgroups-11,&lt;server_hostname&gt;)
ISPN000094: Received new cluster view for channel cluster:
[&lt;server_hostname&gt;|3] (2) [&lt;server_hostname&gt;, &lt;server2_hostname&gt;]
INFO  [org.infinispan.CLUSTER] (jgroups-11,&lt;server_hostname&gt;)
ISPN100000: Node &lt;server2_hostname&gt; joined the cluster</code></pre> </div> </div> <div class="paragraph"> <p>Servers return the following messages when they join clusters:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>INFO  [org.infinispan.remoting.transport.jgroups.JGroupsTransport] (main)
ISPN000078: Starting JGroups channel cluster
INFO  [org.infinispan.CLUSTER] (main)
ISPN000094: Received new cluster view for channel cluster:
[&lt;server_hostname&gt;|3] (2) [&lt;server_hostname&gt;, &lt;server2_hostname&gt;]</code></pre> </div> </div> <div class="paragraph"> <div class="title">Reference</div> <p><a href="https://github.com/infinispan/infinispan/blob/master/server/runtime/README.adoc">Infinispan Server README</a> describes command line arguments for the <code>server</code> script.</p> </div> </div> <div class="sect3"> <h4 id="cli_operations-server_quickstart"><a class="anchor" href="#cli_operations-server_quickstart"></a>1.4.3. Performing Operations with the Infinispan CLI</h4> <div class="paragraph"> <p>Connect to servers with the Infinispan command line interface (CLI) to access data and perform administrative functions.</p> </div> <div class="sect4"> <h5 id="starting_the_infinispan_cli"><a class="anchor" href="#starting_the_infinispan_cli"></a>Starting the Infinispan CLI</h5> <div class="paragraph"> <p>Start the Infinispan CLI as follows:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Open a terminal in <code>$ISPN_HOME</code>.</p> </li> <li> <p>Run the CLI.</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>$ bin/cli.sh
[disconnected]&gt;</code></pre> </div> </div> </li> </ol> </div> </div> <div class="sect4"> <h5 id="connecting_to_infinispan_servers"><a class="anchor" href="#connecting_to_infinispan_servers"></a>Connecting to Infinispan Servers</h5> <div class="paragraph"> <p>Do one of the following:</p> </div> <div class="ulist"> <ul> <li> <p>Run the <code>connect</code> command to connect to a Infinispan server on the default port of <code>11222</code>:</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>[disconnected]&gt; connect
[hostname1@cluster//containers/default]&gt;</code></pre> </div> </div> </li> <li> <p>Specify the location of a Infinispan server. For example, connect to a local server that has a port offset of 100:</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>[disconnected]&gt; connect 127.0.0.1:11322
[hostname2@cluster//containers/default]&gt;</code></pre> </div> </div> </li> </ul> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> <div class="paragraph"> <p>Press the tab key to display available commands and options. Use the <code>-h</code> option to display help text.</p> </div> </td> </tr> </table> </div> </div> <div class="sect4"> <h5 id="creating_caches_from_templates"><a class="anchor" href="#creating_caches_from_templates"></a>Creating Caches from Templates</h5> <div class="paragraph"> <p>Use Infinispan cache templates to add caches with recommended default settings.</p> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Create a distributed, synchronous cache from a template and name it "mycache".</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>[//containers/default]&gt; create cache --template=org.infinispan.DIST_SYNC mycache</code></pre> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> <div class="paragraph"> <p>Press the tab key after the <code>--template=</code> argument to list available cache templates.</p> </div> </td> </tr> </table> </div> </li> <li> <p>Retrieve the cache configuration.</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>[//containers/default]&gt; describe caches/mycache
{
  &quot;distributed-cache&quot; : {
    &quot;mode&quot; : &quot;SYNC&quot;,
    &quot;remote-timeout&quot; : 17500,
    &quot;state-transfer&quot; : {
      &quot;timeout&quot; : 60000
    },
    &quot;transaction&quot; : {
      &quot;mode&quot; : &quot;NONE&quot;
    },
    &quot;locking&quot; : {
      &quot;concurrency-level&quot; : 1000,
      &quot;acquire-timeout&quot; : 15000,
      &quot;striping&quot; : false
    }
  }
}</code></pre> </div> </div> </li> </ol> </div> </div> <div class="sect4"> <h5 id="adding_cache_entries"><a class="anchor" href="#adding_cache_entries"></a>Adding Cache Entries</h5> <div class="paragraph"> <p>Add data to caches with the Infinispan CLI.</p> </div> <div class="ulist"> <div class="title">Prerequisites</div> <ul> <li> <p>Create a cache named "mycache".</p> </li> </ul> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Add a key/value pair to <code>mycache</code>.</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>[//containers/default]&gt; put --cache=mycache hello world</code></pre> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> <div class="paragraph"> <p>If the CLI is in the context of a cache, do <code>put k1 v1</code> for example:</p> </div> <div class="listingblock"> <div class="content"> <pre>[//containers/default]&gt; cd caches/mycache
[//containers/default/caches/mycache]&gt; put hello world</pre> </div> </div> </td> </tr> </table> </div> </li> <li> <p>List keys in the cache.</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>[//containers/default]&gt; ls caches/mycache
hello</code></pre> </div> </div> </li> <li> <p>Get the value for the <code>hello</code> key.</p> <div class="olist loweralpha"> <ol class="loweralpha" type="a"> <li> <p>Navigate to the cache.</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>[//containers/default]&gt; cd caches/mycache</code></pre> </div> </div> </li> <li> <p>Use the <code>get</code> command to retrieve the key value.</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>[//containers/default/caches/mycache]&gt; get hello
world</code></pre> </div> </div> </li> </ol> </div> </li> </ol> </div> </div> <div class="sect4"> <h5 id="shutting_down_infinispan_servers"><a class="anchor" href="#shutting_down_infinispan_servers"></a>Shutting Down Infinispan Servers</h5> <div class="paragraph"> <p>Use the CLI to gracefully shutdown running servers. This ensures that Infinispan passivates all entries to disk and persists state.</p> </div> <div class="ulist"> <ul> <li> <p>Use the <code>shutdown server</code> command to stop individual servers, for example:</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>[//containers/default]&gt; shutdown server server_hostname</code></pre> </div> </div> </li> <li> <p>Use the <code>shutdown cluster</code> command to stop all servers joined to the cluster, for example:</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>[//containers/default]&gt; shutdown cluster</code></pre> </div> </div> </li> </ul> </div> <div class="paragraph"> <p>Infinispan servers log the following shutdown messages:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>INFO  [org.infinispan.SERVER] (pool-3-thread-1) ISPN080002: Infinispan Server stopping
INFO  [org.infinispan.CONTAINER] (pool-3-thread-1) ISPN000029: Passivating all entries to disk
INFO  [org.infinispan.CONTAINER] (pool-3-thread-1) ISPN000030: Passivated 28 entries in 46 milliseconds
INFO  [org.infinispan.CLUSTER] (pool-3-thread-1) ISPN000080: Disconnecting JGroups channel cluster
INFO  [org.infinispan.CONTAINER] (pool-3-thread-1) ISPN000390: Persisted state, version=&lt;Infinispan version&gt; timestamp=YYYY-MM-DDTHH:MM:SS
INFO  [org.infinispan.SERVER] (pool-3-thread-1) ISPN080003: Infinispan Server stopped
INFO  [org.infinispan.SERVER] (Thread-0) ISPN080002: Infinispan Server stopping
INFO  [org.infinispan.SERVER] (Thread-0) ISPN080003: Infinispan Server stopped</code></pre> </div> </div> <div class="paragraph"> <p>When you shutdown Infinispan clusters, the shutdown messages include:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>INFO  [org.infinispan.SERVER] (pool-3-thread-1) ISPN080029: Cluster shutdown
INFO  [org.infinispan.CLUSTER] (pool-3-thread-1) ISPN000080: Disconnecting JGroups channel cluster</code></pre> </div> </div> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="configuring_networking"><a class="anchor" href="#configuring_networking"></a>2. Configuring Infinispan Server Networking</h2> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan servers let you configure interfaces and ports to make endpoints available across your network.</p> </div> <div class="paragraph"> <p>By default, Infinispan servers multiplex endpoints to a single TCP/IP port and automatically detect protocols of inbound client requests.</p> </div> <div class="sect2"> <h3 id="server_interfaces-server"><a class="anchor" href="#server_interfaces-server"></a>2.1. Server Interfaces</h3> <div class="paragraph"> <p>Infinispan servers can use different strategies for binding to IP addresses.</p> </div> <div class="sect3"> <h4 id="address_strategy"><a class="anchor" href="#address_strategy"></a>2.1.1. Address Strategy</h4> <div class="paragraph"> <p>Uses an <code>inet-address</code> strategy that maps a single <code>public</code> interface to the IPv4 loopback address (<code>127.0.0.1</code>).</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;interfaces&gt;</span>
  <span class="tag">&lt;interface</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;inet-address</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${infinispan.bind.address:127.0.0.1}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/interface&gt;</span>
<span class="tag">&lt;/interfaces&gt;</span></code></pre> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> <div class="paragraph"> <p>You can use the CLI <code>-b</code> argument or the <code>infinispan.bind.address</code> property to select a specific address from the command-line. See <a href="#changing_bind_address-server">Changing the Default Bind Address</a>.</p> </div> </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="loopback_strategy"><a class="anchor" href="#loopback_strategy"></a>2.1.2. Loopback Strategy</h4> <div class="paragraph"> <p>Selects a loopback address.</p> </div> <div class="ulist"> <ul> <li> <p><strong>IPv4</strong> the address block <code>127.0.0.0/8</code> is reserved for loopback addresses.</p> </li> <li> <p><strong>IPv6</strong> the address block <code>::1</code> is the only loopback address.</p> </li> </ul> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;interfaces&gt;</span>
    <span class="tag">&lt;interface</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;loopback</span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/interface&gt;</span>
<span class="tag">&lt;/interfaces&gt;</span></code></pre> </div> </div> </div> <div class="sect3"> <h4 id="non_loopback_strategy"><a class="anchor" href="#non_loopback_strategy"></a>2.1.3. Non-Loopback Strategy</h4> <div class="paragraph"> <p>Selects a non-loopback address.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;interfaces&gt;</span>
    <span class="tag">&lt;interface</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;non-loopback</span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/interface&gt;</span>
<span class="tag">&lt;/interfaces&gt;</span></code></pre> </div> </div> </div> <div class="sect3"> <h4 id="network_address_strategy"><a class="anchor" href="#network_address_strategy"></a>2.1.4. Network Address Strategy</h4> <div class="paragraph"> <p>Selects networks based on IP address.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;interfaces&gt;</span>
    <span class="tag">&lt;interface</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;inet-address</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">10.1.2.3</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/interface&gt;</span>
<span class="tag">&lt;/interfaces&gt;</span></code></pre> </div> </div> </div> <div class="sect3"> <h4 id="any_address_strategy"><a class="anchor" href="#any_address_strategy"></a>2.1.5. Any Address Strategy</h4> <div class="paragraph"> <p>Selects the <code>INADDR_ANY</code> wildcard address. As a result Infinispan servers listen on all interfaces.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;interfaces&gt;</span>
    <span class="tag">&lt;interface</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;any-address</span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/interface&gt;</span>
<span class="tag">&lt;/interfaces&gt;</span></code></pre> </div> </div> </div> <div class="sect3"> <h4 id="link_local_strategy"><a class="anchor" href="#link_local_strategy"></a>2.1.6. Link Local Strategy</h4> <div class="paragraph"> <p>Selects a <em>link-local</em> IP address.</p> </div> <div class="ulist"> <ul> <li> <p><strong>IPv4</strong> the address block <code>169.254.0.0/16</code> (<code>169.254.0.0 – 169.254.255.255</code>) is reserved for link-local addressing.</p> </li> <li> <p><strong>IPv6</strong> the address block <code>fe80::/10</code> is reserved for link-local unicast addressing.</p> </li> </ul> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;interfaces&gt;</span>
    <span class="tag">&lt;interface</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;inet-address</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">10.1.2.3</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/interface&gt;</span>
<span class="tag">&lt;/interfaces&gt;</span></code></pre> </div> </div> </div> <div class="sect3"> <h4 id="site_local_strategy"><a class="anchor" href="#site_local_strategy"></a>2.1.7. Site Local Strategy</h4> <div class="paragraph"> <p>Selects a <em>site-local</em> (private) IP address.</p> </div> <div class="ulist"> <ul> <li> <p><strong>IPv4</strong> the address blocks <code>10.0.0.0/8</code>, <code>172.16.0.0/12</code>, and <code>192.168.0.0/16</code> are reserved for site-local addressing.</p> </li> <li> <p><strong>IPv6</strong> the address block <code>fc00::/7</code> is reserved for site-local unicast addressing.</p> </li> </ul> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;interfaces&gt;</span>
    <span class="tag">&lt;interface</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;inet-address</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">10.1.2.3</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/interface&gt;</span>
<span class="tag">&lt;/interfaces&gt;</span></code></pre> </div> </div> </div> <div class="sect3"> <h4 id="match_host_strategy"><a class="anchor" href="#match_host_strategy"></a>2.1.8. Match Host Strategy</h4> <div class="paragraph"> <p>Resolves the host name and selects one of the IP addresses that is assigned to any network interface.</p> </div> <div class="paragraph"> <p>Infinispan servers enumerate all available operating system interfaces to locate IP addresses resolved from the host name in your configuration.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;interfaces&gt;</span>
    <span class="tag">&lt;interface</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;match-host</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">my_host_name</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/interface&gt;</span>
<span class="tag">&lt;/interfaces&gt;</span></code></pre> </div> </div> </div> <div class="sect3"> <h4 id="match_interface_strategy"><a class="anchor" href="#match_interface_strategy"></a>2.1.9. Match Interface Strategy</h4> <div class="paragraph"> <p>Selects an IP address assigned to a network interface that matches a regular expression.</p> </div> <div class="paragraph"> <p>Infinispan servers enumerate all available operating system interfaces to locate the interface name in your configuration.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> <div class="paragraph"> <p>Use regular expressions with this strategy for additional flexibility.</p> </div> </td> </tr> </table> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;interfaces&gt;</span>
    <span class="tag">&lt;interface</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;match-interface</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">eth0</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/interface&gt;</span>
<span class="tag">&lt;/interfaces&gt;</span></code></pre> </div> </div> </div> <div class="sect3"> <h4 id="match_address_strategy"><a class="anchor" href="#match_address_strategy"></a>2.1.10. Match Address Strategy</h4> <div class="paragraph"> <p>Similar to <code>inet-address</code> but selects an IP address using a regular expression.</p> </div> <div class="paragraph"> <p>Infinispan servers enumerate all available operating system interfaces to locate the IP address in your configuration.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> <div class="paragraph"> <p>Use regular expressions with this strategy for additional flexibility.</p> </div> </td> </tr> </table> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;interfaces&gt;</span>
    <span class="tag">&lt;interface</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;match-address</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">132\..*</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/interface&gt;</span>
<span class="tag">&lt;/interfaces&gt;</span></code></pre> </div> </div> </div> <div class="sect3"> <h4 id="fallback_strategy"><a class="anchor" href="#fallback_strategy"></a>2.1.11. Fallback Strategy</h4> <div class="paragraph"> <p>Interface configurations can include multiple strategies. Infinispan servers try each strategy in the declared order.</p> </div> <div class="paragraph"> <p>For example, with the following configuration, Infinispan servers first attempt to match a host, then an IP address, and then fall back to the <code>INADDR_ANY</code> wildcard address:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;interfaces&gt;</span>
    <span class="tag">&lt;interface</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;match-host</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">my_host_name</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;match-address</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">132\..*</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;any-address</span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/interface&gt;</span>
<span class="tag">&lt;/interfaces&gt;</span></code></pre> </div> </div> </div> <div class="sect3"> <h4 id="changing_bind_address-server"><a class="anchor" href="#changing_bind_address-server"></a>2.1.12. Changing the Default Bind Address for Infinispan Servers</h4> <div class="paragraph"> <p>You can use the server <code>-b</code> switch or the <code>infinispan.bind.address</code> system property to bind to a different address.</p> </div> <div class="paragraph"> <p>For example, bind the <code>public</code> interface to <code>127.0.0.2</code> as follows:</p> </div> <div class="dlist"> <dl> <dt class="hdlist1">Linux</dt> </dl> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="bash">$ bin/server.sh -b 127.0.0.2</code></pre> </div> </div> <div class="dlist"> <dl> <dt class="hdlist1">Windows</dt> </dl> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="bash">bin\server.bat -b 127.0.0.2</code></pre> </div> </div> </div> </div> <div class="sect2"> <h3 id="socket_bindings-server"><a class="anchor" href="#socket_bindings-server"></a>2.2. Socket Bindings</h3> <div class="paragraph"> <p>Socket bindings map endpoint connectors to server interfaces and ports.</p> </div> <div class="paragraph"> <p>By default, Infinispan servers provide the following socket bindings:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;socket-bindings</span> <span class="attribute-name">default-interface</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">port-offset</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${infinispan.socket.binding.port-offset:0}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;socket-binding</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${infinispan.bind.port:11222}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;socket-binding</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">memcached</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">11221</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/socket-bindings&gt;</span></code></pre> </div> </div> <div class="ulist"> <ul> <li> <p><code>socket-bindings</code> declares the default interface and port offset.</p> </li> <li> <p><code>default</code> binds to hotrod and rest connectors to the default port <code>11222</code>.</p> </li> <li> <p><code>memcached</code> binds the memcached connector to port <code>11221</code>.</p> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> <div class="paragraph"> <p>The memcached endpoint is disabled by default.</p> </div> </td> </tr> </table> </div> </li> </ul> </div> <div class="paragraph"> <p>To override the default interface for <code>socket-binding</code> declarations, specify the <code>interface</code> attribute.</p> </div> <div class="paragraph"> <p>For example, you add an <code>interface</code> declaration named "private":</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;interfaces&gt;</span>
  ...
  <span class="tag">&lt;interface</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">private</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;inet-address</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">10.1.2.3</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/interface&gt;</span>
<span class="tag">&lt;/interfaces&gt;</span></code></pre> </div> </div> <div class="paragraph"> <p>You can then specify <code>interface="private"</code> in a <code>socket-binding</code> declaration to bind to the private IP address, as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;socket-bindings</span> <span class="attribute-name">default-interface</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">port-offset</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${infinispan.socket.binding.port-offset:0}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  ...
  <span class="tag">&lt;socket-binding</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">private_binding</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">interface</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">private</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1234</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/socket-bindings&gt;</span></code></pre> </div> </div> <div class="sect3"> <h4 id="configuring_port_offsets-server"><a class="anchor" href="#configuring_port_offsets-server"></a>2.2.1. Specifying Port Offsets</h4> <div class="paragraph"> <p>Configure port offsets with Infinispan servers when running multiple instances on the same host. The default port offset is <code>0</code>.</p> </div> <div class="paragraph"> <p>Use the <code>-o</code> switch with the Infinispan CLI or the <code>infinispan.socket.binding.port-offset</code> system property to set port offsets.</p> </div> <div class="paragraph"> <p>For example, start a server instance with an offset of <code>100</code> as follows. With the default configuration, this results in the Infinispan server listening on port <code>11322</code>.</p> </div> <div class="dlist"> <dl> <dt class="hdlist1">Linux</dt> </dl> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="bash">$ bin/server.sh -o 100</code></pre> </div> </div> <div class="dlist"> <dl> <dt class="hdlist1">Windows</dt> </dl> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="bash">bin\server.bat -o 100</code></pre> </div> </div> </div> </div> <div class="sect2"> <h3 id="single_port"><a class="anchor" href="#single_port"></a>2.3. Infinispan Protocol Handling</h3> <div class="paragraph"> <p>Infinispan servers use a router connector to expose multiple protocols over the same TCP port, <code>11222</code>. Using a single port for multiple protocols simplifies configuration and management and increases security by reducing the attack surface for unauthorized users.</p> </div> <div class="paragraph"> <p>Infinispan servers handle HTTP/1.1, HTTP/2, and Hot Rod protocol requests via port <code>11222</code> as follows:</p> </div> <div class="dlist"> <dl> <dt class="hdlist1">HTTP/1.1 upgrade headers</dt> <dd> <p>Client requests can include the <code>HTTP/1.1 upgrade</code> header field to initiate HTTP/1.1 connections with Infinispan servers. Client applications can then send the <code>Upgrade: protocol</code> header field, where <code>protocol</code> is a Infinispan server endpoint.</p> </dd> <dt class="hdlist1">Application-Layer Protocol Negotiation (ALPN)/Transport Layer Security (TLS)</dt> <dd> <p>Client applications specify Server Name Indication (SNI) mappings for Infinispan server endpoints to negotiate protocols in a secure manner.</p> </dd> <dt class="hdlist1">Automatic Hot Rod detection</dt> <dd> <p>Client requests that include Hot Rod headers automatically route to Hot Rod endpoints if the single port router configuration includes Hot Rod.</p> </dd> </dl> </div> <div class="sect3"> <h4 id="configure_alpn"><a class="anchor" href="#configure_alpn"></a>2.3.1. Configuring Clients for ALPN</h4> <div class="paragraph"> <p>Configure clients to provide ALPN messages for protocol negotiation during TLS handshakes with Infinispan servers.</p> </div> <div class="ulist"> <div class="title">Prerequisites</div> <ul> <li> <p>Enable Infinispan server endpoints with encryption.</p> </li> </ul> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Provide your client application with the appropriate libraries to handle ALPN/TLS exchanges with Infinispan servers.</p> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> <div class="paragraph"> <p>Infinispan uses Wildfly OpenSSL bindings for Java.</p> </div> </td> </tr> </table> </div> </li> <li> <p>Configure clients with trust stores as appropriate.</p> </li> </ol> </div> <div class="listingblock"> <div class="title">Programmatically</div> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java">ConfigurationBuilder builder = <span class="keyword">new</span> ConfigurationBuilder()
      .addServers(<span class="string"><span class="delimiter">&quot;</span><span class="content">127.0.0.1:11222</span><span class="delimiter">&quot;</span></span>);

builder.security().ssl().enable()
      .trustStoreFileName(<span class="string"><span class="delimiter">&quot;</span><span class="content">truststore.pkcs12</span><span class="delimiter">&quot;</span></span>)
      .trustStorePassword(DEFAULT_TRUSTSTORE_PASSWORD.toCharArray());

RemoteCacheManager remoteCacheManager = <span class="keyword">new</span> RemoteCacheManager(builder.build());
RemoteCache&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; cache = remoteCacheManager.getCache(<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="string"><span class="delimiter">&quot;</span><span class="content">);</span></span></code></pre> </div> </div> <div class="listingblock"> <div class="title">Hot Rod client properties</div> <div class="content"> <pre class="CodeRay highlight"><code data-lang="properties">infinispan.client.hotrod.server_list = 127.0.0.1:11222
infinispan.client.hotrod.use_ssl = true
infinispan.client.hotrod.trust_store_file_name = truststore.pkcs12
infinispan.client.hotrod.trust_store_password = trust_store_password</code></pre> </div> </div> <div class="ulist"> <div class="title">Reference</div> <ul> <li> <p><a href="#endpoint_connectors">Infinispan Endpoint Connectors</a></p> </li> <li> <p><a href="https://github.com/wildfly-security/wildfly-openssl">Wildfly OpenSSL</a></p> </li> <li> <p><a href="https://docs.jboss.org/infinispan/10.1/apidocs/org/infinispan/client/hotrod/configuration/SslConfigurationBuilder.html">SslConfigurationBuilder</a></p> </li> <li> <p><a href="https://docs.jboss.org/infinispan/10.1/apidocs/org/infinispan/client/hotrod/configuration/package-summary.html">Hot Rod client configuration properties</a></p> </li> </ul> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="configuring_endpoints"><a class="anchor" href="#configuring_endpoints"></a>3. Configuring Infinispan Server Endpoints</h2> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan servers provide listener endpoints that handle requests from remote client applications.</p> </div> <div class="sect2"> <h3 id="infinispan_endpoints"><a class="anchor" href="#infinispan_endpoints"></a>3.1. Infinispan Endpoints</h3> <div class="paragraph"> <p>Infinispan endpoints expose the <code>CacheManager</code> interface over different connector protocols so you can remotely access data and perform operations to manage and maintain Infinispan clusters.</p> </div> <div class="paragraph"> <p>You can define multiple endpoint connectors on different socket bindings.</p> </div> <div class="sect3"> <h4 id="hot_rod"><a class="anchor" href="#hot_rod"></a>3.1.1. Hot Rod</h4> <div class="paragraph"> <p>Hot Rod is a binary TCP client-server protocol designed to provide faster data access and improved performance in comparison to text-based protocols.</p> </div> <div class="paragraph"> <p>Infinispan provides Hot Rod client libraries in Java, C++, C#, Node.js and other programming languages.</p> </div> <div class="paragraph"> <div class="title">Topology state transfer</div> <p>Infinispan uses topology caches to provide clients with cluster views. Topology caches contain entries that map internal JGroups transport addresses to exposed Hot Rod endpoints.</p> </div> <div class="paragraph"> <p>When client send requests, Infinispan servers compare the topology ID in request headers with the topology ID from the cache. Infinispan servers send new topology views if client have older topology IDs.</p> </div> <div class="paragraph"> <p>Cluster topology views allow Hot Rod clients to immediately detect when nodes join and leave, which enables dynamic load balancing and failover.</p> </div> <div class="paragraph"> <p>In distributed cache modes, the consistent hashing algorithm also makes it possible to route Hot Rod client requests directly to primary owners.</p> </div> <div class="ulist"> <div class="title">Reference</div> <ul> <li> <p><a href="../hotrod_java/hotrod_java.html">Infinispan Hot Rod Server</a></p> </li> <li> <p><a href="http://www.infinispan.org/hotrod-clients">Hot Rod client implementations</a></p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="rest"><a class="anchor" href="#rest"></a>3.1.2. REST</h4> <div class="paragraph"> <p>Infinispan exposes a RESTful interface that allows HTTP clients to access data, monitor and maintain clusters, and perform administrative operations.</p> </div> <div class="paragraph"> <p>You can use standard HTTP load balancers to provide clients with load balancing and failover capabilities. However, HTTP load balancers maintain static cluster views and require manual updates when cluster topology changes occur.</p> </div> <div class="ulist"> <div class="title">Reference</div> <ul> <li> <p><a href="../rest/rest.html">Infinispan REST Server</a></p> </li> <li> <p><a href="http://www.jboss.org/mod_cluster">mod_cluster HTTP load balancer</a></p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="memcached"><a class="anchor" href="#memcached"></a>3.1.3. Memcached</h4> <div class="paragraph"> <p>Infinispan provides an implementation of the Memcached text protocol for remote client access.</p> </div> <div class="paragraph"> <p>The Infinispan Memcached server supports clustering with replicated and distributed cache modes.</p> </div> <div class="paragraph"> <p>There are some Memcached client implementations, such as the Cache::Memcached Perl client, that can offer load balancing and failover detection capabilities with static lists of Infinispan server addresses that require manual updates when cluster topology changes occur.</p> </div> <div class="ulist"> <div class="title">Reference</div> <ul> <li> <p><a href="../memcached/memcached.html">Infinispan Memcached Server</a></p> </li> <li> <p><a href="http://code.google.com/p/memcached/wiki/Clients">Memcached clients</a></p> </li> <li> <p><a href="http://github.com/memcached/memcached/blob/master/doc/protocol.txt">Memcached text protocol</a></p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="protocol_comparison"><a class="anchor" href="#protocol_comparison"></a>3.1.4. Protocol Comparison</h4> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 25%;"> <col style="width: 25%;"> <col style="width: 25%;"> <col style="width: 25%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top"></th> <th class="tableblock halign-center valign-top">Hot Rod</th> <th class="tableblock halign-center valign-top">HTTP / REST</th> <th class="tableblock halign-center valign-top">Memcached</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Topology-aware</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">Y</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">N</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">N</strong></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Hash-aware</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">Y</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">N</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">N</strong></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Encryption</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">Y</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">Y</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">N</strong></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Authentication</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">Y</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">Y</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">N</strong></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Conditional ops</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">Y</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">Y</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">Y</strong></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Bulk ops</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">Y</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">N</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">N</strong></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Transactions</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">Y</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">N</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">N</strong></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Listeners</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">Y</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">N</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">N</strong></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Query</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">Y</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">Y</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">N</strong></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Execution</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">Y</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">N</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">N</strong></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Cross-site failover</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">Y</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">N</strong></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">N</strong></p></td> </tr> </tbody> </table> </div> </div> <div class="sect2"> <h3 id="endpoint_connectors"><a class="anchor" href="#endpoint_connectors"></a>3.2. Endpoint Connectors</h3> <div class="paragraph"> <p>You configure Infinispan server endpoints with connector declarations that specify socket bindings, authentication mechanisms, and encryption configuration.</p> </div> <div class="paragraph"> <p>The default endpoint connector configuration is as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;endpoints</span> <span class="attribute-name">socket-binding</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;hotrod-connector</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
   <span class="tag">&lt;rest-connector</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">rest</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
   <span class="tag">&lt;memcached-connector</span> <span class="attribute-name">socket-binding</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">memcached</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/endpoints&gt;</span></code></pre> </div> </div> <div class="ulist"> <ul> <li> <p><code>endpoints</code> contains endpoint connector declarations and defines global configuration for endpoints such as default socket bindings, security realms, and whether clients must present valid TLS certificates.</p> </li> <li> <p><code>&lt;hotrod-connector name="hotrod"/&gt;</code> declares a Hot Rod connector.</p> </li> <li> <p><code>&lt;rest-connector name="rest"/&gt;</code> declares a Hot Rod connector.</p> </li> <li> <p><code>&lt;memcached-connector socket-binding="memcached"/&gt;</code> declares a Memcached connector that uses the memcached socket binding.</p> </li> </ul> </div> <div class="paragraph"> <div class="title">Reference</div> <p><a href="https://docs.jboss.org/infinispan/10.1/configdocs/">urn:infinispan:server</a> schema provides all available endpoint configuration.</p> </div> <div class="sect3"> <h4 id="hot_rod_connectors"><a class="anchor" href="#hot_rod_connectors"></a>3.2.1. Hot Rod Connectors</h4> <div class="paragraph"> <p>Hot Rod connector declarations enable Hot Rod servers.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;hotrod-connector</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;topology-state-transfer</span> <span class="tag">/&gt;</span>
  <span class="tag">&lt;authentication&gt;</span>
    ...
  <span class="tag">&lt;/authentication&gt;</span>
  <span class="tag">&lt;encryption&gt;</span>
    ...
  <span class="tag">&lt;/encryption&gt;</span>
<span class="tag">&lt;/hotrod-connector&gt;</span></code></pre> </div> </div> <div class="ulist"> <ul> <li> <p><code>name="hotrod"</code> logically names the Hot Rod connector.</p> </li> <li> <p><code>topology-state-transfer</code> tunes the state transfer operations that provide Hot Rod clients with cluster topology.</p> </li> <li> <p><code>authentication</code> configures SASL authentication mechanisms.</p> </li> <li> <p><code>encryption</code> configures TLS settings for client connections.</p> </li> </ul> </div> <div class="paragraph"> <div class="title">Reference</div> <p><a href="https://docs.jboss.org/infinispan/10.1/configdocs/">urn:infinispan:server</a> schema provides all available Hot Rod connector configuration.</p> </div> </div> <div class="sect3"> <h4 id="rest_connectors"><a class="anchor" href="#rest_connectors"></a>3.2.2. REST Connectors</h4> <div class="paragraph"> <p>REST connector declarations enable REST servers.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;rest-connector</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">rest</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;authentication&gt;</span>
    ...
  <span class="tag">&lt;/authentication&gt;</span>
  <span class="tag">&lt;cors-rules&gt;</span>
    ...
  <span class="tag">&lt;/cors-rules&gt;</span>
  <span class="tag">&lt;encryption&gt;</span>
    ...
  <span class="tag">&lt;/encryption&gt;</span>
<span class="tag">&lt;/rest-connector&gt;</span></code></pre> </div> </div> <div class="ulist"> <ul> <li> <p><code>name="rest"</code> logically names the REST connector.</p> </li> <li> <p><code>authentication</code> configures authentication mechanisms.</p> </li> <li> <p><code>cors-rules</code> specifies CORS (Cross Origin Resource Sharing) rules for cross-domain requests.</p> </li> <li> <p><code>encryption</code> configures TLS settings for client connections.</p> </li> </ul> </div> <div class="paragraph"> <div class="title">Reference</div> <p><a href="https://docs.jboss.org/infinispan/10.1/configdocs/">urn:infinispan:server</a> schema provides all available REST connector configuration.</p> </div> </div> <div class="sect3"> <h4 id="memcached_connectors"><a class="anchor" href="#memcached_connectors"></a>3.2.3. Memcached Connectors</h4> <div class="paragraph"> <p>Memcached connector declarations enable Memcached servers.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> <div class="paragraph"> <p>Infinispan servers do not enable Memcached connectors by default.</p> </div> </td> </tr> </table> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;memcached-connector</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">memcached</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">socket-binding</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">memcached</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">cache</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mycache</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span></code></pre> </div> </div> <div class="ulist"> <ul> <li> <p><code>name="memcached"</code> logically names the Memcached connector.</p> </li> <li> <p><code>socket-binding="memcached"</code> declares a unique socket binding for the Memcached connector.</p> </li> <li> <p><code>cache="mycache"</code> names the cache that the Memcached connector exposes. The default is <code>memcachedCache</code>.</p> <div class="paragraph"> <p>Memcached connectors expose a single cache only. To expose multiple caches through the Memcached endpoint, you must declare additional connectors. Each Memcached connector must also have a unique socket binding.</p> </div> </li> </ul> </div> <div class="paragraph"> <div class="title">Reference</div> <p><a href="https://docs.jboss.org/infinispan/10.1/configdocs/">urn:infinispan:server</a> schema provides all available Memcached connector configuration.</p> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="monitoring"><a class="anchor" href="#monitoring"></a>4. Monitoring Infinispan Servers</h2> <div class="sectionbody"> <div class="sect2"> <h3 id="logs"><a class="anchor" href="#logs"></a>4.1. Working with Infinispan Server Logs</h3> <div class="paragraph"> <p>Infinispan uses Apache Log4j 2 to provide configurable logging mechanisms that capture details about the environment and record cache operations for troubleshooting purposes and root cause analysis.</p> </div> <div class="sect3"> <h4 id="infinispan_log_files"><a class="anchor" href="#infinispan_log_files"></a>4.1.1. Infinispan Log Files</h4> <div class="paragraph"> <p>Infinispan writes log messages to the following directory:<br> <code>$ISPN_HOME/${infinispan.server.root}/log</code></p> </div> <div class="dlist"> <dl> <dt class="hdlist1"><code>server.log</code></dt> <dd> <p>Messages in human readable format, including boot logs that relate to the server startup.<br> Infinispan creates this file by default when you launch servers.</p> </dd> <dt class="hdlist1"><code>server.log.json</code></dt> <dd> <p>Messages in JSON format that let you parse and analyze Infinispan logs.<br> Infinispan creates this file when you enable the <code>JSON-FILE</code> appender.</p> </dd> </dl> </div> </div> <div class="sect3"> <h4 id="configuring_infinispan_log_properties"><a class="anchor" href="#configuring_infinispan_log_properties"></a>4.1.2. Configuring Infinispan Log Properties</h4> <div class="paragraph"> <p>You configure Infinispan logs with <code>log4j2.xml</code>, which is described in the <a href="https://logging.apache.org/log4j/2.x/manual">Log4j 2 manual</a>.</p> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Open <code>$ISPN_HOME/${infinispan.server.root}/conf/log4j2.xml</code> with any text editor.</p> </li> <li> <p>Change logging configuration as appropriate.</p> </li> <li> <p>Save and close <code>log4j2.xml</code>.</p> </li> </ol> </div> <div class="sect4"> <h5 id="log_levels"><a class="anchor" href="#log_levels"></a>Log Levels</h5> <div class="paragraph"> <p>Log levels indicate the nature and severity of messages.</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-center valign-top">Log level</th> <th class="tableblock halign-center valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-center valign-top"><p class="tableblock"><code>TRACE</code></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">Fine-grained debug messages, capturing the flow of individual requests through the application.</p></td> </tr> <tr> <td class="tableblock halign-center valign-top"><p class="tableblock"><code>DEBUG</code></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">Messages for general debugging, not related to an individual request.</p></td> </tr> <tr> <td class="tableblock halign-center valign-top"><p class="tableblock"><code>INFO</code></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">Messages about the overall progress of applications, including lifecycle events.</p></td> </tr> <tr> <td class="tableblock halign-center valign-top"><p class="tableblock"><code>WARN</code></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">Events that can lead to error or degrade performance.</p></td> </tr> <tr> <td class="tableblock halign-center valign-top"><p class="tableblock"><code>ERROR</code></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">Error conditions that might prevent operations or activites from being successful but do not prevent applications from running.</p></td> </tr> <tr> <td class="tableblock halign-center valign-top"><p class="tableblock"><code>FATAL</code></p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">Events that could cause critical service failure and application shutdown.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>In addition to the levels of individual messages presented above, the configuration allows two more values: <code>ALL</code> to include all messages, and <code>OFF</code> to exclude all messages.</p> </div> </div> <div class="sect4"> <h5 id="infinispan_log_categories"><a class="anchor" href="#infinispan_log_categories"></a>Infinispan Log Categories</h5> <div class="paragraph"> <p>Infinispan provides categories for <code>INFO</code>, <code>WARN</code>, <code>ERROR</code>, <code>FATAL</code> level messages that organize logs by functional area.</p> </div> <div class="dlist"> <dl> <dt class="hdlist1"><code>org.infinispan.CLUSTER</code></dt> <dd> <p>Messages specific to Infinispan clustering that include state transfer operations, rebalancing events, partitioning, and so on.</p> </dd> <dt class="hdlist1"><code>org.infinispan.CONFIG</code></dt> <dd> <p>Messages specific to Infinispan configuration.</p> </dd> <dt class="hdlist1"><code>org.infinispan.CONTAINER</code></dt> <dd> <p>Messages specific to the data container that include expiration and eviction operations, cache listener notifications, transactions, and so on.</p> </dd> <dt class="hdlist1"><code>org.infinispan.PERSISTENCE</code></dt> <dd> <p>Messages specific to cache loaders and stores.</p> </dd> <dt class="hdlist1"><code>org.infinispan.SECURITY</code></dt> <dd> <p>Messages specific to Infinispan security.</p> </dd> <dt class="hdlist1"><code>org.infinispan.SERVER</code></dt> <dd> <p>Messages specific to Infinispan servers.</p> </dd> <dt class="hdlist1"><code>org.infinispan.XSITE</code></dt> <dd> <p>Messages specific to cross-site replication operations.</p> </dd> </dl> </div> </div> <div class="sect4"> <h5 id="log_appenders"><a class="anchor" href="#log_appenders"></a>Log Appenders</h5> <div class="paragraph"> <p>Log appenders define how Infinispan records log messages.</p> </div> <div class="dlist"> <dl> <dt class="hdlist1">CONSOLE</dt> <dd> <p>Write log messages to the host standard out (<code>stdout</code>) or standard error (<code>stderr</code>) stream.<br> Uses the <code>org.apache.logging.log4j.core.appender.ConsoleAppender</code> class by default.</p> </dd> <dt class="hdlist1">FILE</dt> <dd> <p>Write log messages to a file.<br> Uses the <code>org.apache.logging.log4j.core.appender.RollingFileAppender</code> class by default.</p> </dd> <dt class="hdlist1">JSON-FILE</dt> <dd> <p>Write log messages to a file in JSON format.<br> Uses the <code>org.apache.logging.log4j.core.appender.RollingFileAppender</code> class by default.</p> </dd> </dl> </div> </div> <div class="sect4"> <h5 id="log_patterns"><a class="anchor" href="#log_patterns"></a>Log Patterns</h5> <div class="paragraph"> <p>The <code>CONSOLE</code> and <code>FILE</code> appenders use a <a href="https://logging.apache.org/log4j/2.x/manual/layouts.html#PatternLayout"><code>PatternLayout</code></a> to format the log messages according to a <strong>pattern</strong>.</p> </div> <div class="paragraph"> <p>An example is the default pattern in the FILE appender:<br> <code>%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p (%t) [%c{1}] %m%throwable%n</code></p> </div> <div class="ulist"> <ul> <li> <p><code>%d{yyyy-MM-dd HH:mm:ss,SSS}</code> adds the current time and date.</p> </li> <li> <p><code>%-5p</code> specifies the log level, aligned to the right.</p> </li> <li> <p><code>%t</code> adds the name of the current thread.</p> </li> <li> <p><code>%c{1}</code> adds the short name of the logging category.</p> </li> <li> <p><code>%m</code> adds the log message.</p> </li> <li> <p><code>%throwable</code> adds the exception stack trace.</p> </li> <li> <p><code>%n</code> adds a new line.</p> </li> </ul> </div> <div class="paragraph"> <p>Patterns are fully described in <a href="https://logging.apache.org/log4j/2.x/manual/layouts.html#PatternLayout">the <code>PatternLayout</code> documentation</a> .</p> </div> </div> <div class="sect4"> <h5 id="enabling_and_configuring_the_json_log_handler"><a class="anchor" href="#enabling_and_configuring_the_json_log_handler"></a>Enabling and Configuring the JSON Log Handler</h5> <div class="paragraph"> <p>Infinispan provides a JSON log handler to write messages in JSON format.</p> </div> <div class="paragraph"> <div class="title">Prerequisites</div> <p>Ensure that Infinispan is not running. You cannot dynamically enable log handlers.</p> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Open <code>$ISPN_HOME/${infinispan.server.root}/conf/log4j2.xml</code> with any text editor.</p> </li> <li> <p>Uncomment the <code>JSON-FILE</code> appender and comment out the <code>FILE</code> appender:</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml">      <span class="comment">&lt;!--&lt;AppenderRef ref=&quot;FILE&quot;/&gt;--&gt;</span>
      <span class="tag">&lt;AppenderRef</span> <span class="attribute-name">ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">JSON-FILE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre> </div> </div> </li> <li> <p>Optionally configure the JSON <a href="https://logging.apache.org/log4j/2.x/manual/appenders.html#RollingFileAppender">appender</a> and <a href="https://logging.apache.org/log4j/2.x/manual/layouts.html#JSONLayout"> layout</a>.</p> </li> <li> <p>Save and close <code>logging.properties</code>.</p> </li> </ol> </div> <div class="paragraph"> <p>When you start Infinispan, it writes each log message as a JSON map in the following file:<br> <code>$ISPN_HOME/${infinispan.server.root}/log/server.log.json</code></p> </div> </div> </div> <div class="sect3"> <h4 id="server_access_logs"><a class="anchor" href="#server_access_logs"></a>4.1.3. Access Logs</h4> <div class="paragraph"> <p>Hot Rod and REST endpoints can record all inbound client requests as log entries with the following categories:</p> </div> <div class="ulist"> <ul> <li> <p><code>org.infinispan.HOTROD_ACCESS_LOG</code> logging category for the Hot Rod endpoint.</p> </li> <li> <p><code>org.infinispan.REST_ACCESS_LOG</code> logging category for the REST endpoint.</p> </li> </ul> </div> <div class="sect4"> <h5 id="enabling_access_logs"><a class="anchor" href="#enabling_access_logs"></a>Enabling Access Logs</h5> <div class="paragraph"> <p>Access logs for Hot Rod and REST endpoints are disabled by default. To enable either logging category, set the level to <code>TRACE</code> in the Infinispan logging configuration, as in the following example:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;Logger</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.infinispan.HOTROD_ACCESS_LOG</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">additivity</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INFO</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;AppenderRef</span> <span class="attribute-name">ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">HR-ACCESS-FILE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/Logger&gt;</span></code></pre> </div> </div> </div> <div class="sect4"> <h5 id="access_log_properties"><a class="anchor" href="#access_log_properties"></a>Access Log Properties</h5> <div class="paragraph"> <p>The default format for access logs is as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>`%X{address} %X{user} [%d{dd/MMM/yyyy:HH:mm:ss Z}] &amp;quot;%X{method} %m %X{protocol}&amp;quot; %X{status} %X{requestSize} %X{responseSize} %X{duration}%n`</code></pre> </div> </div> <div class="paragraph"> <p>The preceding format creates log entries such as the following:</p> </div> <div class="paragraph"> <p><code>127.0.0.1 - [DD/MM/YYYY:HH:MM:SS +0000] "PUT /rest/v2/caches/default/key HTTP/1.1" 404 5 77 10</code></p> </div> <div class="paragraph"> <p>Logging properties use the <code>%X{name}</code> notation and let you modify the format of access logs. The following are the default logging properties:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Property</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>address</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Either the <code>X-Forwarded-For</code> header or the client IP address.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>user</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Principal name, if using authentication.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>method</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Method used. <code>PUT</code>, <code>GET</code>, and so on.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>protocol</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Protocol used. <code>HTTP/1.1</code>, <code>HTTP/2</code>, <code>HOTROD/2.9</code>, and so on.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>status</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">An HTTP status code for the REST endpoint. <code>OK</code> or an exception for the Hot Rod endpoint.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>requestSize</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Size, in bytes, of the request.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>responseSize</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Size, in bytes, of the response.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>duration</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of milliseconds that the server took to handle the request.</p></td> </tr> </tbody> </table> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> <div class="paragraph"> <p>Use the header name prefixed with <code>h:</code> to log headers that were included in requests; for example, <code>%X{h:User-Agent}</code>.</p> </div> </td> </tr> </table> </div> </div> </div> </div> <div class="sect2"> <h3 id="server_health"><a class="anchor" href="#server_health"></a>4.2. Retrieving Server Health Statistics</h3> <div class="paragraph"> <p>Monitor the health of your Infinispan clusters in the following ways:</p> </div> <div class="ulist"> <ul> <li> <p>Programmatically with <code>embeddedCacheManager.getHealth()</code> method calls.</p> </li> <li> <p>JMX MBeans</p> </li> <li> <p>Infinispan REST Server</p> </li> </ul> </div> <div class="sect3"> <h4 id="accessing_the_health_api_via_jmx"><a class="anchor" href="#accessing_the_health_api_via_jmx"></a>4.2.1. Accessing the Health API via JMX</h4> <div class="paragraph"> <p>Retrieve Infinispan cluster health statistics via JMX.</p> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Connect to Infinispan server using any JMX capable tool such as JConsole and navigate to the following object:</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>org.infinispan:type=CacheManager,name=&quot;default&quot;,component=CacheContainerHealth</code></pre> </div> </div> </li> <li> <p>Select available MBeans to retrieve cluster health statistics.</p> </li> </ol> </div> </div> <div class="sect3"> <h4 id="accessing_the_health_api_via_rest"><a class="anchor" href="#accessing_the_health_api_via_rest"></a>4.2.2. Accessing the Health API via REST</h4> <div class="paragraph"> <p>Get Infinispan cluster health via the REST API.</p> </div> <div class="ulist"> <div class="title">Procedure</div> <ul> <li> <p>Invoke a <code>GET</code> request to retrieve cluster health.</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="bash">GET /rest/v2/cache-managers/{cacheManagerName}/health</code></pre> </div> </div> </li> </ul> </div> <div class="paragraph"> <p>Infinispan responds with a <code>JSON</code> document such as the following:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cluster_health</span><span class="delimiter">&quot;</span></span>:{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">cluster_name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">ISPN</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">health_status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">HEALTHY</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">number_of_nodes</span><span class="delimiter">&quot;</span></span>:<span class="integer">2</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">node_names</span><span class="delimiter">&quot;</span></span>:[
            <span class="string"><span class="delimiter">&quot;</span><span class="content">NodeA-36229</span><span class="delimiter">&quot;</span></span>,
            <span class="string"><span class="delimiter">&quot;</span><span class="content">NodeB-28703</span><span class="delimiter">&quot;</span></span>
        ]
    },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_health</span><span class="delimiter">&quot;</span></span>:[
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">HEALTHY</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">___protobuf_metadata</span><span class="delimiter">&quot;</span></span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">HEALTHY</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">cache2</span><span class="delimiter">&quot;</span></span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">HEALTHY</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">mycache</span><span class="delimiter">&quot;</span></span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">HEALTHY</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">cache1</span><span class="delimiter">&quot;</span></span>
        }
    ]

}</code></pre> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> <div class="paragraph"> <p>Get cache manager status as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/health/status</code></pre> </div> </div> </td> </tr> </table> </div> <div class="paragraph"> <div class="title">Reference</div> <p>See the <em>REST v2 (version 2) API</em> documentation for more information.</p> </div> </div> </div> <div class="sect2"> <h3 id="jmx_stats"><a class="anchor" href="#jmx_stats"></a>4.3. Enabling and Collecting JMX Statistics</h3> <div class="paragraph"> <p>Infinispan exposes JMX objects that you can use to collect statistics, monitor deployments, and manage Infinispan clusters.</p> </div> <div class="sect3"> <h4 id="enable_statistics-server"><a class="anchor" href="#enable_statistics-server"></a>4.3.1. Enabling JMX Statistics</h4> <div class="paragraph"> <p>Infinispan always creates and registers MBeans but only exposes meaningful values if you explicitly enable JMX statistics.</p> </div> <div class="ulist"> <div class="title">Procedure</div> <ul> <li> <p>Enable statistics globally or for specific caches.</p> </li> </ul> </div> <div class="paragraph"> <div class="title">Declaratively</div> <p>Globally enable statistics:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;cache-container</span> <span class="attribute-name">statistics</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre> </div> </div> <div class="paragraph"> <p>Enable statistics at the cache level:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;local-cache</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mycache</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">statistics</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre> </div> </div> <div class="paragraph"> <div class="title">Programmatically</div> <p>Globally enable statistics:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java">GlobalConfigurationBuilder globalConfigurationBuilder = ...
globalConfigurationBuilder.globalJmxStatistics().enable();</code></pre> </div> </div> <div class="paragraph"> <p>Enable statistics at the cache level:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java">ConfigurationBuilder configurationBuilder = ...
configurationBuilder.jmxStatistics().enable();</code></pre> </div> </div> <div class="ulist"> <div class="title">Reference</div> <ul> <li> <p><a href="https://docs.jboss.org/infinispan/10.1/apidocs/org/infinispan/configuration/global/GlobalConfigurationBuilder.html">GlobalConfigurationBuilder</a></p> </li> <li> <p><a href="https://docs.jboss.org/infinispan/10.1/apidocs/org/infinispan/configuration/cache/ConfigurationBuilder.html">ConfigurationBuilder</a></p> </li> <li> <p><a href="https://docs.jboss.org/infinispan/10.1/configdocs/">Infinispan Configuration Schema</a></p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="jmx_mbeans-server"><a class="anchor" href="#jmx_mbeans-server"></a>4.3.2. Infinispan MBeans</h4> <div class="paragraph"> <p>Infinispan exposes JMX MBeans that represent manageable resources.</p> </div> <div class="dlist"> <dl> <dt class="hdlist1"><code>org.infinispan:type=Cache</code></dt> <dd> <p>Attributes and operations available for cache instances.</p> </dd> <dt class="hdlist1"><code>org.infinispan:type=CacheManager</code></dt> <dd> <p>Attributes and operations available for cache managers, including Infinispan cache and cluster health statistics.</p> </dd> </dl> </div> <div class="paragraph"> <p>For a complete list of available JMX MBeans along with descriptions and available operations and attributes, see the <em>Infinispan JMX Components</em> documentation.</p> </div> <div class="paragraph"> <div class="title">Reference</div> <p><a href="https://docs.jboss.org/infinispan/10.1/apidocs/jmxComponents.html">Infinispan JMX Components</a></p> </div> </div> <div class="sect3"> <h4 id="name_cache_managers-server"><a class="anchor" href="#name_cache_managers-server"></a>4.3.3. Naming Multiple Cache Managers</h4> <div class="paragraph"> <p>In cases where multiple Infinispan cache managers run on the same JVM, you should uniquely identify each cache manager to prevent conflicts.</p> </div> <div class="ulist"> <div class="title">Procedure</div> <ul> <li> <p>Uniquely identify each cache manager in your environment.</p> </li> </ul> </div> <div class="paragraph"> <p>For example, the following examples specify "Hibernate2LC" as the cache manager name, which results in a JMX MBean named <code>org.infinispan:type=CacheManager,name="Hibernate2LC"</code>.</p> </div> <div class="listingblock"> <div class="title">Declaratively</div> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;cache-container</span> <span class="attribute-name">statistics</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Hibernate2LC</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre> </div> </div> <div class="listingblock"> <div class="title">Programmatically</div> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java">GlobalConfigurationBuilder globalConfigurationBuilder = ...
globalConfigurationBuilder.globalJmxStatistics()
    .enable()
    .cacheManagerName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hibernate2LC</span><span class="delimiter">&quot;</span></span>);</code></pre> </div> </div> <div class="ulist"> <div class="title">Reference</div> <ul> <li> <p><a href="https://docs.jboss.org/infinispan/10.1/apidocs/org/infinispan/configuration/global/GlobalConfigurationBuilder.html">GlobalConfigurationBuilder</a></p> </li> <li> <p><a href="https://docs.jboss.org/infinispan/10.1/configdocs/">Infinispan Configuration Schema</a></p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="register_mbeans-server"><a class="anchor" href="#register_mbeans-server"></a>4.3.4. Registering MBeans In Custom MBean Servers</h4> <div class="paragraph"> <p>Infinispan includes an <code>MBeanServerLookup</code> interface that you can use to register MBeans in custom MBeanServer instances.</p> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Create an implementation of <code>MBeanServerLookup</code> so that the <code>getMBeanServer()</code> method returns the custom MBeanServer instance.</p> </li> <li> <p>Configure Infinispan with the fully qualified name of your class, as in the following example:</p> </li> </ol> </div> <div class="listingblock"> <div class="title">Declaratively</div> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;cache-container</span> <span class="attribute-name">statistics</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;jmx</span> <span class="attribute-name">mbean-server-lookup</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">com.acme.MyMBeanServerLookup</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;/cache-container&gt;</span></code></pre> </div> </div> <div class="listingblock"> <div class="title">Programmatically</div> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java">GlobalConfigurationBuilder globalConfigurationBuilder = ...
globalConfigurationBuilder.globalJmxStatistics()
    .enable()
    .mBeanServerLookup(<span class="keyword">new</span> com.acme.MyMBeanServerLookup());</code></pre> </div> </div> <div class="ulist"> <div class="title">Reference</div> <ul> <li> <p><a href="https://docs.jboss.org/infinispan/10.1/configdocs/">Infinispan Configuration Schema</a></p> </li> <li> <p><a href="https://docs.jboss.org/infinispan/10.1/apidocs/org/infinispan/commons/jmx/MBeanServerLookup.html">MBeanServerLookup</a></p> </li> </ul> </div> </div> </div> <div class="sect2"> <h3 id="metric_endpoint"><a class="anchor" href="#metric_endpoint"></a>4.4. Collecting Infinispan Metrics</h3> <div class="paragraph"> <p>Infinispan servers provide monitoring data through an HTTP <code>metrics</code> endpoint that exposes OS, JVM, and application-level statistics.</p> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Start at least one Infinispan server.</p> </li> <li> <p>Test the metrics endpoint with any HTTP client, as in the following examples:</p> <div class="paragraph"> <p>To get metrics in Prometheus or OpenMetrics format:</p> </div> <div class="listingblock"> <div class="content"> <pre>$ curl -v http://localhost:11222/metrics</pre> </div> </div> <div class="paragraph"> <p>To get metrics in Microprofile JSON format:</p> </div> <div class="listingblock"> <div class="content"> <pre>$ curl --header "Accept: application/json" http://localhost:11222/metrics</pre> </div> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> <div class="paragraph"> <p>If you configure Infinispan servers with security, you should include the appropriate credentials or client certificates to access the metrics endpoint.</p> </div> </td> </tr> </table> </div> <div class="paragraph"> <p>Infinispan responds with monitoring data.</p> </div> </li> </ol> </div> <div class="paragraph"> <div class="title">Next steps</div> <p>Configure monitoring applications to collect Infinispan metrics from the endpoint as appropriate. For example, add the following to your <code>prometheus.yml</code> file:</p> </div> <div class="listingblock"> <div class="content"> <pre>static_configs:
    - targets: ['localhost:9090', 'localhost:11222']</pre> </div> </div> <div class="ulist"> <div class="title">Reference</div> <ul> <li> <p><a href="https://github.com/eclipse/microprofile-metrics/blob/master/README.adoc">Eclipse Microprofile Metrics</a></p> </li> <li> <p><a href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/">Prometheus Configuration</a></p> </li> </ul> </div> </div> </div> </div> <div class="sect1"> <h2 id="security"><a class="anchor" href="#security"></a>5. Securing Infinispan Servers</h2> <div class="sectionbody"> <div class="paragraph"> <p>Protect Infinispan servers against network attacks and unauthorized access.</p> </div> <div class="sect2"> <h3 id="cache_authorization-server"><a class="anchor" href="#cache_authorization-server"></a>5.1. Cache Authorization</h3> <div class="paragraph"> <p>Infinispan can restrict access to data by authorizing requests to perform cache operations.</p> </div> <div class="paragraph"> <p>Infinispan maps identities, or Principals of type <code>java.security.Principal</code>, to security roles in your configuration. For example, a Principal named <code>reader</code> maps to a security role named <code>reader</code>.</p> </div> <div class="paragraph"> <p>Infinispan lets you assign permissions to the various roles to authorize cache operations. For example, <code>Cache.get()</code> requires read permission while <code>Cache.put()</code> requires write permission.</p> </div> <div class="paragraph"> <p>In this case, iff a client with the <code>reader</code> role attempts to write an entry, Infinispan denies the request and throws a security exception. However, if a client with the <code>writer</code> role sends a write request, Infinispan validates authorization and issues the client with a token for subsequent operations.</p> </div> <div class="sect3"> <h4 id="authorization_config-server"><a class="anchor" href="#authorization_config-server"></a>5.1.1. Cache Authorization Configuration</h4> <div class="paragraph"> <p>Infinispan configuration for cache authorization is as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;infinispan&gt;</span>
   <span class="tag">&lt;cache-container</span> <span class="attribute-name">default-cache</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secured</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secured</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;security&gt;</span>
         <span class="tag">&lt;authorization&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="tag">&lt;identity-role-mapper</span> <span class="tag">/&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
            <span class="tag">&lt;role</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">admin</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">permissions</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ALL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span> <i class="conum" data-value="3"></i><b>(3)</b>
            <span class="tag">&lt;role</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">reader</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">permissions</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">READ</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
            <span class="tag">&lt;role</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">writer</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">permissions</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WRITE</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
            <span class="tag">&lt;role</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">supervisor</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">permissions</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">READ WRITE EXEC</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
         <span class="tag">&lt;/authorization&gt;</span>
      <span class="tag">&lt;/security&gt;</span>
      <span class="tag">&lt;local-cache</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secured</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;security&gt;</span>
            <span class="tag">&lt;authorization</span> <span class="attribute-name">roles</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">admin reader writer supervisor</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span> <i class="conum" data-value="4"></i><b>(4)</b>
         <span class="tag">&lt;/security&gt;</span>
      <span class="tag">&lt;/local-cache&gt;</span>
   <span class="tag">&lt;/cache-container&gt;</span>

<span class="tag">&lt;/infinispan&gt;</span></code></pre> </div> </div> <div class="colist arabic"> <table> <tr> <td><i class="conum" data-value="1"></i><b>1</b></td> <td>configures cache authorization for the cache container.</td> </tr> <tr> <td><i class="conum" data-value="2"></i><b>2</b></td> <td>specifies an implementation of <code>PrincipalRoleMapper</code> that converts Principal names to roles.</td> </tr> <tr> <td><i class="conum" data-value="3"></i><b>3</b></td> <td>names roles and assigns permissions that control access to data.</td> </tr> <tr> <td><i class="conum" data-value="4"></i><b>4</b></td> <td>defines the authorized roles for the cache.</td> </tr> </table> </div> <div class="ulist"> <div class="title">Reference</div> <ul> <li> <p><a href="https://docs.jboss.org/infinispan/10.1/configdocs/">Infinispan Configuration</a></p> </li> <li> <p><a href="https://docs.jboss.org/infinispan/10.1/apidocs/org/infinispan/security/PrincipalRoleMapper.html">org.infinispan.security.PrincipalRoleMapper</a></p> </li> </ul> </div> </div> </div> <div class="sect2"> <h3 id="server_realms"><a class="anchor" href="#server_realms"></a>5.2. Defining Infinispan Server Security Realms</h3> <div class="paragraph"> <p>Security realms provide identity, encryption, authentication, and authorization information to Infinispan server endpoints.</p> </div> <div class="sect3"> <h4 id="property_realm-server"><a class="anchor" href="#property_realm-server"></a>5.2.1. Property Realms</h4> <div class="paragraph"> <p>Property realms use property files to define users and groups.</p> </div> <div class="paragraph"> <p><code>users.properties</code> maps usernames to passwords in plain-text format. Passwords can also be pre-digested if you use the <code>DIGEST-MD5</code> SASL mechanism or <code>Digest</code> HTTP mechanism.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>myuser=a_password
user2=another_password</code></pre> </div> </div> <div class="paragraph"> <p><code>groups.properties</code> maps users to roles.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>supervisor=myuser,user2
reader=myuser
writer=myuser</code></pre> </div> </div> <div class="listingblock"> <div class="title">Property realm configuration</div> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;security</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1 https://infinispan.org/schemas/infinispan-server-10.1.xsd</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;properties-realm</span> <span class="attribute-name">groups-attribute</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="tag">&lt;user-properties</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">users.properties</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="2"></i><b>(2)</b>
                             <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="3"></i><b>(3)</b>
                             <span class="attribute-name">plain-text</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span> <i class="conum" data-value="4"></i><b>(4)</b>
            <span class="tag">&lt;group-properties</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">groups.properties</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="5"></i><b>(5)</b>
                              <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
         <span class="tag">&lt;/properties-realm&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
   <span class="tag">&lt;/security-realms&gt;</span>
<span class="tag">&lt;/security&gt;</span></code></pre> </div> </div> <div class="colist arabic"> <table> <tr> <td><i class="conum" data-value="1"></i><b>1</b></td> <td>Defines groups as roles for Infinispan server authorization.</td> </tr> <tr> <td><i class="conum" data-value="2"></i><b>2</b></td> <td>Specifies the <code>users.properties</code> file.</td> </tr> <tr> <td><i class="conum" data-value="3"></i><b>3</b></td> <td>Specifies that the file is relative to the <code>$ISPN_HOME/server/conf</code> directory.</td> </tr> <tr> <td><i class="conum" data-value="4"></i><b>4</b></td> <td>Specifies that the passwords in <code>users.properties</code> are in plain-text format.</td> </tr> <tr> <td><i class="conum" data-value="5"></i><b>5</b></td> <td>Specifies the <code>groups.properties</code> file.</td> </tr> </table> </div> <div class="paragraph"> <div class="title">Supported authentication mechanisms</div> <p>Property realms support the following authentication mechanisms:</p> </div> <div class="ulist"> <ul> <li> <p><strong>SASL:</strong> <code>PLAIN</code>, <code>DIGEST-*</code>, and <code>SCRAM-*</code></p> </li> <li> <p><strong>HTTP (REST):</strong> <code>Basic</code> and <code>Digest</code></p> </li> </ul> </div> <div class="sect4"> <h5 id="user_tool-server"><a class="anchor" href="#user_tool-server"></a>Adding Users to Property Realms</h5> <div class="paragraph"> <p>Infinispan server provides a <code>user-tool</code> script that lets you easily add new user/role mappings to properties files.</p> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Navigate to your <code>$ISPN_HOME</code> directory.</p> </li> <li> <p>Run the <code>user-tool</code> script in the <code>bin</code> folder.</p> </li> </ol> </div> <div class="paragraph"> <p>For example, create a new user named "myuser" with a password of "qwer1234!" that belongs to the "supervisor", "reader", and "writer" groups:</p> </div> <div class="dlist"> <dl> <dt class="hdlist1">Linux</dt> </dl> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>$ bin/user-tools.sh -a -u myuser -p &quot;qwer1234!&quot; -g supervisor,reader,writer</code></pre> </div> </div> <div class="dlist"> <dl> <dt class="hdlist1">Microsoft Windows</dt> </dl> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>$ bin\user-tools.bat -a -u myuser -p &quot;qwer1234!&quot; -g supervisor,reader,writer</code></pre> </div> </div> </div> </div> <div class="sect3"> <h4 id="ldap_realm-server"><a class="anchor" href="#ldap_realm-server"></a>5.2.2. LDAP Realms</h4> <div class="paragraph"> <p>LDAP realms connect to LDAP servers, such as OpenLDAP, Red Hat Directory Server, Apache Directory Server, or Microsoft Active Directory, to authenticate users and obtain membership information.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> <div class="paragraph"> <p>LDAP servers can have different entry layouts, depending on the type of server and deployment. For this reason, LDAP realm configuration is complex. It is beyond the scope of this document to provide examples for all possibile configurations.</p> </div> </td> </tr> </table> </div> <div class="listingblock"> <div class="title">LDAP realm configuration</div> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;security</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1 https://infinispan.org/schemas/infinispan-server-10.1.xsd</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;ldap-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ldap</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="1"></i><b>(1)</b>
                    <span class="attribute-name">url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ldap://my-ldap-server:10389</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="2"></i><b>(2)</b>
                    <span class="attribute-name">principal</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">uid=admin,ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="3"></i><b>(3)</b>
                    <span class="attribute-name">credential</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">strongPassword</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">connection-timeout</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3000</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">read-timeout</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">30000</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="4"></i><b>(4)</b>
                    <span class="attribute-name">connection-pooling</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">referral-mode</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ignore</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">page-size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">30</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">direct-verification</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span> <i class="conum" data-value="5"></i><b>(5)</b>
            <span class="tag">&lt;identity-mapping</span> <span class="attribute-name">rdn-identifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">uid</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="6"></i><b>(6)</b>
                              <span class="attribute-name">search-dn</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span> <i class="conum" data-value="7"></i><b>(7)</b>
               <span class="tag">&lt;attribute-mapping&gt;</span> <i class="conum" data-value="8"></i><b>(8)</b>
                  <span class="tag">&lt;attribute</span> <span class="attribute-name">from</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cn</span><span class="delimiter">&quot;</span></span>
                             <span class="attribute-name">to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>
                             <span class="attribute-name">filter</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">(</span><span class="entity">&amp;amp;</span><span class="content">(objectClass=groupOfNames)(member={1}))</span><span class="delimiter">&quot;</span></span>
                             <span class="attribute-name">filter-dn</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ou=Roles,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
               <span class="tag">&lt;/attribute-mapping&gt;</span>
            <span class="tag">&lt;/identity-mapping&gt;</span>
         <span class="tag">&lt;/ldap-realm&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
   <span class="tag">&lt;/security-realms&gt;</span>
<span class="tag">&lt;/security&gt;</span></code></pre> </div> </div> <div class="colist arabic"> <table> <tr> <td><i class="conum" data-value="1"></i><b>1</b></td> <td>Names the LDAP realm.</td> </tr> <tr> <td><i class="conum" data-value="2"></i><b>2</b></td> <td>Specifies the LDAP server connection URL.</td> </tr> <tr> <td><i class="conum" data-value="3"></i><b>3</b></td> <td>Specifies a principal and credentials to connect to the LDAP server. <div class="admonitionblock important"> <table> <tr> <td class="icon"> <i class="fa icon-important" title="Important"></i> </td> <td class="content"> <div class="paragraph"> <p>The principal for LDAP connections must have necessary privileges to perform LDAP queries and access specific attributes.</p> </div> </td> </tr> </table> </div></td> </tr> <tr> <td><i class="conum" data-value="4"></i><b>4</b></td> <td>Optionally tunes LDAP server connections by specifying connection timeouts and so on.</td> </tr> <tr> <td><i class="conum" data-value="5"></i><b>5</b></td> <td>Verifies user credentials. Infinispan attempts to connect to the LDAP server using the configured credentials. Alternatively, you can use the <code>user-password-mapper</code> element that specifies a password.</td> </tr> <tr> <td><i class="conum" data-value="6"></i><b>6</b></td> <td>Maps LDAP entries to identities. The <code>rdn-identifier</code> specifies an LDAP attribute that finds the user entry based on a provided identifier, which is typically a username; for example, the <code>uid</code> or <code>sAMAccountName</code> attribute.</td> </tr> <tr> <td><i class="conum" data-value="7"></i><b>7</b></td> <td>Defines a starting context that limits searches to the LDAP subtree that contains the user entries.</td> </tr> <tr> <td><i class="conum" data-value="8"></i><b>8</b></td> <td>Retrieves all the groups of which the user is a member. There are typically two ways in which membership information is stored: <div class="ulist"> <ul> <li> <p>Under group entries that usually have class <code>groupOfNames</code> in the <code>member</code> attribute. In this case, you can use an attribute filter as in the preceding example configuration. This filter searches for entries that match the supplied filter, which locates groups with a <code>member</code> attribute equal to the user&#8217;s DN. The filter then extracts the group entry&#8217;s CN as specified by <code>from</code>, and adds it to the user&#8217;s <code>Roles</code>.</p> </li> <li> <p>In the user entry in the <code>memberOf</code> attribute. In this case you should use an attribute reference such as the following:</p> <div class="paragraph"> <p><code>&lt;attribute-reference reference="memberOf" from="cn" to="Roles" /&gt;</code></p> </div> <div class="paragraph"> <p>This reference gets all <code>memberOf</code> attributes from the user&#8217;s entry, extracts the CN as specified by <code>from</code>, and adds them to the user&#8217;s <code>Roles</code>.</p> </div> </li> </ul> </div></td> </tr> </table> </div> <div class="paragraph"> <div class="title">Supported authentication mechanisms</div> <p>LDAP realms support the following authentication mechanisms directly:</p> </div> <div class="ulist"> <ul> <li> <p><strong>SASL:</strong> <code>PLAIN</code>, <code>DIGEST-*</code>, and <code>SCRAM-*</code></p> </li> <li> <p><strong>HTTP (REST):</strong> <code>Basic</code> and <code>Digest</code></p> </li> </ul> </div> <div class="sect4"> <h5 id="ldap_realm_rewriting-server"><a class="anchor" href="#ldap_realm_rewriting-server"></a>LDAP Realm Principal Rewriting</h5> <div class="paragraph"> <p>Some SASL authentication mechanisms, such as <code>GSSAPI</code>, <code>GS2-KRB5</code> and <code>Negotiate</code>, supply a username that needs to be <em>cleaned up</em> before you can use it to search LDAP servers.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;security</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1 https://infinispan.org/schemas/infinispan-server-10.1.xsd</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;ldap-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ldap</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ldap://${org.infinispan.test.host.address}:10389</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">principal</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">uid=admin,ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span>
                     <span class="attribute-name">credential</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">strongPassword</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;name-rewriter&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
               <span class="tag">&lt;regex-principal-transformer</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">domain-remover</span><span class="delimiter">&quot;</span></span>
                                            <span class="attribute-name">pattern</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">(.*)@INFINISPAN\.ORG</span><span class="delimiter">&quot;</span></span>
                                            <span class="attribute-name">replacement</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">$1</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/name-rewriter&gt;</span>
            <span class="tag">&lt;identity-mapping</span> <span class="attribute-name">rdn-identifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">uid</span><span class="delimiter">&quot;</span></span>
                              <span class="attribute-name">search-dn</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ou=People,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
               <span class="tag">&lt;attribute-mapping&gt;</span>
                  <span class="tag">&lt;attribute</span> <span class="attribute-name">from</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cn</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Roles</span><span class="delimiter">&quot;</span></span>
                             <span class="attribute-name">filter</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">(</span><span class="entity">&amp;amp;</span><span class="content">(objectClass=groupOfNames)(member={1}))</span><span class="delimiter">&quot;</span></span>
                             <span class="attribute-name">filter-dn</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ou=Roles,dc=infinispan,dc=org</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
               <span class="tag">&lt;/attribute-mapping&gt;</span>
               <span class="tag">&lt;user-password-mapper</span> <span class="attribute-name">from</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">userPassword</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
            <span class="tag">&lt;/identity-mapping&gt;</span>
         <span class="tag">&lt;/ldap-realm&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
   <span class="tag">&lt;/security-realms&gt;</span>
<span class="tag">&lt;/security&gt;</span></code></pre> </div> </div> <div class="colist arabic"> <table> <tr> <td><i class="conum" data-value="1"></i><b>1</b></td> <td>Defines a rewriter that extracts the username from the principal using a regular expression.</td> </tr> </table> </div> </div> </div> <div class="sect3"> <h4 id="trust_store_realm-server"><a class="anchor" href="#trust_store_realm-server"></a>5.2.3. Trust Store Realms</h4> <div class="paragraph"> <p>Trust store realms use keystores that contain the public certificates of all clients that are allowed to connect to Infinispan server.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;security</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1 https://infinispan.org/schemas/infinispan-server-10.1.xsd</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;server-identities&gt;</span>
            <span class="tag">&lt;ssl&gt;</span>
               <span class="tag">&lt;keystore</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="1"></i><b>(1)</b>
                         <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="2"></i><b>(2)</b>
                         <span class="attribute-name">keystore-password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="3"></i><b>(3)</b>
                         <span class="attribute-name">alias</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span> <i class="conum" data-value="4"></i><b>(4)</b>
            <span class="tag">&lt;/ssl&gt;</span>
         <span class="tag">&lt;/server-identities&gt;</span>
         <span class="tag">&lt;truststore-realm</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">trust.p12</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="5"></i><b>(5)</b>
                           <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>
                           <span class="attribute-name">keystore-password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
   <span class="tag">&lt;/security-realms&gt;</span>
<span class="tag">&lt;/security&gt;</span></code></pre> </div> </div> <div class="colist arabic"> <table> <tr> <td><i class="conum" data-value="1"></i><b>1</b></td> <td>Provides an SSL server identity with a keystore that contains server certificates.</td> </tr> <tr> <td><i class="conum" data-value="2"></i><b>2</b></td> <td>Specifies that the file is relative to the <code>$ISPN_HOME/server/conf</code> directory.</td> </tr> <tr> <td><i class="conum" data-value="3"></i><b>3</b></td> <td>Specifies a keystore password.</td> </tr> <tr> <td><i class="conum" data-value="4"></i><b>4</b></td> <td>Specifies a keystore alias.</td> </tr> <tr> <td><i class="conum" data-value="5"></i><b>5</b></td> <td>Provides a keystore that contains public certificates of all clients.</td> </tr> </table> </div> <div class="paragraph"> <div class="title">Supported authentication mechanisms</div> <p>Trust store realms work with client-certificate authentication mechanisms:</p> </div> <div class="ulist"> <ul> <li> <p><strong>SASL:</strong> <code>EXTERNAL</code></p> </li> <li> <p><strong>HTTP (REST):</strong> <code>CLIENT_CERT</code></p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="token_realm-server"><a class="anchor" href="#token_realm-server"></a>5.2.4. Token Realms</h4> <div class="paragraph"> <p>Token realms use external services to validate tokens and require providers that are compatible with RFC-7662 (OAuth2 Token Introspection), such as KeyCloak.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;security</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1 https://infinispan.org/schemas/infinispan-server-10.1.xsd</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;token-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">token</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">auth-server-url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://oauth-server/auth/</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="tag">&lt;oauth2-introspection</span>
                    <span class="attribute-name">introspection-url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://oauth-server/auth/realms/infinispan/protocol/openid-connect/token/introspect</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="2"></i><b>(2)</b>
                    <span class="attribute-name">client-id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan-server</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="3"></i><b>(3)</b>
                    <span class="attribute-name">client-secret</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1fdca4ec-c416-47e0-867a-3d471af7050f</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span> <i class="conum" data-value="4"></i><b>(4)</b>
         <span class="tag">&lt;/token-realm&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
   <span class="tag">&lt;/security-realms&gt;</span>
<span class="tag">&lt;/security&gt;</span></code></pre> </div> </div> <div class="colist arabic"> <table> <tr> <td><i class="conum" data-value="1"></i><b>1</b></td> <td>Specifies the URL of the authentication server.</td> </tr> <tr> <td><i class="conum" data-value="2"></i><b>2</b></td> <td>Specifies the URL of the token introspection endpoint.</td> </tr> <tr> <td><i class="conum" data-value="3"></i><b>3</b></td> <td>Names the client identifier for Infinispan server.</td> </tr> <tr> <td><i class="conum" data-value="4"></i><b>4</b></td> <td>Specifies the client secret for Infinispan server.</td> </tr> </table> </div> <div class="paragraph"> <div class="title">Supported authentication mechanisms</div> <p>Token realms support the following authentication mechanisms:</p> </div> <div class="ulist"> <ul> <li> <p><strong>SASL:</strong> <code>OAUTHBEARER</code></p> </li> <li> <p><strong>HTTP (REST):</strong> <code>Bearer</code></p> </li> </ul> </div> </div> </div> <div class="sect2"> <h3 id="server_identity"><a class="anchor" href="#server_identity"></a>5.3. Creating Infinispan Server Identities</h3> <div class="paragraph"> <p>Server identities are defined within security realms and enable Infinispan servers to prove their identity to clients.</p> </div> <div class="sect3"> <h4 id="ssl_identity-server"><a class="anchor" href="#ssl_identity-server"></a>5.3.1. Setting Up SSL Identities</h4> <div class="paragraph"> <p>SSL identities use keystores that contain either a certificate or chain of certificates.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> <div class="paragraph"> <p>If security realms contain SSL identities, Infinispan servers automatically enable encryption for the endpoints that use those security realms.</p> </div> </td> </tr> </table> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Create a keystore for Infinispan server.</p> <div class="admonitionblock important"> <table> <tr> <td class="icon"> <i class="fa icon-important" title="Important"></i> </td> <td class="content"> <div class="paragraph"> <p>Infinispan server supports the following keystore formats: JKS, JCEKS, PKCS12, BKS, BCFKS and UBER.</p> </div> <div class="paragraph"> <p>In production environments, server certificates should be signed by a trusted Certificate Authority, either Root or Intermediate CA.</p> </div> </td> </tr> </table> </div> </li> <li> <p>Add the keystore to the <code>$ISPN_HOME/server/conf</code> directory.</p> </li> <li> <p>Add a <code>server-identities</code> definition to the Infinispan server security realm.</p> </li> <li> <p>Specify the name of the keystore along with the password and alias.</p> </li> </ol> </div> <div class="sect4"> <h5 id="ssl_identity_config-server"><a class="anchor" href="#ssl_identity_config-server"></a>SSL Identity Configuration</h5> <div class="paragraph"> <p>The following example configures an SSL identity for Infinispan server:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;security</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1 https://infinispan.org/schemas/infinispan-server-10.1.xsd</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;server-identities&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="tag">&lt;ssl&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
               <span class="tag">&lt;keystore</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="3"></i><b>(3)</b>
                         <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="4"></i><b>(4)</b>
                         <span class="attribute-name">keystore-password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="5"></i><b>(5)</b>
                         <span class="attribute-name">alias</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span> <i class="conum" data-value="6"></i><b>(6)</b>
            <span class="tag">&lt;/ssl&gt;</span>
         <span class="tag">&lt;/server-identities&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
   <span class="tag">&lt;/security-realms&gt;</span>
<span class="tag">&lt;/security&gt;</span></code></pre> </div> </div> <div class="colist arabic"> <table> <tr> <td><i class="conum" data-value="1"></i><b>1</b></td> <td>Defines identities for Infinispan server.</td> </tr> <tr> <td><i class="conum" data-value="2"></i><b>2</b></td> <td>Configures an SSL identity for Infinispan server.</td> </tr> <tr> <td><i class="conum" data-value="3"></i><b>3</b></td> <td>Names a keystore that contains Infinispan server SSL certificates.</td> </tr> <tr> <td><i class="conum" data-value="4"></i><b>4</b></td> <td>Specifies that the keystore is relative to the <code>server/conf</code> directory in <code>$ISPN_HOME</code>.</td> </tr> <tr> <td><i class="conum" data-value="5"></i><b>5</b></td> <td>Specifies a keystore password.</td> </tr> <tr> <td><i class="conum" data-value="6"></i><b>6</b></td> <td>Specifies a keystore alias.</td> </tr> </table> </div> </div> <div class="sect4"> <h5 id="generate_keystores-server"><a class="anchor" href="#generate_keystores-server"></a>Automatically Generating Keystores</h5> <div class="paragraph"> <p>Configure Infinispan servers to automatically generate keystores at startup.</p> </div> <div class="admonitionblock important"> <table> <tr> <td class="icon"> <i class="fa icon-important" title="Important"></i> </td> <td class="content"> <div class="paragraph"> <p>Automatically generated keystores:</p> </div> <div class="ulist"> <ul> <li> <p>Should not be used in production environments.</p> </li> <li> <p>Are generated whenever necessary; for example, while obtaining the first connection from a client.</p> </li> <li> <p>Contain certificates that you can use directly in Hot Rod clients.</p> </li> </ul> </div> </td> </tr> </table> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Include the <code>generate-self-signed-certificate-host</code> attribute for the <code>keystore</code> element in the server configuration.</p> </li> <li> <p>Specify a hostname for the server certificate as the value.</p> </li> </ol> </div> <div class="listingblock"> <div class="title">SSL server identity with a generated keystore</div> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;security</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1 https://infinispan.org/schemas/infinispan-server-10.1.xsd</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;server-identities&gt;</span>
            <span class="tag">&lt;ssl&gt;</span>
               <span class="tag">&lt;keystore</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">keystore-password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">alias</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">generate-self-signed-certificate-host</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="tag">&lt;/ssl&gt;</span>
         <span class="tag">&lt;/server-identities&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
   <span class="tag">&lt;/security-realms&gt;</span>
<span class="tag">&lt;/security&gt;</span></code></pre> </div> </div> <div class="colist arabic"> <table> <tr> <td><i class="conum" data-value="1"></i><b>1</b></td> <td>generates a keystore using <code>localhost</code></td> </tr> </table> </div> </div> <div class="sect4"> <h5 id="ssl_engine-server"><a class="anchor" href="#ssl_engine-server"></a>Tuning SSL Protocols and Cipher Suites</h5> <div class="paragraph"> <p>You can configure the SSL engine, via the Infinispan server SSL identity, to use specific protocols and ciphers.</p> </div> <div class="admonitionblock important"> <table> <tr> <td class="icon"> <i class="fa icon-important" title="Important"></i> </td> <td class="content"> <div class="paragraph"> <p>You must ensure that you set the correct ciphers for the protocol features you want to use; for example HTTP/2 ALPN.</p> </div> </td> </tr> </table> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Add the <code>engine</code> element to your Infinispan server SSL identity.</p> </li> <li> <p>Configure the SSL engine with the <code>enabled-protocols</code> and <code>enabled-ciphersuites</code> attributes.</p> </li> </ol> </div> <div class="listingblock"> <div class="title">SSL engine configuration</div> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;security</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1</span>
          <span class="content">https://infinispan.org/schemas/infinispan-server-10.1.xsd</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;server-identities&gt;</span>
            <span class="tag">&lt;ssl&gt;</span>
               <span class="tag">&lt;keystore</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server.p12</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">relative-to</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan.server.config.path</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">keystore-password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">alias</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
               <span class="tag">&lt;engine</span> <span class="attribute-name">enabled-protocols</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TLSv1.2 TLSv1.1</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="1"></i><b>(1)</b>
                       <span class="attribute-name">enabled-ciphersuites</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SSL_RSA_WITH_AES_128_GCM_SHA256 </span><i class="conum" data-value="2"></i><b>(2)</b>
                       <span class="content">SSL_RSA_WITH_AES_128_CBC_SHA256</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/ssl&gt;</span>
         <span class="tag">&lt;/server-identities&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
   <span class="tag">&lt;/security-realms&gt;</span>
<span class="tag">&lt;/security&gt;</span></code></pre> </div> </div> <div class="colist arabic"> <table> <tr> <td><i class="conum" data-value="1"></i><b>1</b></td> <td>Configures the SSL engine to use TLS v1 and v2 protocols.</td> </tr> <tr> <td><i class="conum" data-value="2"></i><b>2</b></td> <td>Configures the SSL engine to use the specified cipher suites.</td> </tr> </table> </div> </div> </div> <div class="sect3"> <h4 id="kerberos_identity-server"><a class="anchor" href="#kerberos_identity-server"></a>5.3.2. Setting Up Kerberos Identities</h4> <div class="paragraph"> <p>Kerberos identities use <em>keytab</em> files that contain service principal names and encrypted keys, derived from Kerberos passwords.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> <div class="paragraph"> <p><em>keytab</em> files can contain both user and service account principals. However, Infinispan servers use service account principals only. As a result, Infinispan servers can provide identity to clients and allow clients to authenticate with Kerberos servers.</p> </div> </td> </tr> </table> </div> <div class="paragraph"> <p>In most cases, you create unique principals for the Hot Rod and REST connectors. For example, you have a "datagrid" server in the "INFINISPAN.ORG" domain. In this case you should create the following service principals:</p> </div> <div class="ulist"> <ul> <li> <p><code>hotrod/datagrid@INFINISPAN.ORG</code> identifies the Hot Rod service.</p> </li> <li> <p><code>HTTP/datagrid@INFINISPAN.ORG</code> identifies the REST service.</p> </li> </ul> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Create keytab files for the Hot Rod and REST services.</p> <div class="dlist"> <dl> <dt class="hdlist1">Linux</dt> <dd> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>$ ktutil
ktutil:  addent -password -p datagrid@INFINISPAN.ORG -k 1 -e aes256-cts
Password for datagrid@INFINISPAN.ORG: [enter your password]
ktutil:  wkt http.keytab
ktutil:  quit</code></pre> </div> </div> </dd> <dt class="hdlist1">Microsoft Windows</dt> <dd> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>$ ktpass -princ HTTP/datagrid@INFINISPAN.ORG -pass * -mapuser INFINISPAN\USER_NAME
$ ktab -k http.keytab -a HTTP/datagrid@INFINISPAN.ORG</code></pre> </div> </div> </dd> </dl> </div> </li> <li> <p>Copy the keytab files to the <code>$ISPN_HOME/server/conf</code> directory.</p> </li> <li> <p>Add a <code>server-identities</code> definition to the Infinispan server security realm.</p> </li> <li> <p>Specify the location of keytab files that provide service principals to Hot Rod and REST connectors.</p> </li> <li> <p>Name the Kerberos service principals.</p> </li> </ol> </div> <div class="sect4"> <h5 id="kerberos_identity_config-server"><a class="anchor" href="#kerberos_identity_config-server"></a>Kerberos Identity Configuration</h5> <div class="paragraph"> <p>The following example configures Kerberos identities for Infinispan server:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;security</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1 https://infinispan.org/schemas/infinispan-server-10.1.xsd</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;security-realms&gt;</span>
      <span class="tag">&lt;security-realm</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;server-identities&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="tag">&lt;kerberos</span> <span class="attribute-name">keytab-path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod.keytab</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="2"></i><b>(2)</b>
                      <span class="attribute-name">principal</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod/datagrid@INFINISPAN.ORG</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="3"></i><b>(3)</b>
                      <span class="attribute-name">required</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span> <i class="conum" data-value="4"></i><b>(4)</b>
            <span class="tag">&lt;kerberos</span> <span class="attribute-name">keytab-path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http.keytab</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="5"></i><b>(5)</b>
                      <span class="attribute-name">principal</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">HTTP/localhost@INFINISPAN.ORG</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="6"></i><b>(6)</b>
                      <span class="attribute-name">required</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
         <span class="tag">&lt;/server-identities&gt;</span>
      <span class="tag">&lt;/security-realm&gt;</span>
   <span class="tag">&lt;/security-realms&gt;</span>
<span class="tag">&lt;/security&gt;</span></code></pre> </div> </div> <div class="colist arabic"> <table> <tr> <td><i class="conum" data-value="1"></i><b>1</b></td> <td>Defines identities for Infinispan server.</td> </tr> <tr> <td><i class="conum" data-value="2"></i><b>2</b></td> <td>Specifies a keytab file that provides a Kerberos identity for the Hot Rod connector.</td> </tr> <tr> <td><i class="conum" data-value="3"></i><b>3</b></td> <td>Names the Kerberos service principal for the Hot Rod connector.</td> </tr> <tr> <td><i class="conum" data-value="4"></i><b>4</b></td> <td>Specifies that the keytab file must exist when Infinispan server starts.</td> </tr> <tr> <td><i class="conum" data-value="5"></i><b>5</b></td> <td>Specifies a keytab file that provides a Kerberos identity for the REST connector.</td> </tr> <tr> <td><i class="conum" data-value="6"></i><b>6</b></td> <td>Names the Kerberos service principal for the REST connector.</td> </tr> </table> </div> </div> </div> </div> <div class="sect2"> <h3 id="endpoint_authentication"><a class="anchor" href="#endpoint_authentication"></a>5.4. Configuring Endpoint Authentication Mechanisms</h3> <div class="paragraph"> <p>Configure Hot Rod and REST connectors with SASL authentication mechanisms to authenticate with clients.</p> </div> <div class="sect3"> <h4 id="configure_hotrod_endpoint_auth-server"><a class="anchor" href="#configure_hotrod_endpoint_auth-server"></a>5.4.1. Setting Up Hot Rod Authentication</h4> <div class="paragraph"> <p>Configure Hot Rod connectors to authenticate with clients to Infinispan server security realms using specific SASL authentication mechanisms .</p> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Add an <code>authentication</code> definition to the Hot Rod connector configuration.</p> </li> <li> <p>Specify which Infinispan security realm the Hot Rod connector uses for authentication.</p> </li> <li> <p>Specify the SASL authentication mechanisms for the Hot Rod endpoint to use.</p> </li> <li> <p>Configure SASL authentication properties as appropriate.</p> </li> </ol> </div> <div class="sect4"> <h5 id="hotrod_endpoint_auth_configuration-server"><a class="anchor" href="#hotrod_endpoint_auth_configuration-server"></a>Hot Rod Authentication Configuration</h5> <div class="listingblock"> <div class="title">Hot Rod connector with SCRAM, DIGEST, and PLAIN authentication</div> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;endpoints</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
           <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1</span>
           <span class="content">https://infinispan.org/schemas/infinispan-server-10.1.xsd</span><span class="delimiter">&quot;</span></span>
           <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1</span><span class="delimiter">&quot;</span></span>
           <span class="attribute-name">socket-binding</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">security-realm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
   <span class="tag">&lt;hotrod-connector</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;authentication&gt;</span>
         <span class="tag">&lt;sasl</span> <span class="attribute-name">mechanisms</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SCRAM-SHA-512 SCRAM-SHA-384 SCRAM-SHA-256 </span><i class="conum" data-value="2"></i><b>(2)</b>
                           <span class="content">SCRAM-SHA-1 DIGEST-SHA-512 DIGEST-SHA-384</span>
                           <span class="content">DIGEST-SHA-256 DIGEST-SHA DIGEST-MD5 PLAIN</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">server-name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="3"></i><b>(3)</b>
               <span class="attribute-name">qop</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">auth</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span> <i class="conum" data-value="4"></i><b>(4)</b>
      <span class="tag">&lt;/authentication&gt;</span>
   <span class="tag">&lt;/hotrod-connector&gt;</span>
<span class="tag">&lt;/endpoints&gt;</span></code></pre> </div> </div> <div class="colist arabic"> <table> <tr> <td><i class="conum" data-value="1"></i><b>1</b></td> <td>enables authentication against the security realm named "default".</td> </tr> <tr> <td><i class="conum" data-value="2"></i><b>2</b></td> <td>specifies SASL mechanisms to use for authentication.</td> </tr> <tr> <td><i class="conum" data-value="3"></i><b>3</b></td> <td>defines the name that Infinispan servers declare to clients. The server name should match the client configuration.</td> </tr> <tr> <td><i class="conum" data-value="4"></i><b>4</b></td> <td>enables <strong>auth</strong> QoP.</td> </tr> </table> </div> <div class="listingblock"> <div class="title">Hot Rod connector with Kerberos authentication</div> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;endpoints</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
           <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1 https://infinispan.org/schemas/infinispan-server-10.1.xsd</span><span class="delimiter">&quot;</span></span>
           <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1</span><span class="delimiter">&quot;</span></span>
           <span class="attribute-name">socket-binding</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">security-realm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;hotrod-connector</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;authentication&gt;</span>
         <span class="tag">&lt;sasl</span> <span class="attribute-name">mechanisms</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">GSSAPI GS2-KRB5</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="1"></i><b>(1)</b>
               <span class="attribute-name">server-name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">datagrid</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="2"></i><b>(2)</b>
               <span class="attribute-name">server-principal</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod/datagrid@INFINISPAN.ORG</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span> <i class="conum" data-value="3"></i><b>(3)</b>
      <span class="tag">&lt;/authentication&gt;</span>
   <span class="tag">&lt;/hotrod-connector&gt;</span>
<span class="tag">&lt;/endpoints&gt;</span></code></pre> </div> </div> <div class="colist arabic"> <table> <tr> <td><i class="conum" data-value="1"></i><b>1</b></td> <td>Enables the <code>GSSAPI</code> and <code>GS2-KRB5</code> mechanisms for Kerberos authentication.</td> </tr> <tr> <td><i class="conum" data-value="2"></i><b>2</b></td> <td>Defines the Infinispan server name, which is equivalent to the Kerberos service name.</td> </tr> <tr> <td><i class="conum" data-value="3"></i><b>3</b></td> <td>Specifies the Kerberos identity for the server.</td> </tr> </table> </div> </div> <div class="sect4"> <h5 id="hotrod_endpoint_auth-server"><a class="anchor" href="#hotrod_endpoint_auth-server"></a>Hot Rod Endpoint Authentication Mechanisms</h5> <div class="paragraph"> <p>Infinispan supports the following SASL authentications mechanisms with the Hot Rod connector:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 33.3333%;"> <col style="width: 33.3333%;"> <col style="width: 33.3334%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Authentication mechanism</th> <th class="tableblock halign-left valign-top">Description</th> <th class="tableblock halign-left valign-top">Related details</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>PLAIN</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Uses credentials in plain-text format. You should use <code>PLAIN</code> authentication with encrypted connections only.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Similar to the <code>Basic</code> HTTP mechanism.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>DIGEST-*</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Uses hashing algorithms and nonce values. Hot Rod connectors support <code>DIGEST-MD5</code>, <code>DIGEST-SHA</code>, <code>DIGEST-SHA-256</code>, <code>DIGEST-SHA-384</code>, and <code>DIGEST-SHA-512</code> hashing algorithms, in order of strength.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Similar to the <code>Digest</code> HTTP mechanism.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>SCRAM-*</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Uses <em>salt</em> values in addition to hashing algorithms and nonce values. Hot Rod connectors support <code>SCRAM-SHA</code>, <code>SCRAM-SHA-256</code>, <code>SCRAM-SHA-384</code>, and <code>SCRAM-SHA-512</code> hashing algorithms, in order of strength.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Similar to the <code>Digest</code> HTTP mechanism.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>GSSAPI</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Uses Kerberos tickets and requires a Kerberos Domain Controller. You must add a corresponding <code>kerberos</code> server identity in the realm configuration. In most cases, you also specify an <code>ldap-realm</code> to provide user membership information.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Similar to the <code>SPNEGO</code> HTTP mechanism.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>GS2-KRB5</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Uses Kerberos tickets and requires a Kerberos Domain Controller. You must add a corresponding <code>kerberos</code> server identity in the realm configuration. In most cases, you also specify an <code>ldap-realm</code> to provide user membership information.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Similar to the <code>SPNEGO</code> HTTP mechanism.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>EXTERNAL</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Uses client certificates.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Similar to the <code>CLIENT_CERT</code> HTTP mechanism.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>OAUTHBEARER</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Uses OAuth tokens and requires a <code>token-realm</code> configuration.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Similar to the <code>BEARER_TOKEN</code> HTTP mechanism.</p></td> </tr> </tbody> </table> </div> <div class="sect4"> <h5 id="hotrod_endpoint_sasl_qop-server"><a class="anchor" href="#hotrod_endpoint_sasl_qop-server"></a>SASL Quality of Protection (QoP)</h5> <div class="paragraph"> <p>If SASL mechanisms support integrity and privacy protection settings, you can add them to your Hot Rod connector configuration with the <code>qop</code> attribute.</p> </div> <table class="tableblock frame-all grid-all fit-content"> <colgroup> <col> <col> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">QoP setting</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>auth</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Authentication only.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>auth-int</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Authentication with integrity protection.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>auth-conf</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Authentication with integrity and privacy protection.</p></td> </tr> </tbody> </table> </div> <div class="sect4"> <h5 id="hotrod_endpoint_sasl_policies-server"><a class="anchor" href="#hotrod_endpoint_sasl_policies-server"></a>SASL Policies</h5> <div class="paragraph"> <p>SASL policies let you control which authentication mechanisms Hot Rod connectors can use.</p> </div> <table class="tableblock frame-all grid-all fit-content"> <colgroup> <col> <col> <col> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Policy</th> <th class="tableblock halign-left valign-top">Description</th> <th class="tableblock halign-left valign-top">Default value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>forward-secrecy</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Use only SASL mechanisms that support forward secrecy between sessions. This means that breaking into one session does not automatically provide information for breaking into future sessions.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>pass-credentials</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Use only SASL mechanisms that require client credentials.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>no-plain-text</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Do not use SASL mechanisms that are susceptible to simple plain passive attacks.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>no-active</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Do not use SASL mechanisms that are susceptible to active, non-dictionary, attacks.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>no-dictionary</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Do not use SASL mechanisms that are susceptible to passive dictionary attacks.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>no-anonymous</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Do not use SASL mechanisms that accept anonymous logins.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td> </tr> </tbody> </table> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> <div class="paragraph"> <p>Infinispan cache authorization restricts access to caches based on roles and permissions. If you configure cache authorization, you can then set <code>&lt;no-anonymous value=false /&gt;</code> to allow anonymous login and delegate access logic to cache authorization.</p> </div> </td> </tr> </table> </div> <div class="listingblock"> <div class="title">Hot Rod connector with SASL policy configuration</div> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;hotrod-connector</span> <span class="attribute-name">socket-binding</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">cache-container</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;authentication</span> <span class="attribute-name">security-realm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ApplicationRealm</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;sasl</span> <span class="attribute-name">server-name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">myhotrodserver</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">mechanisms</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PLAIN DIGEST-MD5 GSSAPI EXTERNAL</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="attribute-name">qop</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">auth</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;policy&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
            <span class="tag">&lt;no-active</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
            <span class="tag">&lt;no-anonymous</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
            <span class="tag">&lt;no-plain-text</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
         <span class="tag">&lt;/policy&gt;</span>
      <span class="tag">&lt;/sasl&gt;</span>
   <span class="tag">&lt;/authentication&gt;</span>
<span class="tag">&lt;/hotrod-connector&gt;</span></code></pre> </div> </div> <div class="colist arabic"> <table> <tr> <td><i class="conum" data-value="1"></i><b>1</b></td> <td>Specifies multiple SASL authentication mechanisms for the Hot Rod connector.</td> </tr> <tr> <td><i class="conum" data-value="2"></i><b>2</b></td> <td>Defines policies for SASL mechanisms.</td> </tr> </table> </div> <div class="paragraph"> <p>As a result of the preceding configuration, the Hot Rod connector uses the <code>GSSAPI</code> mechanism because it is the only mechanism that complies with all policies.</p> </div> </div> </div> <div class="sect3"> <h4 id="configure_rest_endpoint_auth-server"><a class="anchor" href="#configure_rest_endpoint_auth-server"></a>5.4.2. Setting Up REST Authentication</h4> <div class="paragraph"> <p>Configure REST connectors to authenticate with clients to Infinispan server security realms using specific SASL authentication mechanisms .</p> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Add an <code>authentication</code> definition to the REST connector configuration.</p> </li> <li> <p>Specify which Infinispan security realm the REST connector uses for authentication.</p> </li> <li> <p>Specify the SASL authentication mechanisms for the REST endpoint to use.</p> </li> <li> <p>Configure SASL authentication properties as appropriate.</p> </li> </ol> </div> <div class="sect4"> <h5 id="rest_endpoint_auth_configuration-server"><a class="anchor" href="#rest_endpoint_auth_configuration-server"></a>REST Authentication Configuration</h5> <div class="listingblock"> <div class="title">REST connector with BASIC and DIGEST authentication</div> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;endpoints</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
           <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1 https://infinispan.org/schemas/infinispan-server-10.1.xsd</span><span class="delimiter">&quot;</span></span>
           <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1</span><span class="delimiter">&quot;</span></span>
           <span class="attribute-name">socket-binding</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">security-realm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
   <span class="tag">&lt;rest-connector</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">rest</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;authentication</span> <span class="attribute-name">mechanisms</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">DIGEST BASIC</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
   <span class="tag">&lt;/rest-connector&gt;</span>
<span class="tag">&lt;/endpoints&gt;</span></code></pre> </div> </div> <div class="colist arabic"> <table> <tr> <td><i class="conum" data-value="1"></i><b>1</b></td> <td>Enables authentication against the security realm named "default".</td> </tr> <tr> <td><i class="conum" data-value="2"></i><b>2</b></td> <td>Specifies SASL mechanisms to use for authentication</td> </tr> </table> </div> <div class="listingblock"> <div class="title">REST connector with Kerberos authentication</div> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;endpoints</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
           <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1 https://infinispan.org/schemas/infinispan-server-10.1.xsd</span><span class="delimiter">&quot;</span></span>
           <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:server:10.1</span><span class="delimiter">&quot;</span></span>
           <span class="attribute-name">socket-binding</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">security-realm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;rest-connector</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">rest</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;authentication</span> <span class="attribute-name">mechanisms</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SPNEGO</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="1"></i><b>(1)</b>
                      <span class="attribute-name">server-principal</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">HTTP/localhost@INFINISPAN.ORG</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
   <span class="tag">&lt;/rest-connector&gt;</span>
<span class="tag">&lt;/endpoints&gt;</span></code></pre> </div> </div> <div class="colist arabic"> <table> <tr> <td><i class="conum" data-value="1"></i><b>1</b></td> <td>Enables the <code>SPENGO</code> mechanism for Kerberos authentication.</td> </tr> <tr> <td><i class="conum" data-value="2"></i><b>2</b></td> <td>Specifies the Kerberos identity for the server.</td> </tr> </table> </div> </div> <div class="sect4"> <h5 id="rest_endpoint_auth-server"><a class="anchor" href="#rest_endpoint_auth-server"></a>REST Endpoint Authentication Mechanisms</h5> <div class="paragraph"> <p>Infinispan supports the following authentications mechanisms with the REST connector:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 33.3333%;"> <col style="width: 33.3333%;"> <col style="width: 33.3334%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Authentication mechanism</th> <th class="tableblock halign-left valign-top">Description</th> <th class="tableblock halign-left valign-top">Related details</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>BASIC</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Uses credentials in plain-text format. You should use <code>BASIC</code> authentication with encrypted connections only.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Corresponds to the <code>Basic</code> HTTP authentication scheme and is similar to the <code>PLAIN</code> SASL mechanism.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>DIGEST</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Uses hashing algorithms and nonce values. REST connectors support <code>SHA-512</code>, <code>SHA-256</code> and <code>MD5</code> hashing algorithms.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Corresponds to the <code>Digest</code> HTTP authentication scheme and is similar to <code>DIGEST-*</code> SASL mechanisms.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>SPNEGO</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Uses Kerberos tickets and requires a Kerberos Domain Controller. You must add a corresponding <code>kerberos</code> server identity in the realm configuration. In most cases, you also specify an <code>ldap-realm</code> to provide user membership information.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Corresponds to the <code>Negotiate</code> HTTP authentication scheme and is similar to the <code>GSSAPI</code> and <code>GS2-KRB5</code> SASL mechanisms.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>BEARER_TOKEN</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Uses OAuth tokens and requires a <code>token-realm</code> configuration.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Corresponds to the <code>Bearer</code> HTTP authentication scheme and is similar to <code>OAUTHBEARER</code> SASL mechanism.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>CLIENT_CERT</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Uses client certificates.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Similar to the <code>EXTERNAL</code> SASL mechanism.</p></td> </tr> </tbody> </table> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="remote_server_execution"><a class="anchor" href="#remote_server_execution"></a>6. Remotely Executing Server-Side Tasks</h2> <div class="sectionbody"> <div class="paragraph"> <p>Define and add tasks to Infinispan servers that you can invoke from the Infinispan command line interface, REST API, or from Hot Rod clients.</p> </div> <div class="paragraph"> <p>You can implement tasks as custom Java classes or define scripts in languages such as JavaScript.</p> </div> <div class="sect2"> <h3 id="server_tasks"><a class="anchor" href="#server_tasks"></a>6.1. Creating Server Tasks</h3> <div class="paragraph"> <p>Create custom task implementations and add them to Infinispan servers.</p> </div> <div class="sect3"> <h4 id="tasks"><a class="anchor" href="#tasks"></a>6.1.1. Server Tasks</h4> <div class="paragraph"> <p>Infinispan server tasks are classes that extend the <code>org.infinispan.tasks.ServerTask</code> interface and generally include the following method calls:</p> </div> <div class="dlist"> <dl> <dt class="hdlist1"><code>setTaskContext()</code></dt> <dd> <p>Allows access to execution context information including task parameters, cache references on which tasks are executed, and so on. In most cases, implementations store this information locally and use it when tasks are actually executed.</p> </dd> <dt class="hdlist1"><code>getName()</code></dt> <dd> <p>Returns unique names for tasks. Clients invoke tasks with these names.</p> </dd> <dt class="hdlist1"><code>getExecutionMode()</code></dt> <dd> <p>Returns the execution mode for tasks.</p> <div class="ulist"> <ul> <li> <p><code>TaskExecutionMode.ONE_NODE</code> only the node that handles the request executes the script. Although scripts can still invoke clustered operations.</p> </li> <li> <p><code>TaskExecutionMode.ALL_NODES</code> Infinispan uses clustered executors to run scripts across nodes. For example, server tasks that invoke stream processing need to be executed on a single node because stream processing is distributed to all nodes.</p> </li> </ul> </div> </dd> <dt class="hdlist1"><code>call()</code></dt> <dd> <p>Computes a result. This method is defined in the <code>java.util.concurrent.Callable</code> interface and is invoked with server tasks.</p> </dd> </dl> </div> <div class="admonitionblock important"> <table> <tr> <td class="icon"> <i class="fa icon-important" title="Important"></i> </td> <td class="content"> <div class="paragraph"> <p>Server task implementations must adhere to service loader pattern requirements. For example, implementations must have a zero-argument constructors.</p> </div> </td> </tr> </table> </div> <div class="paragraph"> <p>The following <code>HelloTask</code> class implementation provides an example task that has one parameter:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">example</span>;

<span class="keyword">import</span> <span class="include">org.infinispan.tasks.ServerTask</span>;
<span class="keyword">import</span> <span class="include">org.infinispan.tasks.TaskContext</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">HelloTask</span> <span class="directive">implements</span> ServerTask&lt;<span class="predefined-type">String</span>&gt; {

   <span class="directive">private</span> TaskContext ctx;

   <span class="annotation">@Override</span>
   <span class="directive">public</span> <span class="type">void</span> setTaskContext(TaskContext ctx) {
      <span class="local-variable">this</span>.ctx = ctx;
   }

   <span class="annotation">@Override</span>
   <span class="directive">public</span> <span class="predefined-type">String</span> call() <span class="directive">throws</span> <span class="exception">Exception</span> {
      <span class="predefined-type">String</span> name = (<span class="predefined-type">String</span>) ctx.getParameters().get().get(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>);
      <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello </span><span class="delimiter">&quot;</span></span> + name;
   }

   <span class="annotation">@Override</span>
   <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
      <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">hello-task</span><span class="delimiter">&quot;</span></span>;
   }

}</code></pre> </div> </div> <div class="ulist"> <div class="title">Reference</div> <ul> <li> <p><a href="https://docs.jboss.org/infinispan/10.1/apidocs/org/infinispan/tasks/ServerTask.html"><code>org.infinispan.tasks.ServerTask</code></a></p> </li> <li> <p><a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Callable.html?is-external=true#call--"><code>java.util.concurrent.Callable.call()</code></a></p> </li> <li> <p><a href="https://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html"><code>java.util.ServiceLoader</code></a></p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="server_tasks-server"><a class="anchor" href="#server_tasks-server"></a>6.1.2. Deploying Server Tasks to Infinispan Servers</h4> <div class="paragraph"> <p>Add your custom server task classes to Infinispan servers.</p> </div> <div class="paragraph"> <div class="title">Prerequisites</div> <p>Stop any running Infinispan servers. Infinispan does not support runtime deployment of custom classes.</p> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Package your server task implementation in a JAR file.</p> </li> <li> <p>Add a <code>META-INF/services/org.infinispan.tasks.ServerTask</code> file that contains the fully qualified names of server tasks, for example:</p> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code>example.HelloTask</code></pre> </div> </div> </li> <li> <p>Copy the JAR file to the <code>$ISPN_HOME/server/lib</code> directory of your Infinispan server.</p> </li> <li> <p>Add your classes to the deserialization whitelist in your Infinispan configuration. Alternatively set the whitelist using system properties.</p> </li> </ol> </div> <div class="ulist"> <div class="title">Reference</div> <ul> <li> <p><a href="../developing/developing.html#adding_java_classes_to_deserialization_white_lists">Adding Java Classes to Deserialization White Lists</a></p> </li> <li> <p><a href="https://docs.jboss.org/infinispan/10.1/configdocs/">Infinispan 10.1 Configuration Schema</a></p> </li> </ul> </div> </div> </div> <div class="sect2"> <h3 id="server_scripts"><a class="anchor" href="#server_scripts"></a>6.2. Creating Server Scripts</h3> <div class="paragraph"> <p>Create custom scripts and add them to Infinispan servers.</p> </div> <div class="sect3"> <h4 id="scripts"><a class="anchor" href="#scripts"></a>6.2.1. Server Scripts</h4> <div class="paragraph"> <p>Infinispan server scripting is based on the <code>javax.script</code> API and is compatible with any JVM-based ScriptEngine implementation. Nashorn is the default JDK ScriptEngine and provides JavaScript capabilities.</p> </div> <div class="paragraph"> <div class="title">Hello World Script Example</div> <p>The following script provides a simple example that runs on a single Infinispan server, has one parameter, and uses JavaScript:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="javascript"><span class="comment">// mode=local,language=javascript,parameters=[greetee]</span>
<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello </span><span class="delimiter">&quot;</span></span> + greetee</code></pre> </div> </div> <div class="paragraph"> <p>When you run the preceding script, you pass a value for the <code>greetee</code> parameter and Infinispan returns <code>"Hello ${value}"</code>.</p> </div> <div class="sect4"> <h5 id="server_script_metdata"><a class="anchor" href="#server_script_metdata"></a>Script Metadata</h5> <div class="paragraph"> <p>Metadata provides additional information about scripts that Infinispan servers use when running scripts.</p> </div> <div class="paragraph"> <p>Script metadata are <code>property=value</code> pairs that you add to comments in the first lines of scripts, such as the following example:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="javascript"><span class="comment">// name=test, language=javascript</span>
<span class="comment">// mode=local, parameters=[a,b,c]</span></code></pre> </div> </div> <div class="ulist"> <ul> <li> <p>Use comment styles that match the scripting language (<code>//</code>, <code>;;</code>, <code>#</code>).</p> </li> <li> <p>Separate <code>property=value</code> pairs with commas.</p> </li> <li> <p>Separate values with single (') or double (") quote characters.</p> </li> </ul> </div> <table class="tableblock frame-all grid-all stretch"> <caption class="title">Table 1. Metadata Properties</caption> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Property</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mode</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Defines the exection mode and has the following values:</p> <p class="tableblock"><code>local</code> only the node that handles the request executes the script. Although scripts can still invoke clustered operations.</p> <p class="tableblock"><code>distributed</code> Infinispan uses clustered executors to run scripts across nodes.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>language</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the ScriptEngine that executes the script.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>extension</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Specifies filename extensions as an alternative method to set the ScriptEngine.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>role</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Specifies roles that users must have to execute scripts.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>parameters</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Specifies an array of valid parameter names for this script. Invocations which specify parameters not included in this list cause exceptions.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>datatype</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Optionally sets the MediaType (MIME type) for storing data as well as parameter and return values. This property is useful for remote clients that support particular data formats only.</p> <p class="tableblock">Currently you can set only <code>text/plain; charset=utf-8</code> to use the String UTF-8 format for data.</p></td> </tr> </tbody> </table> </div> <div class="sect4"> <h5 id="server_script_bindings"><a class="anchor" href="#server_script_bindings"></a>Script Bindings</h5> <div class="paragraph"> <p>Infinispan exposes internal objects as bindings for script execution.</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Binding</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the cache against which the script is run.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>marshaller</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the marshaller to use for serializing data to the cache.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>cacheManager</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the <code>cacheManager</code> for the cache.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>scriptingManager</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the instance of the script manager that runs the script. You can use this binding to run other scripts from a script.</p></td> </tr> </tbody> </table> </div> <div class="sect4"> <h5 id="server_script_parameters"><a class="anchor" href="#server_script_parameters"></a>Script Parameters</h5> <div class="paragraph"> <p>Infinispan lets you pass named parameters as bindings for running scripts.</p> </div> <div class="paragraph"> <p>Parameters are <code>name,value</code> pairs, where <code>name</code> is a string and <code>value</code> is any value that the marshaller can interpret.</p> </div> <div class="paragraph"> <p>The following example script has two parameters, <code>multiplicand</code> and <code>multiplier</code>. The script takes the value of <code>multiplicand</code> and multiplies it with the value of <code>multiplier</code>.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="javascript"><span class="comment">// mode=local,language=javascript</span>
multiplicand * multiplier</code></pre> </div> </div> <div class="paragraph"> <p>When you run the preceding script, Infinispan responds with the result of the expression evaluation.</p> </div> </div> </div> <div class="sect3"> <h4 id="adding_scripts_cli-server"><a class="anchor" href="#adding_scripts_cli-server"></a>6.2.2. Adding Scripts to Infinispan Servers</h4> <div class="paragraph"> <p>Use the command line interface to add scripts to Infinispan servers.</p> </div> <div class="paragraph"> <div class="title">Prerequisites</div> <p>Infinispan servers store scripts in the <code>___script_cache</code> cache. If you enable cache authorization, users must have the <code>___script_manager</code> role to access <code>___script_cache</code>.</p> </div> <div class="olist arabic"> <div class="title">Procedure</div> <ol class="arabic"> <li> <p>Define scripts as required.</p> <div class="paragraph"> <p>For example, create a file named <code>multiplication.js</code> that runs on a single Infinispan server, has two parameters, and uses JavaScript to multiply a given value:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="javascript"><span class="comment">// mode=local,language=javascript</span>
multiplicand * multiplier</code></pre> </div> </div> </li> <li> <p>Open a CLI connection to Infinispan and use the <code>task</code> command to upload your scripts as in the following example:</p> <div class="listingblock"> <div class="content"> <pre>[//containers/default]&gt; task upload --file=multiplication.js multiplication</pre> </div> </div> </li> <li> <p>Verify that your scripts are available.</p> <div class="listingblock"> <div class="content"> <pre>[//containers/default]&gt; ls tasks
multiplication</pre> </div> </div> </li> </ol> </div> </div> <div class="sect3"> <h4 id="add_script_hotrod"><a class="anchor" href="#add_script_hotrod"></a>6.2.3. Programmatically Creating Scripts</h4> <div class="paragraph"> <p>Add scripts with the Hot Rod <code>RemoteCache</code> interface as in the following example:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java">RemoteCache&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; scriptCache = cacheManager.getCache(<span class="string"><span class="delimiter">&quot;</span><span class="content">___script_cache</span><span class="delimiter">&quot;</span></span>);
scriptCache.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">multiplication.js</span><span class="delimiter">&quot;</span></span>,
  <span class="string"><span class="delimiter">&quot;</span><span class="content">// mode=local,language=javascript</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
  <span class="string"><span class="delimiter">&quot;</span><span class="content">multiplicand * multiplier</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>);</code></pre> </div> </div> <div class="paragraph"> <div class="title">Reference</div> <p><a href="https://docs.jboss.org/infinispan/10.1/apidocs/org/infinispan/client/hotrod/RemoteCache.html">org.infinispan.client.hotrod.RemoteCache</a></p> </div> </div> </div> <div class="sect2"> <h3 id="running_tasks_scripts"><a class="anchor" href="#running_tasks_scripts"></a>6.3. Running Server-Side Tasks and Scripts</h3> <div class="paragraph"> <p>Execute tasks and custom scripts on Infinispan servers.</p> </div> <div class="sect3"> <h4 id="running_scripts_cli"><a class="anchor" href="#running_scripts_cli"></a>6.3.1. Running Tasks and Scripts</h4> <div class="paragraph"> <p>Use the command line interface to run tasks and scripts on Infinispan servers.</p> </div> <div class="ulist"> <div class="title">Prerequisites</div> <ul> <li> <p>Open a CLI connection to Infinispan.</p> </li> </ul> </div> <div class="paragraph"> <div class="title">Procedure</div> <p>Use the <code>task</code> command to run tasks and scripts on Infinispan servers, as in the following examples:</p> </div> <div class="ulist"> <ul> <li> <p>Execute a script named <code>multipler.js</code> and specify two parameters:</p> <div class="listingblock"> <div class="content"> <pre>[//containers/default]&gt; task exec multipler.js -Pmultiplicand=10 -Pmultiplier=20
200.0</pre> </div> </div> </li> <li> <p>Execute a task named <code>@@cache@names</code> to retrieve a list of all available caches:</p> <div class="listingblock"> <div class="content"> <pre>//containers/default]&gt; task exec @@cache@names
["___protobuf_metadata","mycache","___script_cache"]</pre> </div> </div> </li> </ul> </div> </div> <div class="sect3"> <h4 id="running_scripts_hotrod"><a class="anchor" href="#running_scripts_hotrod"></a>6.3.2. Programmatically Running Scripts</h4> <div class="paragraph"> <p>Call the <code>execute()</code> method to run scripts with the Hot Rod <code>RemoteCache</code> interface, as in the following example:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java">RemoteCache&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Integer</span>&gt; cache = cacheManager.getCache();
<span class="comment">// Create parameters for script execution.</span>
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; params = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;&gt;();
params.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">multiplicand</span><span class="delimiter">&quot;</span></span>, <span class="integer">10</span>);
params.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">multiplier</span><span class="delimiter">&quot;</span></span>, <span class="integer">20</span>);
<span class="comment">// Run the script with the parameters.</span>
<span class="predefined-type">Object</span> result = cache.execute(<span class="string"><span class="delimiter">&quot;</span><span class="content">multiplication.js</span><span class="delimiter">&quot;</span></span>, params);</code></pre> </div> </div> <div class="paragraph"> <div class="title">Reference</div> <p><a href="https://docs.jboss.org/infinispan/10.1/apidocs/org/infinispan/client/hotrod/RemoteCache.html">org.infinispan.client.hotrod.RemoteCache</a></p> </div> </div> <div class="sect3"> <h4 id="running_tasks_hotrod"><a class="anchor" href="#running_tasks_hotrod"></a>6.3.3. Programmatically Running Tasks</h4> <div class="paragraph"> <p>Call the <code>execute()</code> method to run tasks with the Hot Rod <code>RemoteCache</code> interface, as in the following example:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Add configuration for a locally running server.</span>
ConfigurationBuilder builder = <span class="keyword">new</span> ConfigurationBuilder();
builder.addServer().host(<span class="string"><span class="delimiter">&quot;</span><span class="content">127.0.0.1</span><span class="delimiter">&quot;</span></span>).port(<span class="integer">11222</span>);

<span class="comment">// Connect to the server.</span>
RemoteCacheManager cacheManager = <span class="keyword">new</span> RemoteCacheManager(builder.build());

<span class="comment">// Retrieve the remote cache.</span>
RemoteCache&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; cache = cacheManager.getCache();

<span class="comment">// Create task parameters.</span>
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; parameters = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;&gt;();
parameters.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">developer</span><span class="delimiter">&quot;</span></span>);

<span class="comment">// Run the server task.</span>
<span class="predefined-type">String</span> greet = cache.execute(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello-task</span><span class="delimiter">&quot;</span></span>, parameters);
<span class="predefined-type">System</span>.out.println(greet);</code></pre> </div> </div> <div class="paragraph"> <div class="title">Reference</div> <p><a href="https://docs.jboss.org/infinispan/10.1/apidocs/org/infinispan/client/hotrod/RemoteCache.html">org.infinispan.client.hotrod.RemoteCache</a></p> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="server_rolling_upgrade"><a class="anchor" href="#server_rolling_upgrade"></a>7. Performing Rolling Upgrades</h2> <div class="sectionbody"> <div class="paragraph"> <p>Upgrade Infinispan without downtime or data loss. You can perform rolling upgrades for Infinispan servers to start using a more recent version of Infinispan.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> <div class="paragraph"> <p>This section explains how to upgrade Infinispan servers, see the appropriate documentation for your Hot Rod client for upgrade procedures.</p> </div> </td> </tr> </table> </div> <div class="sect2"> <h3 id="rolling_upgrades"><a class="anchor" href="#rolling_upgrades"></a>7.1. Rolling Upgrades</h3> <div class="paragraph"> <p>From a high-level, you do the following to perform rolling upgrades:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Set up a target cluster. The target cluster is the Infinispan version to which you want to migrate data. The source cluster is the Infinispan deployment that is currently in use. After the target cluster is running, you configure all clients to point to it instead of the source cluster.</p> </li> <li> <p>Synchronize data from the source cluster to the target cluster.</p> </li> </ol> </div> </div> <div class="sect2"> <h3 id="setting_up_target_clusters"><a class="anchor" href="#setting_up_target_clusters"></a>7.2. Setting Up Target Clusters</h3> <div class="olist arabic"> <ol class="arabic"> <li> <p>Start the target cluster with unique network properties or a different JGroups cluster name to keep it separate from the source cluster.</p> </li> <li> <p>Configure a <code>RemoteCacheStore</code> on the target cluster for each cache you want to migrate from the source cluster.</p> <div class="dlist"> <dl> <dt class="hdlist1"><code>RemoteCacheStore</code> settings</dt> <dd> <div class="ulist"> <ul> <li> <p><code>remote-server</code> must point to the source cluster via the <code>outbound-socket-binding</code> property.</p> </li> <li> <p><code>remoteCacheName</code> must match the cache name on the source cluster.</p> </li> <li> <p><code>hotrod-wrapping</code> must be <code>true</code> (enabled).</p> </li> <li> <p><code>shared</code> must be <code>true</code> (enabled).</p> </li> <li> <p><code>purge</code> must be <code>false</code> (disabled).</p> </li> <li> <p><code>passivation</code> must be <code>false</code> (disabled).</p> </li> <li> <p><code>protocol-version</code> matches the Hot Rod protocol version of the source cluster.</p> <div class="listingblock"> <div class="title">Example <code>RemoteCacheStore</code> Configuration</div> <div class="content"> <pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;distributed-cache&gt;</span>
   <span class="tag">&lt;remote-store</span> <span class="attribute-name">cache</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">MyCache</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">socket-timeout</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">60000</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">tcp-no-delay</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">protocol-version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2.5</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">shared</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">hotrod-wrapping</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">purge</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">passivation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;remote-server</span> <span class="attribute-name">outbound-socket-binding</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">remote-store-hotrod-server</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
   <span class="tag">&lt;/remote-store&gt;</span>
<span class="tag">&lt;/distributed-cache&gt;</span>
...
<span class="tag">&lt;socket-binding-group</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">standard-sockets</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">default-interface</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">port-offset</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${jboss.socket.binding.port-offset:0}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  ...
  <span class="tag">&lt;outbound-socket-binding</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">remote-store-hotrod-server</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
     <span class="tag">&lt;remote-destination</span> <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">198.51.100.0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">11222</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/outbound-socket-binding&gt;</span>
  ...
<span class="tag">&lt;/socket-binding-group&gt;</span></code></pre> </div> </div> </li> </ul> </div> </dd> </dl> </div> </li> <li> <p>Configure the target cluster to handle all client requests instead of the source cluster:</p> <div class="olist loweralpha"> <ol class="loweralpha" type="a"> <li> <p>Configure all clients to point to the target cluster instead of the source cluster.</p> </li> <li> <p>Restart each client node.</p> <div class="paragraph"> <p>The target cluster lazily loads data from the source cluster on demand via <code>RemoteCacheStore</code>.</p> </div> </li> </ol> </div> </li> </ol> </div> </div> <div class="sect2"> <h3 id="synchronizing_data_from_source_clusters"><a class="anchor" href="#synchronizing_data_from_source_clusters"></a>7.3. Synchronizing Data from Source Clusters</h3> <div class="olist arabic"> <ol class="arabic"> <li> <p>Call the <code>synchronizeData()</code> method in the <code>TargetMigrator</code> interface. Do one of the following on the target cluster for each cache that you want to migrate:</p> <div class="dlist"> <dl> <dt class="hdlist1">JMX</dt> <dd> <div class="paragraph"> <p>Invoke the <code>synchronizeData</code> operation and specify the <code>hotrod</code> parameter on the <code>RollingUpgradeManager</code> MBean.</p> </div> </dd> <dt class="hdlist1">CLI</dt> <dd> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>$ bin/cli.sh --connect controller=127.0.0.1:9990 -c &quot;/subsystem=datagrid-infinispan/cache-container=clustered/distributed-cache=MyCache:synchronize-data(migrator-name=hotrod)&quot;</code></pre> </div> </div> <div class="paragraph"> <p>Data migrates to all nodes in the target cluster in parallel, with each node receiving a subset of the data.</p> </div> <div class="paragraph"> <p>Use the following parameters to tune the operation:</p> </div> <div class="ulist"> <ul> <li> <p><code>read-batch</code> configures the number of entries to read from the source cluster at a time. The default value is <code>10000</code>.</p> </li> <li> <p><code>write-threads</code> configures the number of threads used to write data. The default value is the number of processors available.</p> <div class="paragraph"> <p>For example:</p> </div> <div class="paragraph"> <p><code>synchronize-data(migrator-name=hotrod, read-batch=100000, write-threads=3)</code></p> </div> </li> </ul> </div> </dd> </dl> </div> </li> <li> <p>Disable the <code>RemoteCacheStore</code> on the target cluster. Do one of the following:</p> <div class="dlist"> <dl> <dt class="hdlist1">JMX</dt> <dd> <div class="paragraph"> <p>Invoke the <code>disconnectSource</code> operation and specify the <code>hotrod</code> parameter on the <code>RollingUpgradeManager</code> MBean.</p> </div> </dd> <dt class="hdlist1">CLI</dt> <dd> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight nowrap"><code>$ bin/cli.sh --connect controller=127.0.0.1:9990 -c &quot;/subsystem=datagrid-infinispan/cache-container=clustered/distributed-cache=MyCache:disconnect-source(migrator-name=hotrod)&quot;</code></pre> </div> </div> </dd> </dl> </div> </li> <li> <p>Decommission the source cluster.</p> </li> </ol> </div> </div> </div> </div> </div> <div id="footer"> <div id="footer-text"> Last updated 2020-02-10 10:54:03 UTC </div> </div> <style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid currentColor;opacity:.35;padding:0 .5em 0 0}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style> <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains('stemblock')) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8601422-1', 'auto');
  ga('send', 'pageview');

</script> </body> </html>