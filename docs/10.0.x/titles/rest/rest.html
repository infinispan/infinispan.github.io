<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<title>Using the Infinispan REST Server</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock pre.nowrap,.literalblock pre.nowrap pre,.listingblock pre.nowrap,.listingblock pre.nowrap pre{white-space:pre;word-wrap:normal}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #dddddf}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
<link rel="canonical" href="http://infinispan.org/docs/stable/user_guide/user_guide.html">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.1/themes/default/style.min.css">
<link rel="stylesheet" href="../../css/css.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.1/jstree.min.js"></script>
<script src="../../js/js.js"></script>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Using the Infinispan REST Server</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#rest_server">1. REST Server</a>
<ul class="sectlevel2">
<li><a href="#rest_run_server">1.1. Running the REST server</a>
<ul class="sectlevel3">
<li><a href="#rest_security">1.1.1. Security</a></li>
</ul>
</li>
<li><a href="#rest_supported_protocols">1.2. Supported protocols</a></li>
<li><a href="#rest_server_cors">1.3. CORS</a></li>
<li><a href="#rest_server_data_format">1.4. Data formats</a>
<ul class="sectlevel3">
<li><a href="#rest_server_data_format_config">1.4.1. Configuration</a></li>
<li><a href="#rest_server_data_format_support">1.4.2. Supported formats</a></li>
<li><a href="#rest_accept">1.4.3. Accept header</a></li>
<li><a href="#rest_key_content_type">1.4.4. Key-Content-Type header</a></li>
<li><a href="#jsonprotostream_conversion">1.4.5. JSON/Protostream conversion</a></li>
</ul>
</li>
<li><a href="#rest_v1_api">1.5. REST V1 API</a>
<ul class="sectlevel3">
<li><a href="#putting_data_in">1.5.1. Putting data in</a>
<ul class="sectlevel4">
<li><a href="#rest_server_put_request"><code>PUT /rest/{cacheName}/{cacheKey}</code></a></li>
<li><a href="#rest_server_post_request"><code>POST /rest/{cacheName}/{cacheKey}</code></a></li>
</ul>
</li>
<li><a href="#rest_server_get_data">1.5.2. Getting data back out</a>
<ul class="sectlevel4">
<li><a href="#rest_server_get_request"><code>GET /rest/{cacheName}/{cacheKey}</code></a></li>
<li><a href="#rest_server_head_request"><code>HEAD /rest/{cacheName}/{cacheKey}</code></a></li>
</ul>
</li>
<li><a href="#rest_server_list_keys">1.5.3. Listing keys</a>
<ul class="sectlevel4">
<li><a href="#rest_server_list_get"><code>GET /rest/{cacheName}</code></a></li>
</ul>
</li>
<li><a href="#rest_server_remove_data">1.5.4. Removing data</a>
<ul class="sectlevel4">
<li><a href="#rest_server_delete_keys"><code>DELETE /rest/{cacheName}/{cacheKey}</code></a></li>
<li><a href="#rest_server_delete_cache"><code>DELETE /rest/{cacheName}</code></a></li>
</ul>
</li>
<li><a href="#rest_server_query">1.5.5. Querying</a>
<ul class="sectlevel4">
<li><a href="#rest_server_query_get"><code>GET /rest/{cacheName}?action=search&amp;query={ickle query}</code></a></li>
<li><a href="#rest_server_query_post"><code>POST /{cacheName}?action=search</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#rest_v2_api">1.6. REST v2 (version 2) API</a>
<ul class="sectlevel3">
<li><a href="#rest_v2_cache_operations">1.6.1. Working with Caches</a>
<ul class="sectlevel4">
<li><a href="#rest_v2_create_cache">Creating Caches</a>
<ul class="sectlevel5">
<li><a href="#rest_v2_create_cache_template">Creating Caches with Templates</a></li>
</ul>
</li>
<li><a href="#rest_v2_cache_configuration">Retrieving Cache Configuration</a></li>
<li><a href="#rest_v2_cache_config_convert">Converting Cache Configurations</a></li>
<li><a href="#rest_v2_add_entries">Adding Entries</a></li>
<li><a href="#rest_v2_replace_entries">Replacing Entries</a></li>
<li><a href="#rest_v2_retrieve_cache">Retrieving Data By Keys</a></li>
<li><a href="#rest_v2_check_entries">Checking if Entries Exist</a></li>
<li><a href="#rest_v2_delete_entries">Deleting Entries</a></li>
<li><a href="#rest_v2_remove_cache">Removing Caches</a></li>
<li><a href="#rest_v2_get_keys">Retrieving cache keys</a></li>
<li><a href="#rest_v2_clear_cache">Clearing Caches</a></li>
<li><a href="#rest_v2_cache_size">Getting Cache Size</a></li>
<li><a href="#rest_v2_cache_stats">Getting Cache Statistics</a></li>
<li><a href="#rest_v2_query_cache">Querying Caches</a></li>
<li><a href="#rest_v2_list_caches">Listing Caches</a></li>
<li><a href="#rest_v2_cache_xsite">Cross site replication</a>
<ul class="sectlevel5">
<li><a href="#getting_status_of_all_backup_sites">Getting status of all backup sites</a></li>
<li><a href="#getting_status_of_a_backup_site">Getting status of a backup site</a></li>
<li><a href="#taking_a_backup_site_offline">Taking a backup site offline</a></li>
<li><a href="#bringing_a_backup_site_online">Bringing a backup site online</a></li>
<li><a href="#starting_a_state_push_to_a_backup_site">Starting a state push to a backup site</a></li>
<li><a href="#cancelling_an_ongoing_state_push_to_a_backup_site">Cancelling an ongoing state push to a backup site</a></li>
<li><a href="#getting_the_status_of_a_state_push">Getting the status of a state push</a></li>
<li><a href="#tuning_the_take_offline_parameters_of_a_remote_site">Tuning the take offline parameters of a remote site</a></li>
<li><a href="#cancelling_the_receiving_state_on_a_site">Cancelling the receiving state on a site</a></li>
<li><a href="#clearing_the_state_transfer_status_of_a_pushing_site">Clearing the state transfer status of a pushing site</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#rest_v2_cache_manager_operations">1.6.2. Interacting with Cache Managers</a>
<ul class="sectlevel4">
<li><a href="#rest_v2_cache_manager_info">Getting Basic Cache Manager Information</a></li>
<li><a href="#rest_v2_cache_manager_health">Getting Cluster Health</a>
<ul class="sectlevel5">
<li><a href="#rest_v2_cache_manager_health_status">Getting Cache Manager Health Status</a></li>
</ul>
</li>
<li><a href="#rest_v2_cache_manager_availability">Checking REST Endpoint Availability</a></li>
<li><a href="#rest_v2_cache_manager_config">Obtaining Global Configuration for Cache Managers</a></li>
<li><a href="#rest_v2_cache_manager_caches_config">Obtaining Configuration for All Caches</a></li>
<li><a href="#rest_v2_cache_manager_cache_list">(Experimental) Obtaining caches with cache information</a></li>
<li><a href="#rest_v2_cache_manager_stats">Getting Cache Manager Statistics</a></li>
<li><a href="#rest_v2_cache_manager_xsite">Managing Cross site replication</a>
<ul class="sectlevel5">
<li><a href="#rest_v2_cache_manager_site_status">Retrieving backup statuses</a></li>
<li><a href="#rest_v2_cache_manager_take_offline">Taking a backup site offline</a></li>
<li><a href="#rest_v2_cache_manager_bring_online">Bringing a backup site online</a></li>
<li><a href="#rest_v2_cache_manager_start_push">Starting a state push</a></li>
<li><a href="#rest_v2_cache_manager_cancel_push">Cancelling an ongoing state push</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#rest_server_counters">1.6.3. Working with Counters</a>
<ul class="sectlevel4">
<li><a href="#rest_server_counters_create">Creating Counters</a></li>
<li><a href="#rest_server_counters_delete">Deleting Counters</a></li>
<li><a href="#rest_server_counters_config">Retrieving Counter Configuration</a></li>
<li><a href="#rest_server_counters_add">Adding Values to Counters</a></li>
<li><a href="#rest_server_counters_get">Getting Counter Values</a></li>
<li><a href="#rest_server_counters_reset">Resetting Counters</a></li>
<li><a href="#rest_server_counters_inc_weak">Incrementing Counters</a></li>
<li><a href="#rest_server_counters_add_weak">Adding Deltas to Counters</a></li>
<li><a href="#rest_server_counters_dec_strong">Decrementing Counters</a></li>
<li><a href="#rest_server_counters_cmpset">compareAndSet Strong Counters</a></li>
<li><a href="#rest_server_counters_cmpswp">compareAndSwap Strong Counters</a></li>
<li><a href="#rest_server_counters_list">Listing Counters</a></li>
</ul>
</li>
<li><a href="#rest_v2_server">1.6.4. Interacting with Infinispan Servers</a>
<ul class="sectlevel4">
<li><a href="#rest_v2_server_info">Retrieving Basic Server Information</a></li>
<li><a href="#rest_v2_server_cm">Cache Managers</a></li>
<li><a href="#rest_v2_cache_ignore">Ignoring caches</a></li>
<li><a href="#rest_v2_server_config">Obtaining Server Configuration</a></li>
<li><a href="#rest_v2_server_env">Getting Environment Variables</a></li>
<li><a href="#rest_v2_server_memory">Getting JVM Memory Details</a></li>
<li><a href="#rest_v2_server_threads">Getting JVM Thread Dumps</a></li>
<li><a href="#rest_v2_server_stop">Stopping Infinispan Servers</a></li>
</ul>
</li>
<li><a href="#rest_v2_cluster">1.6.5. Interacting with Infinispan Clusters</a>
<ul class="sectlevel4">
<li><a href="#rest_v2_cluster_stop">Stopping Infinispan Clusters</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#client_side_code">1.7. Client-Side Code</a>
<ul class="sectlevel3">
<li><a href="#rest_server_client_ruby">1.7.1. Ruby example</a></li>
<li><a href="#rest_server_client_python">1.7.2. Python 3 example</a></li>
<li><a href="#rest_server_client_java">1.7.3. Java example</a></li>
<li><a href="#rest_server_client_java">1.7.4. REST Example with the HttpClient API</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="rest_server"><a class="anchor" href="#rest_server"></a>1. REST Server</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Infinispan Server distribution contains a module that implements <a href="http://en.wikipedia.org/wiki/Representational_State_Transfer">RESTful</a> HTTP access to the Infinispan data grid, built on <a href="https://github.com/netty/netty">Netty</a>.</p>
</div>
<div class="sect2">
<h3 id="rest_run_server"><a class="anchor" href="#rest_run_server"></a>1.1. Running the REST server</h3>
<div class="paragraph">
<p>The REST server endpoint is part of the Infinispan Server and by default listens on port 8080. To run the server locally,
<a href="http://infinispan.org/download/">download</a> the zip distribution and execute in the extracted directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>bin/standalone.sh -b 0.0.0.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>or alternatively, run via docker:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>docker run -it -p 8080:8080 -e "APP_USER=user" -e "APP_PASS=changeme" jboss/infinispan-server</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="rest_security"><a class="anchor" href="#rest_security"></a>1.1.1. Security</h4>
<div class="paragraph">
<p>The REST server is protected by authentication, so before usage it is necessary to create an application login.
When running via docker, this is achieved by the APP_USER and APP_PASS command line arguments, but when running
locally, this can be done with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>bin/add-user.sh -u user -p changeme -a</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_supported_protocols"><a class="anchor" href="#rest_supported_protocols"></a>1.2. Supported protocols</h3>
<div class="paragraph">
<p>The REST Server supports HTTP/1.1 as well as HTTP/2 protocols. It is possible to switch to HTTP/2 by either performing a <a href="https://http2.github.io/http2-spec/#discover-http">HTTP/1.1 Upgrade procedure</a> or
by negotiating communication protocol using <a href="https://http2.github.io/http2-spec/#versioning">TLS/ALPN extension</a>.</p>
</div>
<div class="paragraph">
<p>Note: TLS/ALPN with JDK8 requires additional steps from the client perspective. Please refer to your client documentation but it is very likely
that you will need Jetty ALPN Agent or OpenSSL bindings.</p>
</div>
</div>
<div class="sect2">
<h3 id="rest_server_cors"><a class="anchor" href="#rest_server_cors"></a>1.3. CORS</h3>
<div class="paragraph">
<p>The REST server supports <a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">CORS</a> including preflight and rules based on the request origin.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;rest-connector</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">rest1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">socket-binding</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">rest</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">cache-container</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;cors-rules&gt;</span>
      <span class="tag">&lt;cors-rule</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">restrict host1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">allow-credentials</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;allowed-origins&gt;</span>http://host1,https://host1<span class="tag">&lt;/allowed-origins&gt;</span>
         <span class="tag">&lt;allowed-methods&gt;</span>GET<span class="tag">&lt;/allowed-methods&gt;</span>
      <span class="tag">&lt;/cors-rule&gt;</span>
      <span class="tag">&lt;cors-rule</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">allow ALL</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">allow-credentials</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">max-age-seconds</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2000</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;allowed-origins&gt;</span>*<span class="tag">&lt;/allowed-origins&gt;</span>
         <span class="tag">&lt;allowed-methods&gt;</span>GET,OPTIONS,POST,PUT,DELETE<span class="tag">&lt;/allowed-methods&gt;</span>
         <span class="tag">&lt;allowed-headers&gt;</span>Key-Content-Type<span class="tag">&lt;/allowed-headers&gt;</span>
      <span class="tag">&lt;/cors-rule&gt;</span>
   <span class="tag">&lt;/cors-rules&gt;</span>
<span class="tag">&lt;/rest-connector&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The rules are evaluated sequentially based on the "Origin" header set by the browser; in the example above if the origin is either "http://host1" or "https://host1" the rule "restrict host1" will apply,
otherwise the next rule will be tested. Since the rule "allow ALL" permits all origins, any script coming from a different origin will be able to perform the methods specified and use the headers supplied.</p>
</div>
<div class="paragraph">
<p>The &lt;cors-rule&gt; element can be configured as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Config</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Mandatory</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the rule</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">allow-credentials</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable CORS requests to use credentials</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">allowed-origins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comma separated list used to set the CORS 'Access-Control-Allow-Origin' header to indicate the response can be shared with the origins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">allowed-methods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comma separated list used to set the CORS 'Access-Control-Allow-Methods' header in the preflight response to specify the methods allowed for the configured origin(s)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max-age-seconds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The amount of time CORS preflight request headers can be cached</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">expose-headers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comma separated list used to set the CORS 'Access-Control-Expose-Headers' in the preflight response to specify which headers can be exposed to the configured origin(s)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="rest_server_data_format"><a class="anchor" href="#rest_server_data_format"></a>1.4. Data formats</h3>
<div class="sect3">
<h4 id="rest_server_data_format_config"><a class="anchor" href="#rest_server_data_format_config"></a>1.4.1. Configuration</h4>
<div class="paragraph">
<p>Each cache exposed via REST stores data in a configurable data format defined by a <a href="https://en.wikipedia.org/wiki/Media_type">MediaType</a>. More details in the configuration <a href="#encoding_media_type">here</a>.</p>
</div>
<div class="paragraph">
<p>An example of storage configuration is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;cache&gt;</span>
   <span class="tag">&lt;encoding&gt;</span>
      <span class="tag">&lt;key</span> <span class="attribute-name">media-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application/x-java-object; type=java.lang.Integer</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;value</span> <span class="attribute-name">media-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml; charset=UTF-8</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
   <span class="tag">&lt;/encoding&gt;</span>
<span class="tag">&lt;/cache&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When no MediaType is configured, Infinispan assumes "application/octet-stream" for both keys and values, with the following exceptions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the cache is indexed, it assumes "application/x-protostream"</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_data_format_support"><a class="anchor" href="#rest_server_data_format_support"></a>1.4.2. Supported formats</h4>
<div class="paragraph">
<p>Data can be written and read in different formats than the storage format; Infinispan can convert between those formats when required.</p>
</div>
<div class="paragraph">
<p>The following "standard" formats can be converted interchangeably:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>application/x-java-object</em></p>
</li>
<li>
<p><em>application/octet-stream</em></p>
</li>
<li>
<p><em>application/x-www-form-urlencoded</em></p>
</li>
<li>
<p><em>text/plain</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following formats can be converted to/from the formats above:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>application/xml</em></p>
</li>
<li>
<p><em>application/json</em></p>
</li>
<li>
<p><em>application/x-jboss-marshalling</em></p>
</li>
<li>
<p><em>application/x-protostream</em></p>
</li>
<li>
<p><em>application/x-java-serialized</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Finally, the following conversion is also supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Between <em>application/x-protostream</em> and <em>application/json</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All the REST API calls can provide headers describing the content written or the required format of the content
when reading. Infinispan supports the standard HTTP/1.1 headers "Content-Type" and "Accept" that are applied for values,
plus the "Key-Content-Type" with similar effect for keys.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_accept"><a class="anchor" href="#rest_accept"></a>1.4.3. Accept header</h4>
<div class="paragraph">
<p>The REST server is compliant with the <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html">RFC-2616</a> Accept header,
and will negotiate the correct MediaType based on the conversions supported. Example, sending the following header when reading data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>Accept: text/plain;q=0.7, application/json;q=0.8, */*;q=0.6</code></pre>
</div>
</div>
<div class="paragraph">
<p>will cause Infinispan to try first to return content in JSON format (higher priority 0.8). If it&#8217;s not possible to convert the storage format
to JSON, next format tried will be <em>text/plain</em> (second highest priority 0.7), and finally it falls back to <em>*/*</em>, that will pick a format
suitable for displaying automatically based on the cache configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_key_content_type"><a class="anchor" href="#rest_key_content_type"></a>1.4.4. Key-Content-Type header</h4>
<div class="paragraph">
<p>Most REST API calls have the Key included in the URL. Infinispan will assume the Key is a <em>java.lang.String</em> when handling those calls, but
it&#8217;s possible to use a specific header <em>Key-Content-Type</em> for keys in different formats.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specifying a byte[] Key as a Base64 string:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>API call:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`PUT /my-cache/AQIDBDM=`</pre>
</div>
</div>
<div class="paragraph">
<p>Headers:</p>
</div>
<div class="paragraph">
<p><code>Key-Content-Type: application/octet-stream</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specifying a byte[] Key as a hexadecimal string:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>API call:</p>
</div>
<div class="paragraph">
<p><code>GET /my-cache/0x01CA03042F</code></p>
</div>
<div class="paragraph">
<p>Headers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>Key-Content-Type: application/octet-stream; encoding=hex</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Specifying a double Key:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>API call:</p>
</div>
<div class="paragraph">
<p><code>POST /my-cache/3.141456</code></p>
</div>
<div class="paragraph">
<p>Headers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>Key-Content-Type: application/x-java-object;type=java.lang.Double</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>type</em> parameter for <em>application/x-java-object</em> is restricted to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Primitive wrapper types</p>
</li>
<li>
<p>java.lang.String</p>
</li>
<li>
<p>Bytes, making <em>application/x-java-object;type=Bytes</em> equivalent to <em>application/octet-stream;encoding=hex</em></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="jsonprotostream_conversion"><a class="anchor" href="#jsonprotostream_conversion"></a>1.4.5. JSON/Protostream conversion</h4>
<div class="paragraph">
<p>When caches are indexed, or specifically configured to store <em>application/x-protostream</em>, it&#8217;s possible to send and receive
JSON documents that are automatically converted to/from protostream. In order for the conversion to work, a protobuf schema must be registered.</p>
</div>
<div class="paragraph">
<p>The registration can be done via REST, by doing a POST/PUT in the <em>___protobuf_metadata</em> cache. Example using cURL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl -u user:password -X POST --data-binary @./schema.proto http://127.0.0.1:8080/rest/___protobuf_metadata/schema.proto</code></pre>
</div>
</div>
<div class="paragraph">
<p>When writing a JSON document, a special field <strong><em>_type</em></strong> must be present in the document to identity the protobuf <em>Message</em>
corresponding to the document.</p>
</div>
<div class="paragraph">
<p>For example, consider the following schema:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="protobuf">message Person  {
  required string name = 1;
  required int32 age = 2;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A conformant JSON document would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
   <span class="key"><span class="delimiter">&quot;</span><span class="content">_type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Person</span><span class="delimiter">&quot;</span></span>,
   <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">user1</span><span class="delimiter">&quot;</span></span>,
   <span class="key"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span>: <span class="integer">32</span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v1_api"><a class="anchor" href="#rest_v1_api"></a>1.5. REST V1 API</h3>
<div class="paragraph">
<p>The REST V1 API supports basic cache capabilities including operations on keys and query, and is now deprecated. For a more powerful and comprehensive API, check the <a href="#rest_v2_api">REST V2 API</a>.</p>
</div>
<div class="paragraph">
<p>HTTP PUT and POST methods are used to place data in the cache, with URLs to address the cache name and key(s) - the data being the body of the request (the data can be anything you like). Other headers are used to control the cache settings and behaviour.</p>
</div>
<div class="sect3">
<h4 id="putting_data_in"><a class="anchor" href="#putting_data_in"></a>1.5.1. Putting data in</h4>
<div class="sect4">
<h5 id="rest_server_put_request"><a class="anchor" href="#rest_server_put_request"></a><code>PUT /rest/{cacheName}/{cacheKey}</code></h5>
<div class="paragraph">
<p>A PUT request of the above URL form will place the payload (body) in the given cache, with the given key (the named cache must exist on the server). For example <code><a href="http://someserver/hr/payRoll-3" class="bare">http://someserver/hr/payRoll-3</a></code> (in which case <code>hr</code> is the cache name, and <code>payRoll-3</code> is the key). Any existing data will be replaced, and Time-To-Live and Last-Modified values etc will updated (if applicable).</p>
</div>
</div>
<div class="sect4">
<h5 id="rest_server_post_request"><a class="anchor" href="#rest_server_post_request"></a><code>POST /rest/{cacheName}/{cacheKey}</code></h5>
<div class="paragraph">
<p>Exactly the same as PUT, only if a value in a cache/key already exists, it will return a Http CONFLICT status (and the content will not be updated).</p>
</div>
<div class="ulist">
<div class="title">Headers</div>
<ul>
<li>
<p><a href="#rest_key_content_type">Key-Content-Type</a>: OPTIONAL The content type for the Key present in the URL.</p>
</li>
<li>
<p>Content-Type : OPTIONAL The <a href="https://en.wikipedia.org/wiki/Media_type">MediaType</a> of the Value being sent.</p>
</li>
<li>
<p>timeToLiveSeconds : OPTIONAL number (the number of seconds before this entry will automatically be deleted). If no parameter is sent, Infinispan assumes configuration default value. Passing any negative value will create an entry which will live forever.</p>
</li>
<li>
<p>maxIdleTimeSeconds : OPTIONAL number (the number of seconds after last usage of this entry when it will automatically be deleted). If no  parameter is sent, Infinispan configuration default value. Passing any negative value will create an entry which will live forever.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Passing 0 as parameter for timeToLiveSeconds and/or maxIdleTimeSeconds</div>
<ul>
<li>
<p>If both <code>timeToLiveSeconds</code> and <code>maxIdleTimeSeconds</code> are 0, the cache will use the default <code>lifespan</code> and <code>maxIdle</code> values configured in XML/programmatically</p>
</li>
<li>
<p>If <em>only</em> <code>maxIdleTimeSeconds</code> is 0, it uses the <code>timeToLiveSeconds</code> value passed as parameter (or -1 if not present), and default <code>maxIdle</code> configured in XML/programmatically</p>
</li>
<li>
<p>If <em>only</em> <code>timeToLiveSeconds</code> is 0, it uses default <code>lifespan</code> configured in XML/programmatically, and <code>maxIdle</code> is set to whatever came as parameter (or -1 if not present)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_get_data"><a class="anchor" href="#rest_server_get_data"></a>1.5.2. Getting data back out</h4>
<div class="paragraph">
<p>HTTP GET and HEAD are used to retrieve data from entries.</p>
</div>
<div class="sect4">
<h5 id="rest_server_get_request"><a class="anchor" href="#rest_server_get_request"></a><code>GET /rest/{cacheName}/{cacheKey}</code></h5>
<div class="paragraph">
<p>This will return the data found in the given cacheName, under the given key - as the body of the response. A Content-Type header will be present in the response according to the Media Type negotiation. Browsers can use the cache directly of course (eg as a CDN). An <a href="http://en.wikipedia.org/wiki/HTTP_ETag">ETag</a> will be returned unique for each entry, as will the Last-Modified and Expires headers field indicating the state of the data at the given URL. ETags allow browsers (and other clients) to ask for data only in the case where it has changed (to save on bandwidth) - this is standard HTTP and is honoured by Infinispan.</p>
</div>
<div class="ulist">
<div class="title">Headers</div>
<ul>
<li>
<p><a href="#rest_key_content_type">Key-Content-Type</a>: OPTIONAL The content type for the Key present in the URL. When omitted, <em>application/x-java-object; type=java.lang.String</em> is assumed</p>
</li>
<li>
<p><a href="#rest_accept">Accept</a>: OPTIONAL The required format to return the content</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is possible to obtain additional information by appending the "extended" parameter on the query string, as follows:</p>
</div>
<div class="paragraph">
<p><code>GET /rest/cacheName/cacheKey?extended</code></p>
</div>
<div class="paragraph">
<p>This will return the following custom headers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cluster-Primary-Owner: the node name of the primary owner for this key</p>
</li>
<li>
<p>Cluster-Backup-Owners: the node names of the backup owners for this key</p>
</li>
<li>
<p>Cluster-Node-Name: the JGroups node name of the server that has handled the request</p>
</li>
<li>
<p>Cluster-Physical-Address: the physical JGroups address of the server that has handled the request.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="rest_server_head_request"><a class="anchor" href="#rest_server_head_request"></a><code>HEAD /rest/{cacheName}/{cacheKey}</code></h5>
<div class="paragraph">
<p>The same as GET, only no content is returned (only the header fields). You will receive the same content that you stored. E.g., if you stored a String, this is what you get back. If you stored some XML or JSON, this is what you will receive. If you stored a binary (base 64 encoded) blob, perhaps a serialized; Java; object - you will need to; deserialize this yourself.</p>
</div>
<div class="paragraph">
<p>Similarly to the GET method, the HEAD method also supports returning extended information via headers. See above.</p>
</div>
<div class="ulist">
<div class="title">Headers</div>
<ul>
<li>
<p><a href="#rest_key_content_type">Key-Content-Type</a>: OPTIONAL The content type for the Key present in the URL. When omitted, <em>application/x-java-object; type=java.lang.String</em> is assumed</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_list_keys"><a class="anchor" href="#rest_server_list_keys"></a>1.5.3. Listing keys</h4>
<div class="sect4">
<h5 id="rest_server_list_get"><a class="anchor" href="#rest_server_list_get"></a><code>GET /rest/{cacheName}</code></h5>
<div class="paragraph">
<p>This will return a list of keys present in the given cacheName as the body of the response. The format of the response can be controlled via the Accept header as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>application/xml</em> - the list of keys will be returned in XML format.</p>
</li>
<li>
<p><em>application/json</em> - the list of keys will be return in JSON format.</p>
</li>
<li>
<p><em>text/plain</em> - the list of keys will be returned in plain text format, one key per line</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the cache identified by cacheName is distributed, only the keys owned by the node handling the request will be returned. To return all keys, append the "global" parameter to the query, as follows:</p>
</div>
<div class="paragraph">
<p><code>GET /rest/cacheName?global</code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_remove_data"><a class="anchor" href="#rest_server_remove_data"></a>1.5.4. Removing data</h4>
<div class="paragraph">
<p>Data can be removed at the cache key/element level, or via a whole cache name using the HTTP delete method.</p>
</div>
<div class="sect4">
<h5 id="rest_server_delete_keys"><a class="anchor" href="#rest_server_delete_keys"></a><code>DELETE /rest/{cacheName}/{cacheKey}</code></h5>
<div class="paragraph">
<p>Removes the given key name from the cache.</p>
</div>
<div class="ulist">
<div class="title">Headers</div>
<ul>
<li>
<p><a href="#rest_key_content_type">Key-Content-Type</a>: OPTIONAL The content type for the Key present in the URL. When omitted, <em>application/x-java-object; type=java.lang.String</em> is assumed</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="rest_server_delete_cache"><a class="anchor" href="#rest_server_delete_cache"></a><code>DELETE /rest/{cacheName}</code></h5>
<div class="paragraph">
<p>Removes ALL the entries in the given cache name (i.e., everything from that path down). If the operation is successful, it returns 200 code.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_query"><a class="anchor" href="#rest_server_query"></a>1.5.5. Querying</h4>
<div class="paragraph">
<p>The REST server supports Ickle Queries in JSON format. It&#8217;s important that the cache is configured with
<em>application/x-protostream</em> for both Keys and Values. If the cache is indexed, no configuration is needed.</p>
</div>
<div class="sect4">
<h5 id="rest_server_query_get"><a class="anchor" href="#rest_server_query_get"></a><code>GET /rest/{cacheName}?action=search&amp;query={ickle query}</code></h5>
<div class="paragraph">
<p>Will execute an Ickle query in the given cache name.</p>
</div>
<div class="ulist">
<div class="title">Request parameters</div>
<ul>
<li>
<p><em>query</em>: REQUIRED the query string</p>
</li>
<li>
<p><em>max_results</em>: OPTIONAL the number of results to return, default is <em>10</em></p>
</li>
<li>
<p><em>offset</em>: OPTIONAL the index of the first result to return, default is <em>0</em></p>
</li>
<li>
<p><em>query_mode</em>: OPTIONAL the execution mode of the query once it&#8217;s received by server. Valid values are <em>FETCH</em> and <em>BROADCAST</em>. Default is <em>FETCH</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Query Result</div>
<p>Results are JSON documents containing one or more hits. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">total_results</span><span class="delimiter">&quot;</span></span> : <span class="integer">150</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">hits</span><span class="delimiter">&quot;</span></span> : [ {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">hit</span><span class="delimiter">&quot;</span></span> : {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">user1</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span> : <span class="integer">35</span>
    }
  }, {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">hit</span><span class="delimiter">&quot;</span></span> : {
       <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">user2</span><span class="delimiter">&quot;</span></span>,
       <span class="key"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span> : <span class="integer">42</span>
    }
  }, {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">hit</span><span class="delimiter">&quot;</span></span> : {
       <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">user3</span><span class="delimiter">&quot;</span></span>,
       <span class="key"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span> : <span class="integer">12</span>
    }
  } ]
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><em>total_results</em>: NUMBER, the total number of results from the query.</p>
</li>
<li>
<p><em>hits</em>: ARRAY, list of matches from the query</p>
</li>
<li>
<p><em>hit</em>: OBJECT, each result from the query. Can contain all fields or just a subset of fields in case a <em>Select</em> clause is used.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="rest_server_query_post"><a class="anchor" href="#rest_server_query_post"></a><code>POST /{cacheName}?action=search</code></h5>
<div class="paragraph">
<p>Similar to que query using GET, but the body of the request is used instead to specify the query parameters.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
 <span class="key"><span class="delimiter">&quot;</span><span class="content">query</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">from Entity where name:</span><span class="char">\&quot;</span><span class="content">user1</span><span class="char">\&quot;</span><span class="delimiter">&quot;</span></span>,
 <span class="key"><span class="delimiter">&quot;</span><span class="content">max_results</span><span class="delimiter">&quot;</span></span>:<span class="integer">20</span>,
 <span class="key"><span class="delimiter">&quot;</span><span class="content">offset</span><span class="delimiter">&quot;</span></span>:<span class="integer">10</span>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_api"><a class="anchor" href="#rest_v2_api"></a>1.6. REST v2 (version 2) API</h3>
<div class="paragraph">
<p>The Infinispan REST v2 API improves on the REST v1 API, offering the same features and capabilities in addition to supporting resources beyond caching.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The REST v1 API is deprecated and will not be supported in the next version of Infinispan
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_operations"><a class="anchor" href="#rest_v2_cache_operations"></a>1.6.1. Working with Caches</h4>
<div class="paragraph">
<p>Use the REST API to create and manage caches on your Infinispan cluster and interact with cached entries.</p>
</div>
<div class="sect4">
<h5 id="rest_v2_create_cache"><a class="anchor" href="#rest_v2_create_cache"></a>Creating Caches</h5>
<div class="paragraph">
<p>To create a named cache across the Infinispan cluster, invoke a <code>POST</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/caches/{cacheName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To configure the cache, you supply the configuration in <code>XML</code> or <code>JSON</code> format
as part of the request payload.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">XML Configuration</dt>
<dd>
<p>A configuration in <code>XML</code> format must conform to the schema and include:</p>
<div class="ulist">
<ul>
<li>
<p><code>&lt;infinispan&gt;</code> root element.</p>
</li>
<li>
<p><code>&lt;cache-container&gt;</code> definition.</p>
<div class="paragraph">
<p>The following example shows a valid <code>XML</code> configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;infinispan&gt;</span>
    <span class="tag">&lt;cache-container&gt;</span>
        <span class="tag">&lt;distributed-cache</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cacheName</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">mode</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SYNC</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;memory&gt;</span>
                <span class="tag">&lt;object</span> <span class="attribute-name">size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">20</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/memory&gt;</span>
        <span class="tag">&lt;/distributed-cache&gt;</span>
    <span class="tag">&lt;/cache-container&gt;</span>
<span class="tag">&lt;/infinispan&gt;</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">JSON Configuration</dt>
<dd>
<p>A configuration in <code>JSON</code> format payload:</p>
<div class="ulist">
<ul>
<li>
<p>Requires the cache definition only.</p>
</li>
<li>
<p>Must follow the structure of an <code>XML</code> configuration.</p>
<div class="ulist">
<ul>
<li>
<p><code>XML</code> elements become <code>JSON</code> objects.</p>
</li>
<li>
<p><code>XML</code> attributes become <code>JSON</code> fields.</p>
<div class="paragraph">
<p>The following example shows the previous <code>XML</code> configuration in <code>JSON</code> format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">distributed-cache</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">mode</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SYNC</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">memory</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">object</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span>: <span class="integer">20</span>
      }
    }
  }
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the <a href="https://en.wikipedia.org/wiki/Media_type">MediaType</a> for the
Infinispan configuration payload; either <code>application/xml</code> or
<code>application/json</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to set <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/commons/api/CacheContainerAdmin.AdminFlag.html">AdminFlags</a></p></td>
</tr>
</tbody>
</table>
<div class="sect5">
<h6 id="rest_v2_create_cache_template"><a class="anchor" href="#rest_v2_create_cache_template"></a>Creating Caches with Templates</h6>
<div class="paragraph">
<p>To create caches across a Infinispan cluster with pre-defined templates,
invoke a <code>POST</code> request with no payload and an extra request parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/caches/{cacheName}?template={templateName}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_configuration"><a class="anchor" href="#rest_v2_cache_configuration"></a>Retrieving Cache Configuration</h5>
<div class="paragraph">
<p>To retrieve the configuration of a Infinispan cache, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{name}?action=config</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Accept</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the required format to return content. Supported formats are <code>application/xml</code> and <code>application/json</code>. The default is <code>application/json</code>. See <a href="#rest_accept">Accept</a> for more information.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_config_convert"><a class="anchor" href="#rest_v2_cache_config_convert"></a>Converting Cache Configurations</h5>
<div class="paragraph">
<p>To convert a certain existing cache configuration that is in XML format to JSON, invoke:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/caches?action=toJSON</code></pre>
</div>
</div>
<div class="paragraph">
<p>The POST body must contain a valid cache XML configuration and the response will contain the equivalent JSON representation.</p>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_add_entries"><a class="anchor" href="#rest_v2_add_entries"></a>Adding Entries</h5>
<div class="paragraph">
<p>To add entries to a named cache, invoke a <code>POST</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/caches/{cacheName}/{cacheKey}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding request places the payload, or request body, in the <code>cacheName</code>
cache with the <code>cacheKey</code> key. The request replaces any data that already
exists and updates the <code>Time-To-Live</code> and <code>Last-Modified</code> values, if they apply.</p>
</div>
<div class="paragraph">
<p>If a value already exists for the specified key, the <code>POST</code> request returns an
HTTP <code>CONFLICT</code> status and does not modify the value. To update values, you
should use <code>PUT</code> requests. See <a href="#rest_v2_replace_entries">Replacing Entries</a>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Key-Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the content type for the key in the request. See <a href="#rest_key_content_type">Key-Content-Type</a> for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the <a href="https://en.wikipedia.org/wiki/Media_type">MediaType</a> of the value for the key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timeToLiveSeconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the number of seconds before the entry is automatically deleted. If you do not set this parameter, Infinispan uses the default value from the configuration. If you set a negative value, the entry is never deleted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxIdleTimeSeconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the number of seconds that entries can be idle. If a read or write operation does not occur for an entry after the maximum idle time elapses, the entry is automatically deleted. If you do not set this parameter, Infinispan uses the default value from the configuration. If you set a negative value, the entry is never deleted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The flags used to add the entry. See <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/context/Flag.html">Flag</a> for more information.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>flags</code> header also applies to all other operations involving data manipulation on the cache,
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If both <code>timeToLiveSeconds</code> and <code>maxIdleTimeSeconds</code> have a value of <code>0</code>, Infinispan uses the default <code>lifespan</code> and <code>maxIdle</code> values from the configuration.</p>
</div>
<div class="paragraph">
<p>If <em>only</em> <code>maxIdleTimeSeconds</code> has a value of <code>0</code>, Infinispan uses:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the default <code>maxIdle</code> value from the configuration.</p>
</li>
<li>
<p>the value for <code>timeToLiveSeconds</code> that you pass as a request parameter or a value of <code>-1</code> if you do not pass a value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <em>only</em> <code>timeToLiveSeconds</code> has a value of <code>0</code>, Infinispan uses:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the default <code>lifespan</code> value from the configuration.</p>
</li>
<li>
<p>the value for <code>maxIdle</code> that you pass as a request parameter or a value of <code>-1</code> if you do not pass a value.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_replace_entries"><a class="anchor" href="#rest_v2_replace_entries"></a>Replacing Entries</h5>
<div class="paragraph">
<p>To replace entries in a named cache, invoke a <code>PUT</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>PUT /rest/v2/caches/{cacheName}/{cacheKey}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a value already exists for the specified key, the <code>PUT</code> request updates the
value. If you do not want to modify existing values, use <code>POST</code> requests that
return HTTP <code>CONFLICT</code> status instead of modifying values. See
<a href="#rest_v2_add_entries">Adding Values</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_retrieve_cache"><a class="anchor" href="#rest_v2_retrieve_cache"></a>Retrieving Data By Keys</h5>
<div class="paragraph">
<p>To retrieve data for a specific key in a cache, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{cacheName}/{cacheKey}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The server returns data from the given cache, <code>cacheName</code>, under the given key,
<code>cacheKey</code>, in the response body. Responses contain <code>Content-Type</code> headers that
correspond to the <code>MediaType</code> negotiation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Browsers can also access caches directly, for example as a content delivery
network (CDN). Infinispan returns a unique
<a href="http://en.wikipedia.org/wiki/HTTP_ETag">ETag</a> for each entry along with the
<code>Last-Modified</code> and <code>Expires</code> header fields.</p>
</div>
<div class="paragraph">
<p>These fields provide information about the state of the data that is returned
in your request. ETags allow browsers and other clients to request only data
that has changed, which conserves bandwidth.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Key-Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the content type for the key in the request. The default is <code>application/x-java-object; type=java.lang.String</code>. See <a href="#rest_key_content_type">Key-Content-Type</a> for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Accept</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the required format to return content. See <a href="#rest_accept">Accept</a> for more information.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Append the <code>extended</code> parameter to the query string to get additional information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /cacheName/cacheKey?extended</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding request returns custom headers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Cluster-Primary-Owner</code> returns the node name that is the primary owner of the key.</p>
</li>
<li>
<p><code>Cluster-Node-Name</code> returns the JGroups node name of the server that handled the request.</p>
</li>
<li>
<p><code>Cluster-Physical-Address</code> returns the physical JGroups address of the server that handled the request.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_check_entries"><a class="anchor" href="#rest_v2_check_entries"></a>Checking if Entries Exist</h5>
<div class="paragraph">
<p>To check if a specific entry exists in a cache, invoke a <code>HEAD</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>HEAD /rest/v2/caches/{cacheName}/{cacheKey}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding request returns only the header fields and the same content that
you stored with the entry. For example, if you stored a String, the request
returns a String. If you stored binary, base64-encoded, blobs or serialized
Java objects, Infinispan does not de-serialize the content in the request.</p>
</div>
<div class="paragraph">
<p><code>HEAD</code> requests also support the <code>extended</code> parameter.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Key-Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the content type for the key in the request. The default is <code>application/x-java-object; type=java.lang.String</code>. See <a href="#rest_key_content_type">Key-Content-Type</a> for more information.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="rest_v2_delete_entries"><a class="anchor" href="#rest_v2_delete_entries"></a>Deleting Entries</h5>
<div class="paragraph">
<p>To delete entries from a cache, invoke a <code>DELETE</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>DELETE /rest/v2/caches/{cacheName}/{cacheKey}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan removes the entry under <code>cacheKey</code> from the cache.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Key-Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the content type for the key in the request. The default is <code>application/x-java-object; type=java.lang.String</code>. See <a href="#rest_key_content_type">Key-Content-Type</a> for more information.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="rest_v2_remove_cache"><a class="anchor" href="#rest_v2_remove_cache"></a>Removing Caches</h5>
<div class="paragraph">
<p>To remove caches, invoke a <code>DELETE</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>DELETE /rest/v2/caches/{cacheName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan deletes all data and removes the cache named <code>cacheName</code> from the
cluster.</p>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_get_keys"><a class="anchor" href="#rest_v2_get_keys"></a>Retrieving cache keys</h5>
<div class="paragraph">
<p>To obtain all the keys from the cache in JSON format, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{cacheName}?action=keys</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>batch-size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the internal batch size when retrieving the keys. The default value is 1000.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="rest_v2_clear_cache"><a class="anchor" href="#rest_v2_clear_cache"></a>Clearing Caches</h5>
<div class="paragraph">
<p>To delete all data from a cache, invoke a <code>GET</code> request with the
<code>?action=clear</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{cacheName}?action=clear</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_size"><a class="anchor" href="#rest_v2_cache_size"></a>Getting Cache Size</h5>
<div class="paragraph">
<p>To obtain the size of a cache across the entire cluster, invoke a <code>GET</code>
request with the <code>?action=size</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{cacheName}?action=size</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_stats"><a class="anchor" href="#rest_v2_cache_stats"></a>Getting Cache Statistics</h5>
<div class="paragraph">
<p>To obtain runtime statistics of a cache invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{cacheName}?action=stats</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_query_cache"><a class="anchor" href="#rest_v2_query_cache"></a>Querying Caches</h5>
<div class="paragraph">
<p>Invoke a <code>GET</code> request to perform and Ickle query on a given cache:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{cacheName}?action=search&amp;query={ickle query}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan returns one or more query hits in <code>JSON</code> format, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">total_results</span><span class="delimiter">&quot;</span></span> : <span class="integer">150</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">hits</span><span class="delimiter">&quot;</span></span> : [ {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">hit</span><span class="delimiter">&quot;</span></span> : {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">user1</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span> : <span class="integer">35</span>
    }
  }, {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">hit</span><span class="delimiter">&quot;</span></span> : {
       <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">user2</span><span class="delimiter">&quot;</span></span>,
       <span class="key"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span> : <span class="integer">42</span>
    }
  }, {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">hit</span><span class="delimiter">&quot;</span></span> : {
       <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">user3</span><span class="delimiter">&quot;</span></span>,
       <span class="key"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span> : <span class="integer">12</span>
    }
  } ]
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>total_results</code> displays the total number of results from the query.</p>
</li>
<li>
<p><code>hits</code> is an array of matches from the query.</p>
</li>
<li>
<p><code>hit</code> is an object that matches the query.</p>
<div class="paragraph">
<p>Hits can contain all fields or a subset of fields if you use a <code>Select</code> clause.</p>
</div>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>query</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the query string.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>max_results</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the number of results to return. The default is <code>10</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>offset</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the index of the first result to return. The default is <code>0</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>query_mode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies how the Infinispan server executes the query. Values are <code>FETCH</code> and <code>BROADCAST</code>. The default is <code>FETCH</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To use the body of the request instead of specifying query parameters, invoke a
<code>POST</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/caches/{cacheName}?action=search</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example shows a query in the request body:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
 <span class="key"><span class="delimiter">&quot;</span><span class="content">query</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">from Entity where name:</span><span class="char">\&quot;</span><span class="content">user1</span><span class="char">\&quot;</span><span class="delimiter">&quot;</span></span>,
 <span class="key"><span class="delimiter">&quot;</span><span class="content">max_results</span><span class="delimiter">&quot;</span></span>:<span class="integer">20</span>,
 <span class="key"><span class="delimiter">&quot;</span><span class="content">offset</span><span class="delimiter">&quot;</span></span>:<span class="integer">10</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_list_caches"><a class="anchor" href="#rest_v2_list_caches"></a>Listing Caches</h5>
<div class="paragraph">
<p>To obtain a list of caches available in a Infinispan cluster, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_xsite"><a class="anchor" href="#rest_v2_cache_xsite"></a>Cross site replication</h5>
<div class="paragraph">
<p>Use the REST API to monitor and control Cross Site (x-site) replication on your Infinispan cluster.
See <a href="../xsite/xsite.html">Cross Site replication</a> for more details about this feature.</p>
</div>
<div class="sect5">
<h6 id="getting_status_of_all_backup_sites"><a class="anchor" href="#getting_status_of_all_backup_sites"></a>Getting status of all backup sites</h6>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/caches/{cacheName}/x-site/backups/</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response contains each site followed by a description of the status.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">NYC</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">online</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">LON</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">offline</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. Returned Status</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>online</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All nodes in the backup site are online</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>offline</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All node in the backup site are offline</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mixed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Some nodes in the backup site are online and others offline. It will include in the status the nodes that are offline. E.g.: <code>mixed, offline on nodes: Node1, Node2</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="getting_status_of_a_backup_site"><a class="anchor" href="#getting_status_of_a_backup_site"></a>Getting status of a backup site</h6>
<div class="paragraph">
<p>To obtain the status of a single backup site:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/caches/{cacheName}/x-site/backups/{siteName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response contains each node in the backup site with the status.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">NodeA</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">offline</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">NodeB</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">online</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. Returned Status</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>online</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The node is online</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>offline</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The node is offline</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>failed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failed to obtain status, the remote cache could be shutting down or a network error occurred during the request</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="taking_a_backup_site_offline"><a class="anchor" href="#taking_a_backup_site_offline"></a>Taking a backup site offline</h6>
<div class="paragraph">
<p>To take a backup site <code>siteName</code> offline, for the cache <code>cacheName</code>, execute a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/caches/{cacheName}/x-site/backups/{siteName}?action=take-offline</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="bringing_a_backup_site_online"><a class="anchor" href="#bringing_a_backup_site_online"></a>Bringing a backup site online</h6>
<div class="paragraph">
<p>To take a backup site <code>siteName</code> online, for the cache <code>cacheName</code>, execute a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/caches/{cacheName}/x-site/backups/{siteName}?action=bring-online</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="starting_a_state_push_to_a_backup_site"><a class="anchor" href="#starting_a_state_push_to_a_backup_site"></a>Starting a state push to a backup site</h6>
<div class="paragraph">
<p>To start pushing state of a cache <code>cacheName</code> to a remote backup site <code>siteName</code>, execute a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/caches/{cacheName}/x-site/backups/{siteName}?action=start-push-state</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="cancelling_an_ongoing_state_push_to_a_backup_site"><a class="anchor" href="#cancelling_an_ongoing_state_push_to_a_backup_site"></a>Cancelling an ongoing state push to a backup site</h6>
<div class="paragraph">
<p>To cancel a state push of the cache <code>cacheName</code> to a remote backup site <code>siteName</code>, execute a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/caches/{cacheName}/x-site/backups/{siteName}?action=cancel-push-state</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="getting_the_status_of_a_state_push"><a class="anchor" href="#getting_the_status_of_a_state_push"></a>Getting the status of a state push</h6>
<div class="paragraph">
<p>To obtain the status of an ongoing state push of cache <code>cacheName</code> to backup <code>siteName</code> execute a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/caches/{cacheName}/x-site/backups/{siteName}?action=cancel-push-state</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response will be a JSON document with each destination site name and the state transfer status.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
   <span class="key"><span class="delimiter">&quot;</span><span class="content">NYC</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">CANCELED</span><span class="delimiter">&quot;</span></span>,
   <span class="key"><span class="delimiter">&quot;</span><span class="content">LON</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">OK</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The possible statuses are <code>SENDING</code>, <code>OK</code>, <code>ERROR</code> and <code>CANCELLING</code></p>
</div>
</div>
<div class="sect5">
<h6 id="tuning_the_take_offline_parameters_of_a_remote_site"><a class="anchor" href="#tuning_the_take_offline_parameters_of_a_remote_site"></a>Tuning the take offline parameters of a remote site</h6>
<div class="paragraph">
<p>A remote site can be automatically marked as offline in case some conditions are met.
To check the configured parameters, execute a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/caches/{cacheName}/x-site/backups/{siteName}/take-offline-config</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response include two fields, <code>after_failures</code> and <code>min_wait</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">after_failures</span><span class="delimiter">&quot;</span></span>: <span class="integer">2</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">min_wait</span><span class="delimiter">&quot;</span></span>: <span class="integer">1000</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To change those parameters, execute a PUT request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>PUT /v2/caches/{cacheName}/x-site/backups/{siteName}/take-offline-config</code></pre>
</div>
</div>
<div class="paragraph">
<p>with a body containing the new values, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">after_failures</span><span class="delimiter">&quot;</span></span>: <span class="integer">4</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">min_wait</span><span class="delimiter">&quot;</span></span>: <span class="integer">5000</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="cancelling_the_receiving_state_on_a_site"><a class="anchor" href="#cancelling_the_receiving_state_on_a_site"></a>Cancelling the receiving state on a site</h6>
<div class="paragraph">
<p>The main use for this method is when the link between the sites is broken and the receiver site keeps it state transfer state forever.</p>
</div>
<div class="paragraph">
<p>To set the cluster to normal state in the scope of <code>cacheName</code> for state pushed from site <code>siteName</code> execute a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/caches/{cacheName}/x-site/backups/{siteName}?action=cancel-receive-state</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="clearing_the_state_transfer_status_of_a_pushing_site"><a class="anchor" href="#clearing_the_state_transfer_status_of_a_pushing_site"></a>Clearing the state transfer status of a pushing site</h6>
<div class="paragraph">
<p>To clear the state transfer status of a (sending) site, execute a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/caches/{cacheName}/x-site/local?action=clear-push-state-status</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_manager_operations"><a class="anchor" href="#rest_v2_cache_manager_operations"></a>1.6.2. Interacting with Cache Managers</h4>
<div class="paragraph">
<p>The REST API lets you interact with Infinispan Cache Managers to cluster and
usage statistics.</p>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_info"><a class="anchor" href="#rest_v2_cache_manager_info"></a>Getting Basic Cache Manager Information</h5>
<div class="paragraph">
<p>To obtain information about a cache manager, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a <code>JSON</code> document such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">xx.x.x-FINAL</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">coordinator</span><span class="delimiter">&quot;</span></span>:<span class="value">true</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_configuration_names</span><span class="delimiter">&quot;</span></span>:[
        <span class="string"><span class="delimiter">&quot;</span><span class="content">___protobuf_metadata</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">cache2</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">CacheManagerResourceTest</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">cache1</span><span class="delimiter">&quot;</span></span>
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cluster_name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">ISPN</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">physical_addresses</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">[127.0.0.1:35770]</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">coordinator_address</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">CacheManagerResourceTest-NodeA-49696</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_manager_status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">RUNNING</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">created_cache_count</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">3</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">running_cache_count</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">3</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">node_address</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">CacheManagerResourceTest-NodeA-49696</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cluster_members</span><span class="delimiter">&quot;</span></span>:[
        <span class="string"><span class="delimiter">&quot;</span><span class="content">CacheManagerResourceTest-NodeA-49696</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">CacheManagerResourceTest-NodeB-28120</span><span class="delimiter">&quot;</span></span>
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cluster_members_physical_addresses</span><span class="delimiter">&quot;</span></span>:[
        <span class="string"><span class="delimiter">&quot;</span><span class="content">127.0.0.1:35770</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">127.0.0.1:60031</span><span class="delimiter">&quot;</span></span>
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cluster_size</span><span class="delimiter">&quot;</span></span>:<span class="integer">2</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">defined_caches</span><span class="delimiter">&quot;</span></span>:[
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">CacheManagerResourceTest</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">started</span><span class="delimiter">&quot;</span></span>:<span class="value">true</span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">cache1</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">started</span><span class="delimiter">&quot;</span></span>:<span class="value">true</span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">___protobuf_metadata</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">started</span><span class="delimiter">&quot;</span></span>:<span class="value">true</span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">cache2</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">started</span><span class="delimiter">&quot;</span></span>:<span class="value">true</span>
        }
    ]

}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>version</code> contains the Infinispan version</p>
</li>
<li>
<p><code>name</code> contains the name of the cache manager as defined in the configuration</p>
</li>
<li>
<p><code>coordinator</code> is true if the cache manager is the coordinator of the cluster</p>
</li>
<li>
<p><code>cache_configuration_names</code> contains an array of all caches configurations defined in the cache manager</p>
</li>
<li>
<p><code>cluster_name</code> contains the name of the cluster as defined in the configuration</p>
</li>
<li>
<p><code>physical_addresses</code> contains the physical network addresses associated with the cache manager</p>
</li>
<li>
<p><code>coordinator_address</code> contains the physical network addresses of the coordinator of the cluster</p>
</li>
<li>
<p><code>cache_manager_status</code> the lifecycle status of the cache manager.
For possible values, check the <a href="https://docs.jboss.org/infinispan/9.4/apidocs/org/infinispan/lifecycle/ComponentStatus.html"><code>org.infinispan.lifecycle.ComponentStatus</code></a> documentation</p>
</li>
<li>
<p><code>created_cache_count</code> number of created caches, excludes all internal and private caches</p>
</li>
<li>
<p><code>running_cache_count</code> number of created caches that are running</p>
</li>
<li>
<p><code>node_address</code> contains the logical address of the cache manager</p>
</li>
<li>
<p><code>cluster_members</code> and <code>cluster_members_physical_addresses</code> an array of logical and physical addresses of the members of the cluster</p>
</li>
<li>
<p><code>cluster_size</code> number of members in the cluster</p>
</li>
<li>
<p><code>defined_caches</code> A list of all caches defined in the cache manager, excluding private caches but including internal caches that are accessible</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_health"><a class="anchor" href="#rest_v2_cache_manager_health"></a>Getting Cluster Health</h5>
<div class="paragraph">
<p>To review health information for a Infinispan cluster, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/health</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a <code>JSON</code> document such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cluster_health</span><span class="delimiter">&quot;</span></span>:{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">cluster_name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">ISPN</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">health_status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">HEALTHY</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">number_of_nodes</span><span class="delimiter">&quot;</span></span>:<span class="integer">2</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">node_names</span><span class="delimiter">&quot;</span></span>:[
            <span class="string"><span class="delimiter">&quot;</span><span class="content">NodeA-36229</span><span class="delimiter">&quot;</span></span>,
            <span class="string"><span class="delimiter">&quot;</span><span class="content">NodeB-28703</span><span class="delimiter">&quot;</span></span>
        ]
    },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_health</span><span class="delimiter">&quot;</span></span>:[
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">HEALTHY</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">___protobuf_metadata</span><span class="delimiter">&quot;</span></span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">HEALTHY</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">cache2</span><span class="delimiter">&quot;</span></span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">HEALTHY</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">mycache</span><span class="delimiter">&quot;</span></span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">HEALTHY</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">cache1</span><span class="delimiter">&quot;</span></span>
        }
    ]

}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cluster_health</code> contains the health of the cluster</p>
<div class="ulist">
<ul>
<li>
<p><code>cluster_name</code> specifies the name of the cluster as defined in the configuration.</p>
</li>
<li>
<p><code>health_status</code> provides one of the following:</p>
<div class="ulist">
<ul>
<li>
<p><code>DEGRADED</code> indicates at least one of the caches is in degraded mode.</p>
</li>
<li>
<p><code>HEALTHY_REBALANCING</code> indicates at least one cache is in the rebalancing state.</p>
</li>
<li>
<p><code>HEALTHY</code> indicates all cache instances in the cluster are operating as expected.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>number_of_nodes</code> displays the total number of cluster members.
Returns a value of <code>0</code> for non-clustered (standalone) servers.</p>
</li>
<li>
<p><code>node_names</code> is an array of all cluster members.
Empty for standalone servers.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>cache_health</code> contains health information per-cache</p>
<div class="ulist">
<ul>
<li>
<p><code>status</code>  HEALTHY, DEGRADED or HEALTHY_REBALANCING</p>
</li>
<li>
<p><code>cache_name</code> the name of the cache as defined in the configuration.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="rest_v2_cache_manager_health_status"><a class="anchor" href="#rest_v2_cache_manager_health_status"></a>Getting Cache Manager Health Status</h6>
<div class="paragraph">
<p>To retrieve the health status of the cache managers, without the need for
authentication, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/health/status</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with one of the following in <code>text/plain</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>HEALTHY</code></p>
</li>
<li>
<p><code>HEALTHY_REBALANCING</code></p>
</li>
<li>
<p><code>DEGRADED</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_availability"><a class="anchor" href="#rest_v2_cache_manager_availability"></a>Checking REST Endpoint Availability</h5>
<div class="paragraph">
<p>To check that a Infinispan server REST endpoint is available, invoke a <code>HEAD</code>
request in the health resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>HEAD /rest/v2/cache-managers/{cacheManagerName}/health</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the preceding request returns a successful response code then the
Infinispan REST server is running and serving requests.</p>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_config"><a class="anchor" href="#rest_v2_cache_manager_config"></a>Obtaining Global Configuration for Cache Managers</h5>
<div class="paragraph">
<p>To obtain the
<a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/configuration/global/GlobalConfiguration.html">GlobalConfiguration</a> associated with the Cache Manager, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/config</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><a href="#rest_accept">Accept</a></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The required format to return the content. Supported formats are <em>application/json</em> and <em>application/xml</em>. JSON is assumed if no header is provided.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_caches_config"><a class="anchor" href="#rest_v2_cache_manager_caches_config"></a>Obtaining Configuration for All Caches</h5>
<div class="paragraph">
<p>To get the configuration for all caches, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/cache-configs</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a <code>JSON</code> array that contains each cache and cache configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">[
  {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">cache1</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">configuration</span><span class="delimiter">&quot;</span></span>:{
          <span class="key"><span class="delimiter">&quot;</span><span class="content">distributed-cache</span><span class="delimiter">&quot;</span></span>:{
              <span class="key"><span class="delimiter">&quot;</span><span class="content">mode</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">SYNC</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">partition-handling</span><span class="delimiter">&quot;</span></span>:{
                  <span class="key"><span class="delimiter">&quot;</span><span class="content">when-split</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">DENY_READ_WRITES</span><span class="delimiter">&quot;</span></span>
              },
              <span class="key"><span class="delimiter">&quot;</span><span class="content">statistics</span><span class="delimiter">&quot;</span></span>:<span class="value">true</span>
          }
      }
  },
  {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">cache2</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">configuration</span><span class="delimiter">&quot;</span></span>:{
          <span class="key"><span class="delimiter">&quot;</span><span class="content">distributed-cache</span><span class="delimiter">&quot;</span></span>:{
              <span class="key"><span class="delimiter">&quot;</span><span class="content">mode</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">SYNC</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">transaction</span><span class="delimiter">&quot;</span></span>:{
                  <span class="key"><span class="delimiter">&quot;</span><span class="content">mode</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">NONE</span><span class="delimiter">&quot;</span></span>
              }
          }
      }
  }
]</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_cache_list"><a class="anchor" href="#rest_v2_cache_manager_cache_list"></a>(Experimental) Obtaining caches with cache information</h5>
<div class="paragraph">
<p>To get the list of all the caches of a cache manager with cache informations, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/caches</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a <code>JSON</code> array that contains each cache and the cache information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">[ {
  <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">RUNNING</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">cache1</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">local-cache</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span> : <span class="integer">123</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">simple_cache</span><span class="delimiter">&quot;</span></span> : <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">transactional</span><span class="delimiter">&quot;</span></span> : <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">persistent</span><span class="delimiter">&quot;</span></span> : <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">bounded</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">secured</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">indexed</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">has_remote_backup</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>
}, {
  <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">RUNNING</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">cache2</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">distributed-cache</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span> : <span class="integer">23</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">simple_cache</span><span class="delimiter">&quot;</span></span> : <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">transactional</span><span class="delimiter">&quot;</span></span> : <span class="value">true</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">persistent</span><span class="delimiter">&quot;</span></span> : <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">bounded</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">secured</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">indexed</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">has_remote_backup</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>
}]</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_stats"><a class="anchor" href="#rest_v2_cache_manager_stats"></a>Getting Cache Manager Statistics</h5>
<div class="paragraph">
<p>To obtain the statistics of a Cache Manager, invoke a <code>GET</code> request.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/stats</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a <code>JSON</code> document that contains the following
information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">statistics_enabled</span><span class="delimiter">&quot;</span></span>:<span class="value">true</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">read_write_ratio</span><span class="delimiter">&quot;</span></span>:<span class="float">0.0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">time_since_start</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">time_since_reset</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">number_of_entries</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">total_number_of_entries</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">off_heap_memory_used</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">data_memory_used</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">misses</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">remove_hits</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">remove_misses</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">evictions</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_read_time</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_read_time_nanos</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_write_time</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_write_time_nanos</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_remove_time</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_remove_time_nanos</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">required_minimum_number_of_nodes</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">hits</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">stores</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">current_number_of_entries_in_memory</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">hit_ratio</span><span class="delimiter">&quot;</span></span>:<span class="float">0.0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">retrievals</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>statistics_enabled</code> is <code>true</code> if statistics collection is enabled for the Cache Manager.</p>
</li>
<li>
<p><code>read_write_ratio</code> displays the read/write ratio across all caches.</p>
</li>
<li>
<p><code>time_since_start</code> shows the time, in seconds, since the Cache Manager started.</p>
</li>
<li>
<p><code>time_since_reset</code> shows the number of seconds since the Cache Manager statistics were last reset.</p>
</li>
<li>
<p><code>number_of_entries</code> shows the total number of entries currently in all caches from the Cache Manager. This statistic returns entries in the local cache instances only.</p>
</li>
<li>
<p><code>total_number_of_entries</code> shows the number of store operations performed across all caches for the Cache Manager.</p>
</li>
<li>
<p><code>off_heap_memory_used</code> shows the amount, in <code>bytes[]</code>, of off-heap memory used by this cache container.</p>
</li>
<li>
<p><code>data_memory_used</code> shows the amount, in <code>bytes[]</code>, that the current eviction algorithm estimates is in use for data across all caches. Returns <code>0</code> if eviction is not enabled.</p>
</li>
<li>
<p><code>misses</code> shows the number of <code>get()</code> misses across all caches.</p>
</li>
<li>
<p><code>remove_hits</code> shows the number of removal hits across all caches.</p>
</li>
<li>
<p><code>remove_misses</code> shows the number of removal misses across all caches.</p>
</li>
<li>
<p><code>evictions</code> shows the number of evictions across all caches.</p>
</li>
<li>
<p><code>average_read_time</code> shows the average number of milliseconds taken for <code>get()</code> operations across all caches.</p>
</li>
<li>
<p><code>average_read_time_nanos</code> same as <code>average_read_time</code> but in nanoseconds.</p>
</li>
<li>
<p><code>average_remove_time</code> shows the average number of milliseconds for <code>remove()</code> operations across all caches.</p>
</li>
<li>
<p><code>average_remove_time_nanos</code> same as <code>average_remove_time</code> but in nanoseconds.</p>
</li>
<li>
<p><code>required_minimum_number_of_nodes</code> shows the required minimum number of nodes to guarantee data consistency.</p>
</li>
<li>
<p><code>hits</code> provides the number of <code>get()</code> hits across all caches.</p>
</li>
<li>
<p><code>stores</code> provides the number of <code>put()</code> operations across all caches.</p>
</li>
<li>
<p><code>current_number_of_entries_in_memory</code> shows the total number of entries currently in all caches, excluding passivated entries.</p>
</li>
<li>
<p><code>hit_ratio</code> provides the total percentage hit/(hit+miss) ratio for all caches.</p>
</li>
<li>
<p><code>retrievals</code> shows the total number of <code>get()</code> operations.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_xsite"><a class="anchor" href="#rest_v2_cache_manager_xsite"></a>Managing Cross site replication</h5>
<div class="paragraph">
<p>The REST API expose several operations to manage cross site replication for all the caches in a cache manager.</p>
</div>
<div class="sect5">
<h6 id="rest_v2_cache_manager_site_status"><a class="anchor" href="#rest_v2_cache_manager_site_status"></a>Retrieving backup statuses</h6>
<div class="paragraph">
<p>To retrieve the statuses of all backup sites from the caches of <code>cacheManagerName</code>, do a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/x-site/backups/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
   <span class="key"><span class="delimiter">&quot;</span><span class="content">SFO-3</span><span class="delimiter">&quot;</span></span>:{
      <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">online</span><span class="delimiter">&quot;</span></span>
   },
   <span class="key"><span class="delimiter">&quot;</span><span class="content">NYC-2</span><span class="delimiter">&quot;</span></span>:{
      <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">mixed</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">online</span><span class="delimiter">&quot;</span></span>:[
         <span class="string"><span class="delimiter">&quot;</span><span class="content">CACHE_1</span><span class="delimiter">&quot;</span></span>
      ],
      <span class="key"><span class="delimiter">&quot;</span><span class="content">offline</span><span class="delimiter">&quot;</span></span>:[
         <span class="string"><span class="delimiter">&quot;</span><span class="content">CACHE_2</span><span class="delimiter">&quot;</span></span>
      ]
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>status</code> field can assume the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>online</code>: all caches are online in the backup site.</p>
</li>
<li>
<p><code>offline</code>: all caches are offline in the backup site.</p>
</li>
<li>
<p><code>mixed</code>: some caches are online and others offline, and their names will be listed in the <code>online</code> and <code>offline</code> arrays respectively.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="rest_v2_cache_manager_take_offline"><a class="anchor" href="#rest_v2_cache_manager_take_offline"></a>Taking a backup site offline</h6>
<div class="paragraph">
<p>To take all caches from <code>cacheManagerName</code> offline, for the backup site <code>siteName</code>, execute a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/x-site/backups/{siteName}?action=take-offline</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="rest_v2_cache_manager_bring_online"><a class="anchor" href="#rest_v2_cache_manager_bring_online"></a>Bringing a backup site online</h6>
<div class="paragraph">
<p>To bring all caches from <code>cacheManagerName</code> online, for the backup site <code>siteName</code>, execute a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/x-site/backups/{siteName}?action=bring-online</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="rest_v2_cache_manager_start_push"><a class="anchor" href="#rest_v2_cache_manager_start_push"></a>Starting a state push</h6>
<div class="paragraph">
<p>To start pushing state of all caches of <code>cacheManagerName</code> to a backup site <code>siteName</code>, execute a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/x-site/backups/{siteName}?action=start-push-state</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="rest_v2_cache_manager_cancel_push"><a class="anchor" href="#rest_v2_cache_manager_cancel_push"></a>Cancelling an ongoing state push</h6>
<div class="paragraph">
<p>To cancel an ongoing state push of all caches of <code>cacheManagerName</code> to a remote backup site <code>siteName</code>, execute a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/x-site/backups/{siteName}?action=cancel-push-state</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters"><a class="anchor" href="#rest_server_counters"></a>1.6.3. Working with Counters</h4>
<div class="paragraph">
<p>Use the REST API to create, delete, and modify counters.</p>
</div>
<div class="sect4">
<h5 id="rest_server_counters_create"><a class="anchor" href="#rest_server_counters_create"></a>Creating Counters</h5>
<div class="paragraph">
<p>To create a counter, invoke a <code>POST</code> request with the configuration as payload:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/counters/{counterName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The payload must contain a configuration for the counter in <code>JSON</code> format, as in the following examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">weak-counter</span><span class="delimiter">&quot;</span></span>:{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">initial-value</span><span class="delimiter">&quot;</span></span>:<span class="integer">5</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">storage</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">PERSISTENT</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">concurrency-level</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">strong-counter</span><span class="delimiter">&quot;</span></span>:{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">initial-value</span><span class="delimiter">&quot;</span></span>:<span class="integer">3</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">storage</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">PERSISTENT</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">upper-bound</span><span class="delimiter">&quot;</span></span>:<span class="integer">5</span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_server_counters_delete"><a class="anchor" href="#rest_server_counters_delete"></a>Deleting Counters</h5>
<div class="paragraph">
<p>To delete a counter, invoke a <code>DELETE</code> request with the counter name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>DELETE /rest/v2/counters/{counterName}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_server_counters_config"><a class="anchor" href="#rest_server_counters_config"></a>Retrieving Counter Configuration</h5>
<div class="paragraph">
<p>The get the counter configuration, invoke a <code>GET</code> request with the counter name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/counters/{counterName}/config</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a <code>JSON</code> representation of the counter configuration.</p>
</div>
</div>
<div class="sect4">
<h5 id="rest_server_counters_add"><a class="anchor" href="#rest_server_counters_add"></a>Adding Values to Counters</h5>
<div class="paragraph">
<p>To add a value to a named counter, invoke a <code>POST</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/counters/{counterName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the request payload is empty, the counter is incremented by one, otherwise
the payload is interpreted as a signed long and added to the counter.</p>
</div>
<div class="paragraph">
<p>Request responses depend on the type of counter, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>WEAK</code> counters return empty responses.</p>
</li>
<li>
<p><code>STRONG</code> counters return their values after the operation is applied.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This method processes <code>plain/text</code> content only.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="rest_server_counters_get"><a class="anchor" href="#rest_server_counters_get"></a>Getting Counter Values</h5>
<div class="paragraph">
<p>To retrieve the value of a counter, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/counters/{counterName}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><a href="#rest_accept">Accept</a></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The required format to return the content. Supported formats are <em>application/json</em> and <em>text/plain</em>. JSON is assumed if no header is provided.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="rest_server_counters_reset"><a class="anchor" href="#rest_server_counters_reset"></a>Resetting Counters</h5>
<div class="paragraph">
<p>To reset counters, invoke a <code>GET</code> request with the <code>?action=reset</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/counters/{counterName}?action=reset</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_server_counters_inc_weak"><a class="anchor" href="#rest_server_counters_inc_weak"></a>Incrementing Counters</h5>
<div class="paragraph">
<p>To increment a counter, invoke a <code>GET</code> request with the <code>?action=increment</code>
parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/counters/{counterName}?action=increment</code></pre>
</div>
</div>
<div class="paragraph">
<p>Responses depend on the type of counter, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>WEAK</code> counters return empty responses.</p>
</li>
<li>
<p><code>STRONG</code> counters return their values after the operation is applied.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="rest_server_counters_add_weak"><a class="anchor" href="#rest_server_counters_add_weak"></a>Adding Deltas to Counters</h5>
<div class="paragraph">
<p>To add an arbitrary amount to a counter, invoke a <code>GET</code> request with the
<code>?action=add</code> and <code>delta</code> parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/counters/{counterName}?action=add&amp;delta={delta}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Request responses depend on the type of counter, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>WEAK</code> counters return empty responses.</p>
</li>
<li>
<p><code>STRONG</code> counters return their values after the operation is applied.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="rest_server_counters_dec_strong"><a class="anchor" href="#rest_server_counters_dec_strong"></a>Decrementing Counters</h5>
<div class="paragraph">
<p>To decrement a counter, invoke a <code>GET</code> request with the <code>?action=decrement</code>
parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/counters/{counterName}?action=decrement</code></pre>
</div>
</div>
<div class="paragraph">
<p>Request responses depend on the type of counter, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>WEAK</code> counters return empty responses.</p>
</li>
<li>
<p><code>STRONG</code> counters return their values after the operation is applied.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="rest_server_counters_cmpset"><a class="anchor" href="#rest_server_counters_cmpset"></a>compareAndSet Strong Counters</h5>
<div class="paragraph">
<p>To atomically set the value of a strong counter with the <code>compareAndSet</code>
method, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/counters/{counterName}?action=compareAndSet&amp;expect={expect}&amp;update={update}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan atomically sets the value to <code>{update}</code> if the current value is
<code>{expect}</code>. If the operation is successful, Infinispan returns <code><em>true</em></code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="rest_server_counters_cmpswp"><a class="anchor" href="#rest_server_counters_cmpswp"></a>compareAndSwap Strong Counters</h5>
<div class="paragraph">
<p>To atomically set the value of a strong counter with the <code>compareAndSwap</code>
method, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/counters/{counterName}?action=compareAndSwap&amp;expect={expect}&amp;update={update}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan atomically sets the value to <code>{update}</code> if the current value is
<code>{expect}</code>. If the operation is successful, Infinispan returns the previous
value in the payload.</p>
</div>
</div>
<div class="sect4">
<h5 id="rest_server_counters_list"><a class="anchor" href="#rest_server_counters_list"></a>Listing Counters</h5>
<div class="paragraph">
<p>To obtain a list of counters available in a Infinispan cluster, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/counters/</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_server"><a class="anchor" href="#rest_v2_server"></a>1.6.4. Interacting with Infinispan Servers</h4>
<div class="paragraph">
<p>The REST API lets you interact with Infinispan servers to retrieve server
configuration and information, Java Virtual Machine (JVM) memory usage and
thread dumps. You can also perform operations to manage servers.</p>
</div>
<div class="sect4">
<h5 id="rest_v2_server_info"><a class="anchor" href="#rest_v2_server_info"></a>Retrieving Basic Server Information</h5>
<div class="paragraph">
<p>To view basic information about a Infinispan server, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/server</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response contains the server name, codename, and version in <code>JSON</code> format,
as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Infinispan 'Codename' xx.x.x.Final</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_server_cm"><a class="anchor" href="#rest_v2_server_cm"></a>Cache Managers</h5>
<div class="paragraph">
<p>To obtain the list of the server&#8217;s cache managers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/server/cache-managers</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response will contain an array with the names of the cache managers configured in the server.</p>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_ignore"><a class="anchor" href="#rest_v2_cache_ignore"></a>Ignoring caches</h5>
<div class="paragraph">
<p>A cache can be excluded temporarily from receiving requests from clients,
returning a code 503 (service unavailable) for REST clients or
a Server Error (code 0x85) for Hot Rod clients.</p>
</div>
<div class="paragraph">
<p>To ignore a cache, use an empty <code>POST</code> request with the cache manager name and the cache name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /v2/server/ignored-caches/{cache-manager}/{cache}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To remove the cache from the ignore list, use a <code>DELETE</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>DELETE /v2/server/ignored-caches/{cache-manager}/{cache}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, to check the caches that are ignored, do a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/server/ignored-caches/{cache-manager}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Currently Infinispan only supports a single cache manager per server, but for future compatibility the
name must be provided in the requests above.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_server_config"><a class="anchor" href="#rest_v2_server_config"></a>Obtaining Server Configuration</h5>
<div class="paragraph">
<p>To get the configuration for a Infinispan server, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/server/config</code></pre>
</div>
</div>
<div class="paragraph">
<p>The server responds with the configuration in <code>JSON</code> format. The structure
follows the
<a href="https://github.com/infinispan/infinispan/blob/master/server/runtime/src/main/resources/schema/infinispan-server-10.0.xsd">server schema</a>, as in the
following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>:{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">interfaces</span><span class="delimiter">&quot;</span></span>:{
            <span class="key"><span class="delimiter">&quot;</span><span class="content">interface</span><span class="delimiter">&quot;</span></span>:{
                <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span>,
                <span class="key"><span class="delimiter">&quot;</span><span class="content">inet-address</span><span class="delimiter">&quot;</span></span>:{
                    <span class="key"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">127.0.0.1</span><span class="delimiter">&quot;</span></span>
                }
            }
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">socket-bindings</span><span class="delimiter">&quot;</span></span>:{
            <span class="key"><span class="delimiter">&quot;</span><span class="content">port-offset</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">default-interface</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">socket-binding</span><span class="delimiter">&quot;</span></span>:[
                {
                    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">memcached</span><span class="delimiter">&quot;</span></span>,
                    <span class="key"><span class="delimiter">&quot;</span><span class="content">port</span><span class="delimiter">&quot;</span></span>:<span class="integer">11221</span>,
                    <span class="key"><span class="delimiter">&quot;</span><span class="content">interface</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">memcached</span><span class="delimiter">&quot;</span></span>
                }
            ]
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>:{
            <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realms</span><span class="delimiter">&quot;</span></span>:{
                <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realm</span><span class="delimiter">&quot;</span></span>:{
                    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>
                }
            }
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">endpoints</span><span class="delimiter">&quot;</span></span>:{
            <span class="key"><span class="delimiter">&quot;</span><span class="content">socket-binding</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realm</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">hotrod-connector</span><span class="delimiter">&quot;</span></span>:{
                <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod</span><span class="delimiter">&quot;</span></span>
            },
            <span class="key"><span class="delimiter">&quot;</span><span class="content">rest-connector</span><span class="delimiter">&quot;</span></span>:{
                <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">rest</span><span class="delimiter">&quot;</span></span>
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_server_env"><a class="anchor" href="#rest_v2_server_env"></a>Getting Environment Variables</h5>
<div class="paragraph">
<p>To get environment variables that the server uses, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/server/env</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_server_memory"><a class="anchor" href="#rest_v2_server_memory"></a>Getting JVM Memory Details</h5>
<div class="paragraph">
<p>To get information about JVM memory usage, invoke a
<code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/server/memory</code></pre>
</div>
</div>
<div class="paragraph">
<p>The server responds with heap and non-heap memory statistics, direct memory
usage, and information about memory pools and garbage collection in <code>JSON</code>
format.</p>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_server_threads"><a class="anchor" href="#rest_v2_server_threads"></a>Getting JVM Thread Dumps</h5>
<div class="paragraph">
<p>To get the current thread dump for the JVM, invoke a
<code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/server/threads</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response is the current thread dump in <code>text/plain</code> format.</p>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_server_stop"><a class="anchor" href="#rest_v2_server_stop"></a>Stopping Infinispan Servers</h5>
<div class="paragraph">
<p>To stop the Infinispan server, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/server?action=stop</code></pre>
</div>
</div>
<div class="paragraph">
<p>The server responds with <code>200(OK)</code> and then stops running.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cluster"><a class="anchor" href="#rest_v2_cluster"></a>1.6.5. Interacting with Infinispan Clusters</h4>
<div class="paragraph">
<p>The REST API lets you interact with Infinispan clusters to retrieve cluster-wide
configuration and information. You can also perform operations to manage clusters.</p>
</div>
<div class="sect4">
<h5 id="rest_v2_cluster_stop"><a class="anchor" href="#rest_v2_cluster_stop"></a>Stopping Infinispan Clusters</h5>
<div class="paragraph">
<p>To gracefully stop Infinispan clusters, invoke a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cluster?action=stop</code></pre>
</div>
</div>
<div class="paragraph">
<p>The server responds with <code>200(OK)</code> and then the cluster performs a graceful shutdown.</p>
</div>
<div class="paragraph">
<p>You can also stop one or more specific servers by passing their names:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cluster?action=stop&amp;server=server-38760&amp;server=bespin-1223</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="client_side_code"><a class="anchor" href="#client_side_code"></a>1.7. Client-Side Code</h3>
<div class="paragraph">
<p>Part of the point of a RESTful service is that you don&#8217;t need to have tightly coupled client libraries/bindings. All you need is a HTTP client library. For Java, Apache HTTP Commons Client works just fine (and is used in the integration tests), or you can use java.net API.</p>
</div>
<div class="sect3">
<h4 id="rest_server_client_ruby"><a class="anchor" href="#rest_server_client_ruby"></a>1.7.1. Ruby example</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># Shows how to interact with the REST api from ruby.</span>
<span class="comment"># No special libraries, just standard net/http</span>
<span class="comment">#</span>
<span class="comment"># Author: Michael Neale</span>
<span class="comment">#</span>
require <span class="string"><span class="delimiter">'</span><span class="content">net/http</span><span class="delimiter">'</span></span>

uri = <span class="constant">URI</span>.parse(<span class="string"><span class="delimiter">'</span><span class="content">http://localhost:8080/rest/default/MyKey</span><span class="delimiter">'</span></span>)
http = <span class="constant">Net</span>::<span class="constant">HTTP</span>.new(uri.host, uri.port)

<span class="comment">#Create new entry</span>

post = <span class="constant">Net</span>::<span class="constant">HTTP</span>::<span class="constant">Post</span>.new(uri.path, {<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>})
post.basic_auth(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">pass</span><span class="delimiter">'</span></span>)
post.body = <span class="string"><span class="delimiter">&quot;</span><span class="content">DATA HERE</span><span class="delimiter">&quot;</span></span>

resp = http.request(post)

puts <span class="string"><span class="delimiter">&quot;</span><span class="content">POST response code : </span><span class="delimiter">&quot;</span></span> + resp.code

<span class="comment">#get it back</span>

get = <span class="constant">Net</span>::<span class="constant">HTTP</span>::<span class="constant">Get</span>.new(uri.path)
get.basic_auth(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">pass</span><span class="delimiter">'</span></span>)
resp = http.request(get)

puts <span class="string"><span class="delimiter">&quot;</span><span class="content">GET response code: </span><span class="delimiter">&quot;</span></span> + resp.code
puts <span class="string"><span class="delimiter">&quot;</span><span class="content">GET Body: </span><span class="delimiter">&quot;</span></span> + resp.body

<span class="comment">#use PUT to overwrite</span>

put = <span class="constant">Net</span>::<span class="constant">HTTP</span>::<span class="constant">Put</span>.new(uri.path, {<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>})
put.basic_auth(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">pass</span><span class="delimiter">'</span></span>)
put.body = <span class="string"><span class="delimiter">&quot;</span><span class="content">ANOTHER DATA HERE</span><span class="delimiter">&quot;</span></span>

resp = http.request(put)

puts <span class="string"><span class="delimiter">&quot;</span><span class="content">PUT response code : </span><span class="delimiter">&quot;</span></span> + resp.code

<span class="comment">#and remove...</span>
delete = <span class="constant">Net</span>::<span class="constant">HTTP</span>::<span class="constant">Delete</span>.new(uri.path)
delete.basic_auth(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">pass</span><span class="delimiter">'</span></span>)

resp = http.request(delete)

puts <span class="string"><span class="delimiter">&quot;</span><span class="content">DELETE response code : </span><span class="delimiter">&quot;</span></span> + resp.code

<span class="comment">#Create binary data like this... just the same...</span>

uri = <span class="constant">URI</span>.parse(<span class="string"><span class="delimiter">'</span><span class="content">http://localhost:8080/rest/default/MyLogo</span><span class="delimiter">'</span></span>)
put = <span class="constant">Net</span>::<span class="constant">HTTP</span>::<span class="constant">Put</span>.new(uri.path, {<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">application/octet-stream</span><span class="delimiter">&quot;</span></span>})
put.basic_auth(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">pass</span><span class="delimiter">'</span></span>)
put.body = <span class="constant">File</span>.read(<span class="string"><span class="delimiter">'</span><span class="content">./logo.png</span><span class="delimiter">'</span></span>)

resp = http.request(put)

puts <span class="string"><span class="delimiter">&quot;</span><span class="content">PUT response code : </span><span class="delimiter">&quot;</span></span> + resp.code

<span class="comment">#and if you want to do json...</span>
require <span class="string"><span class="delimiter">'</span><span class="content">rubygems</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">json</span><span class="delimiter">'</span></span>

<span class="comment">#now for fun, lets do some JSON !</span>
uri = <span class="constant">URI</span>.parse(<span class="string"><span class="delimiter">'</span><span class="content">http://localhost:8080/rest/jsonCache/user</span><span class="delimiter">'</span></span>)
put = <span class="constant">Net</span>::<span class="constant">HTTP</span>::<span class="constant">Put</span>.new(uri.path, {<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>})
put.basic_auth(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">pass</span><span class="delimiter">'</span></span>)

data = {<span class="symbol">:name</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">michael</span><span class="delimiter">&quot;</span></span>, <span class="symbol">:age</span> =&gt; <span class="integer">42</span> }
put.body = data.to_json

resp = http.request(put)

puts <span class="string"><span class="delimiter">&quot;</span><span class="content">PUT response code : </span><span class="delimiter">&quot;</span></span> + resp.code

get = <span class="constant">Net</span>::<span class="constant">HTTP</span>::<span class="constant">Get</span>.new(uri.path)
get.basic_auth(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">pass</span><span class="delimiter">'</span></span>)
resp = http.request(get)

puts <span class="string"><span class="delimiter">&quot;</span><span class="content">GET Body: </span><span class="delimiter">&quot;</span></span> + resp.body</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_client_python"><a class="anchor" href="#rest_server_client_python"></a>1.7.2. Python 3 example</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">import</span> <span class="include">urllib.request</span>

<span class="comment"># Setup basic auth</span>
base_uri = <span class="string"><span class="delimiter">'</span><span class="content">http://localhost:8080/rest/default</span><span class="delimiter">'</span></span>
auth_handler = urllib.request.HTTPBasicAuthHandler()
auth_handler.add_password(user=<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, passwd=<span class="string"><span class="delimiter">'</span><span class="content">pass</span><span class="delimiter">'</span></span>, realm=<span class="string"><span class="delimiter">'</span><span class="content">ApplicationRealm</span><span class="delimiter">'</span></span>, uri=base_uri)
opener = urllib.request.build_opener(auth_handler)
urllib.request.install_opener(opener)

<span class="comment"># putting data in</span>
data = <span class="string"><span class="delimiter">&quot;</span><span class="content">SOME DATA HERE </span><span class="content">\!</span><span class="delimiter">&quot;</span></span>

req = urllib.request.Request(url=base_uri + <span class="string"><span class="delimiter">'</span><span class="content">/Key</span><span class="delimiter">'</span></span>, data=data.encode(<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span>), method=<span class="string"><span class="delimiter">'</span><span class="content">PUT</span><span class="delimiter">'</span></span>,
                             headers={<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>})
<span class="keyword">with</span> urllib.request.urlopen(req) <span class="keyword">as</span> f:
    <span class="keyword">pass</span>

print(f.status)
print(f.reason)

<span class="comment"># getting data out</span>
resp = urllib.request.urlopen(base_uri + <span class="string"><span class="delimiter">'</span><span class="content">/Key</span><span class="delimiter">'</span></span>)
print(resp.read().decode(<span class="string"><span class="delimiter">'</span><span class="content">utf-8</span><span class="delimiter">'</span></span>))</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_client_java"><a class="anchor" href="#rest_server_client_java"></a>1.7.3. Java example</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.infinispan</span>;

<span class="keyword">import</span> <span class="include">java.io.BufferedReader</span>;
<span class="keyword">import</span> <span class="include">java.io.IOException</span>;
<span class="keyword">import</span> <span class="include">java.io.InputStreamReader</span>;
<span class="keyword">import</span> <span class="include">java.io.OutputStreamWriter</span>;
<span class="keyword">import</span> <span class="include">java.net.HttpURLConnection</span>;
<span class="keyword">import</span> <span class="include">java.net.URL</span>;
<span class="keyword">import</span> <span class="include">java.util.Base64</span>;

<span class="comment">/**
 * Rest example accessing a cache.
 *
 * @author Samuel Tauil (samuel@redhat.com)
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">RestExample</span> {

    <span class="comment">/**
     * Method that puts a String value in cache.
     *
     * @param urlServerAddress URL containing the cache and the key to insert
     * @param value            Text to insert
     * @param user             Used for basic auth
     * @param password         Used for basic auth
     */</span>
    <span class="directive">public</span> <span class="type">void</span> putMethod(<span class="predefined-type">String</span> urlServerAddress, <span class="predefined-type">String</span> value, <span class="predefined-type">String</span> user, <span class="predefined-type">String</span> password) <span class="directive">throws</span> <span class="exception">IOException</span> {
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Executing PUT</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">URL</span> address = <span class="keyword">new</span> <span class="predefined-type">URL</span>(urlServerAddress);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">executing request </span><span class="delimiter">&quot;</span></span> + urlServerAddress);
        <span class="predefined-type">HttpURLConnection</span> connection = (<span class="predefined-type">HttpURLConnection</span>) address.openConnection();
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Executing put method of value: </span><span class="delimiter">&quot;</span></span> + value);
        connection.setRequestMethod(<span class="string"><span class="delimiter">&quot;</span><span class="content">PUT</span><span class="delimiter">&quot;</span></span>);
        connection.setRequestProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>);
        addAuthorization(connection, user, password);
        connection.setDoOutput(<span class="predefined-constant">true</span>);

        <span class="predefined-type">OutputStreamWriter</span> outputStreamWriter = <span class="keyword">new</span> <span class="predefined-type">OutputStreamWriter</span>(connection.getOutputStream());
        outputStreamWriter.write(value);

        connection.connect();
        outputStreamWriter.flush();
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println(connection.getResponseCode() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span> + connection.getResponseMessage());
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
        connection.disconnect();
    }

    <span class="comment">/**
     * Method that gets a value by a key in url as param value.
     *
     * @param urlServerAddress URL containing the cache and the key to read
     * @param user             Used for basic auth
     * @param password         Used for basic auth
     * @return String value
     */</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getMethod(<span class="predefined-type">String</span> urlServerAddress, <span class="predefined-type">String</span> user, <span class="predefined-type">String</span> password) <span class="directive">throws</span> <span class="exception">IOException</span> {
        <span class="predefined-type">String</span> line;
        <span class="predefined-type">StringBuilder</span> stringBuilder = <span class="keyword">new</span> <span class="predefined-type">StringBuilder</span>();

        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Executing GET</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);

        <span class="predefined-type">URL</span> address = <span class="keyword">new</span> <span class="predefined-type">URL</span>(urlServerAddress);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">executing request </span><span class="delimiter">&quot;</span></span> + urlServerAddress);

        <span class="predefined-type">HttpURLConnection</span> connection = (<span class="predefined-type">HttpURLConnection</span>) address.openConnection();
        connection.setRequestMethod(<span class="string"><span class="delimiter">&quot;</span><span class="content">GET</span><span class="delimiter">&quot;</span></span>);
        connection.setRequestProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>);
        addAuthorization(connection, user, password);
        connection.setDoOutput(<span class="predefined-constant">true</span>);

        <span class="predefined-type">BufferedReader</span> bufferedReader = <span class="keyword">new</span> <span class="predefined-type">BufferedReader</span>(<span class="keyword">new</span> <span class="predefined-type">InputStreamReader</span>(connection.getInputStream()));

        connection.connect();

        <span class="keyword">while</span> ((line = bufferedReader.readLine()) != <span class="predefined-constant">null</span>) {
            stringBuilder.append(line).append(<span class="string"><span class="delimiter">'</span><span class="content">\n</span><span class="delimiter">'</span></span>);
        }

        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Executing get method of value: </span><span class="delimiter">&quot;</span></span> + stringBuilder.toString());

        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println(connection.getResponseCode() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span> + connection.getResponseMessage());
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);

        connection.disconnect();

        <span class="keyword">return</span> stringBuilder.toString();
    }

    <span class="directive">private</span> <span class="type">void</span> addAuthorization(<span class="predefined-type">HttpURLConnection</span> connection, <span class="predefined-type">String</span> user, <span class="predefined-type">String</span> pass) {
        <span class="predefined-type">String</span> credentials = user + <span class="string"><span class="delimiter">&quot;</span><span class="content">:</span><span class="delimiter">&quot;</span></span> + pass;
        <span class="predefined-type">String</span> basic = Base64.getEncoder().encodeToString(credentials.getBytes());
        connection.setRequestProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">Authorization</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Basic </span><span class="delimiter">&quot;</span></span> + basic);
    }

    <span class="comment">/**
     * Main method example.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">IOException</span> {
        RestExample restExample = <span class="keyword">new</span> RestExample();
        <span class="predefined-type">String</span> user = <span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>;
        <span class="predefined-type">String</span> pass = <span class="string"><span class="delimiter">&quot;</span><span class="content">pass</span><span class="delimiter">&quot;</span></span>;
        restExample.putMethod(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/rest/default/1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Infinispan REST Test</span><span class="delimiter">&quot;</span></span>, user, pass);
        restExample.getMethod(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/rest/default/1</span><span class="delimiter">&quot;</span></span>, user, pass);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_client_java"><a class="anchor" href="#rest_server_client_java"></a>1.7.4. REST Example with the HttpClient API</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.infinispan</span>;

<span class="keyword">import</span> <span class="include">java.io.IOException</span>;
<span class="keyword">import</span> <span class="include">java.net.URI</span>;
<span class="keyword">import</span> <span class="include">java.net.http.HttpClient</span>;
<span class="keyword">import</span> <span class="include">java.net.http.HttpRequest</span>;
<span class="keyword">import</span> <span class="include">java.net.http.HttpResponse</span>;
<span class="keyword">import</span> <span class="include">java.util.Base64</span>;

<span class="comment">/**
 * RestExample class shows you how to access your cache via HttpClient API with Java 11 or later.
 *
 * @author Gustavo Lira (glira@redhat.com)
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">RestExample</span> {
   <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> SERVER_ADDRESS = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:11222</span><span class="delimiter">&quot;</span></span>;
   <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> CACHE_URI = <span class="string"><span class="delimiter">&quot;</span><span class="content">/rest/v2/caches/default</span><span class="delimiter">&quot;</span></span>;

   <span class="comment">/**
    * postMethod create a named cache.
    * @param httpClient HTTP client that sends requests and receives responses
    * @param builder    Encapsulates HTTP requests
    * @throws IOException
    * @throws InterruptedException
    */</span>
   <span class="directive">public</span> <span class="type">void</span> postMethod(HttpClient httpClient, HttpRequest.Builder builder) <span class="directive">throws</span> <span class="exception">IOException</span>, <span class="exception">InterruptedException</span> {
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Executing POST</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);

      HttpRequest request = builder.POST(HttpRequest.BodyPublishers.noBody()).build();
      HttpResponse&lt;<span class="predefined-type">Void</span>&gt; response = httpClient.send(request, HttpResponse.BodyHandlers.discarding());

      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(response.statusCode());
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
   }

   <span class="comment">/**
    * putMethod stores a String value in your cache.
    * @param httpClient HTTP client that sends requests and receives responses
    * @param builder    Encapsulates HTTP requests
    * @throws IOException
    * @throws InterruptedException
    */</span>
   <span class="directive">public</span> <span class="type">void</span> putMethod(HttpClient httpClient, HttpRequest.Builder builder) <span class="directive">throws</span> <span class="exception">IOException</span>, <span class="exception">InterruptedException</span> {
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Executing PUT</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);

      <span class="predefined-type">String</span> cacheValue = <span class="string"><span class="delimiter">&quot;</span><span class="content">Infinispan REST Test</span><span class="delimiter">&quot;</span></span>;
      HttpRequest request = builder.PUT(HttpRequest.BodyPublishers.ofString(cacheValue)).build();
      HttpResponse&lt;<span class="predefined-type">Void</span>&gt; response = httpClient.send(request, HttpResponse.BodyHandlers.discarding());

      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(response.statusCode());
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
   }

   <span class="comment">/**
    * getMethod get a String value from your cache.
    * @param httpClient HTTP client that sends requests and receives responses
    * @param builder    Encapsulates HTTP requests
    * @return           String value
    * @throws IOException
    */</span>
   <span class="directive">public</span> <span class="predefined-type">String</span> getMethod(HttpClient httpClient, HttpRequest.Builder builder) <span class="directive">throws</span> <span class="exception">IOException</span>, <span class="exception">InterruptedException</span> {
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Executing GET</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);

      HttpRequest request = builder.GET().build();
      HttpResponse&lt;<span class="predefined-type">String</span>&gt; response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());

      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Executing get method of value: </span><span class="delimiter">&quot;</span></span> + response.body());

      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(response.statusCode());
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);

      <span class="keyword">return</span> response.body();
   }

   <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">IOException</span>, <span class="exception">InterruptedException</span> {
      RestExample restExample = <span class="keyword">new</span> RestExample();
      HttpClient httpClient = HttpClient.newBuilder().version(HttpClient.Version.HTTP_1_1).build();

      restExample.postMethod(httpClient, getHttpReqestBuilder(<span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">%s%s</span><span class="delimiter">&quot;</span></span>, SERVER_ADDRESS, CACHE_URI)));
      restExample.putMethod(httpClient, getHttpReqestBuilder(<span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">%s%s/1</span><span class="delimiter">&quot;</span></span>, SERVER_ADDRESS, CACHE_URI)));
      restExample.getMethod(httpClient, getHttpReqestBuilder(<span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">%s%s/1</span><span class="delimiter">&quot;</span></span>, SERVER_ADDRESS, CACHE_URI)));
   }

   <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">String</span> basicAuth(<span class="predefined-type">String</span> username, <span class="predefined-type">String</span> password) {
      <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Basic </span><span class="delimiter">&quot;</span></span> + Base64.getEncoder().encodeToString((username + <span class="string"><span class="delimiter">&quot;</span><span class="content">:</span><span class="delimiter">&quot;</span></span> + password).getBytes());
   }

   <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> HttpRequest.Builder getHttpReqestBuilder(<span class="predefined-type">String</span> url) {
      <span class="keyword">return</span> HttpRequest.newBuilder()
            .uri(<span class="predefined-type">URI</span>.create(url))
            .header(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
            .header(<span class="string"><span class="delimiter">&quot;</span><span class="content">Authorization</span><span class="delimiter">&quot;</span></span>, basicAuth(<span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">pass</span><span class="delimiter">&quot;</span></span>));
   }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2019-10-27 08:15:43 UTC
</div>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8601422-1', 'auto');
  ga('send', 'pageview');

</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>