<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.15">
<title>Building and deploying Infinispan clusters with Helm</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="canonical" href="http://infinispan.org/docs/stable/titles/helm-chart.html">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.1/themes/default/style.min.css">
<link rel="stylesheet" href="css/css.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.1/jstree.min.js"></script>
<script src="js/ojs.js"></script>
</head>
<body id="infinispan-helm-chart" class="article toc2 toc-left">
<div id="header">
<h1>Building and deploying Infinispan clusters with Helm</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#install">1. Deploying Infinispan clusters as Helm chart releases</a>
<ul class="sectlevel2">
<li><a href="#installing-chart-console_install">1.1. Installing the Infinispan chart through the OpenShift console</a></li>
<li><a href="#installing-chart-command-line_install">1.2. Installing the Infinispan chart on the command line</a></li>
<li><a href="#upgrading-releases_install">1.3. Upgrading Infinispan Helm releases</a></li>
<li><a href="#uninstalling-helm-releases_install">1.4. Uninstalling Infinispan Helm releases</a></li>
<li><a href="#deployment-configuration-values_install">1.5. Deployment configuration values</a></li>
</ul>
</li>
<li><a href="#configuring-servers">2. Configuring Infinispan Servers</a>
<ul class="sectlevel2">
<li><a href="#configuring-servers_configuring-servers">2.1. Customizing Infinispan Server configuration</a></li>
<li><a href="#server-configuration-values_configuring-servers">2.2. Infinispan Server configuration values</a></li>
</ul>
</li>
<li><a href="#configuring-authentication">3. Configuring authentication and authorization</a>
<ul class="sectlevel2">
<li><a href="#default-credentials_configuring-authentication">3.1. Default credentials</a>
<ul class="sectlevel3">
<li><a href="#retrieving-credentials_configuring-authentication">3.1.1. Retrieving credentials</a></li>
</ul>
</li>
<li><a href="#adding-credentials_configuring-authentication">3.2. Adding custom user credentials</a>
<ul class="sectlevel3">
<li><a href="#user-roles-permissions_configuring-authentication">3.2.1. User roles and permissions</a></li>
<li><a href="#adding-multiple-credentials_configuring-authentication">3.2.2. Adding multiple credentials with authentication secrets</a></li>
</ul>
</li>
<li><a href="#disabling-authentication_configuring-authentication">3.3. Disabling authentication</a></li>
<li><a href="#disabling-authorization_configuring-authentication">3.4. Disabling security authorization</a></li>
</ul>
</li>
<li><a href="#network-access">4. Configuring network access</a>
<ul class="sectlevel2">
<li><a href="#exposing-clusters-network_network-access">4.1. Exposing Infinispan clusters on the network</a></li>
<li><a href="#retrieving-network-services_network-access">4.2. Retrieving network service details</a></li>
<li><a href="#network-services_network-access">4.3. Network services</a></li>
</ul>
</li>
<li><a href="#connecting-clusters">5. Connecting to Infinispan clusters</a>
<ul class="sectlevel2">
<li><a href="#connecting-console_connecting-clusters">5.1. Accessing Infinispan Console</a></li>
<li><a href="#connecting-cli_connecting-clusters">5.2. Connecting with the command line interface (CLI)</a></li>
<li><a href="#connecting-clients-internal_connecting-clusters">5.3. Connecting Hot Rod clients running on Kubernetes</a></li>
<li><a href="#connecting-clients-external_connecting-clusters">5.4. Connecting Hot Rod clients running outside Kubernetes</a></li>
<li><a href="#connecting-rest_connecting-clusters">5.5. Accessing the REST API</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Create Infinispan clusters with a Helm chart that lets you specify values for build and deployment configuration.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="install"><a class="anchor" href="#install"></a>1. Deploying Infinispan clusters as Helm chart releases</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Build, configure, and deploy Infinispan clusters with Helm.
Infinispan provides a Helm chart that packages resources for running Infinispan clusters on Kubernetes.</p>
</div>
<div class="paragraph">
<p>Install the Infinispan chart to create a Helm release, which instantiates a Infinispan cluster in your Kubernetes project.</p>
</div>
<div class="sect2">
<h3 id="installing-chart-console_install"><a class="anchor" href="#installing-chart-console_install"></a>1.1. Installing the Infinispan chart through the OpenShift console</h3>
<div class="paragraph _abstract">
<p>Use the OpenShift Web Console to install the Infinispan chart from the Red Hat developer catalog.
Installing the chart creates a Helm release that deploys a Infinispan cluster.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Have access to OpenShift.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log in to the OpenShift Web Console.</p>
</li>
<li>
<p>Select the <strong>Developer</strong> perspective.</p>
</li>
<li>
<p>Open the <strong>Add</strong> view and then select <strong>Helm Chart</strong> to browse the Red Hat developer catalog.</p>
</li>
<li>
<p>Locate and select the Infinispan chart.</p>
</li>
<li>
<p>Specify a name for the chart and select a version.</p>
</li>
<li>
<p>Define values in the following sections of the Infinispan chart:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Images</strong> configures the container images to use when creating pods for your Infinispan cluster.</p>
</li>
<li>
<p><strong>Deploy</strong> configures your Infinispan cluster.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To find descriptions for each value, select the <strong>YAML view</strong> option and access the schema.
Edit the yaml configuration to customize your Infinispan chart.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Select <strong>Install</strong>.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Verification</div>
<ol class="arabic">
<li>
<p>Select the <strong>Helm</strong> view in the <strong>Developer</strong> perspective.</p>
</li>
<li>
<p>Select the Helm release you created to view details, resources, and other information.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="installing-chart-command-line_install"><a class="anchor" href="#installing-chart-command-line_install"></a>1.2. Installing the Infinispan chart on the command line</h3>
<div class="paragraph _abstract">
<p>Use the command line to install the Infinispan chart on Kubernetes and instantiate a Infinispan cluster.
Installing the chart creates a Helm release that deploys a Infinispan cluster.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Install the <code>helm</code> client.</p>
</li>
<li>
<p>Add the <a href="https://github.com/openshift-helm-charts/charts/blob/main/README.md">OpenShift Helm Charts repository</a>.</p>
</li>
<li>
<p>Have access to an OpenShift or Kubernetes cluster.</p>
</li>
<li>
<p>Have a <code>kubectl</code> or <code>oc</code> client.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a values file that configures your Infinispan cluster.</p>
<div class="paragraph">
<p>For example, the following values file creates a cluster with two nodes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>$ cat &gt; infinispan-values.yaml&lt;&lt;EOF
#Build configuration
images:
  server: quay.io/infinispan/server:13.0
  initContainer: registry.access.redhat.com/ubi8-micro
#Deployment configuration
deploy:
  #Add a user with full security authorization.
  security:
    batch: "user create admin -p changeme"
  #Create a cluster with two pods.
  replicas: 2
EOF</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can find descriptions and values for each field in the <a href="https://github.com/infinispan/infinispan-helm-charts/blob/main/README.md">Infinispan chart README</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Install the Infinispan chart and specify your values file.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>$ helm install infinispan openshift-helm-charts/infinispan-infinispan -f infinispan-values.yaml</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Use the <code>--set</code> flag to override configuration values for the deployment.
For example, to create a cluster with three nodes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>--set deploy.replicas=3</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Verification</div>
<p>Watch the pods to ensure all nodes in the Infinispan cluster are created successfully.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>$ kubectl get pods -w</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="upgrading-releases_install"><a class="anchor" href="#upgrading-releases_install"></a>1.3. Upgrading Infinispan Helm releases</h3>
<div class="paragraph _abstract">
<p>Modify your Infinispan cluster configuration at runtime by upgrading Helm releases.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Deploy the Infinispan chart.</p>
</li>
<li>
<p>Have a <code>helm</code> client.</p>
</li>
<li>
<p>Have a <code>kubectl</code> or <code>oc</code> client.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Modify the values file for your Infinispan deployment as appropriate.</p>
</li>
<li>
<p>Use the <code>helm</code> client to apply your changes, for example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>$ helm upgrade infinispan openshift-helm-charts/infinispan-infinispan -f infinispan-values.yaml</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Verification</div>
<p>Watch the pods rebuild to ensure all changes are applied to your Infinispan cluster successfully.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>$ kubectl get pods -w</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="uninstalling-helm-releases_install"><a class="anchor" href="#uninstalling-helm-releases_install"></a>1.4. Uninstalling Infinispan Helm releases</h3>
<div class="paragraph _abstract">
<p>Uninstall a release of the Infinispan chart to remove pods and other deployment artifacts.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This procedure shows you how to uninstall a Infinispan deployment on the command line but you can use the OpenShift Web Console instead.
Refer to the OpenShift documentation for specific instructions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Deploy the Infinispan chart.</p>
</li>
<li>
<p>Have a <code>helm</code> client.</p>
</li>
<li>
<p>Have a <code>kubectl</code> or <code>oc</code> client.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>List the installed Infinispan Helm releases.</p>
<div class="listingblock">
<div class="content">
<pre>$ helm list</pre>
</div>
</div>
</li>
<li>
<p>Use the <code>helm</code> client to uninstall a release and remove the Infinispan cluster:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-bash" data-lang="bash">$ helm uninstall &lt;helm_release_name&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Use the <code>kubectl</code> client to remove the generated secret.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-bash" data-lang="bash">$ kubectl delete secret &lt;helm_release_name&gt;-generated-secret</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="deployment-configuration-values_install"><a class="anchor" href="#deployment-configuration-values_install"></a>1.5. Deployment configuration values</h3>
<div class="paragraph _abstract">
<p>Deployment configuration values let you customize Infinispan clusters.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can also find field and value descriptions in the <a href="https://github.com/infinispan/infinispan-helm-charts/blob/main/README.md">Infinispan chart README</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.replicas</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of nodes in your Infinispan cluster, with a pod created for each node.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.container.extraJvmOpts</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Passes JVM options to Infinispan Server.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No default value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.container.storage.ephemeral</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines whether storage is ephemeral or permanent.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The default value is <code>false</code>, which means data is permanent.
Set the value to <code>true</code> to use ephemeral storage, which means all data is deleted when clusters shut down or restart.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.container.storage.size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines how much storage is allocated to each Infinispan pod.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1Gi</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.container.storage.storageClassName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the name of a <code>StorageClass</code> object to use for the persistent volume claim (PVC).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No default value. By default, the persistent volume claim uses the storage class that has the <code>storageclass.kubernetes.io/is-default-class</code> annotation set to <code>true</code>. If you include this field, you must specify an existing storage class as the value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.container.resources.limits.cpu</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the CPU limit, in CPU units, for each Infinispan pod.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500m</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.container.resources.limits.memory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the maximum amount of memory, in bytes, for each Infinispan pod.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">512Mi</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.container.resources.requests.cpu</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the maximum CPU requests, in CPU units, for each Infinispan pod.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500m</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.container.resources.requests.memory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the maximum memory requests, in bytes, for each Infinispan pod.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">512Mi</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.security.secretName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the name of a secret that creates credentials and configures security authorization.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No default value.
If you create a custom security secret then <code>deploy.security.batch</code> does not take effect.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.security.batch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides a batch file for the Infinispan command line interface (CLI) to create credentials and configure security authorization at startup.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No default value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.expose.type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the service that exposes Hot Rod and REST endpoints on the network and provides access to your Infinispan cluster, including the Infinispan Console.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Route</code>
Valid options are: <code>""</code> (empty value), <code>Route</code>, <code>LoadBalancer</code>, and <code>NodePort</code>.
Set an empty value (<code>""</code>) if you do not want to expose Infinispan on the network.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.expose.nodePort</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a network port for node port services within the default range of 30000 to 32767.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0
If you do not specify a port, the platform selects an available one.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.expose.host</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optionally specifies the hostname where the Route is exposed.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No default value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.expose.annotations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds annotations to the service that exposes Infinispan on the network.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No default value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.logging.categories</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configures Infinispan cluster log categories and levels.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No default value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.resourceLabels</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds labels to Infinispan resources such as pods and services.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No default value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.makeDataDirWritable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows write access to the <code>data</code> directory for each Infinispan Server node.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code>
If you set the value to <code>true</code>, Infinispan creates an initContainer that runs <code>chmod -R</code> on the <code>/opt/infinispan/server/data</code> directory to change permissions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.nameOverride</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a name for all Infinispan cluster resources.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Helm Chart release name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deploy.infinispan</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Infinispan Server configuration.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Infinispan provides default server configuration.
For more information about configuring server instances, see <em>Infinispan Server configuration values</em>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-servers"><a class="anchor" href="#configuring-servers"></a>2. Configuring Infinispan Servers</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Apply custom Infinispan Server configuration to your deployments.</p>
</div>
<div class="sect2">
<h3 id="configuring-servers_configuring-servers"><a class="anchor" href="#configuring-servers_configuring-servers"></a>2.1. Customizing Infinispan Server configuration</h3>
<div class="paragraph _abstract">
<p>Apply custom <code>deploy.infinispan</code> values to Infinispan clusters that configure the Cache Manager and underlying server mechanisms like security realms or Hot Rod and REST endpoints.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You must always provide a complete Infinispan Server configuration when you modify <code>deploy.infinispan</code> values.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Do not modify or remove the default "metrics" configuration if you want to use monitoring capabilities for your Infinispan cluster.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>Modify Infinispan Server configuration as required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specify configuration values for the Cache Manager with <code>deploy.infinispan.cacheContainer</code> fields.</p>
<div class="paragraph">
<p>For example, you can create caches at startup with any Infinispan configuration or add cache templates and use them to create caches on demand.</p>
</div>
</li>
<li>
<p>Configure security authorization to control user roles and permissions with the <code>deploy.infinispan.cacheContainer.security.authorization</code> field.</p>
</li>
<li>
<p>Select one of the default JGroups stacks or configure cluster transport with the <code>deploy.infinispan.cacheContainer.transport</code> fields.</p>
</li>
<li>
<p>Configure Infinispan Server endpoints with the <code>deploy.infinispan.server.endpoints</code> fields.</p>
</li>
<li>
<p>Configure Infinispan Server network interfaces and ports with the <code>deploy.infinispan.server.interfaces</code> and <code>deploy.infinispan.server.socketBindings</code> fields.</p>
</li>
<li>
<p>Configure Infinispan Server security mechanisms with the <code>deploy.infinispan.server.security</code> fields.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Infinispan chart does not currently support TLS/SSL security realms and encrypted client connections.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="server-configuration-values_configuring-servers"><a class="anchor" href="#server-configuration-values_configuring-servers"></a>2.2. Infinispan Server configuration values</h3>
<div class="paragraph _abstract">
<p>Infinispan Server configuration values let you customize the Cache Manager and modify server instances that run in Kubernetes pods.</p>
</div>
<div class="listingblock">
<div class="title">Infinispan Server configuration</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">deploy:
  infinispan:
    cacheContainer:
    # [USER] Add cache, template, and counter configuration.
    name: default
    # [USER] Specify `security: null` to disable security authorization.
    security:
      authorization: {}
    transport:
      cluster: ${infinispan.cluster.name:cluster}
      node-name: ${infinispan.node.name:}
      stack: kubernetes
    server:
      endpoints:
        # [USER] Hot Rod and REST endpoints.
        - securityRealm: default
          socketBinding: default
        # [METRICS] Metrics endpoint for cluster monitoring capabilities.
        - connectors:
            rest:
              restConnector:
                authentication:
                  mechanisms: BASIC
          securityRealm: metrics
          socketBinding: metrics
      interfaces:
      - inetAddress:
          value: ${infinispan.bind.address:127.0.0.1}
        name: public
      security:
        credentialStores:
        - clearTextCredential:
            clearText: secret
          name: credentials
          path: credentials.pfx
        securityRealms:
        # [USER] Security realm for the Hot Rod and REST endpoints.
        - name: default
          # [USER] Comment or remove this properties realm to disable authentication.
          propertiesRealm:
            groupProperties:
              path: groups.properties
            groupsAttribute: Roles
            userProperties:
              path: users.properties
          # [METRICS] Security realm for the metrics endpoint.
        - name: metrics
          propertiesRealm:
            groupProperties:
              path: metrics-groups.properties
              relativeTo: infinispan.server.config.path
            groupsAttribute: Roles
            userProperties:
              path: metrics-users.properties
              plainText: true
              relativeTo: infinispan.server.config.path
        socketBindings:
          defaultInterface: public
          portOffset: ${infinispan.socket.binding.port-offset:0}
          socketBinding:
            # [USER] Socket binding for the Hot Rod and REST endpoints.
          - name: default
            port: 11222
            # [METRICS] Socket binding for the metrics endpoint.
          - name: metrics
            port: 11223</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Infinispan cache configuration</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">deploy:
  infinispan:
    cacheContainer:
      distributedCache:
        name: "mycache"
        mode: "SYNC"
        owners: "2"
        segments: "256"
        capacityFactor: "1.0"
        statistics: "true"
        encoding:
          mediaType: "application/x-protostream"
        expiration:
          lifespan: "5000"
          maxIdle: "1000"
        memory:
          maxCount: "1000000"
          whenFull: "REMOVE"
        partitionHandling:
          whenSplit: "ALLOW_READ_WRITES"
          mergePolicy: "PREFERRED_NON_NULL"
    #Provide additional Cache Manager configuration.
  server:
    #Provide configuration for server instances.</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Cache template</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">deploy:
  infinispan:
    cacheContainer:
      distributedCacheConfiguration:
        name: "my-dist-template"
        mode: "SYNC"
        statistics: "true"
        encoding:
          mediaType: "application/x-protostream"
        expiration:
          lifespan: "5000"
          maxIdle: "1000"
        memory:
          maxCount: "1000000"
          whenFull: "REMOVE"
    #Provide additional Cache Manager configuration.
  server:
    #Provide configuration for server instances.</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Cluster transport</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">deploy:
  infinispan:
    cacheContainer:
      transport:
        #Specifies the name of a default JGroups stack.
        stack: kubernetes
    #Provide additional Cache Manager configuration.
  server:
    #Provide configuration for server instances.</code></pre>
</div>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://infinispan.org/docs/stable/titles/server/server.html">Infinispan Server Guide</a></p>
</li>
<li>
<p><a href="https://infinispan.org/docs/stable/titles/configuring/configuring.html">Configuring Infinispan</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-authentication"><a class="anchor" href="#configuring-authentication"></a>3. Configuring authentication and authorization</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Control access to Infinispan clusters by adding credentials and assigning roles with different permissions.</p>
</div>
<div class="sect2">
<h3 id="default-credentials_configuring-authentication"><a class="anchor" href="#default-credentials_configuring-authentication"></a>3.1. Default credentials</h3>
<div class="paragraph">
<p>Infinispan adds default credentials in a <code>&lt;helm_release_name&gt;-generated-secret</code> secret.</p>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Username</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>developer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User that has the <code>admin</code> role with full access to Infinispan resources.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>monitor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internal user that has the <code>monitor</code> role with access to Infinispan metrics through port <code>11223</code>.</p></td>
</tr>
</tbody>
</table>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://infinispan.org/docs/stable/titles/security/security.html">Infinispan Security Guide</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="retrieving-credentials_configuring-authentication"><a class="anchor" href="#retrieving-credentials_configuring-authentication"></a>3.1.1. Retrieving credentials</h4>
<div class="paragraph _abstract">
<p>Get Infinispan credentials from authentication secrets.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Install the Infinispan Helm chart.</p>
</li>
<li>
<p>Have a <code>kubectl</code> or <code>oc</code> client.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Retrieve default credentials from the <code>&lt;helm_release_name&gt;-generated-secret</code> or custom credentials from another secret with the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>$ kubectl get secret &lt;helm_release_name&gt;-generated-secret \
-o jsonpath="{.data.identities-batch}" | base64 --decode</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding-credentials_configuring-authentication"><a class="anchor" href="#adding-credentials_configuring-authentication"></a>3.2. Adding custom user credentials</h3>
<div class="paragraph _abstract">
<p>Create Infinispan user credentials and assign roles that grant security authorization for cluster access.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create credentials by specifying a <code>user create</code> command in the <code>deploy.security.batch</code> field.</p>
<div class="listingblock">
<div class="title">User with implicit authorization</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">deploy:
  security:
    batch: 'user create admin -p changeme'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">User with a specific role</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">deploy:
  security:
    batch: 'user create personone -p changeme -g deployer'</code></pre>
</div>
</div>
</li>
<li>
<p>Install or upgrade your Infinispan Helm release.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="user-roles-permissions_configuring-authentication"><a class="anchor" href="#user-roles-permissions_configuring-authentication"></a>3.2.1. User roles and permissions</h4>
<div class="paragraph _abstract">
<p>Infinispan uses role-based access control to authorize users for access to cluster resources and data.
For additional security, you should grant Infinispan users with appropriate roles when you add credentials.</p>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Role</th>
<th class="tableblock halign-left valign-top">Permissions</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>admin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Superuser with all permissions including control of the Cache Manager lifecycle.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deployer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL_READ, ALL_WRITE, LISTEN, EXEC, MONITOR, CREATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can create and delete Infinispan resources in addition to <code>application</code> permissions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL_READ, ALL_WRITE, LISTEN, EXEC, MONITOR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Has read and write access to Infinispan resources in addition to <code>observer</code> permissions. Can also listen to events and execute server tasks and scripts.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>observer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL_READ, MONITOR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Has read access to Infinispan resources in addition to <code>monitor</code> permissions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>monitor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MONITOR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can view statistics for Infinispan clusters.</p></td>
</tr>
</tbody>
</table>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://infinispan.org/docs/stable/titles/security/security.html">Infinispan Security Guide</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="adding-multiple-credentials_configuring-authentication"><a class="anchor" href="#adding-multiple-credentials_configuring-authentication"></a>3.2.2. Adding multiple credentials with authentication secrets</h4>
<div class="paragraph _abstract">
<p>Add multiple credentials to Infinispan clusters with authentication secrets.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Have a <code>kubectl</code> or <code>oc</code> client.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create an <code>identities-batch</code> file that contains the commands to add your credentials.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">apiVersion: v1
kind: Secret
metadata:
  name: connect-secret
type: Opaque
stringData:
  # The "monitor" user authenticates with the Prometheus ServiceMonitor.
  username: monitor
  # The password for the "monitor" user.
  password: password
  # The key must be 'identities-batch'.
  # The content is "user create" commands for the Infinispan CLI.
  identities-batch: |-
    user create user1 -p changeme -g admin
    user create user2 -p changeme -g deployer
    user create monitor -p password --users-file metrics-users.properties --groups-file metrics-groups.properties</code></pre>
</div>
</div>
</li>
<li>
<p>Create an authentication secret from your <code>identities-batch</code> file.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>$ kubectl apply -f identities-batch.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Specify the authentication secret in the <code>deploy.security.SecretName</code> field.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>deploy:
  security:
    authentication: true
    secretName: 'connect-secret'</code></pre>
</div>
</div>
</li>
<li>
<p>Install or upgrade your Infinispan Helm release.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="disabling-authentication_configuring-authentication"><a class="anchor" href="#disabling-authentication_configuring-authentication"></a>3.3. Disabling authentication</h3>
<div class="paragraph _abstract">
<p>Allow users to access Infinispan clusters and manipulate data without providing credentials.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Do not disable authentication if endpoints are accessible from outside the Kubernetes cluster.
You should disable authentication for development environments only.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Remove the <code>propertiesRealm</code> fields from the "default" security realm.</p>
</li>
<li>
<p>Install or upgrade your Infinispan Helm release.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="disabling-authorization_configuring-authentication"><a class="anchor" href="#disabling-authorization_configuring-authentication"></a>3.4. Disabling security authorization</h3>
<div class="paragraph _abstract">
<p>Allow Infinispan users to perform any operation regardless of their role.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Set <code>null</code> as the value for the <code>deploy.infinispan.cacheContainer.security</code> field.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Use the <code>--set deploy.infinispan.cacheContainer.security=null</code> argument with the <code>helm</code> client.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Install or upgrade your Infinispan Helm release.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="network-access"><a class="anchor" href="#network-access"></a>4. Configuring network access</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Configure network access for your Infinispan deployment and find out about internal network services.</p>
</div>
<div class="sect2">
<h3 id="exposing-clusters-network_network-access"><a class="anchor" href="#exposing-clusters-network_network-access"></a>4.1. Exposing Infinispan clusters on the network</h3>
<div class="paragraph _abstract">
<p>Make Infinispan clusters available on the network so you can access Infinispan Console as well as REST and Hot Rod endpoints.
By default, the Infinispan chart exposes deployments through a Route but you can configure it to expose clusters via Load Balancer or Node Port.
You can also configure the Infinispan chart so that deployments are not exposed on the network and only available internally to the Kubernetes cluster.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Specify one of the following for the <code>deploy.expose.type</code> field:</p>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Route</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exposes Infinispan through an ingress. This is the default value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LoadBalancer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exposes Infinispan through a load balancer service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NodePort</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exposes Infinispan through a node port service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>""</code> (empty value)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disables exposing Infinispan on the network.</p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Optionally specify a hostname with the <code>deploy.expose.host</code> field if you expose Infinispan through an ingress.</p>
</li>
<li>
<p>Optionally specify a port with the <code>deploy.expose.nodePort</code> field if you expose Infinispan through a node port service.</p>
</li>
<li>
<p>Install or upgrade your Infinispan Helm release.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="retrieving-network-services_network-access"><a class="anchor" href="#retrieving-network-services_network-access"></a>4.2. Retrieving network service details</h3>
<div class="paragraph _abstract">
<p>Get network service details so you can connect to Infinispan clusters.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Expose your Infinispan cluster on the network.</p>
</li>
<li>
<p>Have a <code>kubectl</code> or <code>oc</code> client.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>Use one of the following commands to retrieve network service details:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you expose Infinispan through an ingress:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>$ kubectl get ingress</code></pre>
</div>
</div>
</li>
<li>
<p>If you expose Infinispan through a load balancer or node port service:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>$ kubectl get services</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="network-services_network-access"><a class="anchor" href="#network-services_network-access"></a>4.3. Network services</h3>
<div class="paragraph _abstract">
<p>The Infinispan chart creates default network services for internal access.</p>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Service</th>
<th class="tableblock halign-left valign-top">Port</th>
<th class="tableblock halign-left valign-top">Protocol</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;helm_release_name&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>11222</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides access to Infinispan Hot Rod and REST endpoints.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;helm_release_name&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>11223</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides access to Infinispan metrics.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;helm_release_name&gt;-ping</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>8888</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows Infinispan pods to discover each other and form clusters.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You can retrieve details about internal network services as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>$ kubectl get services

NAME              TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)
infinispan        ClusterIP   192.0.2.0        &lt;none&gt;        11222/TCP,11223/TCP
infinispan-ping   ClusterIP   None             &lt;none&gt;        8888/TCP</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connecting-clusters"><a class="anchor" href="#connecting-clusters"></a>5. Connecting to Infinispan clusters</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>After you configure and deploy Infinispan clusters you can establish remote connections through the Infinispan Console, command line interface (CLI), Hot Rod client, or REST API.</p>
</div>
<div class="sect2">
<h3 id="connecting-console_connecting-clusters"><a class="anchor" href="#connecting-console_connecting-clusters"></a>5.1. Accessing Infinispan Console</h3>
<div class="paragraph _abstract">
<p>Access the console to create caches, perform adminstrative operations, and monitor your Infinispan clusters.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Expose your Infinispan cluster on the network.</p>
</li>
<li>
<p>Retrieve network service details.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Access Infinispan Console from any browser at <code>$SERVICE_HOSTNAME:$PORT</code>.</p>
<div class="paragraph">
<p>Replace <code>$SERVICE_HOSTNAME:$PORT</code> with the hostname and port where Infinispan is available on the network.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="connecting-cli_connecting-clusters"><a class="anchor" href="#connecting-cli_connecting-clusters"></a>5.2. Connecting with the command line interface (CLI)</h3>
<div class="paragraph _abstract">
<p>Use the Infinispan CLI to connect to clusters and create caches, manipulate data, and perform administrative operations.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Expose your Infinispan cluster on the network.</p>
</li>
<li>
<p>Retrieve network service details.</p>
</li>
<li>
<p>Download the native Infinispan CLI distribution from <a href="https://github.com/infinispan/infinispan-quarkus/releases/">infinispan-quarkus releases</a>.</p>
</li>
<li>
<p>Extract the <code>.zip</code> archive for the native Infinispan CLI distribution to your host filesystem.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Start the Infinispan CLI with the network service as the value for the <code>-c</code> argument, for example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-bash" data-lang="bash">$ infinispan-cli -c http://cluster-name-myroute.hostname.net/</code></pre>
</div>
</div>
</li>
<li>
<p>Enter your Infinispan credentials when prompted.</p>
</li>
<li>
<p>Perform CLI operations as required.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Press the tab key or use the <code class="command">--help</code> argument to view available options and help text.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Use the <code class="command">quit</code> command to exit the CLI.</p>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://infinispan.org/docs/stable/titles/cli/cli.html">Using the Infinispan Command Line Interface</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="connecting-clients-internal_connecting-clusters"><a class="anchor" href="#connecting-clients-internal_connecting-clusters"></a>5.3. Connecting Hot Rod clients running on Kubernetes</h3>
<div class="paragraph _abstract">
<p>Access remote caches with Hot Rod clients running on the same Kubernetes cluster as your Infinispan cluster.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Retrieve network service details.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Specify the internal network service detail for your Infinispan cluster in the client configuration.</p>
<div class="paragraph">
<p>In the following configuration examples, <code>$SERVICE_HOSTNAME:$PORT</code> denotes the hostname and port that allows access to your Infinispan cluster.</p>
</div>
</li>
<li>
<p>Specify your credentials so the client can authenticate with Infinispan.</p>
</li>
<li>
<p>Configure client intelligence, if required.</p>
<div class="paragraph">
<p>Hot Rod clients running on Kubernetes can use any client intelligence because they can access internal IP addresses for Infinispan pods.<br>
The default intelligence, <code>HASH_DISTRIBUTION_AWARE</code>, is recommended because it allows clients to route requests to primary owners, which improves performance.</p>
</div>
</li>
</ol>
</div>
<h4 id="_programmatic_configuration" class="discrete">Programmatic configuration</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-java" data-lang="java">import org.infinispan.client.hotrod.configuration.ConfigurationBuilder;
import org.infinispan.client.hotrod.configuration.SaslQop;
import org.infinispan.client.hotrod.impl.ConfigurationProperties;
...

ConfigurationBuilder builder = new ConfigurationBuilder();
      builder.addServer()
               .host("$SERVICE_HOSTNAME")
               .port(ConfigurationProperties.DEFAULT_HOTROD_PORT)
             .security().authentication()
               .username("username")
               .password("changeme")
               .realm("default")
               .saslQop(SaslQop.AUTH)
               .saslMechanism("SCRAM-SHA-512");</code></pre>
</div>
</div>
<h4 id="_hot_rod_client_properties" class="discrete">Hot Rod client properties</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code># Connection
infinispan.client.hotrod.server_list=$SERVICE_HOSTNAME:$PORT

# Authentication
infinispan.client.hotrod.use_auth=true
infinispan.client.hotrod.auth_username=developer
infinispan.client.hotrod.auth_password=$PASSWORD
infinispan.client.hotrod.auth_server_name=$CLUSTER_NAME
infinispan.client.hotrod.sasl_properties.javax.security.sasl.qop=auth
infinispan.client.hotrod.sasl_mechanism=SCRAM-SHA-512</code></pre>
</div>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://infinispan.org/docs/stable/titles/hotrod_java/hotrod_java.html">Hot Rod Java Client Guide</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="connecting-clients-external_connecting-clusters"><a class="anchor" href="#connecting-clients-external_connecting-clusters"></a>5.4. Connecting Hot Rod clients running outside Kubernetes</h3>
<div class="paragraph _abstract">
<p>Access remote caches with Hot Rod clients running externally to the Kubernetes cluster where you deploy your Infinispan cluster.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Expose your Infinispan cluster on the network.</p>
</li>
<li>
<p>Retrieve network service details.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Specify the internal network service detail for your Infinispan cluster in the client configuration.</p>
<div class="paragraph">
<p>In the following configuration examples, <code>$SERVICE_HOSTNAME:$PORT</code> denotes the hostname and port that allows access to your Infinispan cluster.</p>
</div>
</li>
<li>
<p>Specify your credentials so the client can authenticate with Infinispan.</p>
</li>
<li>
<p>Configure clients to use <code>BASIC</code> intelligence.</p>
</li>
</ol>
</div>
<h4 id="_programmatic_configuration_2" class="discrete">Programmatic configuration</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-java" data-lang="java">import org.infinispan.client.hotrod.configuration.ClientIntelligence;
import org.infinispan.client.hotrod.configuration.ConfigurationBuilder;
import org.infinispan.client.hotrod.configuration.SaslQop;
...

ConfigurationBuilder builder = new ConfigurationBuilder();
      builder.addServer()
               .host("$SERVICE_HOSTNAME")
               .port("$PORT")
             .security().authentication()
               .username("username")
               .password("changeme")
               .realm("default")
               .saslQop(SaslQop.AUTH)
               .saslMechanism("SCRAM-SHA-512");
      builder.clientIntelligence(ClientIntelligence.BASIC);</code></pre>
</div>
</div>
<h4 id="_hot_rod_client_properties_2" class="discrete">Hot Rod client properties</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code># Connection
infinispan.client.hotrod.server_list=$SERVICE_HOSTNAME:$PORT

# Client intelligence
infinispan.client.hotrod.client_intelligence=BASIC

# Authentication
infinispan.client.hotrod.use_auth=true
infinispan.client.hotrod.auth_username=developer
infinispan.client.hotrod.auth_password=$PASSWORD
infinispan.client.hotrod.auth_server_name=$CLUSTER_NAME
infinispan.client.hotrod.sasl_properties.javax.security.sasl.qop=auth
infinispan.client.hotrod.sasl_mechanism=SCRAM-SHA-512</code></pre>
</div>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://infinispan.org/docs/stable/titles/hotrod_java/hotrod_java.html">Hot Rod Java Client Guide</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="connecting-rest_connecting-clusters"><a class="anchor" href="#connecting-rest_connecting-clusters"></a>5.5. Accessing the REST API</h3>
<div class="paragraph _abstract">
<p>Infinispan provides a RESTful interface that you can interact with using HTTP clients.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Expose your Infinispan cluster on the network.</p>
</li>
<li>
<p>Retrieve network service details.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Access the REST API with any HTTP client at <code>$SERVICE_HOSTNAME:$PORT/rest/v2</code>.</p>
<div class="paragraph">
<p>Replace <code>$SERVICE_HOSTNAME:$PORT</code> with the hostname and port where Infinispan is available on the network.</p>
</div>
</li>
</ul>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://infinispan.org/docs/stable/titles/rest/rest.html">Infinispan REST API</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-01-28 09:22:33 UTC
</div>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8601422-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>