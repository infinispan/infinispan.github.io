<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="generator" content="Asciidoctor 0.1.4"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Contributing to Infinispan</title> <style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }
audio, canvas, video { display: inline-block; }
audio:not([controls]) { display: none; height: 0; }
[hidden] { display: none; }
html { background: #fff; color: #000; font-family: sans-serif; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; }
body { margin: 0; }
a:focus { outline: thin dotted; }
a:active, a:hover { outline: 0; }
h1 { font-size: 2em; margin: 0.67em 0; }
abbr[title] { border-bottom: 1px dotted; }
b, strong { font-weight: bold; }
dfn { font-style: italic; }
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }
mark { background: #ff0; color: #000; }
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }
pre { white-space: pre-wrap; }
q { quotes: "\201C" "\201D" "\2018" "\2019"; }
small { font-size: 80%; }
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }
sup { top: -0.5em; }
sub { bottom: -0.25em; }
img { border: 0; }
svg:not(:root) { overflow: hidden; }
figure { margin: 0; }
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }
legend { border: 0; padding: 0; }
button, input, select, textarea { font-family: inherit; font-size: 100%; margin: 0; }
button, input { line-height: normal; }
button, select { text-transform: none; }
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; cursor: pointer; }
button[disabled], html input[disabled] { cursor: default; }
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; padding: 0; }
input[type="search"] { -webkit-appearance: textfield; -moz-box-sizing: content-box; -webkit-box-sizing: content-box; box-sizing: content-box; }
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }
textarea { overflow: auto; vertical-align: top; }
table { border-collapse: collapse; border-spacing: 0; }
*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }
html, body { font-size: 100%; }
body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }
a:hover { cursor: pointer; }
a:focus { outline: none; }
img, object, embed { max-width: 100%; height: auto; }
object, embed { height: 100%; }
img { -ms-interpolation-mode: bicubic; }
#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }
.left { float: left !important; }
.right { float: right !important; }
.text-left { text-align: left !important; }
.text-right { text-align: right !important; }
.text-center { text-align: center !important; }
.text-justify { text-align: justify !important; }
.hide { display: none; }
.antialiased, body { -webkit-font-smoothing: antialiased; }
img { display: inline-block; vertical-align: middle; }
textarea { height: auto; min-height: 50px; }
select { width: 100%; }
p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }
.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1.4; color: #7a2518; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }
a { color: #005498; text-decoration: underline; line-height: inherit; }
a:hover, a:focus { color: #00467f; }
a img { border: none; }
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: Georgia, "URW Bookman L", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; color: #ba3925; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #e99b8f; line-height: 0; }
h1 { font-size: 2.125em; }
h2 { font-size: 1.6875em; }
h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }
h4 { font-size: 1.125em; }
h5 { font-size: 1.125em; }
h6 { font-size: 1em; }
hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }
em, i { font-style: italic; line-height: inherit; }
strong, b { font-weight: bold; line-height: inherit; }
small { font-size: 60%; line-height: inherit; }
code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; color: #6d180b; }
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }
ul, ol { margin-left: 1.5em; }
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }
abbr { text-transform: none; }
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: inherit; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }
blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }
.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }
@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
.print-only { display: none !important; }
@media print { * { background: transparent !important; color: #000 !important; box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.6; }
.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }
*:not(pre) > code { font-size: 0.9375em; padding: 1px 3px 0; white-space: nowrap; background-color: #f2f2f2; border: 1px solid #cccccc; -webkit-border-radius: 4px; border-radius: 4px; text-shadow: none; }
pre, pre > code { line-height: 1.4; color: inherit; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }
kbd.keyseq { color: #555555; }
kbd:not(.keyseq) { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }
kbd kbd:first-child { margin-left: 0; }
kbd kbd:last-child { margin-right: 0; }
.menuseq, .menu { color: #090909; }
p a > code:hover { color: #561309; }
#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }
#header { margin-bottom: 2.5em; }
#header > h1 { color: black; font-weight: normal; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #6f6f6f; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }
#toc { border-bottom: 3px double #ebebeb; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }
#toctitle { color: #7a2518; }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; }
  #toc.toc2 { position: fixed; width: 20em; left: 0; top: 0; border-right: 1px solid #ebebeb; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; }
  #toc.toc2 > ul { font-size: .95em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1.25em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #ebebeb; left: auto; right: 0; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; border-width: 0; -webkit-border-radius: 4px; border-radius: 4px; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }
#content #toctitle { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-size: 1em; padding-left: 0.125em; }
#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }
#footer-text { color: #dddddd; line-height: 1.44; }
.sect1 { padding-bottom: 1.25em; }
.sect1 + .sect1 { border-top: 3px double #ebebeb; }
#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #ba3925; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #a53221; }
.imageblock, .literalblock, .listingblock, .verseblock, .videoblock { margin-bottom: 1.25em; }
.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }
.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }
table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }
.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #6f6f6f; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }
.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 4px; border-radius: 4px; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }
.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #d9d9d9; box-shadow: 0 1px 8px #d9d9d9; }
.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 4px; border-radius: 4px; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #7a2518; margin-top: 0; line-height: 1.6; }
.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }
.literalblock > .content pre, .listingblock > .content pre { background: none; border-width: 1px 0; border-style: dotted; border-color: #bfbfbf; -webkit-border-radius: 4px; border-radius: 4px; padding: 0.75em 0.75em 0.5em 0.75em; word-wrap: break-word; }
.literalblock > .content pre.nowrap, .listingblock > .content pre.nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock > .content pre > code, .listingblock > .content pre > code { display: block; }
@media only screen { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.8em; } }
@media only screen and (min-width: 768px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.9em; } }
@media only screen and (min-width: 1280px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 1em; } }
.listingblock > .content { position: relative; }
.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }
.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }
.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }
.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }
table.pyhltable { border: 0; margin-bottom: 0; }
table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }
table.pyhltable td.code { padding-left: .75em; padding-right: 0; }
.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }
.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }
table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }
.quoteblock { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 1.25em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: inherit; color: #555555; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }
table thead th, table tfoot th { font-weight: bold; }
table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 4px; border-radius: 4px; border-top: 1px solid #dddddd; border-bottom: 1px solid #dddddd; }
table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }
table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }
table.tableblock td .paragraph:last-child p, table.tableblock td > p:last-child { margin-bottom: 0; }
th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }
th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }
th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }
th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }
th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }
th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }
p.tableblock.header { color: #222222; font-weight: bold; }
td > div.verse { white-space: pre; }
ol { margin-left: 1.75em; }
ul li ol { margin-left: 1.5em; }
dl dd { margin-left: 1.125em; }
dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }
ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }
ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }
ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }
ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }
ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }
ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }
.unstyled dl dt { font-weight: normal; font-style: normal; }
ol.arabic { list-style-type: decimal; }
ol.decimal { list-style-type: decimal-leading-zero; }
ol.loweralpha { list-style-type: lower-alpha; }
ol.upperalpha { list-style-type: upper-alpha; }
ol.lowerroman { list-style-type: lower-roman; }
ol.upperroman { list-style-type: upper-roman; }
ol.lowergreek { list-style-type: lower-greek; }
.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }
td.hdlist1 { padding-right: .8em; font-weight: bold; }
td.hdlist1, td.hdlist2 { vertical-align: top; }
.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }
.colist > table tr > td:first-of-type { padding: 0 .8em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }
.qanda > ol > li > p > em:only-child { color: #00467f; }
.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }
.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }
.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }
a.image { text-decoration: none; }
span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }
#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }
.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }
div.unbreakable { page-break-inside: avoid; }
.big { font-size: larger; }
.small { font-size: smaller; }
.underline { text-decoration: underline; }
.overline { text-decoration: overline; }
.line-through { text-decoration: line-through; }
.aqua { color: #00bfbf; }
.aqua-background { background-color: #00fafa; }
.black { color: black; }
.black-background { background-color: black; }
.blue { color: #0000bf; }
.blue-background { background-color: #0000fa; }
.fuchsia { color: #bf00bf; }
.fuchsia-background { background-color: #fa00fa; }
.gray { color: #606060; }
.gray-background { background-color: #7d7d7d; }
.green { color: #006000; }
.green-background { background-color: #007d00; }
.lime { color: #00bf00; }
.lime-background { background-color: #00fa00; }
.maroon { color: #600000; }
.maroon-background { background-color: #7d0000; }
.navy { color: #000060; }
.navy-background { background-color: #00007d; }
.olive { color: #606000; }
.olive-background { background-color: #7d7d00; }
.purple { color: #600060; }
.purple-background { background-color: #7d007d; }
.red { color: #bf0000; }
.red-background { background-color: #fa0000; }
.silver { color: #909090; }
.silver-background { background-color: #bcbcbc; }
.teal { color: #006060; }
.teal-background { background-color: #007d7d; }
.white { color: #bfbfbf; }
.white-background { background-color: #fafafa; }
.yellow { color: #bfbf00; }
.yellow-background { background-color: #fafa00; }
span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }
.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #005498; color: #003f72; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }
.conum { display: inline-block; color: white !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }
.literalblock > .content > pre, .listingblock > .content > pre { -webkit-border-radius: 0; border-radius: 0; }

</style> <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.1/css/font-awesome.min.css"> <style>
/* Foundation stylesheet for CodeRay (to match GitHub theme) | MIT License | http://foundation.zurb.com */
table.CodeRay { border-collapse: collapse; padding: 2px; margin-bottom: 0; border: 0; background: transparent; }
table.CodeRay td { padding: 0 .5em; vertical-align: top; }
table.CodeRay td.line-numbers { text-align: right; color: #999; border-right: 1px solid #e5e5e5; padding-left: 0; }
span.line-numbers { border-right: 1px solid #E5E5E5; color: #999; display: inline-block; margin-right: 0.5em; padding-right: 0.5em; }
.CodeRay td.line-numbers strong, .CodeRay span.line-numbers strong { font-weight: normal; }
.CodeRay .debug { color: white !important; background: blue !important; }
.CodeRay .annotation { color: #007; }
.CodeRay .attribute-name { color: #f08; }
.CodeRay .attribute-value { color: #700; }
.CodeRay .binary { color: #509; }
.CodeRay .comment  { color: #999; font-style: italic; }
.CodeRay .char { color: #04D; }
.CodeRay .char .content { color: #04D; }
.CodeRay .char .delimiter { color: #039; }
.CodeRay .class { color: #458; }
.CodeRay .complex { color: #A08; }
.CodeRay .constant { color: teal; }
.CodeRay .color { color: #0A0; }
.CodeRay .class-variable { color: #369; }
.CodeRay .decorator { color: #B0B; }
.CodeRay .definition { color: #099; }
.CodeRay .directive { color: #088; }
.CodeRay .delimiter { color: black; }
.CodeRay .doc { color: #970; }
.CodeRay .doctype { color: #34b; }
.CodeRay .doc-string { color: #D42; }
.CodeRay .escape  { color: #666; }
.CodeRay .entity { color: #800; }
.CodeRay .error { color: #808; }
.CodeRay .exception { color: #C00; }
.CodeRay .filename { color: #099; }
.CodeRay .function { color: #900; }
.CodeRay .global-variable { color: teal; }
.CodeRay .hex { color: #058; }
.CodeRay .integer  { color: #099; }
.CodeRay .include { color: #B44; }
.CodeRay .inline { color: black; }
.CodeRay .inline .inline { background: #ccc; }
.CodeRay .inline .inline .inline { background: #bbb; }
.CodeRay .inline .inline-delimiter { color: #D14; }
.CodeRay .inline-delimiter { color: #D14; }
.CodeRay .important { color: #f00; }
.CodeRay .interpreted { color: #B2B; }
.CodeRay .instance-variable { color: teal; }
.CodeRay .label { color: #970; }
.CodeRay .local-variable { color: #963; }
.CodeRay .octal { color: #40E; }
.CodeRay .predefined { color: #369; }
.CodeRay .preprocessor { color: #579; }
.CodeRay .pseudo-class { color: #00C; }
.CodeRay .predefined-type { color: #074; }
.CodeRay .reserved, .keyword  { color: #000; }
.CodeRay .key { color: #808; }
.CodeRay .key .delimiter { color: #606; }
.CodeRay .key .char { color: #80f; }
.CodeRay .value { color: #088; }
.CodeRay .regexp { background-color: #fff0ff; }
.CodeRay .regexp .content { color: #808; }
.CodeRay .regexp .delimiter { color: #404; }
.CodeRay .regexp .modifier { color: #C2C; }
.CodeRay .regexp .function  { color: #404; font-weight: bold; }
.CodeRay .string { color: #D20; }
.CodeRay .string .string { }
.CodeRay .string .string .string { background-color: #ffd0d0; }
.CodeRay .string .content { color: #D14; }
.CodeRay .string .char { color: #D14; }
.CodeRay .string .delimiter { color: #D14; }
.CodeRay .shell { color: #D14; }
.CodeRay .shell .content { }
.CodeRay .shell .delimiter { color: #D14; }
.CodeRay .symbol { color: #990073; }
.CodeRay .symbol .content { color: #A60; }
.CodeRay .symbol .delimiter { color: #630; }
.CodeRay .tag, .CodeRay .attribute-name { color: #070; }
.CodeRay .tag-special { color: #D70; }
.CodeRay .type { color: #339; }
.CodeRay .variable  { color: #036; }
.CodeRay .insert { background: #afa; }
.CodeRay .delete { background: #faa; }
.CodeRay .change { color: #aaf; background: #007; }
.CodeRay .head { color: #f8f; background: #505; }
.CodeRay .insert .insert { color: #080; }
.CodeRay .delete .delete { color: #800; }
.CodeRay .change .change { color: #66f; }
.CodeRay .head .head { color: #f4f; }

</style> </head> <body class="book toc2 toc-left"> <div id="header"> <h1>Contributing to Infinispan</h1> <span id="author" class="author">Manik Surtani, Mircea Markus, Galder Zamarre√±o, Pete Muir, and others from the Infinispan community</span><br> <div id="toc" class="toc2"> <div id="toctitle">Table of Contents</div> <ul class="sectlevel1"> <li><a href="#_the_basics">1. The Basics</a></li> <li> <ul class="sectlevel2"> <li><a href="#_prequisites">1.1. Prequisites</a></li> <li><a href="#_issue_management">1.2. Issue Management</a></li> <li> <ul class="sectlevel3"> <li><a href="#_reporting_issues">1.2.1. Reporting Issues</a></li> <li><a href="#_versioning_guidelines">1.2.2. Versioning Guidelines</a></li> </ul> </li> <li><a href="#_version_control">1.3. Version control</a></li> <li> <ul class="sectlevel3"> <li><a href="#_setting_up_your_ide">1.3.1. Setting up your IDE</a></li> </ul> </li> <li><a href="#_builds">1.4. Builds</a></li> <li> <ul class="sectlevel3"> <li><a href="#_continuous_integration">1.4.1. Continuous Integration</a></li> </ul> </li> <li><a href="#_testing">1.5. Testing</a></li> <li><a href="#_communicating_with_other_infinispan_contributors">1.6. Communicating with other Infinispan contributors</a></li> <li><a href="#_style_requirements">1.7. Style Requirements</a></li> <li> <ul class="sectlevel3"> <li><a href="#_spelling">1.7.1. Spelling</a></li> <li><a href="#_check_in_comments">1.7.2. Check-in comments</a></li> </ul> </li> <li><a href="#_logging">1.8. Logging</a></li> </ul> </li> <li><a href="#_source_control">2. Source Control</a></li> <li> <ul class="sectlevel2"> <li><a href="#_prerequisites">2.1. Prerequisites</a></li> <li><a href="#_repositories">2.2. Repositories</a></li> <li><a href="#_roles">2.3. Roles</a></li> <li> <ul class="sectlevel3"> <li><a href="#_contributor">2.3.1. Contributor</a></li> <li><a href="#_project_admin">2.3.2. Project Admin</a></li> <li><a href="#_release_branches">2.3.3. Release branches</a></li> <li><a href="#_topic_branches">2.3.4. Topic branches</a></li> <li><a href="#_comments">2.3.5. Comments</a></li> <li><a href="#_commits">2.3.6. Commits</a></li> </ul> </li> <li><a href="#_keeping_your_repo_in_sync_with_upstream">2.4. Keeping your repo in sync with upstream</a></li> <li> <ul class="sectlevel3"> <li><a href="#_if_you_have_cloned_upstream">2.4.1. If you have cloned upstream</a></li> <li><a href="#link_ifyouhaveforkedupstream">2.4.2. If you have forked upstream</a></li> </ul> </li> <li><a href="#_tips_on_enhancing_git">2.5. Tips on enhancing git</a></li> <li> <ul class="sectlevel3"> <li><a href="#_completions">2.5.1. Completions</a></li> <li><a href="#sid-68355157_ContributingtoInfinispan-Terminalcolours">2.5.2. Terminal colors</a></li> <li><a href="#_aliases">2.5.3. Aliases</a></li> <li><a href="#_visual_history">2.5.4. Visual History</a></li> <li><a href="#_visual_diff_and_merge_tools">2.5.5. Visual diff and merge tools</a></li> <li><a href="#_choosing_an_editor">2.5.6. Choosing an Editor</a></li> <li><a href="#_shell_prompt">2.5.7. Shell prompt</a></li> </ul> </li> </ul> </li> <li><a href="#_building_infinispan">3. Building Infinispan</a></li> <li> <ul class="sectlevel2"> <li><a href="#_requirements">3.1. Requirements</a></li> <li><a href="#_maven">3.2. Maven</a></li> <li> <ul class="sectlevel3"> <li><a href="#_quick_command_reference">3.2.1. Quick command reference</a></li> <li><a href="#_publishing_releases_to_maven">3.2.2. Publishing releases to Maven</a></li> <li><a href="#_the_maven_archetypes">3.2.3. The Maven Archetypes</a></li> </ul> </li> </ul> </li> <li><a href="#_api_commons_and_core">4. API, Commons and Core</a></li> <li> <ul class="sectlevel2"> <li><a href="#_api">4.1. API</a></li> <li><a href="#_commons">4.2. Commons</a></li> <li><a href="#_core">4.3. Core</a></li> </ul> </li> <li><a href="#_running_and_writing_tests">5. Running and Writing Tests</a></li> <li> <ul class="sectlevel2"> <li><a href="#_running_the_tests">5.1. Running the tests</a></li> <li> <ul class="sectlevel3"> <li><a href="#_specifying_which_tests_to_run">5.1.1. Specifying which tests to run</a></li> <li><a href="#_skipping_the_test_run">5.1.2. Skipping the test run</a></li> <li><a href="#_running_tests_using_code_parameters_code">5.1.3. Running tests using <code>@Parameters</code></a></li> <li><a href="#_enabling_trace_in_test_logs">5.1.4. Enabling TRACE in test logs</a></li> <li><a href="#_enabling_code_coverage_generation">5.1.5. Enabling code coverage generation</a></li> </ul> </li> <li><a href="#_test_groups">5.2. Test groups</a></li> <li> <ul class="sectlevel3"> <li><a href="#_which_group_should_i_use">5.2.1. Which group should I use?</a></li> </ul> </li> <li><a href="#_test_permutations">5.3. Test permutations</a></li> <li> <ul class="sectlevel3"> <li><a href="#_running_permutations_manually_or_in_an_ide">5.3.1. Running permutations manually or in an IDE</a></li> </ul> </li> <li><a href="#_the_parallel_test_suite">5.4. The Parallel Test Suite</a></li> <li> <ul class="sectlevel3"> <li><a href="#_tips_for_writing_and_debugging_parallel_tests">5.4.1. Tips for writing and debugging parallel tests</a></li> </ul> </li> </ul> </li> <li><a href="#_helping_others_out">6. Helping Others Out</a></li> <li><a href="#_adding_configuration">7. Adding Configuration</a></li> <li> <ul class="sectlevel2"> <li><a href="#_adding_a_property">7.1. Adding a property</a></li> <li><a href="#_adding_a_group">7.2. Adding a group</a></li> <li><a href="#_don_t_forget_to_update_the_xsd_and_xsd_test">7.3. Don&#8217;t forget to update the XSD and XSD test</a></li> <li><a href="#_bridging_to_the_old_configuration">7.4. Bridging to the old configuration</a></li> </ul> </li> <li><a href="#_writing_documentation_and_faqs">8. Writing Documentation and FAQs</a></li> <li> <ul class="sectlevel2"> <li><a href="#_practicalities">8.1. Practicalities</a></li> <li> <ul class="sectlevel3"> <li><a href="#_style_guide">8.1.1. Style guide</a></li> <li><a href="#_editing">8.1.2. Editing</a></li> <li><a href="#_linefeed">8.1.3. Linefeed</a></li> <li><a href="#_end_of_file">8.1.4. End of file</a></li> <li><a href="#_diagrams">8.1.5. Diagrams</a></li> <li><a href="#_live_editing">8.1.6. Live editing</a></li> </ul> </li> <li><a href="#_who_can_contribute_documentation">8.2. Who can contribute documentation?</a></li> <li><a href="#_layout">8.3. Layout</a></li> <li> <ul class="sectlevel3"> <li><a href="#_what_goes_where">8.3.1. What goes where?</a></li> <li><a href="#_headers_page_structure_and_the_table_of_contents">8.3.2. Headers, Page Structure and the Table of Contents</a></li> <li><a href="#_images_and_other_media">8.3.3. Images and other media</a></li> <li><a href="#_code_samples">8.3.4. Code samples</a></li> <li><a href="#_versioning">8.3.5. Versioning</a></li> </ul> </li> <li><a href="#_voice_and_grammar_guide">8.4. Voice and grammar guide</a></li> <li> <ul class="sectlevel3"> <li><a href="#_colloquialisms">8.4.1. Colloquialisms</a></li> </ul> </li> <li><a href="#_glossary_and_faqs">8.5. Glossary and FAQs</a></li> </ul> </li> </ul> </div> </div> <div id="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Feel like contributing to Infinispan? This guide will help you set up your environment, walk you through best practices, and help you debug, improve and add features to Infinispan.</p> </div> </div> </div> <div class="sect1"> <h2 id="_the_basics"><a class="anchor" href="#_the_basics"></a>1. The Basics</h2> <div class="sectionbody"> <div class="paragraph"> <p>In this chapter we quickly walk through the basics on contributing; future chapters go into more depth.</p> </div> <div class="sect2"> <h3 id="_prequisites"><a class="anchor" href="#_prequisites"></a>1.1. Prequisites</h3> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:50%;"> <col style="width:50%;"> </colgroup> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Java 7</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Infinispan is baselined on Java 6, however building it requires Java 7 (we build with Oracle JDK, OpenJDK and IBM JDK)</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Maven 3</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The Infinispan build uses Maven, and we recommend using Maven 3.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Git</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The Infinispan source code is stored in Git.</p></td> </tr> </tbody> </table> </div> <div class="sect2"> <h3 id="_issue_management"><a class="anchor" href="#_issue_management"></a>1.2. Issue Management</h3> <div class="paragraph"> <p>Infinispan uses JIRA for issue management, hosted on <a href="http://issues.jboss.org/browse/ISPN">issues.jboss.org</a>. You can log in using your jboss.org username and password.</p> </div> <div class="sect3"> <h4 id="_reporting_issues"><a class="anchor" href="#_reporting_issues"></a>1.2.1. Reporting Issues</h4> <div class="paragraph"> <p>If you need to create a new issue then follow these steps.</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Choose between</p> <div class="ulist"> <ul> <li> <p><em>Feature Request</em> if you want to request an enhancement or new feature for Infinispan</p> </li> <li> <p><em>Bug</em> if you have discovered an issue</p> </li> <li> <p><em>Task</em> if you wish to request a documentation, sample or process (e.g. build system) enhancement or issue</p> </li> </ul> </div> </li> <li> <p>Then enter a <em>Summary</em> , describing briefly the problem - please try to be descriptive!</p> </li> <li> <p>You should <strong>not</strong> set <em>Priority</em>.</p> </li> <li> <p>Now, enter the version you are reporting an issue against in the <em>Affects Version</em> field, and leave the <em>Fix Version</em> field blank.</p> </li> <li> <p>In the <em>Environment</em> text area, provide as much detail as possible about your environment (e.g. Java runtime and version, operating system, any network topology which is relevant).</p> </li> <li> <p>In the <em>Description</em> field enter a detailed description of your problem or request.</p> </li> <li> <p>If the issue has been discussed on the forums or the mailing list, enter a reference in the <em>Forum Reference</em> field</p> </li> <li> <p>Finally, hit <em>Create</em></p> </li> </ol> </div> </div> <div class="sect3"> <h4 id="_versioning_guidelines"><a class="anchor" href="#_versioning_guidelines"></a>1.2.2. Versioning Guidelines</h4> <div class="admonitionblock warning"> <table> <tr> <td class="icon"> <i class="icon-warning" title="Warning"></i> </td> <td class="content"> <div class="literalblock"> <div class="content"> <pre>Only Infinispan contributors should set the _Fix Version_ field.</pre> </div> </div> </td> </tr> </table> </div> <div class="paragraph"> <p>When setting the <em>Fix Version</em> field for bugs and issues in JIRA, the following guidelines apply: Version numbers are defined as <code>${major}.${minor}.${micro}.${modifier}</code>. For example, <code>4.1.0.Beta1</code> would be:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:50%;"> <col style="width:50%;"> </colgroup> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">major</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">minor</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">micro</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">modifier</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Beta1</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>If the issue relates to a <em>Task</em> or <em>Feature Request</em>, please ensure that the <code>.Final</code> version is included in the <em>Fixed In</em> field. For example, a new feature should contain <code>4.1.0.Beta1</code>, <code>4.1.0.Final</code> if it is new for 4.1.0 and was first made public in beta1. For example, see <a href="https://issues.jboss.org/browse/ISPN-299">ISPN-299</a> .</p> </div> <div class="paragraph"> <p>If the issue relates to a bug which affected a previous Final version, then the <em>Fixed In</em> field should also contain the Final version which contains the fix, in addition to any Alpha, Beta or CR release. For example, see <a href="https://issues.jboss.org/browse/ISPN-546">ISPN-546</a>. If the issue pertains to a bug in the current release, then the Final version should not be in the <em>Fixed In</em> field. For example, a bug found in 4.1.0.Alpha2 (but not in 4.1.0.Alpha1) should be marked as fixed in 4.1.0.Alpha3, but not in 4.1.0.Final. For example, see <a href="https://issues.jboss.org/browse/ISPN-416">ISPN-416</a>.</p> </div> </div> </div> <div class="sect2"> <h3 id="_version_control"><a class="anchor" href="#_version_control"></a>1.3. Version control</h3> <div class="paragraph"> <p>Infinispan uses <a href="http://git-scm.com">git</a>, hosted on <a href="http://github.com">GitHub</a>, for version control. You can find the upstream git repository at <a href="https://github.com/infinispan">https://github.com/infinispan</a>. To clone the repository:</p> </div> <div class="listingblock"> <div class="content"> <pre>$ git clone git@github.com:infinispan/infinispan.git</pre> </div> </div> <div class="paragraph"> <p>or to clone your fork:</p> </div> <div class="listingblock"> <div class="content"> <pre>$ git clone git@github.com:YOUR_GITHB_USERNAME/infinispan.git</pre> </div> </div> <div class="sect3"> <h4 id="_setting_up_your_ide"><a class="anchor" href="#_setting_up_your_ide"></a>1.3.1. Setting up your IDE</h4> <div class="paragraph"> <p>Maven supports generating IDE configuration files for easy setup of a project. This is tested on Eclipse, IntelliJ IDEA and Netbeans.</p> </div> <div class="sect4"> <h5 id="_eclipse"><a class="anchor" href="#_eclipse"></a>Eclipse</h5> <div class="paragraph"> <p>Before we import the project, we need to clone the project as described above.</p> </div> <div class="paragraph"> <p>1. Install the m2eclipse plugin if you have not already installed it. This is bundled with Eclipse from version "Indigo" 3.7. For older versions follow instructions on <a href="http://eclipse.org/m2e/">http://eclipse.org/m2e/</a>.</p> </div> <div class="paragraph"> <p>2. Import the Infinispan maven project. Select File &#8594; Import in your eclipse workbench. Select the Existing Maven Project importer.</p> </div> <div class="imageblock"> <div class="content"> <img src="images/import_maven1.png" alt="import maven1"> </div> </div> <div class="paragraph"> <p>3. Select the root directory of your Infinispan checkout.</p> </div> <div class="imageblock"> <div class="content"> <img src="images/import_maven2.png" alt="import maven2"> </div> </div> <div class="paragraph"> <p>4. Select Infinispan modules that you want to import.</p> </div> <div class="paragraph"> <p>5. Finally, from Infinispan 5.0 onwards, annotation processing is used to allow log messages to be internationalized. This processing can be done directly from Eclipse as part of compilation but it requires some set up:</p> </div> <div class="paragraph"> <p>5.1. Open the properties for infinispan-core and locate Annotation Processing</p> </div> <div class="paragraph"> <p>5.2. Tick Enable project specific settings</p> </div> <div class="paragraph"> <p>5.3. Enter <code>target/generated-sources/annotations</code> as the <code>Generated source</code> directory</p> </div> <div class="imageblock"> <div class="content"> <img src="images/ann_proc_eclipse.png" alt="ann proc eclipse"> </div> </div> <div class="paragraph"> <p>6. Code Formatting. From the menu Window &#8594; Preferences &#8594; Java &#8594; Code Style &#8594; Formatter. Import <a href="https://raw.github.com/infinispan/infinispan/master/ide-settings/eclipse/formatter.xml">formatter.xml</a></p> </div> <div class="paragraph"> <p>7. Code templates. From the menu Window &#8594; Preferences &#8594; Java &#8594; Code Style &#8594; Code Templates. Import <a href="https://raw.github.com/infinispan/infinispan/master/ide-settings/eclipse/codetemplates.xml">codetemplates.xml</a></p> </div> <div class="paragraph"> <p>Some modules use Scala, if you plan contributing to one of these modules it&#8217;s worth installing the <a href="http://www.scala-lang.org/node/94">Scala tools</a> .</p> </div> </div> <div class="sect4"> <h5 id="_intellij_idea"><a class="anchor" href="#_intellij_idea"></a>IntelliJ IDEA</h5> <div class="sect5"> <h6 id="_importing"><a class="anchor" href="#_importing"></a>Importing</h6> <div class="paragraph"> <p>When you start <a href="http://www.jetbrains.com/idea/">IntelliJ IDEA</a>, you will be greeted by a screen as shown below:</p> </div> <div class="imageblock"> <div class="content"> <img src="images/idea-12-import.jpg" alt="idea 12 import"> </div> </div> <div class="paragraph"> <p>If you have already obtained a copy of the Infinispan sources via Github (see <em>'Source Control'</em>), then follow: <em>Import Project &#8594; /directory/to/downloaded/sources</em> . IntelliJ will automatically make use of Maven to import the project since it will detect a <code>pom.xml</code> file in the base directory.</p> </div> <div class="paragraph"> <p>If you have not obtained the sources already, you can use the Git integration in IntelliJ IDEA 12. Click on <em>Check out from Version Control &#8594; Github</em>. After entering your Github credentials, you will then be prompted to enter the git repository URL along with the location that you want to check out the source code to.</p> </div> <div class="imageblock"> <div class="content"> <img src="images/idea-12-git.png" alt="idea 12 git"> </div> </div> </div> <div class="sect5"> <h6 id="_compiler_settings"><a class="anchor" href="#_compiler_settings"></a>Compiler settings</h6> <div class="paragraph"> <p>From Infinispan 5.0 onwards, annotation processing is used to allow log messages to be internationalized. This processing can be done directly from IntelliJ as part of compilation but it requires some set up:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Go to Preferences &#8594; Compiler &#8594; Annotation Processor" and click on <em>Enable annotation processing</em></p> </li> <li> <p>Add an annotation processor with "Processor FQN Name" as <code>org.jboss.logging.LoggingToolsProcessor</code></p> </li> <li> <p>In "Processed Modules", add all modules except the root and the parent modules.</p> </li> </ol> </div> <div class="imageblock"> <div class="content"> <img src="images/idea-12-annotations.png" alt="idea 12 annotations"> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> There can sometimes be issues with the generated logging classes on rebuild (particularly when you switch Git branches). If these issues do crop up then simply run <code>mvn clean install -DskipTests</code> on the command line to clear them out. </td> </tr> </table> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> If you are running a multi-core environment (e.g. quad-core or above) then you can follow the instructions on making use of parallelized compilation in IntelliJ 12. Information on how to do this can be found <a href="http://blogs.jetbrains.com/idea/2012/12/intellij-idea-12-compiler-twice-as-fast/">here</a> . </td> </tr> </table> </div> </div> <div class="sect5"> <h6 id="_scala_plugin"><a class="anchor" href="#_scala_plugin"></a>Scala Plugin</h6> <div class="paragraph"> <p>You will need to download the Scala plugin for IntelliJ as well. This can be done in <em>Project Settings &#8594; Plugins &#8594; Browse Repositories</em>. Then run a search for <em>Scala</em>. JetBrains themselves are the vendor for this plugin and more information on it can be found <a href="http://confluence.jetbrains.net/display/SCA/Scala+Plugin+for+IntelliJ+IDEA">here</a> .</p> </div> <div class="imageblock"> <div class="content"> <img src="images/idea-12-scala.png" alt="idea 12 scala"> </div> </div> <div class="paragraph"> <p>You will then have to configure the Scala plugin to use the Scala compiler for Scala files and the Java compiler for Java files. You can do this by going into <em>Settings &#8594; Compiler &#8594; Scala Compiler</em> . Be sure to add the Scala compiler bundle as shown in the screenshot below.</p> </div> <div class="imageblock"> <div class="content"> <img src="images/idea-12-scala2.png" alt="idea 12 scala2"> </div> </div> </div> <div class="sect5"> <h6 id="_code_style"><a class="anchor" href="#_code_style"></a>Code Style</h6> <div class="paragraph"> <p>Download the code style JAR file from <a href="https://github.com/infinispan/infinispan/blob/master/ide-settings/intellij/IntelliJ_IDEA_Code_Style.jar?raw=true">here</a> and import this into IntelliJ IDEA.</p> </div> </div> </div> </div> </div> <div class="sect2"> <h3 id="_builds"><a class="anchor" href="#_builds"></a>1.4. Builds</h3> <div class="paragraph"> <p>Infinispan uses <a href="http://maven.apache.org/">Maven</a> for builds. Make sure you have Maven 3 installed, and properly configured. For more information, read <a href="#_building_infinispan">the Maven chapter</a>.</p> </div> <div class="sect3"> <h4 id="_continuous_integration"><a class="anchor" href="#_continuous_integration"></a>1.4.1. Continuous Integration</h4> <div class="paragraph"> <p>Infinispan uses <a href="http://www.jetbrains.com/teamcity">TeamCity</a> for continuous integration. TeamCity polls GitHub for updates and runs whenever updates are available. You can check the status of the latest builds <a href="http://ci.infinispan.org/overview.html">here</a> .</p> </div> </div> </div> <div class="sect2"> <h3 id="_testing"><a class="anchor" href="#_testing"></a>1.5. Testing</h3> <div class="paragraph"> <p>Infinispan uses <a href="http://testng.org/doc/index.html">TestNG</a> for unit and functional tests, and all Infinispan tests are run in parallel. For more information see the chapter on the test suite; this chapter gives advice on writing tests which can safely execute in parallel.</p> </div> </div> <div class="sect2"> <h3 id="_communicating_with_other_infinispan_contributors"><a class="anchor" href="#_communicating_with_other_infinispan_contributors"></a>1.6. Communicating with other Infinispan contributors</h3> <div class="paragraph"> <p>Infinispan contributors use a mix of technologies to communicate. Visit <a href="http://infinispan.github.io/forums.html">this page</a> to learn more.</p> </div> </div> <div class="sect2"> <h3 id="_style_requirements"><a class="anchor" href="#_style_requirements"></a>1.7. Style Requirements</h3> <div class="paragraph"> <p>Infinispan uses the <a href="http://en.wikipedia.org/wiki/Indent_style#K.26R_style">K&amp;R code style</a> for all Java source files, with two exceptions:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>use 3 spaces instead of a tab character for indentations.</p> </li> <li> <p>braces start on the same line for class, interface and method declarations as well as code blocks.</p> </li> </ol> </div> <div class="paragraph"> <p>In addition, sure all <a href="http://en.wikipedia.org/wiki/Newline">new line characters</a> used must be LF (UNIX style line feeds). Most good IDEs allow you to set this, regardless of operating system used.</p> </div> <div class="paragraph"> <p>All patches or code committed must adhere to this style. Code style settings which can be imported into IntelliJ IDEA and Eclipse are committed in the project sources, in <a href="https://github.com/infinispan/infinispan/blob/master/ide-settings/">ide-settings</a> .</p> </div> <div class="sect3"> <h4 id="_spelling"><a class="anchor" href="#_spelling"></a>1.7.1. Spelling</h4> <div class="paragraph"> <p>Ensure correct spelling in code, comments, Javadocs, etc. (use <em>American English</em> spelling). It is recommended that you use a spellchecker plugin for your IDE.</p> </div> </div> <div class="sect3"> <h4 id="_check_in_comments"><a class="anchor" href="#_check_in_comments"></a>1.7.2. Check-in comments</h4> <div class="paragraph"> <p>Please ensure any commit comments use <a href="#_comments">this format</a> if related to a task or issue in JIRA. This helps JIRA pick out these checkins and display them on the issue, making it very useful for back/forward porting fixes. If your comment does not follow this format, your commit may not be merged into upstream.</p> </div> </div> </div> <div class="sect2"> <h3 id="_logging"><a class="anchor" href="#_logging"></a>1.8. Logging</h3> <div class="paragraph"> <p>Infinispan follows the JBoss logging standards, which can be found <a href="https://community.jboss.org/wiki/LoggingStandards">here</a> .</p> </div> <div class="paragraph"> <p>From Infinispan 5.0 onwards, Infinispan uses JBoss Logging to abstract over the logging backend. Infinispan supports localization of log message for categories of INFO or above as explained in <a href="http://community.jboss.org/docs/16738">the JBoss Logging guidelines</a> . As a developer, this means that for each INFO, WARN, ERROR and FATAL message your code emits, you need to modify the Log class in your module and add an explicit method for it with the right annotations.</p> </div> <div class="paragraph"> <p>For example:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay"><code class="java language-java">
<span class="annotation">@LogMessage</span>(level = INFO)
<span class="annotation">@Message</span>(value = <span class="string"><span class="delimiter">&quot;</span><span class="content">An informative message: %s - %s</span><span class="delimiter">&quot;</span></span>, id = <span class="integer">600</span>)
<span class="type">void</span> fiveTransactionsHaveCompleted(<span class="predefined-type">String</span> param1, <span class="predefined-type">String</span> param2);
</code></pre> </div> </div> <div class="paragraph"> <p>And then, instead of calling <code>log.info(...)</code>, you call the method, for example <code>log.fiveTransactionsHaveCompleted(param1, param2)</code>. If what you&#8217;re trying to log is an error or similar message and you want an exception to be logged as cause, simply use <code>@Cause</code> annotation:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay"><code class="java language-java">
<span class="annotation">@LogMessage</span>(level = ERROR)
<span class="annotation">@Message</span>(value = <span class="string"><span class="delimiter">&quot;</span><span class="content">An error message: %s</span><span class="delimiter">&quot;</span></span>, id = <span class="integer">600</span>)
<span class="type">void</span> anErrorMessage(<span class="predefined-type">String</span> param1, <span class="annotation">@Cause</span> <span class="exception">IllegalStateException</span> e);
</code></pre> </div> </div> <div class="paragraph"> <p>The last thing to figure out is which id to give to the message. Each module that logs something in production code that could be internationalized has been given an id range, and so the messages should use an available id in the range for the module where the log call resides. Here are the id range assignments per module:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:50%;"> <col style="width:50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Module name</th> <th class="tableblock halign-left valign-top">Id range</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">core</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">1 - 1000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">tree</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">2001 - 3000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">bdbje cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">2001 - 3000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">cassandra cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">3001 - 4000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">hotrod client</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">4001 - 5000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">server core</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">5001 - 6000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">server hotrod</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">6001 - 7000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">cloud cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">7001 - 8000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">jdbc cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">8001 - 9000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">jdbm cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">9001 - 10000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">remote cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">10001 - 11000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">server memcached</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">11001 - 12000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">server rest</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">12001 - 13000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">server websocket</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">13001 - 14000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">query</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">14001 - 15000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">lucene directory</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">15001 - 16000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">rhq plugin</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">16001 - 17000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">cdi integration</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">17001 - 18000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">hbase cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">18001 - 19000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">cli interpreter</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">19001 - 20000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">cli client</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">20001 - 21000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">mongodb cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">21001 - 22000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">jpa cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">22001 - 23000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">leveldb cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">23001 - 24000</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">couchbase cache store</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">24001 - 25000</p></td> </tr> </tbody> </table> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="icon-note" title="Note"></i> </td> <td class="content"> When editing the above table, remember to update the README-i18n.txt file in the project sources! </td> </tr> </table> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="icon-note" title="Note"></i> </td> <td class="content"> You will need to enable annotation processing in order to be able to compile Infinispan and have the logger implementation generated. </td> </tr> </table> </div> </div> </div> </div> <div class="sect1"> <h2 id="_source_control"><a class="anchor" href="#_source_control"></a>2. Source Control</h2> <div class="sectionbody"> <div class="paragraph"> <p>In this chapter we discuss how to interact with Infinispan&#8217;s source control repository.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="icon-note" title="Note"></i> </td> <td class="content"> As a convention, <em>upstream</em> is used as the name of the <a href="http://github.com/infinispan/infinispan">http://github.com/infinispan/infinispan</a> repository. This repository is the canonical repository for Infinispan. We usually name <em>origin</em> the fork on <a href="https://github.com">GitHub</a> of each contributor. So the exact meaning of <em>origin</em> is relative to the developer: you could think of <em>origin</em> as your own fork. </td> </tr> </table> </div> <div class="sect2"> <h3 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>2.1. Prerequisites</h3> <div class="paragraph"> <p>This document assumes some working knowledge of git. We recommend Scott Chacon&#8217;s excellent <a href="http://progit.org/">Pro Git</a> as a valuable piece of background reading. The book is released under the Creative Commons license and can be downloaded in electronic form for free. At very least, we recommend that you read <a href="http://progit.org/book/ch2-0.html">Chapter 2</a>, <a href="http://progit.org/book/ch3-0.html">Chapter 3</a> and <a href="http://progit.org/book/ch5-0.html">Chapter 5</a> of <em>Pro Git</em> before proceeding.</p> </div> </div> <div class="sect2"> <h3 id="_repositories"><a class="anchor" href="#_repositories"></a>2.2. Repositories</h3> <div class="paragraph"> <p>Infinispan uses <a href="http://github.com/infinispan/infinispan">http://github.com/infinispan/infinispan</a> as its canonical repository, and this repository contains the stable code on master as well as the maintenance branches for previous minor versions (e.g., 5.0.x, 4.2.x, 4.1.x, etc)</p> </div> <div class="paragraph"> <p>Typically, only <em>Project Admins</em> would be able to push to this repository while all else may clone or fork the repository.</p> </div> </div> <div class="sect2"> <h3 id="_roles"><a class="anchor" href="#_roles"></a>2.3. Roles</h3> <div class="paragraph"> <p>The project assumes one of 2 <em>roles</em> an individual may assume when interacting with the Infinispan codebase. The 2 roles here are:</p> </div> <div class="ulist"> <div class="title">Roles</div> <ul> <li> <p><em>Contributor</em></p> </li> <li> <p><em>Project Admin</em> (typically, no more than a small handful of people)</p> </li> </ul> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="icon-note" title="Note"></i> </td> <td class="content"> None of the roles assume that you are a Red Hat employee. All it assumes is how much responsibility over the project has been granted to you. Typically, someone may be in more than one role at any given time, and puts on a different "hats" based on the task at hand. </td> </tr> </table> </div> <div class="sect3"> <h4 id="_contributor"><a class="anchor" href="#_contributor"></a>2.3.1. Contributor</h4> <div class="paragraph"> <p>A contributor will only ever submit patches via GitHub&#8217;s <em>pull request</em> mechanism.</p> </div> <div class="paragraph"> <p>Contributors should <em>always</em> fork the upstream project on GitHub and work off a clone of this fork.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="icon-note" title="Note"></i> </td> <td class="content"> All Infinispan core developers are considered contributors and work off personal forks of the upstream repository. This allows for complex features to be developed in parallel without tripping up over one another. This process is certainly not restricted to just Infinispan core developers; any contributor should also participate in this manner. </td> </tr> </table> </div> <div class="sect4"> <h5 id="_creating_a_pull_request_on_github"><a class="anchor" href="#_creating_a_pull_request_on_github"></a>Creating a pull request on GitHub</h5> <div class="imageblock"> <div class="content"> <img src="images/git_wf_2.png" alt="git wf 2"> </div> </div> <div class="paragraph"> <p>In this workflow, the contributor forks the Infinispan upstream repository on GitHub, clones their fork, and makes changes to this private fork. When changes have been tested and are ready to be contributed back to the project, a <em>pull request</em> is issued via GitHub so that one of the <em>Project Administrators</em> can pull in the change.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="icon-note" title="Note"></i> </td> <td class="content"> <div class="title">Topic Branches</div> It is desirable to work off a <em>topic branch</em>, even when using your own, forked repository. A topic branch is created for every feature or bug fix you do. Typically you would create one topic branch per issue, but if several patches are related it&#8217;s acceptable to have several commits in the same branch; however different changes should always be identified by different commits.¬† </td> </tr> </table> </div> <div class="paragraph"> <p>Before you push your work onto your fork of the repository on GitHub (your <em>origin</em>), it is often a good idea to review your commits. Consolidating them (squashing) or breaking them up as necessary and cleaning up commit messages should all be done while still working off your local clone. Also, prior to issuing a pull request, you should make sure you rebase your branch against the upstream branch you expect it to be merged into.¬† Also, only submit pull requests for your topic branch - not for your master!</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> The section on <em>Public Small Project</em> in <a href="http://progit.org/book/ch5-2.html">Chapter 5, Section 2</a> of Pro Git has more information on this style of workflow. </td> </tr> </table> </div> <div class="sect5"> <h6 id="_a_worked_example"><a class="anchor" href="#_a_worked_example"></a>A worked example</h6> <div class="olist arabic"> <ol class="arabic"> <li> <p>Make sure your master is synced up with upstream. See <a href="#link_ifyouhaveforkedupstream">this section</a> for how to do this</p> </li> <li> <p>Create new branch for your topic and switch to it. For the example issue, ISPN-1234:</p> <div class="literalblock"> <div class="content"> <pre>git checkout -b t_ISPN-12345 master</pre> </div> </div> </li> <li> <p>Do your work. Test. Repeat</p> </li> <li> <p>Commit your work on your topic branch</p> </li> <li> <p>Push your topic branch to GitHub. For example:</p> <div class="literalblock"> <div class="content"> <pre>git push origin t_ISPN-12345</pre> </div> </div> </li> <li> <p>Issue a pull request using the <a href="http://help.github.com/send-pull-requests/">GitHub pull request system</a></p> </li> <li> <p>Once your pull request has been applied upstream, delete the topic branch both locally and on your fork. For example:</p> <div class="literalblock"> <div class="content"> <pre>git branch -d t_ISPN-12345 &amp;&amp; git push origin :t_ISPN-12345</pre> </div> </div> </li> <li> <p>Sync with upstream again so that your changes now appear in your master branch</p> </li> </ol> </div> <div class="paragraph"> <p>If your topic branch has been open for a while and you are afraid changes upstream may clash with your changes, it makes sense to rebase your topic branch before you issue a pull request. To do this:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Sync your master branch with upstream</p> <div class="literalblock"> <div class="content"> <pre>git checkout master
git pull upstream master</pre> </div> </div> </li> <li> <p>Switch to your topic branch. For example:</p> <div class="literalblock"> <div class="content"> <pre>git checkout t_ISPN-12345</pre> </div> </div> </li> <li> <p>Rebase your topic branch against master:</p> <div class="literalblock"> <div class="content"> <pre>git rebase master</pre> </div> </div> </li> <li> <p>During the rebase process you might need to fix conflicts</p> </li> <li> <p>When you&#8217;re done test your code again.</p> </li> <li> <p>Push your rebased topic branch to your repo on GitHub (you will likely need to force this with the -f option).</p> <div class="literalblock"> <div class="content"> <pre>git push -f origin ISPN-12345</pre> </div> </div> </li> <li> <p>Continue your work on your topic branch.</p> </li> </ol> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> If you are sharing your forked Infinispan repo with others, then do not rebase! Use a merge instead. </td> </tr> </table> </div> </div> </div> <div class="sect4"> <h5 id="_multi_step_coordination_between_developers_using_forked_repositories"><a class="anchor" href="#_multi_step_coordination_between_developers_using_forked_repositories"></a>Multi-step coordination between developers using forked repositories</h5> <div class="paragraph"> <p>Sometimes a feature/task is rather complex to implement and requires competence from multiple areas of the projects. In such occasions it is not uncommon for developers to coordinate feature implementation using personal forks of Infinispan prior to finally issuing request to integrate into Infinispan main repository on GitHub.</p> </div> <div class="paragraph"> <p>For example, developer A using his personal Infinispan fork creates a topic branch T and completes as much work as he/she can before requesting for assistance from developer B. Developer A pushes topic T to his personal Infinispan fork where developer B picks it up and brings it down to his local repo. Developer B then in turn completes necessary work, commits his/her changes on branch T, and finally pushes back T to his own personal fork. After issuing request for pull to developer A, developer B waits for notification that developer A integrated his changes. This exchange can be repeated as much as it is necessary and can involve multiple developers.</p> </div> <div class="sect5"> <h6 id="_a_worked_example_2"><a class="anchor" href="#_a_worked_example_2"></a>A worked example</h6> <div class="paragraph"> <p>This example assumes that developer A and B have added each others Infinispan forked repositories with the <code>git add remote</code> command. For example, developer B would add developer A&#8217;s personal Infinispan fork repository with the command</p> </div> <div class="literalblock"> <div class="content"> <pre>git remote add devA https://github.com/developerA/infinispan.git</pre> </div> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Developer A starts implementing feature ISPN-244 and works on a local topic branch <code>t_ISPN244</code>. Developer A pushes <code>t_ISPN244</code> to personal Infinispan fork. For example:</p> <div class="literalblock"> <div class="content"> <pre>git push origin t_ISPN244</pre> </div> </div> </li> <li> <p>Developer B fetches branch <code>t_ISPN244</code> to local repository. For example:</p> <div class="literalblock"> <div class="content"> <pre>git fetch devA t_ispn244:my_t_ispn244</pre> </div> </div> </li> <li> <p>Developer B works on local branch <code>my_t_ispn244</code></p> </li> <li> <p>Developer B commits changes, pushes <code>my_t_ispn244</code> to own fork.</p> <div class="literalblock"> <div class="content"> <pre>git push origin my_t_ispn244</pre> </div> </div> </li> <li> <p>Developer B sends pull request to developer A to integrate changes from <code>my_t_ispn244</code> to <code>t_ispn244</code></p> </li> </ol> </div> </div> </div> </div> <div class="sect3"> <h4 id="_project_admin"><a class="anchor" href="#_project_admin"></a>2.3.2. Project Admin</h4> <div class="paragraph"> <p>Project Admins have a very limited role. Only Project Admins are allowed to push to upstream, and Project Admins <em>never</em> write any code directly on the upstream repository. All Project Admins do is pull in and merge changes from contributors (even if the "contributor" happens to be themselves) into upstream, perform code reviews and either commit or reject such changes.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="icon-note" title="Note"></i> </td> <td class="content"> All Contributors who are also Project Admins are encouraged to not merge their own changes, to ensure that all changes are reviewed by someone else. </td> </tr> </table> </div> <div class="paragraph"> <p>This approach ensures Infinispan maintains quality on the main code source tree, and allows for important code reviews to take place again ensuring quality. Further, it ensures clean and easily traceable code history and makes sure that more than one person knows about the changes being performed.</p> </div> <div class="sect4"> <h5 id="_handling_pull_requests"><a class="anchor" href="#_handling_pull_requests"></a>Handling pull requests</h5> <div class="imageblock"> <div class="content"> <img src="images/git_wf_3.png" alt="git wf 3"> </div> </div> <div class="paragraph"> <p>Project Admins are also responsible for responding to pull requests. When pulling in changes from a forked repository, more than a single commit may be pulled in. Again, this should be done on a newly created working branch, code reviewed, tested and cleaned up as necessary.</p> </div> <div class="paragraph"> <p>If commits need to be altered - e.g., rebasing to squash or split commits, or to alter commit messages - it is often better to contact the Contributor and ask the Contributor to do so and re-issue the pull request, since doing so on the upstream repo could cause update issues for other contributors later on. If commits were altered or three-way merge was performed during a merge instead of fast-forward, it&#8217;s also a good idea to check the log to make sure that the resulting repository history looks OK:</p> </div> <div class="listingblock"> <div class="content"> <pre>
$ git log --pretty=oneline --graph --abbrev-commit¬† # History messed up due to a bad merge
*¬†¬† 3005020 Merge branch 'ISPN-786' of git://github.com/Sanne/infinispan
|\¬†
| * e757265 ISPN-786 Make dependency to log4j optional¬† &lt;-- Same with cb4e5d6 - unnecessary
* | cb4e5d6 ISPN-786 Make dependency to log4j optional¬† &lt;-- Cherry-picked commit by other admin
|/
* ...

$ git reset cb4e5d6¬† # revert the bad merge
</pre> </div> </div> <div class="paragraph"> <p>It is therefore <em>strongly recommended</em> that you use the <a href="https://github.com/maniksurtani/githelpers/blob/master/project_admins/handle_pull_request"><code>handle_pull_request</code></a> script that ensures a clean merge. If you <em>still</em> wish to do this manually, please consider reading through the script first to get an idea of what needs to happen.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> More information on pulling changes from remote, forked repos can be found in <a href="http://progit.org/book/ch5-3.html">Chapter 5, Section 3</a> of Pro Git, under <em>Checking Out Remote Branches</em> . </td> </tr> </table> </div> <div class="sect5"> <h6 id="_possible_trouble_handling_pull_requests"><a class="anchor" href="#_possible_trouble_handling_pull_requests"></a>Possible trouble handling pull requests</h6> <div class="olist arabic"> <ol class="arabic"> <li> <p>If you have warnings about "Merge made by recursive" you have to fix it rebasing.</p> </li> <li> <p>If you have warnings about "non-fast-forward" you have to rebase.</p> </li> <li> <p>If you see "non-fast-forward updates were rejected" you <strong>must never</strong> use <code>--force</code> on upstream! It means that another patch was merged before you and you have to update your master again, and rebase again.</p> </li> <li> <p><code>--force</code> is allowed only in special maintenance circumstances. If you find you&#8217;re needing it to handle a pull request, then you&#8217;re doing it wrong, and the mistake might be a dangerous one! It&#8217;s like the good rule of never commit when you&#8217;re drunk (drunk coding, however, is allowed).</p> </li> </ol> </div> <div class="admonitionblock warning"> <table> <tr> <td class="icon"> <i class="icon-warning" title="Warning"></i> </td> <td class="content"> <div class="title">Never use <code>--force</code> on <code>git push</code></div> Using <code>--force</code> while pushing on a shared repository such as <em>upstream</em> you could effectively erase other committed patches. No one should ever use this option unless unanimously approved on the public mailing list: the most dangerous aspect of it is that nobody gets any notification if this happens, and we might think issues are solved but you silently removed the fix and it&#8217;s history from the repository. </td> </tr> </table> </div> </div> </div> <div class="sect4"> <h5 id="_cutting_releases"><a class="anchor" href="#_cutting_releases"></a>Cutting releases</h5> <div class="paragraph"> <p>Releases can only be cut by Project Admins, and must be done off a recently updated (<code>git fetch</code> and <code>git pull origin</code>) clone of the upstream repo. Infinispan&#8217;s <code>bin/release.py</code> script takes care of the rest.</p> </div> </div> </div> <div class="sect3"> <h4 id="_release_branches"><a class="anchor" href="#_release_branches"></a>2.3.3. Release branches</h4> <div class="paragraph"> <p>Infinispan has several main release branches. These are master (ongoing work on the current unstable release), and maintenance branches for previous minor releases (e.g., <code>5.0.x</code>, <code>4.2.x</code>, <code>4.1.x</code>). Work should never be committed directly to any of these release branches directly; topic branches should always be used for work, and these topic branches should be merged in using the process outlined above.</p> </div> </div> <div class="sect3"> <h4 id="_topic_branches"><a class="anchor" href="#_topic_branches"></a>2.3.4. Topic branches</h4> <div class="paragraph"> <p>Some of the biggest features of git are speed and efficiency of branching, and accuracy of merging. As a result, best practices involve making frequent use of branches. Creating several topic branches a day, even, should not be considered excessive, and working on several topic branches simultaneously again should be commonplace.</p> </div> <div class="paragraph"> <p><a href="http://progit.org/book/ch3-4.html">Chapter 3, Section 4</a> of Pro Git has a detailed discussion of topic branches. For Infinispan, it makes sense to create a topic branch and name it after the JIRA it corresponds to. (if it doesn&#8217;t correspond to a JIRA, a simple but descriptive name should be used).</p> </div> <div class="sect4"> <h5 id="_topic_branches_affecting_more_than_one_release_branch"><a class="anchor" href="#_topic_branches_affecting_more_than_one_release_branch"></a>Topic Branches Affecting More Than One Release Branch</h5> <div class="paragraph"> <p>Most topic branches will only affect a single release branch, e.g. features targeted at the current unstable release will only affect the master release branch. So a topic branch should be created based off master. However, occasionally, fixes may apply to both release branches 4.2.x as well as master. In this case, the following workflow should apply:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Create topic branch off 4.2.x. For example:</p> <div class="literalblock"> <div class="content"> <pre>git checkout -b &lt;topic&gt;_4.2.x 4.2.x</pre> </div> </div> </li> <li> <p>Create topic branch off master. For example:</p> <div class="literalblock"> <div class="content"> <pre>git checkout -b &lt;topic&gt;_master master</pre> </div> </div> </li> <li> <p>Do your work on <code>&lt;topic&gt;_master</code>, test and commit your fixes</p> </li> <li> <p>Switch to <code>&lt;topic&gt;_4.2.x</code>. For example:</p> <div class="literalblock"> <div class="content"> <pre>git checkout &lt;topic&gt;_4.2.x</pre> </div> </div> </li> <li> <p>Cherry-pick your commit from <code>&lt;topic&gt;_master</code> onto <code>&lt;topic&gt;_4.2.x</code>. For example:</p> <div class="literalblock"> <div class="content"> <pre>git cherry-pick &lt;commit_id&gt;</pre> </div> </div> </li> <li> <p>Test <code>&lt;topic&gt;_4.2.x</code> for correctness, modify as necessary</p> </li> <li> <p>Issue two separate pull requests for both branches</p> </li> </ol> </div> </div> </div> <div class="sect3"> <h4 id="_comments"><a class="anchor" href="#_comments"></a>2.3.5. Comments</h4> <div class="paragraph"> <p>It is <em>extremely important</em> that comments for each commit are clear and follow certain conventions. This allows for proper parsing of logs by git tools. Read <a href="http://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html">this article</a> on how to format comments for git and adhere to them. Further to the recommendations in the article, the short summary of the commit message should be in the following format:</p> </div> <div class="literalblock"> <div class="content"> <pre>ISPN-XXX Subject line of the JIRA in question</pre> </div> </div> <div class="paragraph"> <p>This can optionally be followed by a detailed explanation of the commit. Why it was done, how much of it was completed, etc. You may wish to express this as a list, for example:</p> </div> <div class="ulist"> <ul> <li> <p>Add a unit test</p> </li> <li> <p>Add more unit tests</p> </li> <li> <p>Fix regressions</p> </li> <li> <p>Solve major NP-Complete problems</p> </li> </ul> </div> <div class="paragraph"> <p>Make sure however to split separate concerns - especially if they are unrelated - in separate commits.</p> </div> </div> <div class="sect3"> <h4 id="_commits"><a class="anchor" href="#_commits"></a>2.3.6. Commits</h4> <div class="paragraph"> <p>Sometimes work on your topic branch may include several commits. For example, committing a test. Then committing another test. Then perhaps committing a fix. And perhaps fixing your own fix in the next commit&#8230; Before issuing a pull request for this topic branch, consider cleaning up these commits. Interactive rebasing helps you squash several commits into a single commit, which is often more coherent to deal with for others merging in your work. <a href="http://progit.org/book/ch6-4.html">Chapter 6, Section 4</a> of Pro Git has details on how to squash commits and generally, clean up a series of commits before sharing this work with others. Note that you can also easily reorder them, just change the order of lines during the interactive rebase process.</p> </div> <div class="paragraph"> <p>Also, it is important to make sure you don&#8217;t accidentally commit files for which no real changes have happened, but rather, whitespace has been modified. This often happens with some IDEs. <code>git diff --check</code> should be run before you issue such a pull request, which will check for such "noise" commits and warn you accordingly. Such files should be reverted and not be committed to the branch.</p> </div> <div class="paragraph"> <p>Adhering to <a href="chapter-1-The_Basics.html#_style_requirements">Infinispan&#8217;s code style</a> guidelines will help minimise "noise" commits. Project Admins are going to ask contributors to reformat their code if necessary.</p> </div> </div> </div> <div class="sect2"> <h3 id="_keeping_your_repo_in_sync_with_upstream"><a class="anchor" href="#_keeping_your_repo_in_sync_with_upstream"></a>2.4. Keeping your repo in sync with upstream</h3> <div class="sect3"> <h4 id="_if_you_have_cloned_upstream"><a class="anchor" href="#_if_you_have_cloned_upstream"></a>2.4.1. If you have cloned upstream</h4> <div class="paragraph"> <p>If you have a clone of the upstream, you may want to update it from time to time. Running:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ git fetch origin
$ git fetch origin --tags</pre> </div> </div> <div class="paragraph"> <p>will often do the trick. You could then pull the specific branches you would need to update:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ git checkout master
$ git pull origin master
$ git checkout 4.2.x
$ git pull origin 4.2.x</pre> </div> </div> <div class="sect4"> <h5 id="_updating_topic_branches"><a class="anchor" href="#_updating_topic_branches"></a>Updating topic branches</h5> <div class="paragraph"> <p>You should rebase your topic branches at this point so that they are up-to-date and when pulled by upstream, upstream can fast-forward the release branches:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ git checkout &lt;topic&gt;_master
$ git rebase master</pre> </div> </div> <div class="paragraph"> <p>and/or</p> </div> <div class="literalblock"> <div class="content"> <pre>$ git checkout topic_4.2.x
$ git rebase 4.2.x</pre> </div> </div> </div> </div> <div class="sect3"> <h4 id="link_ifyouhaveforkedupstream"><a class="anchor" href="#link_ifyouhaveforkedupstream"></a>2.4.2. If you have forked upstream</h4> <div class="paragraph"> <p>If you have a fork of upstream, you should probably define upstream as one of your remotes:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ git remote add upstream git://github.com/infinispan/infinispan.git</pre> </div> </div> <div class="paragraph"> <p>You should now be able to fetch and pull changes from upstream into your local repository, though you should make sure you have no uncommitted changes. (You <em>do</em> use topic branches, right?)</p> </div> <div class="literalblock"> <div class="content"> <pre>$ git fetch upstream
$ git fetch upstream --tags
$ git checkout master
$ git pull upstream master
$ git push origin master
$ git checkout 4.2.x
$ git pull upstream 4.2.x
$ git push origin 4.2.x</pre> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> A script can do this for you - have a look at <a href="https://github.com/maniksurtani/githelpers/blob/master/contributors/sync_with_upstream"><code>sync_with_upstream</code></a> . </td> </tr> </table> </div> <div class="sect4"> <h5 id="_updating_topic_branches_2"><a class="anchor" href="#_updating_topic_branches_2"></a>Updating topic branches</h5> <div class="paragraph"> <p>Again, you should rebase your topic branches at this point so that they are up-to-date and when pulled by upstream, upstream can fast-forward the release branches:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ git checkout topic_master
$ git rebase master</pre> </div> </div> <div class="paragraph"> <p>and/or</p> </div> <div class="literalblock"> <div class="content"> <pre>$ git checkout topic_4.2.x
$ git rebase 4.2.x</pre> </div> </div> <div class="paragraph"> <p>The <code>sync_with_upstream</code> script can do this for you if your topic branch naming conventions match the script.</p> </div> </div> </div> </div> <div class="sect2"> <h3 id="_tips_on_enhancing_git"><a class="anchor" href="#_tips_on_enhancing_git"></a>2.5. Tips on enhancing git</h3> <div class="sect3"> <h4 id="_completions"><a class="anchor" href="#_completions"></a>2.5.1. Completions</h4> <div class="paragraph"> <p>Save <a href="http://git.kernel.org/?p=git/git.git;a=blob_plain;f=contrib/completion/git-completion.bash;h=168669bbf79cb33c527a688fb906e276beadaf79;hb=HEAD">this script</a> as <code>~/.git-completion.bash</code> and in <code>~/.bash_profile</code>, add the following on one line:</p> </div> <div class="literalblock"> <div class="content"> <pre>source ~/.git-completion.bash</pre> </div> </div> <div class="paragraph"> <p>After logging out and back in again, typing <code>git</code> followed by <kbd>TAB</kbd> will give you a list of git commands, as would <code>git c</code> followed by <kbd>TAB</kbd>, etc. This even works for options, e.g. <code>git commit --</code> followed by <kbd>TAB</kbd>. The completions are even aware of your refs, so even <code>git checkout my_br</code> followed by <kbd>TAB</kbd> will complete to <code>git checkout my_branch</code>!</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> You get git autocompletion for free if you use <a href="http://zsh.sourceforge.net/">zsh</a> instead of bash. </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="sid-68355157_ContributingtoInfinispan-Terminalcolours"><a class="anchor" href="#sid-68355157_ContributingtoInfinispan-Terminalcolours"></a>2.5.2. Terminal colors</h4> <div class="paragraph"> <p>Add the following to your <code>~/.gitconfig</code></p> </div> <div class="listingblock"> <div class="title">~/.gitconfig</div> <div class="content"> <pre>  [color]
    ui = yes
  [color "branch"]
   current = yellow reverse
   local = yellow
   remote = green
  [color "diff"]
    meta = yellow bold
    frag = magenta bold
    old = red bold
    new = green bold
  [color "status"]
    added = yellow
    changed = green
    untracked = cyan</pre> </div> </div> </div> <div class="sect3"> <h4 id="_aliases"><a class="anchor" href="#_aliases"></a>2.5.3. Aliases</h4> <div class="paragraph"> <p>Some git commands are pretty long to type, especially with various switches. Aliases help you to map shortcuts to more complex commands. Again, For example, add the following to <code>~/.gitconfig</code>:</p> </div> <div class="listingblock"> <div class="title">~/.gitconfig</div> <div class="content"> <pre>[alias]
¬†¬†¬†¬† co = checkout
¬†¬†¬†¬† undo = reset --hard
¬†¬†¬†¬† cb = checkout -b
¬†¬†¬†¬† br = branch
¬†¬†¬†¬† cp = cherry-pick
¬†¬†¬†¬† st = status
¬†¬†¬†¬† l = log --pretty=oneline --decorate --abbrev-commit
¬†¬†¬†¬† lg = log --decorate --abbrev-commit
¬†¬†¬†¬† last = log --decorate -1 -p --abbrev-commit
¬†¬†¬†¬† ci = commit -a
¬†¬†¬†¬† pom = push origin master
¬†¬†¬†¬† graph = log --pretty=oneline --graph --abbrev-commit
¬†¬†¬†¬† dt = difftool</pre> </div> </div> </div> <div class="sect3"> <h4 id="_visual_history"><a class="anchor" href="#_visual_history"></a>2.5.4. Visual History</h4> <div class="paragraph"> <p>Git ships with gitk, a GUI that visually represents a log. If you use Mac OS X, <a href="http://gitx.frim.nl/">GitX</a> is a good alternative. Try typing gitk or gitx in a git project directory. For Linux users, there are lots of alternatives: <em>gitk</em> , <em>gitg</em> , <em>giggle</em>, &#8230; up to <em>egit</em> for Eclipse.</p> </div> </div> <div class="sect3"> <h4 id="_visual_diff_and_merge_tools"><a class="anchor" href="#_visual_diff_and_merge_tools"></a>2.5.5. Visual diff and merge tools</h4> <div class="paragraph"> <p>There are several options available, including <a href="http://kdiff3.sourceforge.net/">KDiff3</a>, <a href="http://meld.sourceforge.net/">meld</a> and Perforce&#8217;s <a href="http://www.perforce.com/perforce/products/merge.html">P4Merge</a> which are all either open source or available for free. See <a href="http://progit.org/book/ch7-1.html">this link</a> on setting these up (section under <em>External Merge and Diff Tools</em>)</p> </div> </div> <div class="sect3"> <h4 id="_choosing_an_editor"><a class="anchor" href="#_choosing_an_editor"></a>2.5.6. Choosing an Editor</h4> <div class="paragraph"> <p>You can customise the editor used by git editing <code>~/.gitconfig</code>. The following fires up <a href="http://code.google.com/p/macvim/">MacVIM</a> instead of the default vi editor:</p> </div> <div class="listingblock"> <div class="title">~/.gitconfig</div> <div class="content"> <pre>[core]
¬†¬†¬†¬† editor = mvim -f</pre> </div> </div> <div class="paragraph"> <p>Alternatively, you could fire up TextMate or another editors of your choice.</p> </div> </div> <div class="sect3"> <h4 id="_shell_prompt"><a class="anchor" href="#_shell_prompt"></a>2.5.7. Shell prompt</h4> <div class="paragraph"> <p>You can change your bash shell prompt to print the current repository&#8217;s branch name. Add the following to your <code>~/.bashrc</code></p> </div> <div class="listingblock"> <div class="title">~/.bashrc</div> <div class="content"> <pre>function git_current_branch {
¬† git branch --no-color 2&gt; /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/[\1]/'
}

if [ "$PS1" ]; then
¬† PS1='[\u@\h:\W]$(git_current_branch)\$ '
fi</pre> </div> </div> <div class="paragraph"> <p>The resulting shell prompt will look like:</p> </div> <div class="literalblock"> <div class="content"> <pre>trustin@matrix:infinispan-4.2][4.2.x]$</pre> </div> </div> <div class="paragraph"> <p>If you&#8217;re a zsh user, you can get even more interesting branch information thanks to <a href="http://sebastiancelis.com/2009/nov/16/zsh-prompt-git-users/">this blog post</a> , such as:</p> </div> <div class="ulist"> <ul> <li> <p>whether your branch is dirty (<em>X</em>)</p> </li> <li> <p>whether it&#8217;s ahead of the remote(‚Üë)</p> </li> <li> <p>whether it diverges with the remote (‚Üï)</p> </li> <li> <p>whether it&#8217;s behind (‚Üì)</p> </li> </ul> </div> <div class="paragraph"> <p>For example, the following prompt indicates that the current branch is <em>t_ispn775_master</em> and that it is behind remote:</p> </div> <div class="literalblock"> <div class="content"> <pre>[~/Go/code/infinispan.git]% (t_ispn775_master ‚Üì)</pre> </div> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_building_infinispan"><a class="anchor" href="#_building_infinispan"></a>3. Building Infinispan</h2> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan uses <a href="http://maven.apache.org/">Maven</a> as a build system.</p> </div> <div class="sect2"> <h3 id="_requirements"><a class="anchor" href="#_requirements"></a>3.1. Requirements</h3> <div class="ulist"> <ul> <li> <p>Java 7.0 or above</p> </li> <li> <p>Maven 3 or above</p> </li> </ul> </div> <div class="admonitionblock warning"> <table> <tr> <td class="icon"> <i class="icon-warning" title="Warning"></i> </td> <td class="content"> Make sure you follow the steps outlined in <a href="http://community.jboss.org/docs/15169">Maven Getting Started - Users</a> to set up your JBoss repository correctly. This step is <em>crucial</em> to ensure your Maven setup can locate JBoss artifacts! If you also want to test the EAP integration modules you should also add the appropriate <a href="http://maven.repository.redhat.com/">Enterprise Red Hat Maven Repository.</a> </td> </tr> </table> </div> </div> <div class="sect2"> <h3 id="_maven"><a class="anchor" href="#_maven"></a>3.2. Maven</h3> <div class="paragraph"> <p>The following is an example <code>settings.xml</code> to get you started:</p> </div> <div class="listingblock"> <div class="title">settings.xml</div> <div class="content"> <pre class="CodeRay"><code class="xml language-xml"><span class="tag">&lt;settings</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://maven.apache.org/SETTINGS/1.0.0</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://maven.apache.org/SETTINGS/1.0.0</span>
                      <span class="content">http://maven.apache.org/xsd/settings-1.0.0.xsd</span><span class="delimiter">&quot;</span></span> <span class="tag">&gt;</span>
  <span class="tag">&lt;localRepository</span><span class="tag">/&gt;</span>
  <span class="tag">&lt;interactiveMode</span><span class="tag">/&gt;</span>
  <span class="tag">&lt;usePluginRegistry</span><span class="tag">/&gt;</span>
  <span class="tag">&lt;offline</span><span class="tag">/&gt;</span>
  <span class="tag">&lt;proxies</span><span class="tag">/&gt;</span>
  <span class="tag">&lt;profiles&gt;</span>
    <span class="tag">&lt;profile&gt;</span>
      <span class="tag">&lt;id&gt;</span>jboss-public-repository<span class="tag">&lt;/id&gt;</span>
      <span class="tag">&lt;repositories&gt;</span>
        <span class="tag">&lt;repository&gt;</span>
          <span class="tag">&lt;id&gt;</span>jboss-public-repository-group<span class="tag">&lt;/id&gt;</span>
          <span class="tag">&lt;name&gt;</span>JBoss Public Maven Repository Group<span class="tag">&lt;/name&gt;</span>
          <span class="tag">&lt;url&gt;</span> https://repository.jboss.org/nexus/content/groups/public-jboss/ <span class="tag">&lt;/url&gt;</span>
          <span class="tag">&lt;layout&gt;</span>default<span class="tag">&lt;/layout&gt;</span>
          <span class="tag">&lt;releases&gt;</span>
            <span class="tag">&lt;enabled&gt;</span>true<span class="tag">&lt;/enabled&gt;</span>
            <span class="tag">&lt;updatePolicy&gt;</span>never<span class="tag">&lt;/updatePolicy&gt;</span>
          <span class="tag">&lt;/releases&gt;</span>
          <span class="tag">&lt;snapshots&gt;</span>
            <span class="tag">&lt;enabled&gt;</span>true<span class="tag">&lt;/enabled&gt;</span>
            <span class="tag">&lt;updatePolicy&gt;</span>never<span class="tag">&lt;/updatePolicy&gt;</span>
          <span class="tag">&lt;/snapshots&gt;</span>
        <span class="tag">&lt;/repository&gt;</span>
      <span class="tag">&lt;/repositories&gt;</span>
      <span class="tag">&lt;pluginRepositories&gt;</span>
        <span class="tag">&lt;pluginRepository&gt;</span>
          <span class="tag">&lt;id&gt;</span>jboss-public-repository-group<span class="tag">&lt;/id&gt;</span>
          <span class="tag">&lt;name&gt;</span>JBoss Public Maven Repository Group<span class="tag">&lt;/name&gt;</span>
          <span class="tag">&lt;url&gt;</span> https://repository.jboss.org/nexus/content/groups/public-jboss/ <span class="tag">&lt;/url&gt;</span>
          <span class="tag">&lt;layout&gt;</span>default<span class="tag">&lt;/layout&gt;</span>
          <span class="tag">&lt;releases&gt;</span>
            <span class="tag">&lt;enabled&gt;</span>true<span class="tag">&lt;/enabled&gt;</span>
            <span class="tag">&lt;updatePolicy&gt;</span>never<span class="tag">&lt;/updatePolicy&gt;</span>
          <span class="tag">&lt;/releases&gt;</span>
          <span class="tag">&lt;snapshots&gt;</span>
            <span class="tag">&lt;enabled&gt;</span>true<span class="tag">&lt;/enabled&gt;</span>
            <span class="tag">&lt;updatePolicy&gt;</span>never<span class="tag">&lt;/updatePolicy&gt;</span>
          <span class="tag">&lt;/snapshots&gt;</span>
        <span class="tag">&lt;/pluginRepository&gt;</span>
      <span class="tag">&lt;/pluginRepositories&gt;</span>
    <span class="tag">&lt;/profile&gt;</span>

    <span class="comment">&lt;!-- Include early access of application server and other products --&gt;</span>
    <span class="tag">&lt;profile&gt;</span>
      <span class="tag">&lt;id&gt;</span>redhat-earlyaccess-repository<span class="tag">&lt;/id&gt;</span>
        <span class="tag">&lt;repositories&gt;</span>
          <span class="tag">&lt;repository&gt;</span>
            <span class="tag">&lt;id&gt;</span>redhat-earlyaccess-repository-group<span class="tag">&lt;/id&gt;</span>
            <span class="tag">&lt;name&gt;</span>Red Hat early access repository<span class="tag">&lt;/name&gt;</span>
            <span class="tag">&lt;url&gt;</span> http://maven.repository.redhat.com/earlyaccess/all/ <span class="tag">&lt;/url&gt;</span>
            <span class="tag">&lt;layout&gt;</span>default<span class="tag">&lt;/layout&gt;</span>
            <span class="tag">&lt;releases&gt;</span>
              <span class="tag">&lt;enabled&gt;</span>true<span class="tag">&lt;/enabled&gt;</span>
              <span class="tag">&lt;updatePolicy&gt;</span>never<span class="tag">&lt;/updatePolicy&gt;</span>
            <span class="tag">&lt;/releases&gt;</span>
            <span class="tag">&lt;snapshots&gt;</span>
              <span class="tag">&lt;enabled&gt;</span>true<span class="tag">&lt;/enabled&gt;</span>
              <span class="tag">&lt;updatePolicy&gt;</span>never<span class="tag">&lt;/updatePolicy&gt;</span>
            <span class="tag">&lt;/snapshots&gt;</span>
          <span class="tag">&lt;/repository&gt;</span>
        <span class="tag">&lt;/repositories&gt;</span>
     <span class="tag">&lt;/profile&gt;</span>
  <span class="tag">&lt;/profiles&gt;</span>
  <span class="tag">&lt;activeProfiles&gt;</span>
    <span class="tag">&lt;activeProfile&gt;</span>jboss-public-repository<span class="tag">&lt;/activeProfile&gt;</span>
    <span class="tag">&lt;activeProfile&gt;</span>redhat-earlyaccess-repository<span class="tag">&lt;/activeProfile&gt;</span>
  <span class="tag">&lt;/activeProfiles&gt;</span>
<span class="tag">&lt;/settings&gt;</span></code></pre> </div> </div> <div class="sect3"> <h4 id="_quick_command_reference"><a class="anchor" href="#_quick_command_reference"></a>3.2.1. Quick command reference</h4> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> Maven places it&#8217;s output in <code>target/</code> </td> </tr> </table> </div> <table class="tableblock frame-all grid-all" style="width:80%; "> <colgroup> <col style="width:66%;"> <col style="width:33%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Command</th> <th class="tableblock halign-left valign-top">Meaning</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn clean</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Cleans out any old builds and binaries</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn compile</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Compiles java source code</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn test</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Runs the TestNG unit test suite on the compiled code. Will also compile the tests. See the testing section below for more information on running different test groups. The default test group run is the "unit" group.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn package</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Packages the module as a JAR file, the resulting JAR file will be in target/</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn package -DskipTests</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Creates a JAR file without running tests</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn package -DskipTests -P minimal-distribution</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Creates a reduced version of the distribution with all modules,scripts&#8230;etc but no javadoc or source code. This is very handy to quickly build the distribution in order to run some tests.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn install -DskipTests</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Installs the artifacts in your local repo for use by other projects/modules, including inter-module dependencies within the same project.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn install -P distribution</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">In addition to install, will also use Maven&#8217;s assembly plugin to build ZIP files for distribution (in target/distribution ). Contents of various distribution are controlled by the files in src/main/resources/assemblies .</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn deploy</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Builds and deploy the project to the JBoss snapshots repository.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn -Pgenerate-schema-doc install -DskipTests -pl core</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Builds the configuration reference HTML file, often followed up with <code>firefox core/target/xsd_doc</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mvn install -P-extras</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Avoids the extras profile disables the enforce plugin, generation of source jars and OSGI bundleconstruction, hence making builds run faster. Clearly, this option should not be used when making a release or publishing a snapshot.</p></td> </tr> </tbody> </table> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="icon-note" title="Note"></i> </td> <td class="content"> For non-snapshot releases (e.g., alphas, betas, release candidates and final releases) you should use the <code>bin/release.py</code> script. </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="_publishing_releases_to_maven"><a class="anchor" href="#_publishing_releases_to_maven"></a>3.2.2. Publishing releases to Maven</h4> <div class="paragraph"> <p>To be able to publish releases to Maven, you need to have the following in your <code>settings.xml</code> file:</p> </div> <div class="listingblock"> <div class="title">settings.xml</div> <div class="content"> <pre class="CodeRay"><code class="xml language-xml">
<span class="tag">&lt;settings&gt;</span>
¬† ...
¬† <span class="tag">&lt;servers&gt;</span>
¬†¬†¬† ...
¬†¬†¬† <span class="tag">&lt;server&gt;</span>
¬†¬†¬†¬†¬† <span class="tag">&lt;id&gt;</span>jboss-snapshots-repository<span class="tag">&lt;/id&gt;</span>
¬†¬†¬†¬†¬† <span class="tag">&lt;username&gt;</span>your JBoss.org username<span class="tag">&lt;/username&gt;</span>
¬†¬†¬†¬†¬† <span class="tag">&lt;password&gt;</span>your JBoss.org password<span class="tag">&lt;/password&gt;</span>

¬†¬†¬† <span class="tag">&lt;/server&gt;</span>
¬†¬†¬† <span class="tag">&lt;server&gt;</span>
¬†¬†¬†¬†¬† <span class="tag">&lt;id&gt;</span>jboss-releases-repository<span class="tag">&lt;/id&gt;</span>
¬†¬†¬†¬†¬† <span class="tag">&lt;username&gt;</span>your JBoss.org username<span class="tag">&lt;/username&gt;</span>
¬†¬†¬†¬†¬† <span class="tag">&lt;password&gt;</span>your JBoss.org password<span class="tag">&lt;/password&gt;</span>

¬†¬†¬† <span class="tag">&lt;/server&gt;</span>
¬†¬†¬† ...
¬† <span class="tag">&lt;/servers&gt;</span>
¬† ...
<span class="tag">&lt;/settings&gt;</span>
</code></pre> </div> </div> <div class="sect4"> <h5 id="_publishing_snapshots"><a class="anchor" href="#_publishing_snapshots"></a>Publishing snapshots</h5> <div class="paragraph"> <p>Simply running</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn clean deploy -DskipTests</pre> </div> </div> <div class="paragraph"> <p>in the Infinispan root directory will deploy a snapshot.</p> </div> </div> <div class="sect4"> <h5 id="_publishing_releases"><a class="anchor" href="#_publishing_releases"></a>Publishing releases</h5> <div class="paragraph"> <p>Use the <code>bin/release.py</code> script.</p> </div> </div> </div> <div class="sect3"> <h4 id="_the_maven_archetypes"><a class="anchor" href="#_the_maven_archetypes"></a>3.2.3. The Maven Archetypes</h4> <div class="paragraph"> <p>Infinispan currently has 2 separate Maven <a href="http://maven.apache.org/guides/introduction/introduction-to-archetypes.html">archetypes</a> you can use to create a skeleton project and get started using Infinispan. This is an easy way to get started using Infinispan as the archetype generates sample code, a sample Maven pom.xml with necessary dependencies, etc.</p> </div> <div class="paragraph"> <p>You don&#8217;t need to have any experience with or knowledge of Maven&#8217;s Archetypes to use this!¬† Just follow the simple steps below.</p> </div> <div class="sect4"> <h5 id="_starting_a_new_project"><a class="anchor" href="#_starting_a_new_project"></a>Starting a new project</h5> <div class="paragraph"> <p>Use the <code>newproject-archetype</code> project. The simple command below will get you started, and</p> </div> <div class="literalblock"> <div class="content"> <pre> $ mvn archetype:generate \
¬†¬†¬† -DarchetypeGroupId=org.infinispan.archetypes \
¬†¬†¬† -DarchetypeArtifactId=newproject-archetype \
¬†¬†¬† -DarchetypeVersion=1.0.5 \
¬†¬†¬† -DarchetypeRepository=http://repository.jboss.org/nexus/content/groups/public</pre> </div> </div> <div class="paragraph"> <p>You will be prompted for a few things, including the artifactId , groupId and version of your new project. And that&#8217;s it - you&#8217;re ready to go!</p> </div> <div class="sect5"> <h6 id="_exploring_your_new_project"><a class="anchor" href="#_exploring_your_new_project"></a>Exploring your new project</h6> <div class="paragraph"> <p>The skeleton project ships with a sample application class for interacting with Infinispan. You can open this new project in your IDE - most good IDEs such as IntelliJ and Eclipse allow you to import Maven projects, see <a href="http://www.jetbrains.com/idea/webhelp/importing-maven-project.html">this guide</a> and <a href="http://m2eclipse.sonatype.org/">this guide</a>. Once you open your project in your IDE, you should examine the generated classes and read through the comments.</p> </div> </div> <div class="sect5"> <h6 id="_on_the_command_line"><a class="anchor" href="#_on_the_command_line"></a>On the command line&#8230;</h6> <div class="paragraph"> <p>Try running</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn install -Prun</pre> </div> </div> <div class="paragraph"> <p>in your newly generated project. This runs the <code>main()</code> method in the generated application class.</p> </div> </div> </div> <div class="sect4"> <h5 id="_writing_a_test_case_for_infinispan"><a class="anchor" href="#_writing_a_test_case_for_infinispan"></a>Writing a test case for Infinispan</h5> <div class="paragraph"> <p>This archetype is useful if you wish to contribute a test to the Infinispan project and helps you get set up to use Infinispan&#8217;s testing harness and related tools. Use</p> </div> <div class="literalblock"> <div class="content"> <pre> $ mvn archetype:generate \
¬†¬†¬† -DarchetypeGroupId=org.infinispan.archetypes \
¬†¬†¬† -DarchetypeArtifactId=testcase-archetype \
¬†¬†¬† -DarchetypeVersion=1.0.5 \
¬†¬†¬† -DarchetypeRepository=http://repository.jboss.org/nexus/content/groups/public</pre> </div> </div> <div class="paragraph"> <p>As above, this will prompt you for project details and again as above, you should open this project in your IDE. Once you have done so, you will see some sample tests written for Infinispan making use of Infinispan&#8217;s test harness and testing tools along with extensive comments and links for further reading.</p> </div> <div class="sect5"> <h6 id="_on_the_command_line_2"><a class="anchor" href="#_on_the_command_line_2"></a>On the command line&#8230;</h6> <div class="paragraph"> <p>Try running</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn test</pre> </div> </div> <div class="paragraph"> <p>in your newly generated project to run your tests. The generated project has a few different profiles you can use as well, using Maven&#8217;s -P flag. For example:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn test -Pudp</pre> </div> </div> </div> <div class="sect5"> <h6 id="_available_profiles"><a class="anchor" href="#_available_profiles"></a>Available profiles</h6> <div class="paragraph"> <p>The profiles available in the generated sample project are:</p> </div> <div class="ulist"> <ul> <li> <p>udp: use UDP for network communications rather than TCP</p> </li> <li> <p>tcp: use TCP for network communications rather than UDP</p> </li> <li> <p>jbosstm: Use the embedded <a href="http://www.jboss.org/jbosstm">JBoss Transaction Manager</a> rather than Infinispan&#8217;s dummy test transaction manager</p> </li> </ul> </div> </div> </div> <div class="sect4"> <h5 id="_contributing_tests_back_to_infinispan"><a class="anchor" href="#_contributing_tests_back_to_infinispan"></a>Contributing tests back to Infinispan</h5> <div class="paragraph"> <p>If you have written a functional, unit or stress test for Infinispan and want to contribute this back to Infinispan, your best bet is to <a href="https://github.com/infinispan/infinispan">fork the Infinispan sources on GitHub</a>. The test you would have prototyped and tested in an isolated project created using this archetype can be simply dropped in to Infinispan&#8217;s test suite. Make your changes, add your test, prove that it fails even on Infinispan&#8217;s upstream source tree and issue a <a href="http://help.github.com/pull-requests/">pull request</a> .</p> </div> </div> <div class="sect4"> <h5 id="_versions"><a class="anchor" href="#_versions"></a>Versions</h5> <div class="paragraph"> <p>The archetypes generate poms with dependencies to specific versions of Infinispan. You should edit these generated poms by hand to point to other versions of Infinispan that you are interested in.</p> </div> </div> <div class="sect4"> <h5 id="_source_code"><a class="anchor" href="#_source_code"></a>Source Code</h5> <div class="paragraph"> <p>The source code used to generate these archetypes are <a href="https://github.com/infinispan/infinispan-archetypes">on GitHub</a>. If you wish to enhance and contribute back to the project, fork away!</p> </div> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_api_commons_and_core"><a class="anchor" href="#_api_commons_and_core"></a>4. API, Commons and Core</h2> <div class="sectionbody"> <div class="paragraph"> <p>In order to provide proper separation between public APIs, common utilities and the actual implementation of Infinispan, these are split into 3 Maven modules: <code>infinispan-api</code>, <code>infinispan-commons</code> and <code>infinispan-core</code>. This separation also makes sure that modules, such as the remote clients, don&#8217;t have to depend on infinispan-core and its transitive dependencies. The following paragraphs describe the role of each of these modules and give indication as to what goes where.</p> </div> <div class="sect2"> <h3 id="_api"><a class="anchor" href="#_api"></a>4.1. API</h3> <div class="paragraph"> <p>The <code>infinispan-api</code> module should only contain the public interfaces which can be used in any context (local, remote, etc). Any additions and/or modifications to this module <em>must</em> be discussed and approved by the core team beforehand. Ideally it should not contain any concrete classes: rare exceptions may be made for small, self-contained classes which need to be referenced from the API interfaces and for which the introduction of an interface would be deemed cumbersome.</p> </div> </div> <div class="sect2"> <h3 id="_commons"><a class="anchor" href="#_commons"></a>4.2. Commons</h3> <div class="paragraph"> <p>The <code>infinispan-commons</code> module contains utility classes which can be reused across other modules. Classes in infinispan-commons should be self-contained and not pull in any dependencies (apart from the existing <code>jboss-logging</code> and <code>infinispan-api</code>). They should also make no reference to configuration aspects specific to a particular environment.</p> </div> </div> <div class="sect2"> <h3 id="_core"><a class="anchor" href="#_core"></a>4.3. Core</h3> <div class="paragraph"> <p>The <code>infinispan-core</code> module contains the actual implementation used for local/embedded mode. When adding new functionality to the APIs, it is generally safe to start by putting them in <code>infinispan-core</code> and promoting them to <code>infinispan-api</code> only when it is deemed mature enough to do so and it makes sense across the various use-cases.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_running_and_writing_tests"><a class="anchor" href="#_running_and_writing_tests"></a>5. Running and Writing Tests</h2> <div class="sectionbody"> <div class="paragraph"> <p>Tests are written using the <a href="http://testng.org/">TestNG</a> framework.</p> </div> <div class="sect2"> <h3 id="_running_the_tests"><a class="anchor" href="#_running_the_tests"></a>5.1. Running the tests</h3> <div class="paragraph"> <p>Before running the actual tests it is highly recommended to configure adjust suite&#8217;s memory setting by updating the <code>MAVEN_OPTS</code> variables. E.g.</p> </div> <div class="literalblock"> <div class="content"> <pre>$ export MAVEN_OPTS="-Xms512m -Xmx2048m -XX:MaxPermSize=384m"</pre> </div> </div> <div class="paragraph"> <p>The default run executes all tests in the functional and unit groups. To just run the tests with txt and xml output the command is:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn test</pre> </div> </div> <div class="paragraph"> <p>Alternatively, you can execute the tests <em>and</em> generate a report with:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn surefire-report:report</pre> </div> </div> <div class="paragraph"> <p>If you are running the tests on a Unix-like operating system, the default limits per user are typically low. The Infinispan test suite creates a lot of processes/threads, thus you will have to increase your user&#8217;s limits and reboot the system to pick up the new values. Open up <code>/etc/security/limits.conf</code> and add the following lines replacing the user name with your username.</p> </div> <div class="listingblock"> <div class="title">/etc/security/limits.conf</div> <div class="content"> <pre> rhusar¬†¬† ¬†soft¬†¬† ¬†nofile¬†¬† ¬†16384
 rhusar¬†¬† ¬†hard¬†¬† ¬†nofile¬†¬† ¬†16384
 rhusar¬†¬† ¬†soft¬†¬† ¬†nproc¬†¬†  ¬†16384
 rhusar¬†¬† ¬†hard¬†¬† ¬†nproc¬†¬†  ¬†16384</pre> </div> </div> <div class="sect3"> <h4 id="_specifying_which_tests_to_run"><a class="anchor" href="#_specifying_which_tests_to_run"></a>5.1.1. Specifying which tests to run</h4> <div class="paragraph"> <p>A single test can be executed using the test property. The value is the short name (not the fully qualified package name) of the test. For example:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn -Dtest=FqnTest test</pre> </div> </div> <div class="paragraph"> <p>Alternatively, if there is more than one test with a given classname in your test suite, you could provide the path to the test.</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn -Dtest=org/infinispan/api/MixedModeTest test</pre> </div> </div> <div class="paragraph"> <p>Patterns are also supported:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn -Dtest=org/infinispan/api/* test</pre> </div> </div> <div class="paragraph"> <p>Also, you can always pass your own Log4j configuration file via <code>-Dlog4.configuration</code> with your own logging settings.</p> </div> </div> <div class="sect3"> <h4 id="_skipping_the_test_run"><a class="anchor" href="#_skipping_the_test_run"></a>5.1.2. Skipping the test run</h4> <div class="paragraph"> <p>It is sometimes desirable to install the Infinispan package in your local repository without performing a full test run. To do this, simply use the <code>skipTests</code> property:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn -DskipTests install</pre> </div> </div> <div class="paragraph"> <p>Note that you should <em>never</em> use <code>-Dmaven.test.skip=true</code> since modules' test classes depend on other module test classes, and this will cause compilation errors.</p> </div> </div> <div class="sect3"> <h4 id="_running_tests_using_code_parameters_code"><a class="anchor" href="#_running_tests_using_code_parameters_code"></a>5.1.3. Running tests using <code>@Parameters</code></h4> <div class="paragraph"> <p>If you want to execute tests relying on TestNG&#8217;s <code>@Parameters</code> from an IDE (such as Eclipse or IntelliJ IDEA), please read <a href="http://infinispan.blogspot.com/2009/06/executing-testng-tests-relying-on.html">this blog entry</a> .</p> </div> </div> <div class="sect3"> <h4 id="_enabling_trace_in_test_logs"><a class="anchor" href="#_enabling_trace_in_test_logs"></a>5.1.4. Enabling TRACE in test logs</h4> <div class="paragraph"> <p>When you run tests, you can get TRACE logging via using the <code>traceTests</code> profile</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn test -PtraceTests</pre> </div> </div> <div class="paragraph"> <p>ecuting this will generate a GZIP file called <code>trace-infinispan.log.gz</code>. This file is not fully closed, so to extract the log file, execute:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ gunzip -c trace-infinispan.log.gz &gt; trace-infinsipan.log</pre> </div> </div> </div> <div class="sect3"> <h4 id="_enabling_code_coverage_generation"><a class="anchor" href="#_enabling_code_coverage_generation"></a>5.1.5. Enabling code coverage generation</h4> <div class="paragraph"> <p>When you run tests, you can enable code coverage recorder for calculating and analysing the Infinispan code coverage. You can do this using <code>coverage</code> and <code>jacocoReport</code> profiles. As a code coverage evaluation tool, the JaCoCo is used.</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn test -Pcoverage -Dmaven.test.failure.ignore=true</pre> </div> </div> <div class="paragraph"> <p>Please note, that <code>-Dmaven.test.failure.ignore=true</code> is used for generating JaCoCo code coverage report, even if there are test failures.</p> </div> <div class="paragraph"> <p>Executing this will generate <code>jacoco.exec</code> file in each module&#8217;s <code>target/</code> directory. These are the JaCoCo execution data files, which contain full data about the specific module&#8217;s coverage.</p> </div> <div class="paragraph"> <p>As soon as the coverage execution command is finished, you will need to generate the JaCoCo report, which will merge the generated <code>jacoco.exec</code> files as well as will create the code coverage report.</p> </div> <div class="paragraph"> <p>For having the report in place, run the following command from your Infinispan home directory:</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn install -pl parent -PjacocoReport</pre> </div> </div> <div class="paragraph"> <p>The <code>jacoco-html/</code> directory will be generated in Infinispan Home directory, which will contain the code coverage report.</p> </div> </div> </div> <div class="sect2"> <h3 id="_test_groups"><a class="anchor" href="#_test_groups"></a>5.2. Test groups</h3> <div class="paragraph"> <p>Each test should belong to one or more group. The group acts as a filter, and is used to select which tests are ran as part of the maven test lifecycle.</p> </div> <div class="sect3"> <h4 id="_which_group_should_i_use"><a class="anchor" href="#_which_group_should_i_use"></a>5.2.1. Which group should I use?</h4> <div class="paragraph"> <p>The following test groups are used by Infinispan.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> If your test does not fit into one of these groups, a new group should be added. </td> </tr> </table> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:50%;"> <col style="width:50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Test Group</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>unit</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Unit tests using stubs to isolate and test each major class in Infinispan. This is the default group run if no test group is specified</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>functional</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Tests which test the general functionality of Infinispan</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>jgroups</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Tests which need to send data on a JGroups Channel</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>transaction</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Tests which use a transaction manager</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>profiling</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Tests used for manual profiling, not meant for automated test runs</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>manual</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Other tests that are run manually</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Every test (except those not intended to be run by continuous integration) should at least be in the <strong>functional</strong> or <strong>unit</strong> groups, since these are the default test groups executed by Maven, and are run when preparing a release.</p> </div> </div> </div> <div class="sect2"> <h3 id="_test_permutations"><a class="anchor" href="#_test_permutations"></a>5.3. Test permutations</h3> <div class="paragraph"> <p>We use the term permutation to describe a test suite execution against a particular configuration. This allows us to test a variety of environments and configurations without rewriting the same basic test over and over again. For example, if we pass JVM parameter <code>-Dinfinispan.test.jgroups.protocol=udp</code> test suite is executed using UDP config.</p> </div> <div class="literalblock"> <div class="content"> <pre>$ mvn -Dinfinispan.test.jgroups.protocol=udp test</pre> </div> </div> <div class="paragraph"> <p>Each permutation uses its own report directory, and its own html output file name. This allows you to execute multiple permutations without wiping the results from the previous run. Note that due to the way Maven operates, only one permutation can be executed per <code>mvn</code> invocation. So automating multiple runs requires shell scripting, or some other execution framework to make multiple calls to Maven.</p> </div> <div class="sect3"> <h4 id="_running_permutations_manually_or_in_an_ide"><a class="anchor" href="#_running_permutations_manually_or_in_an_ide"></a>5.3.1. Running permutations manually or in an IDE</h4> <div class="paragraph"> <p>Sometimes you want to run a test using settings other than the defaults (such as UDP for <code>jgroups</code> group tests or the DummyTransactionManager for <code>transaction</code> group tests). This can be achieved by referring to the Maven POM file to figure out which system properties are passed in to the test when doing something different. For example to run a <code>jgroups</code> group test in your IDE using TCP instead of the default UDP, set <code>-Dinfinispan.test.jgroups.protocol=tcp</code>. Or, to use JBoss JTA (Arjuna TM) instead of the DummyTransactionManager in a <code>transaction</code> group test, set <code>-Dinfinispan.test.jta.tm=jbosstm</code>. Please refer to the POM file for more properties and permutations.</p> </div> </div> </div> <div class="sect2"> <h3 id="_the_parallel_test_suite"><a class="anchor" href="#_the_parallel_test_suite"></a>5.4. The Parallel Test Suite</h3> <div class="paragraph"> <p>Infinispan runs its unit test suite in parallel; Infinispan tests are often IO rather than processor bound, so executing them in parallel offers significant speed up in executing the entire test suite.</p> </div> <div class="sect3"> <h4 id="_tips_for_writing_and_debugging_parallel_tests"><a class="anchor" href="#_tips_for_writing_and_debugging_parallel_tests"></a>5.4.1. Tips for writing and debugging parallel tests</h4> <div class="paragraph"> <p>There are a number of constraints and best practices that need to be followed in order to ensure correctness and keep the execution time to a minimum. If you follow these guidelines you will find your tests are more reliable:</p> </div> <div class="ulist"> <ul> <li> <p><em>Each test class is run in a single thread</em> There is no need to synchronize unit test&#8217;s fixture, as test methods will be run in sequence. However, multiple test classes are executed in parallel.</p> </li> <li> <p><em>Each test class must have an unique test name</em> As a convention, the name of the test should be the fully qualified class name of the test class with the <code>org.infinispan</code> prefix removed. For example, given a test class <code>org.infinispan.mypackage.MyTest</code> the name of the test should be <code>mypackage.MyTest</code>. This convention guarantees a unique name.</p> </li> </ul> </div> <div class="listingblock"> <div class="title">MyTest.java</div> <div class="content"> <pre class="CodeRay"><code class="java language-java"><span class="keyword">package</span> <span class="namespace">org.infinispan.mypackage</span>;
<span class="annotation">@Test</span> (testName = <span class="string"><span class="delimiter">&quot;</span><span class="content">mypackage.MyTest</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyTest</span> { ... }
</code></pre> </div> </div> <div class="ulist"> <ul> <li> <p>Use <code>TestCacheManagerFactory.createXyzCacheManager</code> and <strong>never</strong> create managers using <code>new DefaultCacheManager()</code>. This ensures that there are no conflicts on resources e.g. a cluster created by one test won&#8217;t interfere with a cluster created by another test.</p> </li> <li> <p>Where possible, extend <code>SingleCacheManagerTestorMultipleCacheManagersTest</code>. Tests inheriting from these template method classes will only create a cache/cluster once for all the test methods, rather than before each method. This helps keep the execution time down.</p> </li> <li> <p><strong>Never</strong> rely on <code>Thread.sleep()</code>. When running in heavily threaded environments this will most often not work. For example, if using ASYNC_REPL , don&#8217;t use a <code>sleep(someValue)</code> and expect the data will be replicated to another cache instance after this delay has elapsed. Instead, use a ReplicationListener (look up javadocs for more information on this class). Generally speaking, if you expect something will happen and you don&#8217;t have a guarantee when, a good approach is to try that expectation in a loop, several times, with an generous (5-10secs) timeout. For example:</p> </li> </ul> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay"><code class="java language-java"><span class="keyword">while</span> (Systet.currentTimeMillis() - startTime &lt; timeout) {
   <span class="keyword">if</span> (conditionMeet()) <span class="keyword">break</span>;
<span class="error">¬†</span><span class="error">¬†</span><span class="error">¬†</span><span class="predefined-type">Thread</span>.sleep(<span class="integer">50</span>);
}
</code></pre> </div> </div> <div class="ulist"> <ul> <li> <p><code>Thread.sleep(10)</code> may not work in certain OS/JRE combos (e.g. Windows XP/Sun JRE 1.5). Use values grater than 10 for these statements, e.g. 50. Otherwise, a <code>System.currentTimeMillis()</code> might return same value when called before and after such a sleep statement.</p> </li> <li> <p>For each cache that is create with <code>TestCacheManagerFactory.createXyzCacheManager()</code> the test harness will allocate a unique JMX domain name which can be obtained through <code>CacheManager.getJmxDomain()</code>. This ensures that no JMX collisions will takes place between any tests executed in parallel. If you want to enforce a JMX domain name, this can be done by using one of the <code>TestCacheManagerFactory.createCacheManagerEnforceJmxDomain</code> methods. These methods must be used with care, and you are responsible for ensuring no domain name collisions happen when the parallel suite is executed.</p> </li> <li> <p>Use obscure words. Insert uncommon or obscure words into the cache that has been generated with a random word generator. In a multi-threaded environment like Infinispan&#8217;s testsuite, grepping for these words can greatly help the debugging process. You may find <a href="http://watchout4snakes.com/creativitytools/RandomWord/RandomWordPlus.aspx">this random word generator</a> useful.</p> </li> <li> <p>Use the test method name as the key. Grab the test method and use it as part of the cached key. You can dynamically grab the test method using code like this:</p> <div class="literalblock"> <div class="content"> <pre>Thread.currentThread().getStackTrace()(1).getMethodName()</pre> </div> </div> </li> </ul> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> Even though we&#8217;ve tried to reduce them to a minimum, intermittent failures might still appear from time to time. If you see such failures <em>in existing code</em> please report them in the issue tracker. </td> </tr> </table> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_helping_others_out"><a class="anchor" href="#_helping_others_out"></a>6. Helping Others Out</h2> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan is reliant on the whole community helping each other out. Less experienced contributors are often able to help out answering the "newbie" questions, leaving more experienced contributors to handle the more complex questions.</p> </div> <div class="paragraph"> <p>Users are encouraged to follow the <a href="http://community.jboss.org/wiki/HowToAskAForumQuestion">How to ask a forum question</a> guide.</p> </div> <div class="paragraph"> <p>Forum discussions should be posed as questions (we encourage people to do this). Questions can be marked as answered, indicating to the community that they no longer require answering, allowing easy tracking of open questions. Open questions can <a href="http://community.jboss.org/en/infinispan?view=discussions#/?filter=open">be easily viewed using this filter</a>. Community members are encouraged to regularly view the open questions and answer any questions they can.</p> </div> <div class="paragraph"> <p>In order to track what questions are still open, you are encouraged to mark questions as "assumed answered" if you provide information that you think resolves the query and you don&#8217;t hear back to the contrary after a week or so.</p> </div> <div class="paragraph"> <p>Approximately every month, a member of the Infinispan team will go through any open questions for the past month and clear up any unanswered questions, either by chasing for an answer from core team, or by checking with the user if they require more info.</p> </div> </div> </div> <div class="sect1"> <h2 id="_adding_configuration"><a class="anchor" href="#_adding_configuration"></a>7. Adding Configuration</h2> <div class="sectionbody"> <div class="admonitionblock warning"> <table> <tr> <td class="icon"> <i class="icon-warning" title="Warning"></i> </td> <td class="content"> We still use the old configuration system internally within Infinispan. This makes things a little complicated. This will be switched out soon! For now, you need to also add your property to the old config system as well as the new. </td> </tr> </table> </div> <div class="paragraph"> <p>Note, these guides assume you are adding an element to the cache configuration, but apply equally to the global configuration.</p> </div> <div class="paragraph"> <p>Before you start adding a configuration property, identify whether you want to add a property to an existing configuration group/element, or whether you need to create a child object. We call the configuration group XXX in the steps below.</p> </div> <div class="sect2"> <h3 id="_adding_a_property"><a class="anchor" href="#_adding_a_property"></a>7.1. Adding a property</h3> <div class="olist arabic"> <ol class="arabic"> <li> <p>Add the property to the relevant XXXConfiguration class. Add a private final field, add a parameter to the constructor, and assign the value to the field in the constructor body. Add a accessor for the property. If the property should be mutable at runtime, then add a mutator as well. Most configuration properties are not mutable at runtime - if the configuration is runtime mutable, then Infinispan needs to take notice of this update whilst the cache is running (you can&#8217;t cache the value of the configuration in your implementation class). Mutators and accessors don&#8217;t use the classic JavaBean pattern of prepending accessors with "get" and mutators with "set". Instead, the name of the property is used for an accessor. A mutator is an overloaded version of the accessor which takes a parameter, the new value.</p> </li> <li> <p>Add the property to the matching XXXConfigurationBuilder. You&#8217;ll need to add a mutable field to the class, and initialise it to it&#8217;s default value in the field declaration. Add a mutator (following the above pattern).</p> </li> <li> <p>The <code>create()</code> method is called by the parent object in order to instantiate the XXXConfiguration object from the builder. Therefore, make sure to pass the value of the field in the builder to the XXXConfiguration object&#8217;s constructor here. Additionally, if you require a complex default (for example, the value of a configuration property is defaulted conditionally based on the value of some other configuration property), then this is the place to do this.</p> </li> <li> <p>The <code>validate()</code> method is called by the parent object to validate the values the user has passed in. This method may also be called directly by user code, should they wish to manually validate a configuration object. You should place any validation logic here related to your configuration property. If you need to "cross-validate" properties (validate the value of your property conditionally upon the value of another property), and the other property is on another builder object, increase the visibility of that other property field to "default", and reference it from this builder, by calling the <code>getBuilder()</code> method, which will gives you a handle on the root configuration builder.</p> </li> <li> <p>The final step is to add parsing logic to the <code>Parser</code> class. First, add the attribute to name to the <code>Attribute</code> enum (this class simply provides a mapping between the non-type-safe name of the attribute in XML and a type-safe reference to use in the parser). Locate the relevant <code>parseXXX()</code> method on the class, and add a case to the switch statement for the attribute. Call the builder mutator you created above, performing any XML related validation (you are unlikely to need this), and type conversion (using the static methods on the primitive wrapper classes, String class, or relevant enum class).</p> </li> </ol> </div> </div> <div class="sect2"> <h3 id="_adding_a_group"><a class="anchor" href="#_adding_a_group"></a>7.2. Adding a group</h3> <div class="paragraph"> <p>In some situations you may additionally want to add a configuration grouping object, represented in XML as an element. You might want to do this if you are adding a new area of functionality to Infinispan. Identify the location of the new configuration grouping object. It might be added to the root Configuration object, or it might be added to one it&#8217;s children, children&#8217;s children. We&#8217;ll call the parent YYY in the steps below. Create the XXXConfiguration object. Add any properties required following the guide for adding properties. The constructors visibility should be "default".</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Create the XXXConfigurationBuilder object. It should subclass the relevant configuration child builder ‚Äì use the YYYConfigurationChildBuilder as the superclass. This will ensure that all builder methods that allow the user to "escape" are provided correctly (i.e provide access to other grouping elements), and also require you to provide a <code>create()</code> and <code>validate()</code> method. The constructor needs to take the the YYYConfigurationBuilder as an argument, and pass this to the superclass (this simply allows access to the root of the builder tree using the <code>getBuilder()</code> method).</p> </li> <li> <p>Follow the property adding guide to add any properties you need to the builder. The <code>create()</code> method needs to return a new instance of the XXXConfiguration object. Implement any validation needed in the <code>validate()</code> method.</p> </li> <li> <p>In the YYYConfiguration object, add your new configuration class as a private final field, add an accessor, and add initialiser assignment in the constructor</p> </li> </ol> </div> <div class="paragraph"> <p>` In the YYYConfigurationBuilder, add your new configuration builder as a private final field, and initialise it in the constructor with a new instance. Finally, add an accessor for it following the standard pattern discussed in the guide.</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>In the YYYConfigurationBuilder ensure that your validate method is called in it&#8217;s validate method, and that result of the XXXConfiguration instances' create method is passed to the constructor of YYYConfiguration.</p> </li> <li> <p>Finally, add this to the parser. First, add the element to the <code>Element</code> class, which provides a type safe representation of the element name in XML. In the <code>Parser</code> class, add a new <code>parseXXX</code> method, copying one of the others that most matches your requirements (parse methods either parse elements only - look for <code>ParseUtils.requireNoAttributes()</code>, attributes only ‚Äì look for <code>ParseUtils.requireNoContent()</code> or a combination of both ‚Äì look for an iterator over both elements and attributes). Add any attributes as discussed in the adding a property guide. Finally, wire this in by locating the <code>parseYYY()</code> method, and adding an element to the switch statement, that calls your new <code>parseXXX()</code> method.</p> </li> </ol> </div> </div> <div class="sect2"> <h3 id="_don_t_forget_to_update_the_xsd_and_xsd_test"><a class="anchor" href="#_don_t_forget_to_update_the_xsd_and_xsd_test"></a>7.3. Don&#8217;t forget to update the XSD and XSD test</h3> <div class="olist arabic"> <ol class="arabic"> <li> <p>Add your new elements or attributes to the XSD in <code>src/main/resources</code>.</p> </li> <li> <p>Update <code>src/test/resources/configs/all.xml</code> to include your new elements or attributes.</p> </li> </ol> </div> </div> <div class="sect2"> <h3 id="_bridging_to_the_old_configuration"><a class="anchor" href="#_bridging_to_the_old_configuration"></a>7.4. Bridging to the old configuration</h3> <div class="paragraph"> <p>Until we entirely swap out the old configuration you will need to add your property to the old configuration (no need to worry about JAXB mappings though!), and then add some code to the <code>LegacyConfigurationAdaptor</code> to adapt both ways. It&#8217;s fairly straightforward, just locate the relevant point in the <code>adapt()</code> method (near the configuration group you are using) and map from the legacy configuration to the new configuration, or vs versa. You will need to map both ways, in both adapt methods.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_writing_documentation_and_faqs"><a class="anchor" href="#_writing_documentation_and_faqs"></a>8. Writing Documentation and FAQs</h2> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan makes use of <a href="http://www.methods.co.nz/asciidoc/">AsciiDoc</a> as a lightweight markup language to write all documentation. AsciiDoc is quick and easy to write, easy to learn, and there are a number of ways to render AsciiDoc, including HTML5, PDF and DocBook.</p> </div> <div class="ulist"> <div class="title">AsciiDoc resources</div> <ul> <li> <p><a href="http://www.methods.co.nz/asciidoc/">AsciiDoc website</a></p> </li> <li> <p><a href="http://asciidoctor.org/docs/asciidoc-syntax-quick-reference/">Quick Syntax Reference</a></p> </li> </ul> </div> <div class="sect2"> <h3 id="_practicalities"><a class="anchor" href="#_practicalities"></a>8.1. Practicalities</h3> <div class="sect3"> <h4 id="_style_guide"><a class="anchor" href="#_style_guide"></a>8.1.1. Style guide</h4> <div class="paragraph"> <p><a href="http://asciidoctor.org/">AsciiDoctor</a> has some excellent resources on authoring documentation effectively, including:</p> </div> <div class="ulist"> <ul> <li> <p><a href="http://asciidoctor.org/docs/asciidoc-writers-guide/">Writers' Guide</a></p> </li> <li> <p><a href="http://asciidoctor.org/docs/asciidoc-recommended-practices/">Style Guide</a></p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="_editing"><a class="anchor" href="#_editing"></a>8.1.2. Editing</h4> <div class="paragraph"> <p>You will want to install the entire AsciiDoctor toolchain on your computer.</p> </div> <div class="ulist"> <ul> <li> <p><a href="http://asciidoctor.org/docs/install-toolchain/#installing-or-updating-asciidoctor">Installing AsciiDoctor</a></p> <div class="ulist"> <ul> <li> <p><a href="http://asciidoctor.org/docs/install-asciidoctor-macosx/">On a Mac</a></p> </li> </ul> </div> </li> <li> <p><a href="http://asciidoctor.org/docs/install-toolchain/#text-editors-and-syntax-highlighting">Text editors</a></p> </li> </ul> </div> <div class="paragraph"> <p>In order to see the result of your editing, from the infinispan&#8217;s root dir (embedded):</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay"><code class="bash language-bash">## compile the user guide and the index
$ asciidoctor ./documentation/src/main/asciidoc/user_guide/user_guide.adoc
$ asciidoctor ./documentation/src/main/asciidoc/index.adoc

## open the documentation and make sure it renders correctly (this is OS-X specific)
$ open /Applications/Google\ Chrome.app documentation/src/main/asciidoc/index.html</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="_linefeed"><a class="anchor" href="#_linefeed"></a>8.1.3. Linefeed</h4> <div class="paragraph"> <p>A soft limit of 80 characters is recommended. At the end of each sentence, go to the next line. Consider going to the next line for each new clause, in particular if the sentence would go beyond 80 characters. But do not obsess: if a multi-clause sentence is below 80 characters, don&#8217;t split it to limit the <em>verticality</em> of the document. For long links, tend to go to the next line.</p> </div> <div class="paragraph"> <p>The 80 characters limit is used because GitHub diffs are around 90 chars long.</p> </div> <div class="paragraph"> <p>For more information, read <a href="http://emmanuelbernard.com/blog/2013/08/08/one-line-per-idea/">this blog post</a></p> </div> </div> <div class="sect3"> <h4 id="_end_of_file"><a class="anchor" href="#_end_of_file"></a>8.1.4. End of file</h4> <div class="paragraph"> <p>If you intend your file to be included in another file (aggregated), such as the technique used in the User Guide, then you <strong>must</strong> end the file with two blank lines.</p> </div> <div class="admonitionblock warning"> <table> <tr> <td class="icon"> <i class="icon-warning" title="Warning"></i> </td> <td class="content"> Failure to do so <em>will</em> mess up formatting and layout. </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="_diagrams"><a class="anchor" href="#_diagrams"></a>8.1.5. Diagrams</h4> <div class="paragraph"> <p>As far as possible, use OmniGraffle for diagrams. Please store diagram sources if possible as well, XML files in <code>src/main/omnigraffle</code>. Export the omnigraffle files as <code>png</code> with a dot per inch of 72. This will create a file of the right size for the web.</p> </div> <div class="paragraph"> <p>Binary images should be stored under <code>documentation/src/main/asciidoc/${your_document}/images</code></p> </div> </div> <div class="sect3"> <h4 id="_live_editing"><a class="anchor" href="#_live_editing"></a>8.1.6. Live editing</h4> <div class="paragraph"> <p>Naturally, while editing the docs, you don&#8217;t want to have to build the entire docs to see your changes. A good way to do this is to set up <em>live previews</em> as described <a href="http://asciidoctor.org/docs/editing-asciidoc-with-live-preview/">here</a>.</p> </div> </div> </div> <div class="sect2"> <h3 id="_who_can_contribute_documentation"><a class="anchor" href="#_who_can_contribute_documentation"></a>8.2. Who can contribute documentation?</h3> <div class="paragraph"> <p>Anyone. Just fork Infinispan on GitHub, and edit away in the <code>documents</code> directory. Then submit a <em>pull request</em>, just as you would do with any code contributions. See the <a href="#_source_control">Source Control</a> chapter for more information on this process.</p> </div> </div> <div class="sect2"> <h3 id="_layout"><a class="anchor" href="#_layout"></a>8.3. Layout</h3> <div class="sect3"> <h4 id="_what_goes_where"><a class="anchor" href="#_what_goes_where"></a>8.3.1. What goes where?</h4> <div class="paragraph"> <p>Official documentation - a User Guide, Getting Started Guide, FAQs, guides to contributing, extending and upgrading Infinispan - live in Infinispan&#8217;s source code repository on GitHub.</p> </div> <div class="paragraph"> <p>Additional documentation - such as for cache stores, Hot Rod clients and modules that live outside of Infinispan&#8217;s core repository - live alongside the code in their respective repositories following a similar structure.</p> </div> <div class="paragraph"> <p>In addition, Infinispan maintains a wiki for design documents and the like, on <a href="community.jboss.org/en/infinispan">this site</a>.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="icon-note" title="Note"></i> </td> <td class="content"> Infinispan no longer uses <a href="https://docs.jboss.org/author/display/ISPN/Home">Confluence</a> for online documentation. </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="_headers_page_structure_and_the_table_of_contents"><a class="anchor" href="#_headers_page_structure_and_the_table_of_contents"></a>8.3.2. Headers, Page Structure and the Table of Contents</h4> <div class="paragraph"> <p>Each <em>book</em> has its own structure. Longer books such as the User Guide and the Getting Started Guide may have a table of contents, while shorter books like the guide to extending or upgrading Infinispan may skip this.</p> </div> <div class="sect4"> <h5 id="_table_of_contents"><a class="anchor" href="#_table_of_contents"></a>Table of Contents</h5> <div class="paragraph"> <p>Tables of contents should use the <code>:toc2:</code> AsciiDoctor directive at the start of the page.</p> </div> <div class="paragraph"> <p>Each book may choose how many levels deep the TOC should go to, by using the <code>:toclevels: N</code> directive, where <code>1 &lt;= N &lt;= 5</code>.</p> </div> </div> <div class="sect4"> <h5 id="_headers"><a class="anchor" href="#_headers"></a>Headers</h5> <div class="paragraph"> <p>Each book should have a title, along with a section for authors, TOC information, etc. For example, copied from the User Guide:</p> </div> <div class="literalblock"> <div class="content"> <pre>= Infinispan User Guide
Manik Surtani, Mircea Markus, Galder Zamarre√±o, Pete Muir, and others from the Infinispan community
:toc2:
:icons: font
:toclevels: 3
:numbered:</pre> </div> </div> </div> <div class="sect4"> <h5 id="_chapters"><a class="anchor" href="#_chapters"></a>Chapters</h5> <div class="paragraph"> <p>Each chapter thereafter - whether written directly into the book or included via the <code>include::</code> directive - should then begin with <code>==</code>. For example, from this very document:</p> </div> <div class="literalblock"> <div class="content"> <pre>== Writing Documentation and FAQs
Infinispan makes use of link:http://www.methods.co.nz/asciidoc/[AsciiDoc] as a
lightweight markup language to write all documentation.</pre> </div> </div> </div> </div> <div class="sect3"> <h4 id="_images_and_other_media"><a class="anchor" href="#_images_and_other_media"></a>8.3.3. Images and other media</h4> <div class="paragraph"> <p>If you are describing the use of a GUI, or showing results of some operation, images embedded in the page can bring the documentation to life for the reader. Images can be included via the <code>image::[]</code> directive.</p> </div> <div class="paragraph"> <p>See <a href="#_diagrams">this section</a> for details on where to store your images.</p> </div> </div> <div class="sect3"> <h4 id="_code_samples"><a class="anchor" href="#_code_samples"></a>8.3.4. Code samples</h4> <div class="paragraph"> <p><a href="http://coderay.rubychan.de/">CodeRay</a> is used for image highlighting. Visit the CodeRay site for a list of supported languages. Highlighting code is as simple as:</p> </div> <div class="literalblock"> <div class="content"> <pre>[source,java]
.MyClass.java
----
// some Java code
----</pre> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> Only include snippets you want to use to demonstrate an idea. If you want to share a reusable block of code or a configuration file, consider storing it in GitHub as a <a href="https://gist.github.com/">gist</a> and linking to it. </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="_versioning"><a class="anchor" href="#_versioning"></a>8.3.5. Versioning</h4> <div class="paragraph"> <p>If you are writing about a feature that has existed from Infinispan 5.0 onwards, there is no need to specify a version that the feature existed from. However, if you are writing about a new feature, use a <code>TIP</code> callout to specify the version it applies to. Also, only specify a MINOR version rather than a detailed version.</p> </div> <div class="exampleblock"> <div class="title">Example 1. A bad version statement</div> <div class="content"> <div class="paragraph"> <p><em>This section talks about a new API in Infinispan, called a WidgetMeister. The WidgetMeister has the power to rule all widgets in your cluster, and is included in Infinispan from version 6.2.3.Beta2 onwards.</em></p> </div> </div> </div> <div class="paragraph"> <p>Why is this bad? A number of reasons.</p> </div> <div class="ulist"> <ul> <li> <p>It mixes feature detail (what the WidgetMeister does) with versioning (when it was released)</p> </li> <li> <p>It points to a beta version!!</p> </li> </ul> </div> <div class="paragraph"> <p>How <em>should</em> this be written?</p> </div> <div class="exampleblock"> <div class="title">Example 2. A good version statement</div> <div class="content"> <div class="paragraph"> <p>This section talks about a new API in Infinispan, called a WidgetMeister. The WidgetMeister has the power to rule all widgets in your cluster.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> The WidgetMeister API is new in Infinispan 6.2.x. </td> </tr> </table> </div> </div> </div> </div> </div> <div class="sect2"> <h3 id="_voice_and_grammar_guide"><a class="anchor" href="#_voice_and_grammar_guide"></a>8.4. Voice and grammar guide</h3> <div class="paragraph"> <p>By using a consistent voice throughout the documentation, the Infinispan documentation appears more professional The aim is to make it feel to the user like the documentation was written by a single person. This can only be completely achieved by regular editing, however in order to make the workload of the editor lighter, following these rules will produce a pretty consistent voice.</p> </div> <div class="ulist"> <ul> <li> <p>Never use abbreviations. On the other hand, contractions are fine.</p> </li> <li> <p>Always use the project name "Infinispan". Never abbreviate it, for example, to "ISPN"</p> </li> <li> <p>Always write in the second or third person, never the first (plural or singular forms). Use the second person to emphasize you are giving instructions to the user.</p> </li> </ul> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> Naturally, most people write in the first person, and, typically find it the easiest form to write, however without a lot of care it can produce the most "unprofessional" text. Conversely, writing in the third person is trickier, but will produce text that feels well written almost without fail. The first person can be used for emphasis but in general it is recommended to avoid it unless you feel confident! </td> </tr> </table> </div> <div class="paragraph"> <p>Writing entirely in the third person can produce quite "dry" text, so it is recommended that you use the second person when you are giving instructions to the user. This could be when you are walking through a sequence of steps they should perform, or could be when you are stating that they <em>must</em> do something in order for them to succeed.</p> </div> <div class="paragraph"> <p>So, are there any tricks to reformulate a sentence so the first person is not used?</p> </div> <div class="ulist"> <ul> <li> <p>Use the passive voice. "I recommend" can become "It is recommended". However, extensive use of the can produce boring, dry and indefinite text, so don&#8217;t do this too much!</p> </li> <li> <p>Change the subject. For example you can change "Here we discuss" to "This section discusses"</p> </li> <li> <p>Use a "chatty" style. Although the use of the first person is avoided, the documentation shouldn&#8217;t be too dry. Use the second person as needed. Short sentences and good use of punctuation help too!</p> </li> <li> <p>If you define a list, keep the ordering of the list the same whenever you express the list. For example, if you say "In this section you will learn about interceptors, commands and factories" do not go on to say "First, let&#8217;s discuss factories". This will subconsciously confuse the user</p> </li> <li> <p>You should only capitalize proper nouns only. For example "data grid" is lower case (it&#8217;s a concept), whilst "Infinispan" is capitalized (it&#8217;s a project/product name)</p> </li> <li> <p>You should always use American spelling. <strong>Enable a spell checker!</strong></p> </li> <li> <p>Use the definite article when discussing a specific instance or the indefinite article when describing a generalization of something; generally you omit the article when using a name for a project or product.</p> </li> </ul> </div> <div class="exampleblock"> <div class="title">Example 3. Articles used correctly</div> <div class="content"> <div class="paragraph"> <p><em>Infinispan uses <strong>a</strong> logging framework to communicate messages to the user, <strong>the</strong> logging framework used by Infinispan is JBoss Logging</em>.</p> </div> </div> </div> <div class="paragraph"> <p>Let&#8217;s dig into this. . The sentence states that "Infinispan uses logging", and the indefinite article is used - we are not stating which of many possibilities is used. . The sentence goes on to discuss the logging framework Infinispan uses, and here the definite article is used, as the specific framework in use is discussed. . The sentence is concluded by stating that the logging framework used is called "JBoss Logging", and as this is a product name, no article is used.</p> </div> <div class="paragraph"> <p>This is not a formal or complete description, but is a good rule of thumb.</p> </div> <div class="ulist"> <ul> <li> <p>Keep the tense the same. It&#8217;s very easy to slip between the present, past and future tenses, but this produces text that is feels "unnatural" to the reader.</p> </li> </ul> </div> <div class="exampleblock"> <div class="title">Example 4. Bad tenses</div> <div class="content"> <div class="paragraph"> <p>Data is collected from Infinispan every hour. Upon analysis the data showed that Infinispan is 2 million times faster than it&#8217;s nearest competitor.</p> </div> </div> </div> <div class="paragraph"> <p>You may not have noticed, but the phrase starts using the present tense ( <em>is</em> ) and slips into the past tense ( <em>showed</em> ). This is clearly not actually the order in which the events happened!</p> </div> <div class="paragraph"> <p>Of course, if you are actually describing the progression of time, then changing tenses is fine.</p> </div> <div class="exampleblock"> <div class="title">Example 5. Tenses used correctly</div> <div class="content"> <div class="paragraph"> <p>In the last section you <em>were</em> shown how to configure Infinispan using XML, and in the next section you <em>will be</em> shown how to configure Infinispan programmatically.</p> </div> </div> </div> <div class="ulist"> <ul> <li> <p>If you are telling the user about a procedure they can follow, do be explicit about this, and enumerate the steps clearly</p> </li> </ul> </div> <div class="sect3"> <h4 id="_colloquialisms"><a class="anchor" href="#_colloquialisms"></a>8.4.1. Colloquialisms</h4> <div class="paragraph"> <p>Please stay away from colloquialisms at all cost. This impacts the professionalism and readability of the documentation. The examples below probably need no explanation.</p> </div> <div class="exampleblock"> <div class="title">Example 6. Bad colloquialisms</div> <div class="content"> <div class="paragraph"> <p><em>You should use the WidgetMeister API for this sort of problem, coz it&#8217;s the fastest way and its pretty cool.</em></p> </div> </div> </div> <div class="exampleblock"> <div class="content"> <div class="paragraph"> <p><em>You&#8217;ve then gotta install the downloaded archive.</em></p> </div> </div> </div> <div class="exampleblock"> <div class="content"> <div class="paragraph"> <p><em>If the dload fails, contact the SA who runs the svr.</em></p> </div> </div> </div> </div> </div> <div class="sect2"> <h3 id="_glossary_and_faqs"><a class="anchor" href="#_glossary_and_faqs"></a>8.5. Glossary and FAQs</h3> <div class="paragraph"> <p>When writing a glossary or FAQ entry, you should follow the existing entries as a template.</p> </div> <div class="ulist"> <ul> <li> <p>If the entry is commonly referred to using an acronym, then the title should consistent of the fully expanded name, with the acronym in brackets. You can then use the acronym always within the main text body.</p> </li> <li> <p>If you want to refer to other glossary articles using links in the text body, then just link them with no alternative text.</p> </li> <li> <p>If you want to make external links (e.g. Wikipedia, user guide), then add a bulleted list with title "More resources", and list them there. This clearly indicates to users when they are moving outside of our definitions.</p> </li> </ul> </div> </div> </div> </div> </div> <div id="footer"> <div id="footer-text"> Last updated 2014-10-07 15:44:12 UTC </div> </div> </body> </html>