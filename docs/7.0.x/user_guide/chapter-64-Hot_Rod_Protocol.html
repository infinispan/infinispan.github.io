<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="generator" content="Asciidoctor 0.1.4"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Hot Rod Protocol</title> <style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }
audio, canvas, video { display: inline-block; }
audio:not([controls]) { display: none; height: 0; }
[hidden] { display: none; }
html { background: #fff; color: #000; font-family: sans-serif; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; }
body { margin: 0; }
a:focus { outline: thin dotted; }
a:active, a:hover { outline: 0; }
h1 { font-size: 2em; margin: 0.67em 0; }
abbr[title] { border-bottom: 1px dotted; }
b, strong { font-weight: bold; }
dfn { font-style: italic; }
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }
mark { background: #ff0; color: #000; }
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }
pre { white-space: pre-wrap; }
q { quotes: "\201C" "\201D" "\2018" "\2019"; }
small { font-size: 80%; }
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }
sup { top: -0.5em; }
sub { bottom: -0.25em; }
img { border: 0; }
svg:not(:root) { overflow: hidden; }
figure { margin: 0; }
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }
legend { border: 0; padding: 0; }
button, input, select, textarea { font-family: inherit; font-size: 100%; margin: 0; }
button, input { line-height: normal; }
button, select { text-transform: none; }
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; cursor: pointer; }
button[disabled], html input[disabled] { cursor: default; }
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; padding: 0; }
input[type="search"] { -webkit-appearance: textfield; -moz-box-sizing: content-box; -webkit-box-sizing: content-box; box-sizing: content-box; }
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }
textarea { overflow: auto; vertical-align: top; }
table { border-collapse: collapse; border-spacing: 0; }
*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }
html, body { font-size: 100%; }
body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }
a:hover { cursor: pointer; }
a:focus { outline: none; }
img, object, embed { max-width: 100%; height: auto; }
object, embed { height: 100%; }
img { -ms-interpolation-mode: bicubic; }
#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }
.left { float: left !important; }
.right { float: right !important; }
.text-left { text-align: left !important; }
.text-right { text-align: right !important; }
.text-center { text-align: center !important; }
.text-justify { text-align: justify !important; }
.hide { display: none; }
.antialiased, body { -webkit-font-smoothing: antialiased; }
img { display: inline-block; vertical-align: middle; }
textarea { height: auto; min-height: 50px; }
select { width: 100%; }
p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }
.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1.4; color: #7a2518; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }
a { color: #005498; text-decoration: underline; line-height: inherit; }
a:hover, a:focus { color: #00467f; }
a img { border: none; }
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: Georgia, "URW Bookman L", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; color: #ba3925; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #e99b8f; line-height: 0; }
h1 { font-size: 2.125em; }
h2 { font-size: 1.6875em; }
h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }
h4 { font-size: 1.125em; }
h5 { font-size: 1.125em; }
h6 { font-size: 1em; }
hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }
em, i { font-style: italic; line-height: inherit; }
strong, b { font-weight: bold; line-height: inherit; }
small { font-size: 60%; line-height: inherit; }
code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; color: #6d180b; }
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }
ul, ol { margin-left: 1.5em; }
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }
abbr { text-transform: none; }
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: inherit; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }
blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }
.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }
@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
.print-only { display: none !important; }
@media print { * { background: transparent !important; color: #000 !important; box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.6; }
.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }
*:not(pre) > code { font-size: 0.9375em; padding: 1px 3px 0; white-space: nowrap; background-color: #f2f2f2; border: 1px solid #cccccc; -webkit-border-radius: 4px; border-radius: 4px; text-shadow: none; }
pre, pre > code { line-height: 1.4; color: inherit; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }
kbd.keyseq { color: #555555; }
kbd:not(.keyseq) { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }
kbd kbd:first-child { margin-left: 0; }
kbd kbd:last-child { margin-right: 0; }
.menuseq, .menu { color: #090909; }
p a > code:hover { color: #561309; }
#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }
#header { margin-bottom: 2.5em; }
#header > h1 { color: black; font-weight: normal; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #6f6f6f; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }
#toc { border-bottom: 3px double #ebebeb; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }
#toctitle { color: #7a2518; }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; }
  #toc.toc2 { position: fixed; width: 20em; left: 0; top: 0; border-right: 1px solid #ebebeb; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; }
  #toc.toc2 > ul { font-size: .95em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1.25em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #ebebeb; left: auto; right: 0; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; border-width: 0; -webkit-border-radius: 4px; border-radius: 4px; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }
#content #toctitle { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-size: 1em; padding-left: 0.125em; }
#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }
#footer-text { color: #dddddd; line-height: 1.44; }
.sect1 { padding-bottom: 1.25em; }
.sect1 + .sect1 { border-top: 3px double #ebebeb; }
#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #ba3925; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #a53221; }
.imageblock, .literalblock, .listingblock, .verseblock, .videoblock { margin-bottom: 1.25em; }
.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }
.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }
table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }
.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #6f6f6f; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }
.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 4px; border-radius: 4px; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }
.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #d9d9d9; box-shadow: 0 1px 8px #d9d9d9; }
.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 4px; border-radius: 4px; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #7a2518; margin-top: 0; line-height: 1.6; }
.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }
.literalblock > .content pre, .listingblock > .content pre { background: none; border-width: 1px 0; border-style: dotted; border-color: #bfbfbf; -webkit-border-radius: 4px; border-radius: 4px; padding: 0.75em 0.75em 0.5em 0.75em; word-wrap: break-word; }
.literalblock > .content pre.nowrap, .listingblock > .content pre.nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock > .content pre > code, .listingblock > .content pre > code { display: block; }
@media only screen { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.8em; } }
@media only screen and (min-width: 768px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.9em; } }
@media only screen and (min-width: 1280px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 1em; } }
.listingblock > .content { position: relative; }
.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }
.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }
.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }
.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }
table.pyhltable { border: 0; margin-bottom: 0; }
table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }
table.pyhltable td.code { padding-left: .75em; padding-right: 0; }
.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }
.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }
table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }
.quoteblock { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 1.25em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: inherit; color: #555555; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }
table thead th, table tfoot th { font-weight: bold; }
table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 4px; border-radius: 4px; border-top: 1px solid #dddddd; border-bottom: 1px solid #dddddd; }
table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }
table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }
table.tableblock td .paragraph:last-child p, table.tableblock td > p:last-child { margin-bottom: 0; }
th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }
th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }
th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }
th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }
th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }
th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }
p.tableblock.header { color: #222222; font-weight: bold; }
td > div.verse { white-space: pre; }
ol { margin-left: 1.75em; }
ul li ol { margin-left: 1.5em; }
dl dd { margin-left: 1.125em; }
dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }
ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }
ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }
ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }
ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }
ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }
ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }
.unstyled dl dt { font-weight: normal; font-style: normal; }
ol.arabic { list-style-type: decimal; }
ol.decimal { list-style-type: decimal-leading-zero; }
ol.loweralpha { list-style-type: lower-alpha; }
ol.upperalpha { list-style-type: upper-alpha; }
ol.lowerroman { list-style-type: lower-roman; }
ol.upperroman { list-style-type: upper-roman; }
ol.lowergreek { list-style-type: lower-greek; }
.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }
td.hdlist1 { padding-right: .8em; font-weight: bold; }
td.hdlist1, td.hdlist2 { vertical-align: top; }
.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }
.colist > table tr > td:first-of-type { padding: 0 .8em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }
.qanda > ol > li > p > em:only-child { color: #00467f; }
.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }
.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }
.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }
a.image { text-decoration: none; }
span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }
#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }
.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }
div.unbreakable { page-break-inside: avoid; }
.big { font-size: larger; }
.small { font-size: smaller; }
.underline { text-decoration: underline; }
.overline { text-decoration: overline; }
.line-through { text-decoration: line-through; }
.aqua { color: #00bfbf; }
.aqua-background { background-color: #00fafa; }
.black { color: black; }
.black-background { background-color: black; }
.blue { color: #0000bf; }
.blue-background { background-color: #0000fa; }
.fuchsia { color: #bf00bf; }
.fuchsia-background { background-color: #fa00fa; }
.gray { color: #606060; }
.gray-background { background-color: #7d7d7d; }
.green { color: #006000; }
.green-background { background-color: #007d00; }
.lime { color: #00bf00; }
.lime-background { background-color: #00fa00; }
.maroon { color: #600000; }
.maroon-background { background-color: #7d0000; }
.navy { color: #000060; }
.navy-background { background-color: #00007d; }
.olive { color: #606000; }
.olive-background { background-color: #7d7d00; }
.purple { color: #600060; }
.purple-background { background-color: #7d007d; }
.red { color: #bf0000; }
.red-background { background-color: #fa0000; }
.silver { color: #909090; }
.silver-background { background-color: #bcbcbc; }
.teal { color: #006060; }
.teal-background { background-color: #007d7d; }
.white { color: #bfbfbf; }
.white-background { background-color: #fafafa; }
.yellow { color: #bfbf00; }
.yellow-background { background-color: #fafa00; }
span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }
.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #005498; color: #003f72; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }
.conum { display: inline-block; color: white !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }
.literalblock > .content > pre, .listingblock > .content > pre { -webkit-border-radius: 0; border-radius: 0; }

</style> <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.1/css/font-awesome.min.css"> <style>
/* Foundation stylesheet for CodeRay (to match GitHub theme) | MIT License | http://foundation.zurb.com */
table.CodeRay { border-collapse: collapse; padding: 2px; margin-bottom: 0; border: 0; background: transparent; }
table.CodeRay td { padding: 0 .5em; vertical-align: top; }
table.CodeRay td.line-numbers { text-align: right; color: #999; border-right: 1px solid #e5e5e5; padding-left: 0; }
span.line-numbers { border-right: 1px solid #E5E5E5; color: #999; display: inline-block; margin-right: 0.5em; padding-right: 0.5em; }
.CodeRay td.line-numbers strong, .CodeRay span.line-numbers strong { font-weight: normal; }
.CodeRay .debug { color: white !important; background: blue !important; }
.CodeRay .annotation { color: #007; }
.CodeRay .attribute-name { color: #f08; }
.CodeRay .attribute-value { color: #700; }
.CodeRay .binary { color: #509; }
.CodeRay .comment  { color: #999; font-style: italic; }
.CodeRay .char { color: #04D; }
.CodeRay .char .content { color: #04D; }
.CodeRay .char .delimiter { color: #039; }
.CodeRay .class { color: #458; }
.CodeRay .complex { color: #A08; }
.CodeRay .constant { color: teal; }
.CodeRay .color { color: #0A0; }
.CodeRay .class-variable { color: #369; }
.CodeRay .decorator { color: #B0B; }
.CodeRay .definition { color: #099; }
.CodeRay .directive { color: #088; }
.CodeRay .delimiter { color: black; }
.CodeRay .doc { color: #970; }
.CodeRay .doctype { color: #34b; }
.CodeRay .doc-string { color: #D42; }
.CodeRay .escape  { color: #666; }
.CodeRay .entity { color: #800; }
.CodeRay .error { color: #808; }
.CodeRay .exception { color: #C00; }
.CodeRay .filename { color: #099; }
.CodeRay .function { color: #900; }
.CodeRay .global-variable { color: teal; }
.CodeRay .hex { color: #058; }
.CodeRay .integer  { color: #099; }
.CodeRay .include { color: #B44; }
.CodeRay .inline { color: black; }
.CodeRay .inline .inline { background: #ccc; }
.CodeRay .inline .inline .inline { background: #bbb; }
.CodeRay .inline .inline-delimiter { color: #D14; }
.CodeRay .inline-delimiter { color: #D14; }
.CodeRay .important { color: #f00; }
.CodeRay .interpreted { color: #B2B; }
.CodeRay .instance-variable { color: teal; }
.CodeRay .label { color: #970; }
.CodeRay .local-variable { color: #963; }
.CodeRay .octal { color: #40E; }
.CodeRay .predefined { color: #369; }
.CodeRay .preprocessor { color: #579; }
.CodeRay .pseudo-class { color: #00C; }
.CodeRay .predefined-type { color: #074; }
.CodeRay .reserved, .keyword  { color: #000; }
.CodeRay .key { color: #808; }
.CodeRay .key .delimiter { color: #606; }
.CodeRay .key .char { color: #80f; }
.CodeRay .value { color: #088; }
.CodeRay .regexp { background-color: #fff0ff; }
.CodeRay .regexp .content { color: #808; }
.CodeRay .regexp .delimiter { color: #404; }
.CodeRay .regexp .modifier { color: #C2C; }
.CodeRay .regexp .function  { color: #404; font-weight: bold; }
.CodeRay .string { color: #D20; }
.CodeRay .string .string { }
.CodeRay .string .string .string { background-color: #ffd0d0; }
.CodeRay .string .content { color: #D14; }
.CodeRay .string .char { color: #D14; }
.CodeRay .string .delimiter { color: #D14; }
.CodeRay .shell { color: #D14; }
.CodeRay .shell .content { }
.CodeRay .shell .delimiter { color: #D14; }
.CodeRay .symbol { color: #990073; }
.CodeRay .symbol .content { color: #A60; }
.CodeRay .symbol .delimiter { color: #630; }
.CodeRay .tag, .CodeRay .attribute-name { color: #070; }
.CodeRay .tag-special { color: #D70; }
.CodeRay .type { color: #339; }
.CodeRay .variable  { color: #036; }
.CodeRay .insert { background: #afa; }
.CodeRay .delete { background: #faa; }
.CodeRay .change { color: #aaf; background: #007; }
.CodeRay .head { color: #f8f; background: #505; }
.CodeRay .insert .insert { color: #080; }
.CodeRay .delete .delete { color: #800; }
.CodeRay .change .change { color: #66f; }
.CodeRay .head .head { color: #f4f; }

</style> </head> <body class="book"> <div id="header"> </div> <div id="content"> <div class="sect3"> <h4 id="_hot_rod_protocol"><a class="anchor" href="#_hot_rod_protocol"></a>1. Hot Rod Protocol</h4> <div class="paragraph"> <p>The following articles provides detailed information about each version of the custom TCP client/server Hot Rod protocol.</p> </div> <div class="ulist"> <ul> <li> <p><a href="#_hot_rod_protocol_1_0">Hot Rod Protocol 1.0</a></p> </li> <li> <p><a href="#_hot_rod_protocol_1_1">Hot Rod Protocol 1.1</a></p> </li> <li> <p><a href="#_hot_rod_protocol_1_2">Hot Rod Protocol 1.2</a></p> </li> <li> <p><a href="#_hot_rod_protocol_1_3">Hot Rod Protocol 1.3</a></p> </li> <li> <p><a href="#_hot_rod_protocol_1_3">Hot Rod Protocol 1.4</a></p> </li> <li> <p><a href="#_hot_rod_protocol_2_0">Hot Rod Protocol 2.0</a></p> </li> </ul> </div> <div class="sect4"> <h5 id="_hot_rod_protocol_1_0"><a class="anchor" href="#_hot_rod_protocol_1_0"></a>Hot Rod Protocol 1.0</h5> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> <div class="title">Infinispan versions</div> This version of the protocol is implemented since Infinispan 4.1.0.Final </td> </tr> </table> </div> <div class="admonitionblock important"> <table> <tr> <td class="icon"> <i class="icon-important" title="Important"></i> </td> <td class="content"> All key and values are sent and stored as byte arrays. Hot Rod makes no assumptions about their types. </td> </tr> </table> </div> <div class="paragraph"> <p>Some clarifications about the other types:</p> </div> <div class="ulist"> <ul> <li> <p>vInt : Variable-length integers are defined defined as compressed, positive integers where the high-order bit of each byte indicates whether more bytes need to be read. The low-order seven bits are appended as increasingly more significant bits in the resulting integer value making it efficient to decode. Hence, values from zero to 127 are stored in a single byte, values from 128 to 16,383 are stored in two bytes, and so on:</p> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:25%;"> <col style="width:25%;"> <col style="width:25%;"> <col style="width:25%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top"><code>Value</code></th> <th class="tableblock halign-left valign-top"><code>First byte</code></th> <th class="tableblock halign-left valign-top"><code>Second byte</code></th> <th class="tableblock halign-left valign-top"><code>Third byte</code></th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>00000000</code></p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>00000001</code></p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>2</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>00000010</code></p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>...</code></p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>127</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>01111111</code></p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>128</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>10000000</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>00000001</code></p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>129</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>10000001</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>00000001</code></p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>130</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>10000010</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>00000001</code></p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>...</code></p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>16,383</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>11111111</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>01111111</code></p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>16,384</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>10000000</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>10000000</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>00000001</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>16,385</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>10000001</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>10000000</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>00000001</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>...</code></p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> </tbody> </table> </li> <li> <p>vLong : Refers to unsigned variable length long values similar to vInt but applied to longer values. They&#8217;re between 1 and 9 bytes long.</p> </li> <li> <p>String : Strings are always represented using UTF-8 encoding.</p> </li> </ul> </div> <div class="sect5"> <h6 id="_request_header"><a class="anchor" href="#_request_header"></a>Request Header</h6> <div class="paragraph"> <p>The header for a request is composed of:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <caption class="title">Table 1. Request header</caption> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Magic</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0xA0</code> = request</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Message ID</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vLong</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">ID of the message that will be copied back in the response. This allows for hot rod clients to implement the protocol in an asynchronous way.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Version</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Infinispan hot rod server version. In this particular case, this is <code>10</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Opcode</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Request operation code:<br> <code>0x01</code> = put request<br> <code>0x03</code> = get<br> <code>0x05</code> = putIfAbsent<br> <code>0x07</code> = replace<br> <code>0x09</code> = replaceIfUnmodified<br> <code>0x0B</code> = remove<br> <code>0x0D</code> = removeIfUnmodified<br> <code>0x0F</code> = containsKey<br> <code>0x11</code> = getWithVersion<br> <code>0x13</code> = clear<br> <code>0x15</code> = stats<br> <code>0x17</code> = ping<br> <code>0x19</code> = bulkGet<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Cache Name Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of cache name. If the passed length is <code>0</code> (followed by no cache name), the operation will interact with the default cache.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Cache Name</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Name of cache on which to operate. This name must match the name of predefined cache in the Infinispan configuration file.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Flags</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">A variable length number representing flags passed to the system. Each flags is represented by a bit. Note that since this field is sent as variable length, the most significant bit in a byte is used to determine whether more bytes need to be read, hence this bit does not represent any flag. Using this model allows for flags to be combined in a short space. Here are the current values for each flag:<br> <code>0x0001</code> = force return previous value</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Client Intelligence</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">This byte hints the server on the client capabilities:<br> <code>0x01</code> = basic client, interested in neither cluster nor hash information<br> <code>0x02</code> = topology-aware client, interested in cluster information<br> <code>0x03</code> = hash-distribution-aware client, that is interested in both cluster and hash information<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Topology Id</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">This field represents the last known view in the client. Basic clients will only send 0 in this field. When topology-aware or hash-distribution-aware clients will send 0 until they have received a reply from the server with the current view id. Afterwards, they should send that view id until they receive a new view id in a response.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Transaction Type</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">This is a 1 byte field, containing one of the following well-known supported transaction types (For this version of the protocol, the only supported transaction type is 0):<br> <code>0</code> = Non-transactional call, or client does not support transactions. The subsequent TX_ID field will be omitted.<br> <code>1</code> = X/Open XA transaction ID (XID). This is a well-known, fixed-size format.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Transaction Id</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The byte array uniquely identifying the transaction associated to this call. Its length is determined by the transaction type. If transaction type is 0, no transaction id will be present.</p></td> </tr> </tbody> </table> </div> <div class="sect5"> <h6 id="_response_header"><a class="anchor" href="#_response_header"></a>Response Header</h6> <div class="paragraph"> <p>The header for a response is composed of:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <caption class="title">Table 2. Response header</caption> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Magic</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0xA1</code> = response</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Message ID</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vLong</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">ID of the message, matching the request for which the response is sent.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Opcode</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response operation code:<br> <code>0x02</code> = put<br> <code>0x04</code> = get<br> <code>0x06</code> = putIfAbsent<br> <code>0x08</code> = replace<br> <code>0x0A</code> = replaceIfUnmodified<br> <code>0x0C</code> = remove<br> <code>0x0E</code> = removeIfUnmodified<br> <code>0x10</code> = containsKey<br> <code>0x12</code> = getWithVersion<br> <code>0x14</code> = clear<br> <code>0x16</code> = stats<br> <code>0x18</code> = ping<br> <code>0x1A</code> = bulkGet<br> <code>0x50</code> = error<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Status of the response, possible values:<br> <code>0x00</code> = No error<br> <code>0x01</code> = Not put/removed/replaced<br> <code>0x02</code> = Key does not exist<br> <code>0x81</code> = Invalid magic or message id<br> <code>0x82</code> = Unknown command<br> <code>0x83</code> = Unknown version<br> <code>0x84</code> = Request parsing error<br> <code>0x85</code> = Server Error<br> <code>0x86</code> = Command timed out<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Topology Change Marker</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">This is a marker byte that indicates whether the response is prepended with topology change information. When no topology change follows, the content of this byte is <code>0</code>. If a topology change follows, its contents are <code>1</code>.</p></td> </tr> </tbody> </table> <div class="admonitionblock caution"> <table> <tr> <td class="icon"> <i class="icon-caution" title="Caution"></i> </td> <td class="content"> Exceptional error status responses, those that start with 0x8 &#8230;, are followed by the length of the error message (as a vInt ) and error message itself as String. </td> </tr> </table> </div> </div> <div class="sect5"> <h6 id="_topology_change_headers"><a class="anchor" href="#_topology_change_headers"></a>Topology Change Headers</h6> <div class="paragraph"> <p>The following section discusses how the response headers look for topology-aware or hash-distribution-aware clients when there&#8217;s been a cluster or view formation change. Note that it&#8217;s the server that makes the decision on whether it sends back the new topology based on the current topology id and the one the client sent. If they&#8217;re different, it will send back the new topology.</p> </div> </div> <div class="sect5"> <h6 id="_topology_aware_client_topology_change_header"><a class="anchor" href="#_topology_aware_client_topology_change_header"></a>Topology-Aware Client Topology Change Header</h6> <div class="paragraph"> <p>This is what topology-aware clients receive as response header when a topology change is sent back:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header with topology change marker</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">See previous section.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Topology Id</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Topology ID</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Num servers in topology</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of Infinispan Hot Rod servers running within the cluster. This could be a subset of the entire cluster if only a fraction of those nodes are running Hot Rod servers.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m1: Host/IP length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of hostname or IP address of individual cluster member that Hot Rod client can use to access it. Using variable length here allows for covering for hostnames, IPv4 and IPv6 addresses.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m1: Host/IP address</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">String containing hostname or IP address of individual cluster member that Hot Rod client can use to access it.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m1: Port</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">2 bytes (Unsigned Short)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Port that Hot Rod clients can use to communicate with this cluster member.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m2: Host/IP length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m2: Host/IP address</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m2: Port</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">2 bytes (Unsigned Short)</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;etc</p></td> <td class="tableblock halign-center valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> </tbody> </table> </div> <div class="sect5"> <h6 id="_distribution_aware_client_topology_change_header"><a class="anchor" href="#_distribution_aware_client_topology_change_header"></a>Distribution-Aware Client Topology Change Header</h6> <div class="paragraph"> <p>This is what hash-distribution-aware clients receive as response header when a topology change is sent back:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header with topology change marker</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">See previous section.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Topology Id</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Topology ID</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Num Key Owners</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">2 bytes (Unsigned Short)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Globally configured number of copies for each Infinispan distributed key</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Hash Function Version</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Hash function version, pointing to a specific hash function in use. See <a href="#_hot_rod_hash_functions">Hot Rod hash functions</a> for details.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Hash space size</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Modulus used by Infinispan for for all module arithmetic related to hash code generation. Clients will likely require this information in order to apply the correct hash calculation to the keys.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Num servers in topology</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of Infinispan Hot Rod servers running within the cluster. This could be a subset of the entire cluster if only a fraction of those nodes are running Hot Rod servers.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m1: Host/IP length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of hostname or IP address of individual cluster member that Hot Rod client can use to access it. Using variable length here allows for covering for hostnames, IPv4 and IPv6 addresses.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m1: Host/IP address</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">String containing hostname or IP address of individual cluster member that Hot Rod client can use to access it.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m1: Port</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">2 bytes (Unsigned Short)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Port that Hot Rod clients can use to communicat with this cluster member.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m1: Hashcode</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">4 bytes</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">32 bit integer representing the hashcode of a cluster member that a Hot Rod client can use indentify in which cluster member a key is located having applied the CSA to it.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m2: Host/IP length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m2: Host/IP address</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m2: Port</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">2 bytes (Unsigned Short)</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m2: Hashcode</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">4 bytes</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;etc</p></td> <td class="tableblock halign-center valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> </tbody> </table> <div class="paragraph"> <p>It&#8217;s important to note that since hash headers rely on the consistent hash algorithm used by the server and this is a factor of the cache interacted with, hash-distribution-aware headers can only be returned to operations that target a particular cache. Currently ping command does not target any cache (this is to change as per <a href="https://jira.jboss.org/jira/browse/ISPN-424">ISPN-424</a>) , hence calls to ping command with hash-topology-aware client settings will return a hash-distribution-aware header with "Num Key Owners", "Hash Function Version", "Hash space size" and each individual host&#8217;s hash code all set to 0. This type of header will also be returned as response to operations with hash-topology-aware client settings that are targeting caches that are not configured with distribution.</p> </div> </div> <div class="sect5"> <h6 id="_operations"><a class="anchor" href="#_operations"></a>Operations</h6> <div class="paragraph"> <div class="title">Get/Remove/ContainsKey/GetWithVersion</div> <p>Common request format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Request header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of key. Note that the size of a vint can be up to 5 bytes which in theory can produce bigger numbers than Integer.MAX_VALUE. However, Java cannot create a single array thats bigger than Integer.MAX_VALUE, hence the protocol is limiting vint array lengths to Integer.MAX_VALUE.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Byte array containing the key whose value is being requested.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Get response:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x00</code> = success, if key retrieved<br> <code>0x02</code> = if key does not exist<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If success, length of value</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If success, the requested value</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Remove response:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x00</code> = success, if key removed<br> <code>0x02</code> = if key does not exist<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Previous value Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If force return previous value flag was sent in the request and the key was removed, the length of the previous value will be returned. If the key does not exist, value length would be 0. If no flag was sent, no value length would be present.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Previous value</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If force return previous value flag was sent in the request and the key was removed, previous value.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>ContainsKey response:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x00</code> = success, if key exists<br> <code>0x02</code> = if key does not exist<br></p></td> </tr> </tbody> </table> <div class="paragraph"> <p>GetWithVersion response:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x00</code> = success, if key retrieved<br> <code>0x02</code> = if key does not exist<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Entry Version</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">8 bytes</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Unique value of an existing entry&#8217;s modification. The protocol does not mandate that entry_version values are sequential. They just need to be unique per update at the key level.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If success, length of value</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If success, the requested value</p></td> </tr> </tbody> </table> <div class="paragraph"> <div class="title">BulkGet</div> <p>Request format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Request header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Entry count</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of Infinispan entries to be returned by the server (entry == key + associated value). Needed to support CacheLoader.load(int). If 0 then all entries are returned (needed for CacheLoader.loadAll()).</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Response:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x00</code> = success, data follows<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">More</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">One byte representing whether more entries need to be read from the stream. So, when it&#8217;s set to 1, it means that an entry follows, whereas when it&#8217;s set to 0, it&#8217;s the end of stream and no more entries are left to read. For more information on BulkGet look <a href="http://community.jboss.org/docs/DOC-15592">here</a></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key 1 Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of key</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key 1</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Retrieved key</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value 1 Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of value</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value 1</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Retrieved value</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">More</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key 2 Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key 2</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value 2 Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value 2</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230; etc</p></td> <td class="tableblock halign-center valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> </tbody> </table> <div class="paragraph"> <div class="title">Put/PutIfAbsent/Replace</div> <p>Common request format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Request header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of key. Note that the size of a vint can be up to 5 bytes which in theory can produce bigger numbers than Integer.MAX_VALUE. However, Java cannot create a single array thats bigger than Integer.MAX_VALUE, hence the protocol is limiting vint array lengths to Integer.MAX_VALUE.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Byte array containing the key whose value is being requested.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Lifespan</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of seconds that a entry during which the entry is allowed to life. If number of seconds is bigger than 30 days, this number of seconds is treated as UNIX time and so, represents the number of seconds since 1/1/1970. If set to 0, lifespan is unlimited.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Max Idle</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of seconds that a entry can be idle before it&#8217;s evicted from the cache. If 0, no max idle time.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of value</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte-array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Value to be stored</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Put response:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x00</code> = success, if stored<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Previous value Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If force return previous value flag was sent in the request and the key was put, the length of the previous value will be returned. If the key does not exist, value length would be 0. If no flag was sent, no value length would be present.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Previous value</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If force return previous value flag was sent in the request and the key was put, previous value.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Replace response:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x00</code> = success, if stored<br> <code>0x01</code> = if store did not happen because key does not exist<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Previous value Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If force return previous value flag was sent in the request, the length of the previous value will be returned. If the key does not exist, value length would be 0. If no flag was sent, no value length would be present.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Previous value</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If force return previous value flag was sent in the request and the key was replaced, previous value.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>PutIfAbsent response:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x00</code> = success, if stored<br> <code>0x01</code> = if store did not happen because key was present<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Previous value Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If force return previous value flag was sent in the request, the length of the previous value will be returned. If the key does not exist, value length would be 0. If no flag was sent, no value length would be present.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Previous value</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If force return previous value flag was sent in the request and the key was replaced, previous value.</p></td> </tr> </tbody> </table> <div class="paragraph"> <div class="title">ReplaceIfUnmodified</div> <p>Request format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Request header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of key. Note that the size of a vint can be up to 5 bytes which in theory can produce bigger numbers than Integer.MAX_VALUE. However, Java cannot create a single array thats bigger than Integer.MAX_VALUE, hence the protocol is limiting vint array lengths to Integer.MAX_VALUE.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Byte array containing the key whose value is being requested.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Lifespan</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of seconds that a entry during which the entry is allowed to life. If number of seconds is bigger than 30 days, this number of seconds is treated as UNIX time and so, represents the number of seconds since 1/1/1970. If set to 0, lifespan is unlimited.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Max Idle</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of seconds that a entry can be idle before it&#8217;s evicted from the cache. If 0, no max idle time.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Entry Version</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">8 bytes</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Use the value returned by GetWithVersion operation.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of value</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte-array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Value to be stored</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Response:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x00</code> = success, if replaced<br> <code>0x01</code> = if replace did not happen because key had been modified<br> <code>0x02</code> = if not replaced because if key does not exist</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Previous value Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If force return previous value flag was sent in the request, the length of the previous value will be returned. If the key does not exist, value length would be 0. If no flag was sent, no value length would be present.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Previous value</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If force return previous value flag was sent in the request and the key was replaced, previous value.</p></td> </tr> </tbody> </table> <div class="paragraph"> <div class="title">RemoveIfUnmodified</div> <p>Request format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Request header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of key. Note that the size of a vint can be up to 5 bytes which in theory can produce bigger numbers than Integer.MAX_VALUE. However, Java cannot create a single array thats bigger than Integer.MAX_VALUE, hence the protocol is limiting vint array lengths to Integer.MAX_VALUE.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Byte array containing the key whose value is being requested.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Entry Version</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">8 bytes</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Use the value returned by GetWithVersion operation.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Response:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x00</code> = success, if removed<br> <code>0x01</code> = if remove did not happen because key had been modified<br> <code>0x02</code> = if not removed because key does not exist<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Previous value Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If force return previous value flag was sent in the request, the length of the previous value will be returned. If the key does not exist, value length would be 0. If no flag was sent, no value length would be present.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Previous value</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If force return previous value flag was sent in the request and the key was removed, previous value.</p></td> </tr> </tbody> </table> <div class="paragraph"> <div class="title">Clear</div> <p>Request:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Request header</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Response:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x00</code> = success, if cleared<br></p></td> </tr> </tbody> </table> <div class="paragraph"> <div class="title">Stats</div> <p>Returns a summary of all available statistics. For each statistic returned, a name and a value is returned both in String UTF-8 format. The supported stats are the following:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:50%;"> <col style="width:50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Name</th> <th class="tableblock halign-left valign-top">Explanation</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">timeSinceStart</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of seconds since Hot Rod started.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">currentNumberOfEntries</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of entries currently in the Hot Rod server.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">totalNumberOfEntries</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of entries stored in Hot Rod server.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">stores</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of put operations.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">retrievals</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of get operations.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">hits</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of get hits.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">misses</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of get misses.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">removeHits</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of removal hits.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">removeMisses</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of removal misses.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Request:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Request header</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Response:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x00</code> = success, if stats retrieved<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of stats</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of individual stats returned.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Name 1 length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of named statistic.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Name 1</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">String containing statistic name.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value 1 length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of value field.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value 1</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">String containing statistic value.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Name 2 length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Name 2</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value 2 length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value 2</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">String</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;etc</p></td> <td class="tableblock halign-center valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> </tbody> </table> <div class="paragraph"> <div class="title">Ping</div> <p>Application level request to see if the server is available.</p> </div> <div class="paragraph"> <p>Request:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Request header</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Response:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x00</code> = success, if no errors<br></p></td> </tr> </tbody> </table> <div class="paragraph"> <div class="title">Error Handling</div> <p>Error response</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x8x</code> = error response code<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Error Message Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of error message</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Error Message</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Error message. In the case of 0x84 , this error field contains the latest version supported by the hot rod server. Length is defined by total body length.</p></td> </tr> </tbody> </table> <div class="paragraph"> <div class="title">Multi-Get Operations</div> <p>A multi-get operation is a form of get operation that instead of requesting a single key, requests a set of keys. The Hot Rod protocol does not include such operation but remote Hot Rod clients could easily implement this type of operations by either parallelizing/pipelining individual get requests. Another possibility would be for remote clients to use async or non-blocking get requests. For example, if a client wants N keys, it could send send N async get requests and then wait for all the replies. Finally, multi-get is not to be confused with bulk-get operations. In bulk-gets, either all or a number of keys are retrieved, but the client does not know which keys to retrieve, whereas in multi-get, the client defines which keys to retrieve.</p> </div> </div> <div class="sect5"> <h6 id="_example_put_request"><a class="anchor" href="#_example_put_request"></a>Example - Put request</h6> <div class="ulist"> <ul> <li> <p>Coded request</p> </li> </ul> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:11%;"> <col style="width:11%;"> <col style="width:11%;"> <col style="width:11%;"> <col style="width:11%;"> <col style="width:11%;"> <col style="width:11%;"> <col style="width:11%;"> <col style="width:11%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Byte</th> <th class="tableblock halign-left valign-top">0</th> <th class="tableblock halign-left valign-top">1</th> <th class="tableblock halign-left valign-top">2</th> <th class="tableblock halign-left valign-top">3</th> <th class="tableblock halign-left valign-top">4</th> <th class="tableblock halign-left valign-top">5</th> <th class="tableblock halign-left valign-top">6</th> <th class="tableblock halign-left valign-top">7</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0xA0</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x09</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x41</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x01</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x07</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x4D (<em>M</em>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x79 (<em>y</em>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x43 (<em>C</em>)</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x61 (<em>a</em>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x63 (<em>c</em>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x68 (<em>h</em>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x65 (<em>e</em>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x03</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">24</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x05</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x48 (<em>H</em>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x65 (<em>e</em>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x6C (<em>l</em>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x6C (<em>l</em>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x6F (<em>o</em>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x05</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x57 (<em>W</em>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x6F (<em>o</em>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x72 (<em>r</em>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x6C (<em>l</em>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x64 (<em>d</em>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"></p></td> </tr> </tbody> </table> <div class="ulist"> <ul> <li> <p>Field explanation</p> </li> </ul> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:25%;"> <col style="width:25%;"> <col style="width:25%;"> <col style="width:25%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-left valign-top">Value</th> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Magic (0)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0xA0</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Message Id (1)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x09</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Version (2)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x41</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Opcode (3)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x01</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Cache name length (4)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x07</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Cache name(5-11)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>MyCache</em></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Flag (12)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Client Intelligence (13)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x03</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Topology Id (14)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Transaction Type (15)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Transaction Id (16)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Key field length (17)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x05</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key (18 - 22)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>Hello</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Lifespan (23)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Max idle (24)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Value field length (25)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x05</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value (26-30)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>World</em></p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> </tbody> </table> <div class="ulist"> <ul> <li> <p>Coded response</p> </li> </ul> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:11%;"> <col style="width:11%;"> <col style="width:11%;"> <col style="width:11%;"> <col style="width:11%;"> <col style="width:11%;"> <col style="width:11%;"> <col style="width:11%;"> <col style="width:11%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Byte</th> <th class="tableblock halign-left valign-top">0</th> <th class="tableblock halign-left valign-top">1</th> <th class="tableblock halign-left valign-top">2</th> <th class="tableblock halign-left valign-top">3</th> <th class="tableblock halign-left valign-top">4</th> <th class="tableblock halign-left valign-top">5</th> <th class="tableblock halign-left valign-top">6</th> <th class="tableblock halign-left valign-top">7</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0xA1</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x09</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x01</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"><p class="tableblock"></p></td> </tr> </tbody> </table> <div class="ulist"> <ul> <li> <p>Field Explanation</p> </li> </ul> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:25%;"> <col style="width:25%;"> <col style="width:25%;"> <col style="width:25%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-left valign-top">Value</th> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Magic (0)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0xA1</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Message Id (1)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x09</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Opcode (2)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x01</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Status (3)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Topology change marker (4)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> </tbody> </table> </div> </div> <div class="sect4"> <h5 id="_hot_rod_protocol_1_1"><a class="anchor" href="#_hot_rod_protocol_1_1"></a>Hot Rod Protocol 1.1</h5> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> <div class="title">Infinispan versions</div> This version of the protocol is implemented since Infinispan 5.1.0.FINAL </td> </tr> </table> </div> <div class="sect5"> <h6 id="_request_header_2"><a class="anchor" href="#_request_header_2"></a>Request Header</h6> <div class="paragraph"> <p>The <code>version</code> field in the header is updated to <code>11</code>.</p> </div> </div> </div> <div class="sect4"> <h5 id="_distribution_aware_client_topology_change_header_2"><a class="anchor" href="#_distribution_aware_client_topology_change_header_2"></a>Distribution-Aware Client Topology Change Header</h5> <div class="admonitionblock important"> <table> <tr> <td class="icon"> <i class="icon-important" title="Important"></i> </td> <td class="content"> <div class="title">Updated for 1.1</div> This section has been modified to be more efficient when talking to distributed caches with virtual nodes enabled. </td> </tr> </table> </div> <div class="paragraph"> <p>This is what hash-distribution-aware clients receive as response header when a topology change is sent back:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header with topology change marker</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">See previous section.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Topology Id</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Topology ID</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Num Key Owners</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">2 bytes (Unsigned Short)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Globally configured number of copies for each Infinispan distributed key</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Hash Function Version</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Hash function version, pointing to a specific hash function in use. See <a href="#_hot_rod_hash_functions">Hot Rod hash functions</a> for details.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Hash space size</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Modulus used by Infinispan for for all module arithmetic related to hash code generation. Clients will likely require this information in order to apply the correct hash calculation to the keys.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Num servers in topology</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of Infinispan Hot Rod servers running within the cluster. This could be a subset of the entire cluster if only a fraction of those nodes are running Hot Rod servers.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Num Virtual Nodes Owners</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Field added in version <code>1.1</code> of the protocol that represents the number of configured virtual nodes. If no virtual nodes are configured or the cache is not configured with distribution, this field will contain 0.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m1: Host/IP length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of hostname or IP address of individual cluster member that Hot Rod client can use to access it. Using variable length here allows for covering for hostnames, IPv4 and IPv6 addresses.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m1: Host/IP address</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">String containing hostname or IP address of individual cluster member that Hot Rod client can use to access it.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m1: Port</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">2 bytes (Unsigned Short)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Port that Hot Rod clients can use to communicat with this cluster member.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m1: Hashcode</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">4 bytes</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">32 bit integer representing the hashcode of a cluster member that a Hot Rod client can use indentify in which cluster member a key is located having applied the CSA to it.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m2: Host/IP length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m2: Host/IP address</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m2: Port</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">2 bytes (Unsigned Short)</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m2: Hashcode</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">4 bytes</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;etc</p></td> <td class="tableblock halign-center valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> </tbody> </table> </div> <div class="sect4"> <h5 id="_server_node_hash_code_calculation"><a class="anchor" href="#_server_node_hash_code_calculation"></a>Server node hash code calculation</h5> <div class="paragraph"> <p>Adding support for virtual nodes has made version <code>1.0</code> of the Hot Rod protocol impractical due to bandwidth it would have taken to return hash codes for all virtual nodes in the clusters (this number could easily be in the millions). So, as of version <code>1.1</code> of the Hot Rod protocol, clients are given the base hash id or hash code of each server, and then they have to calculate the real hash position of each server both with and without virtual nodes configured. Here are the rules clients should follow when trying to calculate a node&#8217;s hash code:</p> </div> <div class="paragraph"> <p>1. With <em>virtual nodes disabled</em> : Once clients have received the base hash code of the server, they need to normalize it in order to find the exact position of the hash wheel. The process of normalization involves passing the base hash code to the hash function, and then do a small calculation to avoid negative values. The resulting number is the node&#8217;s position in the hash wheel:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay"><code class="java language-java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">int</span> getNormalizedHash(<span class="type">int</span> nodeBaseHashCode, Hash hashFct) {
   <span class="keyword">return</span> hashFct.hash(nodeBaseHashCode) &amp; <span class="predefined-type">Integer</span>.MAX_VALUE; <span class="comment">// make sure no negative numbers are involved.</span>
}</code></pre> </div> </div> <div class="paragraph"> <p>2. With <em>virtual nodes enabled</em> : In this case, each node represents N different virtual nodes, and to calculate each virtual node&#8217;s hash code, we need to take the the range of numbers between 0 and N-1 and apply the following logic:</p> </div> <div class="ulist"> <ul> <li> <p>For virtual node with 0 as id, use the technique used to retrieve a node&#8217;s hash code, as shown in the previous section.</p> </li> <li> <p>For virtual nodes from 1 to N-1 ids, execute the following logic:</p> </li> </ul> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay"><code class="java language-java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">int</span> virtualNodeHashCode(<span class="type">int</span> nodeBaseHashCode, <span class="type">int</span> id, Hash hashFct) {
   <span class="type">int</span> virtualNodeBaseHashCode = id;
   virtualNodeBaseHashCode = <span class="integer">31</span> * virtualNodeBaseHashCode + nodeBaseHashCode;
   <span class="keyword">return</span> getNormalizedHash(virtualNodeBaseHashCode, hashFct);
}</code></pre> </div> </div> </div> <div class="sect4"> <h5 id="_hot_rod_protocol_1_2"><a class="anchor" href="#_hot_rod_protocol_1_2"></a>Hot Rod Protocol 1.2</h5> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> <div class="title">Infinispan versions</div> This version of the protocol is implemented since Infinispan 5.2.0.Final. Since Infinispan 5.3.0, HotRod supports encryption via SSL. However, since this only affects the transport, the version number of the protocol has not been incremented. </td> </tr> </table> </div> <div class="sect5"> <h6 id="_request_header_3"><a class="anchor" href="#_request_header_3"></a>Request Header</h6> <div class="paragraph"> <p>The <code>version</code> field in the header is updated to <code>12</code>.</p> </div> <div class="paragraph"> <p>Two new request operation codes have been added:</p> </div> <div class="ulist"> <ul> <li> <p><code>0x1B</code> = getWithMetadata request</p> </li> <li> <p><code>0x1D</code> = bulkKeysGet request</p> </li> </ul> </div> <div class="paragraph"> <p>Two new flags have been added too:</p> </div> <div class="ulist"> <ul> <li> <p><code>0x0002</code> = use cache-level configured default lifespan</p> </li> <li> <p><code>0x0004</code> = use cache-level configured default max idle</p> </li> </ul> </div> </div> <div class="sect5"> <h6 id="_response_header_2"><a class="anchor" href="#_response_header_2"></a>Response Header</h6> <div class="paragraph"> <p>Two new response operation codes have been added:</p> </div> <div class="ulist"> <ul> <li> <p><code>0x1C</code> = getWithMetadata response</p> </li> <li> <p><code>0x1E</code> = bulkKeysGet response</p> </li> </ul> </div> </div> <div class="sect5"> <h6 id="_operations_2"><a class="anchor" href="#_operations_2"></a>Operations</h6> <div class="paragraph"> <div class="title">GetWithMetadata</div> <p>Request format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Request header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of key. Note that the size of a vint can be up to 5 bytes which in theory can produce bigger numbers than Integer.MAX_VALUE. However, Java cannot create a single array thats bigger than Integer.MAX_VALUE, hence the protocol is limiting vint array lengths to Integer.MAX_VALUE.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Byte array containing the key whose value is being requested.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Response format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x00</code> = success, if key retrieved<br> <code>0x02</code> = if key does not exist<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Flag</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">A flag indicating whether the response contains expiration information. The value of the flag is obtained as a bitwise OR operation between <code>INFINITE_LIFESPAN (0x01)</code> and <code>INFINITE_MAXIDLE (0x02)</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Created</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">Long</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">(optional) a Long representing the timestamp when the entry was created on the server. This value is returned only if the flag&#8217;s <code>INFINITE_LIFESPAN</code> bit is not set.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Lifespan</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">(optional) a vInt representing the lifespan of the entry in seconds. This value is returned only if the flag&#8217;s <code>INFINITE_LIFESPAN</code> bit is not set.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">LastUsed</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">Long</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">(optional) a Long representing the timestamp when the entry was last accessed on the server. This value is returned only if the flag&#8217;s <code>INFINITE_MAXIDLE</code> bit is not set.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">MaxIdle</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">(optional) a vInt representing the maxIdle of the entry in seconds. This value is returned only if the flag&#8217;s <code>INFINITE_MAXIDLE</code> bit is not set.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Entry Version</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">8 bytes</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Unique value of an existing entry&#8217;s modification. The protocol does not mandate that entry_version values are sequential. They just need to be unique per update at the key level.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If success, length of value</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If success, the requested value</p></td> </tr> </tbody> </table> <div class="paragraph"> <div class="title">BulkKeysGet</div> <p>Request format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Request header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code> = Default Scope - This scope is used by RemoteCache.keySet() method. If the remote cache is a distributed cache, the server launch a map/reduce operation to retrieve all keys from all of the nodes. (Remember, a topology-aware Hot Rod Client could be load balancing the request to any one node in the cluster). Otherwise, it&#8217;ll get keys from the cache instance local to the server receiving the request (that is because the keys should be the same across all nodes in a replicated cache).<br> <code>1</code> = Global Scope - This scope behaves the same to Default Scope.<br> <code>2</code> = Local Scope - In case when remote cache is a distributed cache, the server will not launch a map/reduce operation to retrieve keys from all nodes. Instead, it&#8217;ll only get keys local from the cache instance local to the server receiving the request.<br></p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Response format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x00</code> = success, data follows<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">More</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">One byte representing whether more keys need to be read from the stream. So, when it&#8217;s set to 1, it means that an entry follows, whereas when it&#8217;s set to 0, it&#8217;s the end of stream and no more entries are left to read. For more information on BulkGet look <a href="http://community.jboss.org/docs/DOC-15592">here</a></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key 1 Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of key</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key 1</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Retrieved key</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">More</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key 2 Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key 2</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230; etc</p></td> <td class="tableblock halign-center valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> </tbody> </table> </div> </div> <div class="sect4"> <h5 id="_hot_rod_protocol_1_3"><a class="anchor" href="#_hot_rod_protocol_1_3"></a>Hot Rod Protocol 1.3</h5> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> <div class="title">Infinispan versions</div> This version of the protocol is implemented since Infinispan 6.0.0.Final. </td> </tr> </table> </div> <div class="sect5"> <h6 id="_request_header_4"><a class="anchor" href="#_request_header_4"></a>Request Header</h6> <div class="paragraph"> <p>The <code>version</code> field in the header is updated to <code>13</code>.</p> </div> <div class="paragraph"> <p>A new request operation code has been added:</p> </div> <div class="ulist"> <ul> <li> <p><code>0x1F</code> = query request</p> </li> </ul> </div> </div> <div class="sect5"> <h6 id="_response_header_3"><a class="anchor" href="#_response_header_3"></a>Response Header</h6> <div class="paragraph"> <p>A new response operation code has been added:</p> </div> <div class="ulist"> <ul> <li> <p><code>0x20</code> = query response</p> </li> </ul> </div> </div> <div class="sect5"> <h6 id="_operations_3"><a class="anchor" href="#_operations_3"></a>Operations</h6> <div class="paragraph"> <div class="title">Query</div> <p>Request format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Request header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Query Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The length of the protobuf encoded query object</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Query</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Byte array containing the protobuf encoded query object, having a length specified by previous field.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Response format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response payload Length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The length of the protobuf encoded response object</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response payload</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Byte array containing the protobuf encoded response object, having a length specified by previous field.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>As of Infinispan 6.0, the query and response objects are specified by the protobuf message types <em>org.infinispan.client.hotrod.impl.query.QueryRequest</em> and <em>org.infinispan.client.hotrod.impl.query.QueryResponse</em> respectively defined in <a href="https://github.com/infinispan/infinispan/blob/master/remote-query/remote-query-client/src/main/resources/query.proto">remote-query/remote-query-client/src/main/resources/query.proto</a>. These definitions could change in future Infinispan versions, but as long as these evolutions will be kept backward compatible (according to the rules defined <a href="https://developers.google.com/protocol-buffers/docs/proto#updating">here</a>) no new Hot Rod protocol version will be introduced to accommodate this.</p> </div> </div> </div> <div class="sect4"> <h5 id="_hot_rod_protocol_2_0"><a class="anchor" href="#_hot_rod_protocol_2_0"></a>Hot Rod Protocol 2.0</h5> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> <div class="title">Infinispan versions</div> This version of the protocol is implemented since Infinispan 7.0.0.Final. </td> </tr> </table> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon"> <i class="icon-tip" title="Tip"></i> </td> <td class="content"> Starting with this protocol version, the previous limitation of having to interact with defined cache names has been dropped. From now on, clients can interact with caches, whose names, are not necessarily defined in the cache configuration. </td> </tr> </table> </div> <div class="sect5"> <h6 id="_request_header_5"><a class="anchor" href="#_request_header_5"></a>Request Header</h6> <div class="paragraph"> <p>The request header no longer contains <code>Transaction Type</code> and <code>Transaction ID</code> elements since they&#8217;re not in use, and even if they were in use, there are several operations for which they would not make sense, such as <code>ping</code> or <code>stats</code> commands. Once transactions are implemented, the protocol version will be upped, with the necessary changes in the request header.</p> </div> <div class="paragraph"> <p>The <code>version</code> field in the header is updated to <code>20</code>.</p> </div> <div class="paragraph"> <p>Two new flags have been added:</p> </div> <div class="ulist"> <ul> <li> <p><code>0x0008</code> = operation skips loading from configured cache loader.</p> </li> <li> <p><code>0x0010</code> = operation skips indexing. Only relevant when the query module is enabled for the cache</p> </li> </ul> </div> <div class="paragraph"> <p>The following new request operation codes have been added:</p> </div> <div class="ulist"> <ul> <li> <p><code>0x21</code> = auth mech list request</p> </li> <li> <p><code>0x23</code> = auth request</p> </li> <li> <p><code>0x25</code> = add client remote event listener request</p> </li> <li> <p><code>0x27</code> = remove client remote event listener request</p> </li> <li> <p><code>0x29</code> = size request</p> </li> </ul> </div> </div> <div class="sect5"> <h6 id="_response_header_4"><a class="anchor" href="#_response_header_4"></a>Response Header</h6> <div class="paragraph"> <p>The following new response operation codes have been added:</p> </div> <div class="ulist"> <ul> <li> <p><code>0x22</code> = auth mech list response</p> </li> <li> <p><code>0x24</code> = auth mech response</p> </li> <li> <p><code>0x26</code> = add client remote event listener response</p> </li> <li> <p><code>0x28</code> = remove client remote event listener response</p> </li> <li> <p><code>0x2A</code> = size response</p> </li> </ul> </div> <div class="paragraph"> <p>Two new error codes have also been added to enable clients more intelligent decisions, particularly when it comes to fail-over logic:</p> </div> <div class="ulist"> <ul> <li> <p><code>0x87</code> = Node suspected. When a client receives this error as response, it means that the node that responded had an issue sending an operation to a third node, which was suspected. Generally, requests that return this error should be failed-over to other nodes.</p> </li> <li> <p><code>0x88</code> = Illegal lifecycle state. When a client receives this error as response, it means that the server-side cache or cache manager are not available for requests because either stopped, they&#8217;re stopping or similar situation. Generally, requests that return this error should be failed-over to other nodes.</p> </li> </ul> </div> <div class="paragraph"> <p>Some adjustments have been made to the responses for the following commands in order to better handle response decoding without the need to keep track of the information sent. More precisely, the way previous values are parsed has changed so that the status of the command response provides clues on whether the previous value follows or not. More precisely:</p> </div> <div class="ulist"> <ul> <li> <p>Put response returns <code>0x03</code> status code when put was successful and previous value follows.</p> </li> <li> <p>PutIfAbsent response returns <code>0x04</code> status code only when the putIfAbsent operation failed because the key was present and its value follows in the response. If the putIfAbsent worked, there would have not been a previous value, and hence it does not make sense returning anything extra.</p> </li> <li> <p>Replace response returns <code>0x03</code> status code only when replace happened and the previous or replaced value follows in the response. If the replace did not happen, it means that the cache entry was not present, and hence there&#8217;s no previous value that can be returned.</p> </li> <li> <p>ReplaceIfUnmodified returns <code>0x03</code> status code only when replace happened and the previous or replaced value follows in the response.</p> </li> <li> <p>ReplaceIfUnmodified returns <code>0x04</code> status code only when replace did not happen as a result of the key being modified, and the modified value follows in the response.</p> </li> <li> <p>Remove returns <code>0x03</code> status code when the remove happened and the previous or removed value follows in the response. If the remove did not occur as a result of the key not being present, it does not make sense sending any previous value information.</p> </li> <li> <p>RemoveIfUnmodified returns <code>0x03</code> status code only when remove happened and the previous or replaced value follows in the response.</p> </li> <li> <p>RemoveIfUnmodified returns <code>0x04</code> status code only when remove did not happen as a result of the key being modified, and the modified value follows in the response.</p> </li> </ul> </div> </div> </div> <div class="sect4"> <h5 id="_distribution_aware_client_topology_change_header_3"><a class="anchor" href="#_distribution_aware_client_topology_change_header_3"></a>Distribution-Aware Client Topology Change Header</h5> <div class="paragraph"> <p>In Infinispan 5.2, virtual nodes based consistent hashing was abandoned and instead segment based consistent hash was implemented. In order to satisfy the ability for Hot Rod clients to find data as reliably as possible, Infinispan has been transforming the segment based consistent hash to fit Hot Rod 1.x protocol. Starting with version 2.0, a brand new distribution-aware topology change header has been implemented which suppors segment based consistent hashing suitably and provides 100% data location guarantees.</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header with topology change marker</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Topology Id</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Topology ID</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Num servers in topology</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of Infinispan Hot Rod servers running within the cluster. This could be a subset of the entire cluster if only a fraction of those nodes are running Hot Rod servers.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m1: Host/IP length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of hostname or IP address of individual cluster member that Hot Rod client can use to access it. Using variable length here allows for covering for hostnames, IPv4 and IPv6 addresses.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m1: Host/IP address</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">String containing hostname or IP address of individual cluster member that Hot Rod client can use to access it.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m1: Port</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">2 bytes (Unsigned Short)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Port that Hot Rod clients can use to communicat with this cluster member.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m2: Host/IP length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m2: Host/IP address</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">m2: Port</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">2 bytes (Unsigned Short)</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">&#8230;</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Hash Function Version</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Hash function version, pointing to a specific hash function in use. See <a href="#_hot_rod_hash_functions">Hot Rod hash functions</a> for details.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Num segments in topology</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Total number of segments in the topology</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Number of owners in segment</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">This can be either 0, 1 or 2 owners.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">First owner&#8217;s index</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Given the list of all nodes, the position of this owner in this list. This is only present if number of owners for this segment is 1 or 2.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Second owner&#8217;s index</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Given the list of all nodes, the position of this owner in this list. This is only present if number of owners for this segment is 2.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Given this information, Hot Rod clients should be able to recalculate all the hash segments and be able to find out which nodes are owners for each segment. Even though there could be more than 2 owners per segment, Hot Rod protocol limits the number of owners to send for efficiency reasons.</p> </div> <div class="sect5"> <h6 id="_operations_4"><a class="anchor" href="#_operations_4"></a>Operations</h6> <div class="paragraph"> <div class="title">Auth Mech List</div> <p>Request format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Request header</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Response format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Mech count</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The number of mechs</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Mech 1</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">String containing the name of the SASL mech in its IANA-registered form (e.g. GSSAPI, CRAM-MD5, etc)</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Mech 2</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;etc</p></td> <td class="tableblock halign-center valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> </tbody> </table> <div class="paragraph"> <p>The purpose of this operation is to obtain the list of valid SASL authentication mechs supported by the server. The client will then need to issue an Authenticate request with the preferred mech.</p> </div> <div class="paragraph"> <div class="title">Authenticate</div> <p>Request format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Request header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Mech</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">String containing the name of the mech chosen by the client for authentication. Empty on the successive invocations</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of the SASL client response</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Response data</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The SASL client response</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Response format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Completed</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">0 if further processing is needed, 1 if authentication is complete</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Challenge length</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Length of the SASL server challenge</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Challenge data</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The SASL server challenge</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>The purpose of this operation is to authenticate a client against a server using SASL. The authentication process, depending on the chosen mech, might be a multi-step operation. Once complete the connection becomes authenticated</p> </div> <div class="paragraph"> <div class="title">Add client listener for remote events</div> <p>Request format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Request header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Listener ID</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Listener identifier</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Include state</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">When this byte is set to <code>1</code>, cached state is sent back to remote clients when either adding a cache listener for the first time, or when the node where a remote listener is registered changes in a clustered environment. When enabled, state is sent back as cache entry created events to the clients. If set to <code>0</code>, no state is sent back to the client when adding a listener, nor it gets state when the node where the listener is registered changes.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key/value filter factory name</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Optional name of the key/value filter factory to be used with this listener. The factory is used to create key/value filter instances which allow events to be filtered directly in the Hot Rod server, avoiding sending events that the client is not interested in. If no factory is to be used, the length of the string is <code>0</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key/value filter factory parameter count</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The key/value filter factory, when creating a filter instance, can take an arbitrary number of parameters, enabling the factory to be used to create different filter instances dynamically. This count field indicates how many parameters will be passed to the factory. If no factory name was provided, this field is not present in the request.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key/value filter factory parameter 1</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">First key/value filter factory parameter</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key/value filter factory parameter 2</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Second key/value filter factory parameter</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;</p></td> <td class="tableblock halign-center valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Converter factory name</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">string</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Optional name of the converter factory to be used with this listener. The factory is used to transform the contents of the events sent to clients. By default, when no converter is in use, events are well defined, according to the type of event generated. However, there might be situations where users want to add extra information to the event, or they want to reduce the size of the events. In these cases, a converter can be used to transform the event contents. The given converter factory name produces converter instances to do this job. If no factory is to be used, the length of the string is <code>0</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Converter factory parameter count</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The converter factory, when creating a converter instance, can take an arbitrary number of parameters, enabling the factory to be used to create different converter instances dynamically. This count field indicates how many parameters will be passed to the factory. If no factory name was provided, this field is not present in the request.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Converter factory parameter 1</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">First converter factory parameter</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Converter factory parameter 2</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Second converter factory parameter</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;</p></td> <td class="tableblock halign-center valign-top"></td> <td class="tableblock halign-left valign-top"></td> </tr> </tbody> </table> <div class="paragraph"> <p>Response format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> </tbody> </table> <div class="paragraph"> <div class="title">Remove client listener for remote events</div> <p>Request format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Request header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Listener ID</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Listener identifier</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Response format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> </tbody> </table> <div class="paragraph"> <div class="title">Size</div> <p>Request format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Request header</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Response format:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Response header</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Size</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vInt</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Size of the remote cache, which is calculated globally in the clustered set ups, and if present, takes cache store contents into account as well.</p></td> </tr> </tbody> </table> </div> <div class="sect5"> <h6 id="_remote_events"><a class="anchor" href="#_remote_events"></a>Remote Events</h6> <div class="paragraph"> <p>Starting with Hot Rod 2.0, clients can register listeners for remote events happening in the server. Sending these events commences the moment a client adds a client listener for remote events.</p> </div> <div class="paragraph"> <p>Event Header:</p> </div> <table class="tableblock frame-all grid-all" style="width:100%; "> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Magic</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0xA1</code> = response</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Message ID</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">vLong</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">ID of event</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Opcode</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Event type:<br> <code>0x60</code> = cache entry created event<br> <code>0x61</code> = cache entry modified event<br> <code>0x62</code> = cache entry removed event<br> <code>0x50</code> = error<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Status</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Status of the response, possible values:<br> <code>0x00</code> = No error<br></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Topology Change Marker</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">1 byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Since events are not associated with a particular incoming topology ID to be able to decide whether a new topology is required to be sent or not, new topologies will never be sent with events. Hence, this marker will always have <code>0</code> value for events.</p></td> </tr> </tbody> </table> <table class="tableblock frame-all grid-all" style="width:100%; "> <caption class="title">Table 3. Cache entry created event</caption> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Event header with <code>0x60</code> operation code</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Listener ID</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Listener for which this event is directed</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Custom marker</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Custom event marker. For created events, this is <code>0</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Command retried</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Marker for events that are result of retried commands. If command is retried, it returns <code>1</code>, otherwise <code>0</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Created key</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Version</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">long</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Version of the created entry. This version information can be used to make conditional operations on this cache entry.</p></td> </tr> </tbody> </table> <table class="tableblock frame-all grid-all" style="width:100%; "> <caption class="title">Table 4. Cache entry modified event</caption> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Event header with <code>0x61</code> operation code</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Listener ID</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Listener for which this event is directed</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Custom marker</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Custom event marker. For created events, this is <code>0</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Command retried</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Marker for events that are result of retried commands. If command is retried, it returns <code>1</code>, otherwise <code>0</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Modified key</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Version</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">long</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Version of the modified entry. This version information can be used to make conditional operations on this cache entry.</p></td> </tr> </tbody> </table> <table class="tableblock frame-all grid-all" style="width:100%; "> <caption class="title">Table 5. Cache entry removed event</caption> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Event header with <code>0x62</code> operation code</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Listener ID</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Listener for which this event is directed</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Custom marker</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Custom event marker. For created events, this is <code>0</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Command retried</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Marker for events that are result of retried commands. If command is retried, it returns <code>1</code>, otherwise <code>0</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Key</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Removed key</p></td> </tr> </tbody> </table> <table class="tableblock frame-all grid-all" style="width:100%; "> <caption class="title">Table 6. Custom event</caption> <colgroup> <col style="width:20%;"> <col style="width:13%;"> <col style="width:66%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Field Name</th> <th class="tableblock halign-center valign-top">Size</th> <th class="tableblock halign-left valign-top">Value</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">variable</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Event header with event specific operation code</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Listener ID</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Listener for which this event is directed</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Custom marker</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Custom event marker. For custom events, this is <code>1</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Event data</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">byte array</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Custom event data, formatted according to the converter implementation logic.</p></td> </tr> </tbody> </table> </div> </div> </div> <div class="sect3"> <h4 id="_hot_rod_hash_functions"><a class="anchor" href="#_hot_rod_hash_functions"></a>2. Hot Rod Hash Functions</h4> <div class="paragraph"> <p>Infinispan makes use of a consistent hash function to place nodes on a hash wheel, and to place keys of entries on the same wheel to determine where entries live.</p> </div> <div class="paragraph"> <p>In Infinispan 4.2 and earlier, the hash space was hardcoded to 10240, but since 5.0, the hash space is <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Integer.html#MAX_VALUE">Integer.MAX_INT</a> . Please note that since Hot Rod clients should not assume a particular hash space by default, every time a hash-topology change is detected, this value is sent back to the client via the Hot Rod protocol.</p> </div> <div class="paragraph"> <p>When interacting with Infinispan via the Hot Rod protocol, it is mandated that keys (and values) are byte arrays, to ensure platform neutral behavior. As such, smart-clients which are aware of hash distribution on the backend would need to be able to calculate the hash codes of such byte array keys, again in a platform-neutral manner. To this end, the hash functions used by Infinispan are versioned and documented, so that it can be re-implemented by non-Java clients if needed.</p> </div> <div class="paragraph"> <p>The version of the hash function in use is provided in the Hot Rod protocol, as the hash function version parameter.</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Version 1 (single byte, 0x01) The initial version of the hash function in use is <a href="https://github.com/infinispan/infinispan/blob/master/commons/src/main/java/org/infinispan/commons/hash/MurmurHash2.java">Austin Appleby&#8217;s MurmurHash 2.0 algorithm</a> , a fast, non-cryptographic hash that exhibits excellent distribution, collision resistance and avalanche behavior. The specific version of the algorithm used is the slightly slower, endian-neutral version that allows consistent behavior across both big- and little-endian CPU architectures. Infinispan&#8217;s version also hard-codes the hash seed as -1. For details of the algorithm, please visit <a href="http://sites.google.com/site/murmurhash/">Austin Appleby&#8217;s MurmurHash 2.0 page</a> . Other implementations are detailed on <a href="http://en.wikipedia.org/wiki/MurmurHash">Wikipedia</a> . This hash function was the default one used by the Hot Rod server until Infinispan 4.2.1.</p> </li> <li> <p>Version 2 (single byte, 0x02) Since Infinispan 5.0, a new hash function is used by default which is <a href="https://github.com/infinispan/infinispan/blob/master/commons/src/main/java/org/infinispan/commons/hash/MurmurHash3.java">Austin Appleby&#8217;s MurmurHash 3.0 algorithm</a> . Detailed information about the hash function can be found in this <a href="http://code.google.com/p/smhasher/wiki/MurmurHash3">wiki</a> . Compared to 2.0, it provides better performance and spread.</p> </li> </ol> </div> </div> </div> <div id="footer"> <div id="footer-text"> Last updated 2015-02-02 15:48:45 CET </div> </div> </body> </html>