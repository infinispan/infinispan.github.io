<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Using the Infinispan REST Server</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="canonical" href="https://infinispan.org/docs/stable/index.html">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.1/themes/default/style.min.css">
<link rel="stylesheet" href="../../css/css.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.1/jstree.min.js"></script>
<script src="../../js/js.js"></script>
<style>
.hidden {
    display: none;
}

.switch {
    border-width: 1px 1px 0 1px;
    border-style: solid;
    border-color: #7a2518;
    display: inline-block;
}

.switch--item {
    padding: 10px;
    background-color: #ffffff;
    color: #7a2518;
    display: inline-block;
    cursor: pointer;
}

.switch--item.selected {
    background-color: #7a2519;
    color: #ffffff;
}

</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
<script type="text/javascript">
function addBlockSwitches() {
    $('.primary').each(function() {
        primary = $(this);
        createSwitchItem(primary, createBlockSwitch(primary)).item.addClass("selected");
        primary.children('.title').remove();
    });
    $('.secondary').each(function(idx, node) {
        secondary = $(node);
        primary = findPrimary(secondary);
        switchItem = createSwitchItem(secondary, primary.children('.switch'));
        switchItem.content.addClass('hidden');
        findPrimary(secondary).append(switchItem.content);
        secondary.remove();
    });
}

function createBlockSwitch(primary) {
    blockSwitch = $('<div class="switch"></div>');
    primary.prepend(blockSwitch);
    return blockSwitch;
}

function findPrimary(secondary) {
    candidate = secondary.prev();
    while (!candidate.is('.primary')) {
        candidate = candidate.prev();
    }
    return candidate;
}

function createSwitchItem(block, blockSwitch) {
    blockName = block.children('.title').text();
    content = block.children('.content').first().append(block.next('.colist'));
    item = $('<div class="switch--item">' + blockName + '</div>');
    item.on('click', '', content, function(e) {
        $(this).addClass('selected');
        $(this).siblings().removeClass('selected');
        e.data.siblings('.content').addClass('hidden');
        e.data.removeClass('hidden');
    });
    blockSwitch.append(item);
    return {'item': item, 'content': content};
}

$(addBlockSwitches);

</script>

</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Using the Infinispan REST Server</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#rest_server">1. Infinispan REST Endpoint</a>
<ul class="sectlevel2">
<li><a href="#rest_security">1.1. REST Authentication</a></li>
<li><a href="#rest_supported_protocols">1.2. Supported Protocols</a></li>
<li><a href="#rest_data_formats">1.3. Data Formats and the REST API</a>
<ul class="sectlevel3">
<li><a href="#rest_server_data_format_support">1.3.1. Supported Formats</a></li>
<li><a href="#rest_accept">1.3.2. Accept Headers</a></li>
<li><a href="#rest_encoded_names">1.3.3. Names with Special Characters</a></li>
<li><a href="#rest_key_content_type">1.3.4. Key-Content-Type Headers</a></li>
<li><a href="#rest_json_proto_conversion">1.3.5. JSON/Protostream Conversion</a></li>
</ul>
</li>
<li><a href="#rest_cors">1.4. Cross-Origin Resource Sharing (CORS) Requests</a>
<ul class="sectlevel3">
<li><a href="#allowing_all_cors_permissions_for_some_origins">1.4.1. Allowing all CORS permissions for some origins</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#rest_v2_api">2. Interacting with the Infinispan REST API</a>
<ul class="sectlevel2">
<li><a href="#rest_v2_cache_operations">2.1. Creating and Managing Caches</a>
<ul class="sectlevel3">
<li><a href="#rest_v2_create_cache">2.1.1. Creating Caches</a>
<ul class="sectlevel4">
<li><a href="#cache_configuration">Cache Configuration</a></li>
</ul>
</li>
<li><a href="#rest_v2_modify_cache">2.1.2. Modifying Caches</a></li>
<li><a href="#rest_v2_cache_exists">2.1.3. Verifying Caches</a></li>
<li><a href="#rest_v2_create_cache_template">2.1.4. Creating Caches with Templates</a></li>
<li><a href="#rest_v2_cache_configuration">2.1.5. Retrieving Cache Configuration</a></li>
<li><a href="#rest_v2_cache_config_convert">2.1.6. Converting Cache Configurations to JSON</a></li>
<li><a href="#rest_v2_cache_detail">2.1.7. Retrieving All Cache Details</a></li>
<li><a href="#rest_v2_add_entries">2.1.8. Adding Entries</a></li>
<li><a href="#rest_v2_replace_entries">2.1.9. Replacing Entries</a></li>
<li><a href="#rest_v2_retrieve_cache">2.1.10. Retrieving Data By Keys</a></li>
<li><a href="#rest_v2_check_entries">2.1.11. Checking if Entries Exist</a></li>
<li><a href="#rest_v2_delete_entries">2.1.12. Deleting Entries</a></li>
<li><a href="#rest_v2_remove_cache">2.1.13. Deleting Caches</a></li>
<li><a href="#rest_v2_get_keys">2.1.14. Retrieving All Keys from Caches</a></li>
<li><a href="#rest_v2_get_entries">2.1.15. Retrieving All Entries from Caches</a></li>
<li><a href="#rest_v2_clear_cache">2.1.16. Clearing Caches</a></li>
<li><a href="#rest_v2_cache_size">2.1.17. Getting Cache Size</a></li>
<li><a href="#rest_v2_cache_stats">2.1.18. Getting Cache Statistics</a></li>
<li><a href="#rest_v2_query_cache">2.1.19. Querying Caches</a></li>
<li><a href="#rest_v2_query_reindex">2.1.20. Re-indexing Data</a></li>
<li><a href="#rest_v2_query_purge_index">2.1.21. Purging Indexes</a></li>
<li><a href="#rest_v2_search_stats">2.1.22. Retrieving Query and Index Statistics</a></li>
<li><a href="#rest_v2_search_stats_clear">2.1.23. Clearing Search Statistics</a></li>
<li><a href="#rest_v2_query_index_stats">2.1.24. Retrieving Index Statistics (Deprecated)</a></li>
<li><a href="#rest_v2_query_stats">2.1.25. Retrieving Query Statistics (Deprecated)</a></li>
<li><a href="#rest_v2_query_stats_clear">2.1.26. Clearing Query Statistics (Deprecated)</a></li>
<li><a href="#rest_v2_list_caches">2.1.27. Listing Caches</a></li>
<li><a href="#rest_v2_cache_listen">2.1.28. Listening to cache events</a></li>
<li><a href="#rest_v2_caches_enable_rebalancing">2.1.29. Enabling rebalancing</a></li>
<li><a href="#rest_v2_caches_disable_rebalancing">2.1.30. Disabling rebalancing</a></li>
<li><a href="#rest_v2_xsite_cache">2.1.31. Cross-Site Operations with Caches</a>
<ul class="sectlevel4">
<li><a href="#rest_v2_xsite_sites_status">Getting Status of All Backup Locations</a></li>
<li><a href="#rest_v2_xsite_site_status">Getting Status of Specific Backup Locations</a></li>
<li><a href="#rest_v2_xsite_take_site_offline">Taking Backup Locations Offline</a></li>
<li><a href="#rest_v2_xsite_bring_backup_online">Bringing Backup Locations Online</a></li>
<li><a href="#rest_v2_xsite_start_push">Pushing State to Backup Locations</a></li>
<li><a href="#rest_v2_xsite_cancel_state_push">Canceling State Transfer</a></li>
<li><a href="#rest_v2_xsite_state_push">Getting State Transfer Status</a></li>
<li><a href="#rest_v2_xsite_clear_transfer_status">Clearing State Transfer Status</a></li>
<li><a href="#rest_v2_xsite_tuning_takeoffline">Modifying Take Offline Conditions</a></li>
<li><a href="#rest_v2_xsite_cancel_receive_state">Canceling State Transfer from Receiving Sites</a></li>
</ul>
</li>
<li><a href="#rest_v2_rolling_upgrades">2.1.32. Rolling Upgrades</a>
<ul class="sectlevel4">
<li><a href="#rest_v2_sync_data">Connecting Source Clusters</a></li>
<li><a href="#synchronizing_data">Synchronizing Data</a></li>
<li><a href="#rest_v2_disconnect_source">Disconnecting Source Clusters</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#rest_v2_counters">2.2. Creating and Managing Counters</a>
<ul class="sectlevel3">
<li><a href="#rest_server_counters_create">2.2.1. Creating Counters</a></li>
<li><a href="#rest_server_counters_delete">2.2.2. Deleting Counters</a></li>
<li><a href="#rest_server_counters_config">2.2.3. Retrieving Counter Configuration</a></li>
<li><a href="#rest_server_counters_get">2.2.4. Getting Counter Values</a></li>
<li><a href="#rest_server_counters_reset">2.2.5. Resetting Counters</a></li>
<li><a href="#rest_server_counters_inc_weak">2.2.6. Incrementing Counters</a></li>
<li><a href="#rest_server_counters_add_weak">2.2.7. Adding Deltas to Counters</a></li>
<li><a href="#rest_server_counters_dec">2.2.8. Decrementing Counter Values</a></li>
<li><a href="#rest_server_counters_cmpset">2.2.9. Performing compareAndSet Operations on Strong Counters</a></li>
<li><a href="#rest_server_counters_cmpswp">2.2.10. Performing compareAndSwap Operations on Strong Counters</a></li>
<li><a href="#rest_server_counters_list">2.2.11. Listing Counters</a></li>
</ul>
</li>
<li><a href="#rest_v2_protobuf_schemas">2.3. Working with Protobuf Schemas</a>
<ul class="sectlevel3">
<li><a href="#rest_v2_create_protobuf">2.3.1. Creating Protobuf Schemas</a></li>
<li><a href="#rest_v2_get_protobuf">2.3.2. Reading Protobuf Schemas</a></li>
<li><a href="#rest_v2_update_protobuf">2.3.3. Updating Protobuf Schemas</a></li>
<li><a href="#rest_v2_delete_protobuf">2.3.4. Deleting Protobuf Schemas</a></li>
<li><a href="#rest_v2_list_protobuf">2.3.5. Listing Protobuf Schemas</a></li>
</ul>
</li>
<li><a href="#rest_v2_cache_managers">2.4. Working with Cache Managers</a>
<ul class="sectlevel3">
<li><a href="#rest_v2_cache_manager_info">2.4.1. Getting Basic Cache Manager Information</a></li>
<li><a href="#rest_v2_cache_manager_health">2.4.2. Getting Cluster Health</a></li>
<li><a href="#rest_v2_cache_manager_health_status">2.4.3. Getting Cache Manager Health Status</a></li>
<li><a href="#rest_v2_cache_manager_availability">2.4.4. Checking REST Endpoint Availability</a></li>
<li><a href="#rest_v2_cache_manager_config">2.4.5. Obtaining Global Configuration for Cache Managers</a></li>
<li><a href="#rest_v2_cache_manager_caches_config">2.4.6. Obtaining Configuration for All Caches</a></li>
<li><a href="#rest_v2_cache_manager_cache_templates">2.4.7. Listing Available Cache Templates</a></li>
<li><a href="#rest_v2_cache_manager_cache_list">2.4.8. (Experimental) Obtaining Cache Status and Information</a></li>
<li><a href="#rest_v2_cache_manager_stats">2.4.9. Getting Cache Manager Statistics</a></li>
<li><a href="#rest_v2_cache_manager_enable_rebalancing">2.4.10. Enabling rebalancing for all caches</a></li>
<li><a href="#rest_v2_cache_manager_disable_rebalancing">2.4.11. Disabling rebalancing for all caches</a></li>
<li><a href="#rest_v2_backup_manager_create">2.4.12. Backing Up Infinispan Cache Managers</a></li>
<li><a href="#rest_v2_backup_manager_list">2.4.13. Listing Backups</a></li>
<li><a href="#rest_v2_backup_manager_head">2.4.14. Checking Backup Availability</a></li>
<li><a href="#rest_v2_backup_manager_get">2.4.15. Downloading Backup Archives</a></li>
<li><a href="#rest_v2_backup_manager_delete">2.4.16. Deleting Backup Archives</a></li>
<li><a href="#rest_v2_restore_manager">2.4.17. Restoring Infinispan Resources from Backup Archives</a>
<ul class="sectlevel4">
<li><a href="#restoring_from_backup_archives_on_infinispan_server">Restoring from Backup Archives on Infinispan Server</a></li>
<li><a href="#restoring_from_local_backup_archives">Restoring from Local Backup Archives</a></li>
</ul>
</li>
<li><a href="#rest_v2_restore_manager_list">2.4.18. Listing Restores</a></li>
<li><a href="#rest_v2_restore_manager_head">2.4.19. Checking Restore Progress</a></li>
<li><a href="#rest_v2_restore_manager_delete">2.4.20. Deleting Restore Metadata</a></li>
<li><a href="#rest_v2_container_configuration_listen">2.4.21. Listening to container configuration events</a></li>
<li><a href="#rest_v2_xsite_cache_manager">2.4.22. Cross-Site Operations with Cache Managers</a>
<ul class="sectlevel4">
<li><a href="#rest_v2_cache_manager_site_status">Getting Status of Backup Locations</a></li>
<li><a href="#rest_v2_cache_manager_take_offline">Taking Backup Locations Offline</a></li>
<li><a href="#rest_v2_cache_manager_bring_online">Bringing Backup Locations Online</a></li>
<li><a href="#rest_v2_cache_manager_get_state_transfer_mode">Retrieving the State Transfer Mode</a></li>
<li><a href="#rest_v2_cache_manager_set_state_transfer_mode">Setting the State Transfer Mode</a></li>
<li><a href="#rest_v2_cache_manager_start_push">Starting State Transfer</a></li>
<li><a href="#rest_v2_cache_manager_cancel_push">Canceling State Transfer</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#rest_v2_server">2.5. Working with Infinispan Servers</a>
<ul class="sectlevel3">
<li><a href="#rest_v2_server_info">2.5.1. Retrieving Basic Server Information</a></li>
<li><a href="#rest_v2_server_cm">2.5.2. Getting Cache Managers</a></li>
<li><a href="#rest_v2_cache_ignore">2.5.3. Adding Caches to Ignore Lists</a></li>
<li><a href="#rest_v2_cache_ignore_remove">2.5.4. Removing Caches from Ignore Lists</a></li>
<li><a href="#rest_v2_cache_ignore_confirm">2.5.5. Confirming Ignored Caches</a></li>
<li><a href="#rest_v2_server_config">2.5.6. Obtaining Server Configuration</a></li>
<li><a href="#rest_v2_server_env">2.5.7. Getting Environment Variables</a></li>
<li><a href="#rest_v2_server_memory">2.5.8. Getting JVM Memory Details</a></li>
<li><a href="#rest_v2_server_threads">2.5.9. Getting JVM Thread Dumps</a></li>
<li><a href="#rest_v2_server_report">2.5.10. Getting Diagnostic Reports for Infinispan Servers</a></li>
<li><a href="#rest_v2_server_stop">2.5.11. Stopping Infinispan Servers</a></li>
</ul>
</li>
<li><a href="#rest_v2_cluster">2.6. Working with Infinispan Clusters</a>
<ul class="sectlevel3">
<li><a href="#rest_v2_cluster_stop">2.6.1. Stopping Infinispan Clusters</a></li>
<li><a href="#rest_v2_stop_cluster_server">2.6.2. Stopping Specific Infinispan Servers in Clusters</a></li>
<li><a href="#rest_v2_backup_cluster">2.6.3. Backing Up Infinispan Clusters</a></li>
<li><a href="#rest_v2_backup_cluster_list">2.6.4. Listing Backups</a></li>
<li><a href="#rest_v2_backup_cluster_head">2.6.5. Checking Backup Availability</a></li>
<li><a href="#rest_v2_backup_cluster_get">2.6.6. Downloading Backup Archives</a></li>
<li><a href="#rest_v2_backup_cluster_delete">2.6.7. Deleting Backup Archives</a></li>
<li><a href="#rest_v2_restore_cluster">2.6.8. Restoring Infinispan Cluster Resources</a>
<ul class="sectlevel4">
<li><a href="#restoring_from_backup_archives_on_infinispan_server_2">Restoring from Backup Archives on Infinispan Server</a></li>
<li><a href="#restoring_from_local_backup_archives_2">Restoring from Local Backup Archives</a></li>
</ul>
</li>
<li><a href="#rest_v2_restore_cluster_list">2.6.9. Listing Restores</a></li>
<li><a href="#rest_v2_restore_cluster_head">2.6.10. Checking Restore Progress</a></li>
<li><a href="#rest_v2_restore_cluster_delete">2.6.11. Deleting Restore Metadata</a></li>
</ul>
</li>
<li><a href="#rest_v2_logging">2.7. Infinispan Server logging configuration</a>
<ul class="sectlevel3">
<li><a href="#rest_v2_logging_list_appenders">2.7.1. Listing the logging appenders</a></li>
<li><a href="#rest_v2_logging_list_loggers">2.7.2. Listing the loggers</a></li>
<li><a href="#rest_v2_logging_set_logger">2.7.3. Creating/modifying a logger</a></li>
<li><a href="#rest_v2_logging_remove_logger">2.7.4. Removing a logger</a></li>
</ul>
</li>
<li><a href="#rest_v2_tasks">2.8. Using Server Tasks</a>
<ul class="sectlevel3">
<li><a href="#rest_v2_tasks_list">2.8.1. Retrieving Server Tasks Information</a></li>
<li><a href="#rest_v2_tasks_execute">2.8.2. Executing Tasks</a></li>
<li><a href="#rest_v2_tasks_upload">2.8.3. Uploading Script Tasks</a></li>
</ul>
</li>
<li><a href="#rest_v2_security">2.9. Working with Infinispan Security</a>
<ul class="sectlevel3">
<li><a href="#rest_v2_get_user_acl">2.9.1. Retrieving the ACL of a user</a></li>
<li><a href="#rest_v2_flush_acl_cache">2.9.2. Flushing the ACL cache</a></li>
<li><a href="#rest_v2_get_roles">2.9.3. Retrieving the available roles</a></li>
<li><a href="#rest_v2_get_principal_roles">2.9.4. Retrieving the roles for a principal</a></li>
<li><a href="#rest_v2_grant_principal_roles">2.9.5. Granting roles to a principal</a></li>
<li><a href="#rest_v2_deny_principal_roles">2.9.6. Denying roles to a principal</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#rest_client_code">3. REST Client Examples</a>
<ul class="sectlevel2">
<li><a href="#rest_server_client_ruby">3.1. Ruby REST Example</a></li>
<li><a href="#rest_server_client_python">3.2. Python 3 REST Example</a></li>
<li><a href="#rest_server_client_java">3.3. Java REST Example</a></li>
<li><a href="#rest_server_client_http">3.4. <code>HttpClient</code> API REST Example</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="rest_server"><a class="anchor" href="#rest_server"></a>1. Infinispan REST Endpoint</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Infinispan servers provide <a href="http://en.wikipedia.org/wiki/Representational_State_Transfer">RESTful</a> HTTP
access to data through a REST endpoint built on <a href="https://github.com/netty/netty">Netty</a>.</p>
</div>
<div class="sect2">
<h3 id="rest_security"><a class="anchor" href="#rest_security"></a>1.1. REST Authentication</h3>
<div class="paragraph">
<p>Configure authentication to the REST endpoint with the Infinispan command line
interface (CLI) and the <strong>user</strong> command. The CLI lets you create and manage
users, passwords, and authorization roles for accessing the REST endpoint.</p>
</div>
<div class="paragraph">
<p>When running the Docker image, configure authentication with the <code>APP_USER</code> and
<code>APP_PASS</code> command line arguments.</p>
</div>
<div class="ulist">
<div class="title">Reference</div>
<ul>
<li>
<p><a href="../server/server.html#user_tool-server">Adding Users to Property Realms</a></p>
</li>
<li>
<p><a href="../server/server.html#endpoint_authentication">Configuring Endpoint Authentication Mechanisms</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="rest_supported_protocols"><a class="anchor" href="#rest_supported_protocols"></a>1.2. Supported Protocols</h3>
<div class="paragraph">
<p>The Infinispan REST endpoint supports <code>HTTP/1.1</code> and <code>HTTP/2</code> protocols.</p>
</div>
<div class="paragraph">
<p>You can do either of the following to use <code>HTTP/2</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Perform an <a href="https://http2.github.io/http2-spec/#discover-http">HTTP/1.1 upgrade</a>.</p>
</li>
<li>
<p>Negotiate the communication protocol using a <a href="https://http2.github.io/http2-spec/#versioning">TLS/ALPN extension</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>TLS/ALPN with JDK8 requires additional client configuration. Refer to the
appropriate documentation for your REST client. In most cases you need to use
either the Jetty ALPN Agent or OpenSSL bindings.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="rest_data_formats"><a class="anchor" href="#rest_data_formats"></a>1.3. Data Formats and the REST API</h3>
<div class="paragraph">
<p>Infinispan caches store data in formats that you can define with a
<a href="https://en.wikipedia.org/wiki/Media_type">MediaType</a>.</p>
</div>
<div class="paragraph">
<p>See the <a href="../encoding/encoding.html">Cache Encoding and Marshalling</a> for more information about MediaTypes and encoding data with Infinispan.</p>
</div>
<div class="paragraph">
<p>The following example configures the storage format for entries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;distributed-cache</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mycache</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;encoding&gt;</span>
      <span class="tag">&lt;key</span> <span class="attribute-name">media-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application/x-java-object</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;value</span> <span class="attribute-name">media-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml; charset=UTF-8</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
   <span class="tag">&lt;/encoding&gt;</span>
<span class="tag">&lt;/distributed-cache&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you do not configure a MediaType, Infinispan defaults to
<code>application/octet-stream</code> for both keys and values. However, if the cache is
indexed, Infinispan defaults to <code>application/x-protostream</code>.</p>
</div>
<div class="sect3">
<h4 id="rest_server_data_format_support"><a class="anchor" href="#rest_server_data_format_support"></a>1.3.1. Supported Formats</h4>
<div class="paragraph">
<p>You can write and read data in different formats and Infinispan can convert
between those formats when required.</p>
</div>
<div class="paragraph">
<p>The following "standard" formats are interchangeable:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>application/x-java-object</code></p>
</li>
<li>
<p><code>application/octet-stream</code></p>
</li>
<li>
<p><code>application/x-www-form-urlencoded</code></p>
</li>
<li>
<p><code>text/plain</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also convert the preceding data formats into the following formats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>application/xml</code></p>
</li>
<li>
<p><code>application/json</code></p>
</li>
<li>
<p><code>application/x-jboss-marshalling</code></p>
</li>
<li>
<p><code>application/x-protostream</code></p>
</li>
<li>
<p><code>application/x-java-serialized</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Infinispan also lets you convert between <code>application/x-protostream</code> and <code>application/json</code>.</p>
</div>
<div class="paragraph">
<p>All calls to the REST API can provide headers describing the content written or
the required format of the content when reading. Infinispan supports the
standard HTTP/1.1 headers "Content-Type" and "Accept" that are applied for
values, plus the "Key-Content-Type" with similar effect for keys.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_accept"><a class="anchor" href="#rest_accept"></a>1.3.2. Accept Headers</h4>
<div class="paragraph">
<p>The Infinispan REST endpoint is compliant with the <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html">RFC-2616</a> Accept
header and negotiates the correct MediaType based on the conversions supported.</p>
</div>
<div class="paragraph">
<p>For example, send the following header when reading data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>Accept: text/plain;q=0.7, application/json;q=0.8, */*;q=0.6</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding header causes Infinispan to first return content in JSON format
(higher priority 0.8). If it is not possible to convert the storage format
to JSON, Infinispan attempts the next format of <code>text/plain</code> (second highest
priority 0.7). Finally, Infinispan falls back to <em>*/*</em>, which picks a suitable
format based on the cache configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_encoded_names"><a class="anchor" href="#rest_encoded_names"></a>1.3.3. Names with Special Characters</h4>
<div class="paragraph">
<p>The creation of any REST resource requires a name that is part of the URL,
and in case this name contains any special characters as defined in
<a href="https://tools.ietf.org/html/rfc3986#section-2.2">Section 2.2 of the RFC 3986 spec</a>, it is necessary to encode it with the <a href="https://en.wikipedia.org/wiki/Percent-encoding">Percent encoding</a> mechanism.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_key_content_type"><a class="anchor" href="#rest_key_content_type"></a>1.3.4. Key-Content-Type Headers</h4>
<div class="paragraph">
<p>Most REST API calls have the Key included in the URL. Infinispan assumes the
Key is a <em>java.lang.String</em> when handling those calls, but you can use a
specific header <em>Key-Content-Type</em> for keys in different formats.</p>
</div>
<div class="ulist">
<div class="title">Key-Content-Type Header Examples</div>
<ul>
<li>
<p>Specifying a byte[] Key as a Base64 string:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>API call:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`PUT /my-cache/AQIDBDM=`</pre>
</div>
</div>
<div class="paragraph">
<p>Headers:</p>
</div>
<div class="paragraph">
<p><code>Key-Content-Type: application/octet-stream</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specifying a byte[] Key as a hexadecimal string:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>API call:</p>
</div>
<div class="paragraph">
<p><code>GET /my-cache/0x01CA03042F</code></p>
</div>
<div class="paragraph">
<p>Headers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>Key-Content-Type: application/octet-stream; encoding=hex</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Specifying a double Key:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>API call:</p>
</div>
<div class="paragraph">
<p><code>POST /my-cache/3.141456</code></p>
</div>
<div class="paragraph">
<p>Headers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>Key-Content-Type: application/x-java-object;type=java.lang.Double</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>type</em> parameter for <code>application/x-java-object</code> is restricted to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Primitive wrapper types</p>
</li>
<li>
<p>java.lang.String</p>
</li>
<li>
<p>Bytes, making <code>application/x-java-object;type=Bytes</code> equivalent to <code>application/octet-stream;encoding=hex</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_json_proto_conversion"><a class="anchor" href="#rest_json_proto_conversion"></a>1.3.5. JSON/Protostream Conversion</h4>
<div class="paragraph">
<p>When caches are indexed, or specifically configured to store _application/x-protostream`, you can send and receive JSON documents that are automatically converted to and from Protobuf.</p>
</div>
<div class="paragraph">
<p>You must register a Protobuf schema for the conversion to work.</p>
</div>
<div class="paragraph">
<p>To register protobuf schemas via REST, invoke a POST or PUT in the <code><em>___protobuf_metadata</em></code> cache as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl -u user:password -X POST --data-binary @./schema.proto http://127.0.0.1:11222/rest/v2/caches/___protobuf_metadata/schema.proto</code></pre>
</div>
</div>
<div class="paragraph">
<p>When writing JSON documents, a special field <strong><em>_type</em></strong> must be present in the document to identity the Protobuf <em>Message</em>  that corresponds to the document.</p>
</div>
<div class="paragraph">
<p>Person.proto</p>
</div>
<div class="listingblock primary">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="protobuf">message Person  {
  required string name = 1;
  required int32 age = 2;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Person.json</p>
</div>
<div class="listingblock secondary">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
   <span class="key"><span class="delimiter">&quot;</span><span class="content">_type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Person</span><span class="delimiter">&quot;</span></span>,
   <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">user1</span><span class="delimiter">&quot;</span></span>,
   <span class="key"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span>: <span class="integer">32</span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_cors"><a class="anchor" href="#rest_cors"></a>1.4. Cross-Origin Resource Sharing (CORS) Requests</h3>
<div class="paragraph">
<p>The Infinispan REST connector supports
<a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">CORS</a>, including
preflight and rules based on the request origin.</p>
</div>
<div class="paragraph">
<p>The following shows an example REST connector configuration with CORS rules:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;rest-connector</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">rest1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">socket-binding</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">rest</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">cache-container</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;cors-rules&gt;</span>
      <span class="tag">&lt;cors-rule</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">restrict host1</span><span class="delimiter">&quot;</span></span>
                 <span class="attribute-name">allow-credentials</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;allowed-origins&gt;</span>http://host1,https://host1<span class="tag">&lt;/allowed-origins&gt;</span>
         <span class="tag">&lt;allowed-methods&gt;</span>GET<span class="tag">&lt;/allowed-methods&gt;</span>
      <span class="tag">&lt;/cors-rule&gt;</span>
      <span class="tag">&lt;cors-rule</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">allow ALL</span><span class="delimiter">&quot;</span></span>
                 <span class="attribute-name">allow-credentials</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>
                 <span class="attribute-name">max-age-seconds</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2000</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;allowed-origins&gt;</span>*<span class="tag">&lt;/allowed-origins&gt;</span>
         <span class="tag">&lt;allowed-methods&gt;</span>GET,OPTIONS,POST,PUT,DELETE<span class="tag">&lt;/allowed-methods&gt;</span>
         <span class="tag">&lt;allowed-headers&gt;</span>Key-Content-Type<span class="tag">&lt;/allowed-headers&gt;</span>
      <span class="tag">&lt;/cors-rule&gt;</span>
   <span class="tag">&lt;/cors-rules&gt;</span>
<span class="tag">&lt;/rest-connector&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan evaluates CORS rules sequentially based on the "Origin" header set
by the browser.</p>
</div>
<div class="paragraph">
<p>In the preceding example, if the origin is either "http://host1" or
"https://host1", then the rule "restrict host1" applies. If the origin is
different, then the next rule is tested.</p>
</div>
<div class="paragraph">
<p>Because the "allow ALL" rule permits all origins, any script that has an origin
other than "http://host1" or "https://host1" can perform the allowed methods
and use the supplied headers.</p>
</div>
<div class="paragraph">
<p>For information about configuring CORS rules, see the <a href="https://docs.jboss.org/infinispan/13.0/configdocs/">Infinispan Server Configuration Schema</a>.</p>
</div>
<div class="sect3">
<h4 id="allowing_all_cors_permissions_for_some_origins"><a class="anchor" href="#allowing_all_cors_permissions_for_some_origins"></a>1.4.1. Allowing all CORS permissions for some origins</h4>
<div class="paragraph">
<p>The VM property <code>infinispan.server.rest.cors-allow</code> can be used when starting the server to allow all permissions to one or more origins.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>./bin/server.sh -Dinfinispan.server.rest.cors-allow=http://192.168.1.78:11222,http://host.mydomain.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>All origins specified using this method will take precedence over the configured rules.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rest_v2_api"><a class="anchor" href="#rest_v2_api"></a>2. Interacting with the Infinispan REST API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Infinispan REST API lets you monitor, maintain, and manage Infinispan
deployments and provides access to your data.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By default Infinispan REST API operations return <code>200 (OK)</code> when successful.
However, when some operations are processed successfully, they return an HTTP status code such as <code>204</code> or <code>202</code> instead of <code>200</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="rest_v2_cache_operations"><a class="anchor" href="#rest_v2_cache_operations"></a>2.1. Creating and Managing Caches</h3>
<div class="paragraph">
<p>Create and manage Infinispan caches and perform operations on data.</p>
</div>
<div class="sect3">
<h4 id="rest_v2_create_cache"><a class="anchor" href="#rest_v2_create_cache"></a>2.1.1. Creating Caches</h4>
<div class="paragraph">
<p>Create named caches across Infinispan clusters with <code>POST</code> requests that
include XML or JSON configuration in the payload.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/caches/{cacheName}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the <a href="https://en.wikipedia.org/wiki/Media_type">MediaType</a> for the
Infinispan configuration payload; either <code>application/xml</code> or
<code>application/json</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to set <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/commons/api/CacheContainerAdmin.AdminFlag.html">AdminFlags</a></p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="cache_configuration"><a class="anchor" href="#cache_configuration"></a>Cache Configuration</h5>
<div class="paragraph">
<p>You can provide cache configuration in XML or JSON format.</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;distributed-cache</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">myCache</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">mode</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SYNC</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;encoding</span> <span class="attribute-name">media-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application/x-protostream</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;memory</span> <span class="attribute-name">max-count</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1000000</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">when-full</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">REMOVE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/distributed-cache&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">distributed-cache</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">myCache</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">mode</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SYNC</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">encoding</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">media-type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application/x-protostream</span><span class="delimiter">&quot;</span></span>
      },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">memory</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">max-count</span><span class="delimiter">&quot;</span></span>: <span class="integer">1000000</span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">when-full</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">REMOVE</span><span class="delimiter">&quot;</span></span>
    }
  }
}</code></pre>
</div>
</div>
<h6 id="json_format" class="discrete">JSON format</h6>
<div class="paragraph">
<p>Cache configuration in JSON format must follow the structure of an XML configuration.
* XML elements become JSON objects.
* XML attributes become JSON fields.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_modify_cache"><a class="anchor" href="#rest_v2_modify_cache"></a>2.1.2. Modifying Caches</h4>
<div class="paragraph">
<p>Make changes to attributes in cache configurations across Infinispan clusters with <code>PUT</code> requests that include XML or JSON configuration in the payload.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can modify a cache only if the changes are compatible with the existing configuration.</p>
</div>
<div class="paragraph">
<p>For example you cannot use a replicated cache configuration to modify a distributed cache.
Likewise if you create a cache configuration with a specific attribute, you cannot modify the configuration to use a different attribute instead.
For example, attempting to modify cache configuration by specifying a value for the <code>max-count</code> attribute results in invalid configuration if the <code>max-size</code> is already set.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>PUT /rest/v2/caches/{cacheName}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the <a href="https://en.wikipedia.org/wiki/Media_type">MediaType</a> for the
Infinispan configuration payload; either <code>application/xml</code> or
<code>application/json</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to set <a href="https://docs.jboss.org/infinispan/13.0/apidocs/org/infinispan/commons/api/CacheContainerAdmin.AdminFlag.html">AdminFlags</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_exists"><a class="anchor" href="#rest_v2_cache_exists"></a>2.1.3. Verifying Caches</h4>
<div class="paragraph">
<p>Check if caches are available in Infinispan clusters with <code>HEAD</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>HEAD /rest/v2/caches/{cacheName}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_create_cache_template"><a class="anchor" href="#rest_v2_create_cache_template"></a>2.1.4. Creating Caches with Templates</h4>
<div class="paragraph">
<p>Create caches from Infinispan templates with <code>POST</code> requests and the
<code>?template=</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/caches/{cacheName}?template={templateName}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>See <a href="#rest_v2_cache_manager_cache_templates">Listing Available Cache Templates</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_configuration"><a class="anchor" href="#rest_v2_cache_configuration"></a>2.1.5. Retrieving Cache Configuration</h4>
<div class="paragraph">
<p>Retrieve Infinispan cache configurations with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{name}?action=config</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Accept</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the required format to return content. Supported formats are <code>application/xml</code> and <code>application/json</code>. The default is <code>application/json</code>. See <a href="#rest_accept">Accept</a> for more information.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_config_convert"><a class="anchor" href="#rest_v2_cache_config_convert"></a>2.1.6. Converting Cache Configurations to JSON</h4>
<div class="paragraph">
<p>Invoke a <code>POST</code> request with valid XML configuration and the <code>?action=toJSON</code>
parameter. Infinispan responds with the equivalent JSON representation of the
configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/caches?action=toJSON</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_detail"><a class="anchor" href="#rest_v2_cache_detail"></a>2.1.7. Retrieving All Cache Details</h4>
<div class="paragraph">
<p>Invoke a <code>GET</code> request to retrieve all details for Infinispan caches.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{name}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan provides a JSON response such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">stats</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">time_since_start</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">time_since_reset</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">hits</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">current_number_of_entries</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">current_number_of_entries_in_memory</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">total_number_of_entries</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">stores</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">off_heap_memory_used</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">data_memory_used</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">retrievals</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">misses</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">remove_hits</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">remove_misses</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">evictions</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_read_time</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_read_time_nanos</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_write_time</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_write_time_nanos</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_remove_time</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_remove_time_nanos</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">required_minimum_number_of_nodes</span><span class="delimiter">&quot;</span></span>: <span class="integer">-1</span>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span>: <span class="integer">0</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">configuration</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">distributed-cache</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">mode</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SYNC</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">transaction</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">stop-timeout</span><span class="delimiter">&quot;</span></span>: <span class="integer">0</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">mode</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">NONE</span><span class="delimiter">&quot;</span></span>
      }
    }
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">rehash_in_progress</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">bounded</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">indexed</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">persistent</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">transactional</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">secured</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">has_remote_backup</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">indexing_in_progress</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">statistics</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>stats</code> current stats of the cache.</p>
</li>
<li>
<p><code>size</code> the estimated size for the cache.</p>
</li>
<li>
<p><code>configuration</code> the cache configuration.</p>
</li>
<li>
<p><code>rehash_in_progress</code> true when a rehashing is in progress.</p>
</li>
<li>
<p><code>indexing_in_progress</code> true when indexing is in progress.</p>
</li>
<li>
<p><code>bounded</code> when expiration is enabled.</p>
</li>
<li>
<p><code>indexed</code> true if the cache is indexed.</p>
</li>
<li>
<p><code>persistent</code> true if the cache is persisted.</p>
</li>
<li>
<p><code>transactional</code> true if the cache is transactional.</p>
</li>
<li>
<p><code>secured</code> true if the cache is secured.</p>
</li>
<li>
<p><code>has_remote_backup</code> true if the cache has remote backups.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_add_entries"><a class="anchor" href="#rest_v2_add_entries"></a>2.1.8. Adding Entries</h4>
<div class="paragraph">
<p>Add entries to caches with <code>POST</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/caches/{cacheName}/{cacheKey}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding request places the payload, or request body, in the <code>cacheName</code>
cache with the <code>cacheKey</code> key. The request replaces any data that already
exists and updates the <code>Time-To-Live</code> and <code>Last-Modified</code> values, if they apply.</p>
</div>
<div class="paragraph">
<p>If the entry is created successfully, the service returns <code>204 (No Content)</code>.</p>
</div>
<div class="paragraph">
<p>If a value already exists for the specified key, the <code>POST</code> request returns
<code>409 (Conflict)</code> and does not modify the value.
To update values, you
should use <code>PUT</code> requests. See <a href="#rest_v2_replace_entries">Replacing Entries</a>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Key-Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the content type for the key in the request. See <a href="#rest_key_content_type">Key-Content-Type</a> for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the <a href="https://en.wikipedia.org/wiki/Media_type">MediaType</a> of the value for the key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timeToLiveSeconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the number of seconds before the entry is automatically deleted. If you do not set this parameter, Infinispan uses the default value from the configuration. If you set a negative value, the entry is never deleted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxIdleTimeSeconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the number of seconds that entries can be idle. If a read or write operation does not occur for an entry after the maximum idle time elapses, the entry is automatically deleted. If you do not set this parameter, Infinispan uses the default value from the configuration. If you set a negative value, the entry is never deleted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The flags used to add the entry. See <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/context/Flag.html">Flag</a> for more information.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>flags</code> header also applies to all other operations involving data manipulation on the cache,
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If both <code>timeToLiveSeconds</code> and <code>maxIdleTimeSeconds</code> have a value of <code>0</code>, Infinispan uses the default <code>lifespan</code> and <code>maxIdle</code> values from the configuration.</p>
</div>
<div class="paragraph">
<p>If <em>only</em> <code>maxIdleTimeSeconds</code> has a value of <code>0</code>, Infinispan uses:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the default <code>maxIdle</code> value from the configuration.</p>
</li>
<li>
<p>the value for <code>timeToLiveSeconds</code> that you pass as a request parameter or a value of <code>-1</code> if you do not pass a value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <em>only</em> <code>timeToLiveSeconds</code> has a value of <code>0</code>, Infinispan uses:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the default <code>lifespan</code> value from the configuration.</p>
</li>
<li>
<p>the value for <code>maxIdle</code> that you pass as a request parameter or a value of <code>-1</code> if you do not pass a value.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_replace_entries"><a class="anchor" href="#rest_v2_replace_entries"></a>2.1.9. Replacing Entries</h4>
<div class="paragraph">
<p>Replace entries in caches with <code>PUT</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>PUT /rest/v2/caches/{cacheName}/{cacheKey}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a value already exists for the specified key, the <code>PUT</code> request updates the
value. If you do not want to modify existing values, use <code>POST</code> requests that
return <code>409 (Conflict)</code> instead of modifying values. See
<a href="#rest_v2_add_entries">Adding Values</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_retrieve_cache"><a class="anchor" href="#rest_v2_retrieve_cache"></a>2.1.10. Retrieving Data By Keys</h4>
<div class="paragraph">
<p>Retrieve data for specific keys with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{cacheName}/{cacheKey}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The server returns data from the given cache, <code>cacheName</code>, under the given key,
<code>cacheKey</code>, in the response body. Responses contain <code>Content-Type</code> headers that
correspond to the <code>MediaType</code> negotiation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Browsers can also access caches directly, for example as a content delivery
network (CDN). Infinispan returns a unique
<a href="http://en.wikipedia.org/wiki/HTTP_ETag">ETag</a> for each entry along with the
<code>Last-Modified</code> and <code>Expires</code> header fields.</p>
</div>
<div class="paragraph">
<p>These fields provide information about the state of the data that is returned
in your request. ETags allow browsers and other clients to request only data
that has changed, which conserves bandwidth.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Key-Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the content type for the key in the request. The default is <code>application/x-java-object; type=java.lang.String</code>. See <a href="#rest_key_content_type">Key-Content-Type</a> for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Accept</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the required format to return content. See <a href="#rest_accept">Accept</a> for more information.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Append the <code>extended</code> parameter to the query string to get additional information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{cacheName}/{cacheKey}?extended</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding request returns custom headers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Cluster-Primary-Owner</code> returns the node name that is the primary owner of the key.</p>
</li>
<li>
<p><code>Cluster-Node-Name</code> returns the JGroups node name of the server that handled the request.</p>
</li>
<li>
<p><code>Cluster-Physical-Address</code> returns the physical JGroups address of the server that handled the request.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_check_entries"><a class="anchor" href="#rest_v2_check_entries"></a>2.1.11. Checking if Entries Exist</h4>
<div class="paragraph">
<p>Verify that specific entries exists with <code>HEAD</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>HEAD /rest/v2/caches/{cacheName}/{cacheKey}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding request returns only the header fields and the same content that
you stored with the entry. For example, if you stored a String, the request
returns a String. If you stored binary, base64-encoded, blobs or serialized
Java objects, Infinispan does not de-serialize the content in the request.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>HEAD</code> requests also support the <code>extended</code> parameter.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Key-Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the content type for the key in the request. The default is <code>application/x-java-object; type=java.lang.String</code>. See <a href="#rest_key_content_type">Key-Content-Type</a> for more information.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_delete_entries"><a class="anchor" href="#rest_v2_delete_entries"></a>2.1.12. Deleting Entries</h4>
<div class="paragraph">
<p>Remove entries from caches with <code>DELETE</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>DELETE /rest/v2/caches/{cacheName}/{cacheKey}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Key-Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the content type for the key in the request. The default is <code>application/x-java-object; type=java.lang.String</code>. See <a href="#rest_key_content_type">Key-Content-Type</a> for more information.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_remove_cache"><a class="anchor" href="#rest_v2_remove_cache"></a>2.1.13. Deleting Caches</h4>
<div class="paragraph">
<p>Remove caches from Infinispan clusters with <code>DELETE</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>DELETE /rest/v2/caches/{cacheName}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_get_keys"><a class="anchor" href="#rest_v2_get_keys"></a>2.1.14. Retrieving All Keys from Caches</h4>
<div class="paragraph">
<p>Invoke <code>GET</code> requests to retrieve all the keys in a cache in JSON format.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{cacheName}?action=keys</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>limit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the maximum number of keys to retrieve using an InputStream. A negative value retrieves all keys. The default value is <code>-1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>batch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the internal batch size when retrieving the keys. The default value is <code>1000</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_get_entries"><a class="anchor" href="#rest_v2_get_entries"></a>2.1.15. Retrieving All Entries from Caches</h4>
<div class="paragraph">
<p>Invoke <code>GET</code> requests to retrieve all the entries in a cache in JSON format.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{cacheName}?action=entries</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metadata</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Includes metadata for each entry in the response. The default value is <code>false</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>limit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the maximum number of keys to include in the response. A negative value retrieves all keys. The default value is <code>-1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>batch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the internal batch size when retrieving the keys. The default value is <code>1000</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>content-negotiation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, will convert keys and values to a readable format.
For caches with text encodings (e.g., text/plain, xml, json), the server returns keys and values as plain text.
For caches with binary encodings, the server will return the entries as JSON if the conversion is supported, otherwise in a text hexadecimal format, e.g., <code>0xA123CF98</code>.
When content-negotiation is used, the response will contain two headers: <code>key-content-type</code> and <code>value-content-type</code> to described the negotiated format.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Infinispan provides a JSON response such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">[
    {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">key</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">value1</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">timeToLiveSeconds</span><span class="delimiter">&quot;</span></span>:<span class="integer">-1</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">maxIdleTimeSeconds</span><span class="delimiter">&quot;</span></span>:<span class="integer">-1</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">created</span><span class="delimiter">&quot;</span></span>:<span class="integer">-1</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">lastUsed</span><span class="delimiter">&quot;</span></span>:<span class="integer">-1</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">expireTime</span><span class="delimiter">&quot;</span></span>:<span class="integer">-1</span>
    },
    {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">key</span><span class="delimiter">&quot;</span></span>:<span class="integer">2</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">value2</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">timeToLiveSeconds</span><span class="delimiter">&quot;</span></span>:<span class="integer">10</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">maxIdleTimeSeconds</span><span class="delimiter">&quot;</span></span>:<span class="integer">45</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">created</span><span class="delimiter">&quot;</span></span>:<span class="integer">1607966017944</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">lastUsed</span><span class="delimiter">&quot;</span></span>: <span class="integer">1607966017944</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">expireTime</span><span class="delimiter">&quot;</span></span>:<span class="integer">1607966027944</span>
    }
]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>key</code> The key for the entry.</p>
</li>
<li>
<p><code>value</code> The value of the entry.</p>
</li>
<li>
<p><code>timeToLiveSeconds</code> Based on the entry lifespan but in seconds, or <code>-1</code> if the entry never expires. It&#8217;s not returned unless you set metadata="true".</p>
</li>
<li>
<p><code>maxIdleTimeSeconds</code> Maximum idle time, in seconds, or <code>-1</code> if entry never expires. It&#8217;s not returned unless you set metadata="true".</p>
</li>
<li>
<p><code>created</code> Time the entry was created or or <code>-1</code> for immortal entries. It&#8217;s not returned unless you set metadata="true".</p>
</li>
<li>
<p><code>lastUsed</code> Last time an operation was performed on the entry or <code>-1</code> for immortal entries. It&#8217;s not returned unless you set metadata="true".</p>
</li>
<li>
<p><code>expireTime</code> Time when the entry expires or <code>-1</code> for immortal entries. It&#8217;s not returned unless you set metadata="true".</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_clear_cache"><a class="anchor" href="#rest_v2_clear_cache"></a>2.1.16. Clearing Caches</h4>
<div class="paragraph">
<p>To delete all data from a cache, invoke a <code>POST</code> request with the
<code>?action=clear</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/caches/{cacheName}?action=clear</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns <code>204 (No Content)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_size"><a class="anchor" href="#rest_v2_cache_size"></a>2.1.17. Getting Cache Size</h4>
<div class="paragraph">
<p>Retrieve the size of caches across the entire cluster with <code>GET</code> requests and
the <code>?action=size</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{cacheName}?action=size</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_stats"><a class="anchor" href="#rest_v2_cache_stats"></a>2.1.18. Getting Cache Statistics</h4>
<div class="paragraph">
<p>Obtain runtime statistics for caches with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{cacheName}?action=stats</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_query_cache"><a class="anchor" href="#rest_v2_query_cache"></a>2.1.19. Querying Caches</h4>
<div class="paragraph">
<p>Perform Ickle queries on caches with <code>GET</code> requests and the
<code>?action=search&amp;query</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{cacheName}?action=search&amp;query={ickle query}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with query hits such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">total_results</span><span class="delimiter">&quot;</span></span> : <span class="integer">150</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">hits</span><span class="delimiter">&quot;</span></span> : [ {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">hit</span><span class="delimiter">&quot;</span></span> : {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">user1</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span> : <span class="integer">35</span>
    }
  }, {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">hit</span><span class="delimiter">&quot;</span></span> : {
       <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">user2</span><span class="delimiter">&quot;</span></span>,
       <span class="key"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span> : <span class="integer">42</span>
    }
  }, {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">hit</span><span class="delimiter">&quot;</span></span> : {
       <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">user3</span><span class="delimiter">&quot;</span></span>,
       <span class="key"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span> : <span class="integer">12</span>
    }
  } ]
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>total_results</code> displays the total number of results from the query.</p>
</li>
<li>
<p><code>hits</code> is an array of matches from the query.</p>
</li>
<li>
<p><code>hit</code> is an object that matches the query.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Hits can contain all fields or a subset of fields if you use a <code>Select</code> clause.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>query</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the query string.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>max_results</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the number of results to return. The default is <code>10</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>offset</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the index of the first result to return. The default is <code>0</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>local</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When <code>true</code>, the query is restricted to the data present in node that process the request. The default is <code>false</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To use the body of the request instead of specifying query parameters, invoke
<code>POST</code> requests as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/caches/{cacheName}?action=search</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example shows a query in the request body:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
 <span class="key"><span class="delimiter">&quot;</span><span class="content">query</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">from Entity where name:</span><span class="char">\&quot;</span><span class="content">user1</span><span class="char">\&quot;</span><span class="delimiter">&quot;</span></span>,
 <span class="key"><span class="delimiter">&quot;</span><span class="content">max_results</span><span class="delimiter">&quot;</span></span>:<span class="integer">20</span>,
 <span class="key"><span class="delimiter">&quot;</span><span class="content">offset</span><span class="delimiter">&quot;</span></span>:<span class="integer">10</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_query_reindex"><a class="anchor" href="#rest_v2_query_reindex"></a>2.1.20. Re-indexing Data</h4>
<div class="paragraph">
<p>Re-index all data in caches with <code>POST</code> requests and the <code>?action=mass-index</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST  /v2/caches/{cacheName}/search/indexes?action=mass-index</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Values for the <code>mode</code> parameter are as follows:</p>
<p class="tableblock">* <code>sync</code> returns <code>204 (No Content)</code> only after the re-indexing operation is complete.</p>
<p class="tableblock">* <code>async</code> returns <code>204 (No Content)</code> immediately and the re-indexing operation continues
running in the cluster. You can check the status with
the <a href="#rest_v2_query_index_stats">Index Statistics</a> REST call.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>local</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When <code>true</code>, only the data from node that process the request is re-indexed. The default is <code>false</code>, meaning all data cluster-wide is re-indexed.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_query_purge_index"><a class="anchor" href="#rest_v2_query_purge_index"></a>2.1.21. Purging Indexes</h4>
<div class="paragraph">
<p>Delete all indexes from caches with <code>POST</code> requests and the <code>?action=clear</code>
parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST  /v2/caches/{cacheName}/search/indexes?action=clear</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns <code>204 (No Content)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_search_stats"><a class="anchor" href="#rest_v2_search_stats"></a>2.1.22. Retrieving Query and Index Statistics</h4>
<div class="paragraph">
<p>Obtain information about queries and indexes in caches with <code>GET</code> requests.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Statistics must be enabled in the cache otherwise the results will be empty.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/caches/{cacheName}/search/stats</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scope</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use <code>cluster</code> to retrieve consolidated statistics for all members of the cluster. When omitted, Infinispan returns statistics for the local queries and indexes.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Infinispan provides a JSON response such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "query": {
    "indexed_local": {
      "count": 1,
      "average": 12344.2,
      "max": 122324,
      "slowest": "FROM Entity WHERE field &gt; 4"
    },
    "indexed_distributed": {
      "count": 0,
      "average": 0.0,
      "max": -1,
      "slowest": "FROM Entity WHERE field &gt; 4"
    },
    "hybrid": {
      "count": 0,
      "average": 0.0,
      "max": -1,
      "slowest": "FROM Entity WHERE field &gt; 4 AND desc = 'value'"
    },
    "non_indexed": {
      "count": 0,
      "average": 0.0,
      "max": -1,
      "slowest": "FROM Entity WHERE desc = 'value'"
    },
    "entity_load": {
      "count": 123,
      "average": 10.0,
      "max": 120
    }
  },
  "index": {
    "types": {
      "org.infinispan.same.test.Entity": {
        "count": 5660001,
        "size": 0
      },
      "org.infinispan.same.test.AnotherEntity": {
        "count": 40,
        "size": 345560
      }
    },
    "reindexing": false
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>In the <code><code>query</code></code> section:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>indexed_local</code> Provides details about indexed queries.</p>
</li>
<li>
<p><code>indexed_distributed</code> Provides details about distributed indexed queries.</p>
</li>
<li>
<p><code>hybrid</code> Provides details about queries that used the index only partially.</p>
</li>
<li>
<p><code>non_indexed</code> Provides details about queries that didn&#8217;t use the index.</p>
</li>
<li>
<p><code>entity_load</code> Provides details about cache operations to fetch objects after indexed queries execution.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All time related statistics are in nanoseconds.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the <code><code>index</code></code> section:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>types</code> Provide details about each indexed type (class name or protobuf message) that is configured in the cache.</p>
<div class="ulist">
<ul>
<li>
<p><code>count</code> The number of entities indexed for the type.</p>
</li>
<li>
<p><code>size</code> Usage in bytes of the type.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>reindexing</code> If the value is <code>true</code>, the <code>Indexer</code> is running in the cache.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_search_stats_clear"><a class="anchor" href="#rest_v2_search_stats_clear"></a>2.1.23. Clearing Search Statistics</h4>
<div class="paragraph">
<p>Reset runtime statistics with <code>POST</code> requests and the <code>?action=clear</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /v2/caches/{cacheName}/search/stats?action=clear</code></pre>
</div>
</div>
<div class="paragraph">
<p>Index statistics will not be cleared, but only query execution times.
Infinispan clears query statistics for the local node only.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_query_index_stats"><a class="anchor" href="#rest_v2_query_index_stats"></a>2.1.24. Retrieving Index Statistics (Deprecated)</h4>
<div class="paragraph">
<p>Obtain information about indexes in caches with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/caches/{cacheName}/search/indexes/stats</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan provides a JSON response such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">indexed_class_names</span><span class="delimiter">&quot;</span></span>: [<span class="string"><span class="delimiter">&quot;</span><span class="content">org.infinispan.sample.User</span><span class="delimiter">&quot;</span></span>],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">indexed_entities_count</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">org.infinispan.sample.User</span><span class="delimiter">&quot;</span></span>: <span class="integer">4</span>
    },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">index_sizes</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">cacheName_protobuf</span><span class="delimiter">&quot;</span></span>: <span class="integer">14551</span>
    },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">reindexing</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>indexed_class_names</code> Provides the class names of the indexes present in the cache. For Protobuf the value is always <code>org.infinispan.query.remote.impl.indexing.ProtobufValueWrapper</code>.</p>
</li>
<li>
<p><code>indexed_entities_count</code> Provides the number of entities indexed per class.</p>
</li>
<li>
<p><code>index_sizes</code> Provides the size, in bytes, for each index in the cache.</p>
</li>
<li>
<p><code>reindexing</code> Indicates if a re-indexing operation was performed for the cache. If the value is <code>true</code>, the <code>MassIndexer</code> was started in the cache.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_query_stats"><a class="anchor" href="#rest_v2_query_stats"></a>2.1.25. Retrieving Query Statistics (Deprecated)</h4>
<div class="paragraph">
<p>Get information about the queries that have been run in caches with <code>GET</code>
requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/caches/{cacheName}/search/query/stats</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan provides a JSON response such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">search_query_execution_count</span><span class="delimiter">&quot;</span></span>:<span class="integer">20</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">search_query_total_time</span><span class="delimiter">&quot;</span></span>:<span class="integer">5</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">search_query_execution_max_time</span><span class="delimiter">&quot;</span></span>:<span class="integer">154</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">search_query_execution_avg_time</span><span class="delimiter">&quot;</span></span>:<span class="integer">2</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">object_loading_total_time</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">object_loading_execution_max_time</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">object_loading_execution_avg_time</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">objects_loaded_count</span><span class="delimiter">&quot;</span></span>:<span class="integer">20</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">search_query_execution_max_time_query_string</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">FROM entity</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>search_query_execution_count</code> Provides the number of queries that have been run.</p>
</li>
<li>
<p><code>search_query_total_time</code> Provides the total time spent on queries.</p>
</li>
<li>
<p><code>search_query_execution_max_time</code> Provides the maximum time taken for a query.</p>
</li>
<li>
<p><code>search_query_execution_avg_time</code> Provides the average query time.</p>
</li>
<li>
<p><code>object_loading_total_time</code> Provides the total time spent loading objects from the cache after query execution.</p>
</li>
<li>
<p><code>object_loading_execution_max_time</code> Provides the maximum time spent loading objects execution.</p>
</li>
<li>
<p><code>object_loading_execution_avg_time</code> Provides the average time spent loading objects execution.</p>
</li>
<li>
<p><code>objects_loaded_count</code> Provides the count of objects loaded.</p>
</li>
<li>
<p><code>search_query_execution_max_time_query_string</code> Provides the slowest query executed.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_query_stats_clear"><a class="anchor" href="#rest_v2_query_stats_clear"></a>2.1.26. Clearing Query Statistics (Deprecated)</h4>
<div class="paragraph">
<p>Reset runtime statistics with <code>POST</code> requests and the <code>?action=clear</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /v2/caches/{cacheName}/search/query/stats?action=clear</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_list_caches"><a class="anchor" href="#rest_v2_list_caches"></a>2.1.27. Listing Caches</h4>
<div class="paragraph">
<p>List all available caches in Infinispan clusters with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_listen"><a class="anchor" href="#rest_v2_cache_listen"></a>2.1.28. Listening to cache events</h4>
<div class="paragraph">
<p>Receive cache events using <a href="https://html.spec.whatwg.org/multipage/server-sent-events.html">Server-Sent Events</a>.
The <code>event</code> value will be one of <code>cache-entry-created</code>, <code>cache-entry-removed</code>, <code>cache-entry-updated</code>, <code>cache-entry-expired</code>.
The <code>data</code> value will contain the key of the entry that has fired the event in the format set by the <code>Accept</code> header.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{name}?action=listen</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Accept</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the required format to return content. Supported formats are <code>text/plain</code> and <code>application/json</code>. The default is <code>application/json</code>. See <a href="#rest_accept">Accept</a> for more information.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_caches_enable_rebalancing"><a class="anchor" href="#rest_v2_caches_enable_rebalancing"></a>2.1.29. Enabling rebalancing</h4>
<div class="paragraph">
<p>Turn on automatic rebalancing for a specific cache.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /v2/caches/{cacheName}?action=enable-rebalancing</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_caches_disable_rebalancing"><a class="anchor" href="#rest_v2_caches_disable_rebalancing"></a>2.1.30. Disabling rebalancing</h4>
<div class="paragraph">
<p>Turn off automatic rebalancing for a specific cache.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /v2/caches/{cacheName}?action=disable-rebalancing</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_xsite_cache"><a class="anchor" href="#rest_v2_xsite_cache"></a>2.1.31. Cross-Site Operations with Caches</h4>
<div class="paragraph">
<p>Perform cross-site replication operations with the Infinispan REST API.</p>
</div>
<div class="paragraph">
<p>See <a href="../xsite/xsite.html">Cross Site replication</a> for more details about this feature.</p>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_sites_status"><a class="anchor" href="#rest_v2_xsite_sites_status"></a>Getting Status of All Backup Locations</h5>
<div class="paragraph">
<p>Retrieve the status of all backup locations with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/caches/{cacheName}/x-site/backups/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with the status of each backup location in JSON format, as
in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">NYC</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">online</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">LON</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">offline</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. Returned Status</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>online</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All nodes in the local cluster have a cross-site view with the backup location.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>offline</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No nodes in the local cluster have a cross-site view with the backup location.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mixed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Some nodes in the local cluster have a cross-site view with the backup location, other nodes in the local cluster do not have a cross-site view. The response indicates status for each node.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_site_status"><a class="anchor" href="#rest_v2_xsite_site_status"></a>Getting Status of Specific Backup Locations</h5>
<div class="paragraph">
<p>Retrieve the status of a backup location with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/caches/{cacheName}/x-site/backups/{siteName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with the status of each node in the site in JSON
format, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">NodeA</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">offline</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">NodeB</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">online</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. Returned Status</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>online</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The node is online.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>offline</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The node is offline.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>failed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not possible to retrieve status. The remote cache could be shutting down or a network error occurred during the request.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_take_site_offline"><a class="anchor" href="#rest_v2_xsite_take_site_offline"></a>Taking Backup Locations Offline</h5>
<div class="paragraph">
<p>Take backup locations offline with <code>POST</code> requests and the
<code>?action=take-offline</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /v2/caches/{cacheName}/x-site/backups/{siteName}?action=take-offline</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_bring_backup_online"><a class="anchor" href="#rest_v2_xsite_bring_backup_online"></a>Bringing Backup Locations Online</h5>
<div class="paragraph">
<p>Bring backup locations online with the <code>?action=bring-online</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /v2/caches/{cacheName}/x-site/backups/{siteName}?action=bring-online</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_start_push"><a class="anchor" href="#rest_v2_xsite_start_push"></a>Pushing State to Backup Locations</h5>
<div class="paragraph">
<p>Push cache state to a backup location with the <code>?action=start-push-state</code>
parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /v2/caches/{cacheName}/x-site/backups/{siteName}?action=start-push-state</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_cancel_state_push"><a class="anchor" href="#rest_v2_xsite_cancel_state_push"></a>Canceling State Transfer</h5>
<div class="paragraph">
<p>Cancel state transfer operations with the <code>?action=cancel-push-state</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /v2/caches/{cacheName}/x-site/backups/{siteName}?action=cancel-push-state</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_state_push"><a class="anchor" href="#rest_v2_xsite_state_push"></a>Getting State Transfer Status</h5>
<div class="paragraph">
<p>Retrieve status of state transfer operations with the
<code>?action=push-state-status</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/caches/{cacheName}/x-site/backups?action=push-state-status</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with the status of state transfer for each backup location
in JSON format, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
   <span class="key"><span class="delimiter">&quot;</span><span class="content">NYC</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">CANCELED</span><span class="delimiter">&quot;</span></span>,
   <span class="key"><span class="delimiter">&quot;</span><span class="content">LON</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">OK</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. Returned Status</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SENDING</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State transfer to the backup location is in progress.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>OK</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State transfer completed successfully.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ERROR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An error occurred with state transfer. Check log files.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CANCELLING</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State transfer cancellation is in progress.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_clear_transfer_status"><a class="anchor" href="#rest_v2_xsite_clear_transfer_status"></a>Clearing State Transfer Status</h5>
<div class="paragraph">
<p>Clear state transfer status for sending sites with the
<code>?action=clear-push-state-status</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /v2/caches/{cacheName}/x-site/local?action=clear-push-state-status</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_tuning_takeoffline"><a class="anchor" href="#rest_v2_xsite_tuning_takeoffline"></a>Modifying Take Offline Conditions</h5>
<div class="paragraph">
<p>Sites go offline if certain conditions are met. Modify the take offline
parameters to control when backup locations automatically go offline.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Check configured take offline parameters with <code>GET</code> requests and the
<code>take-offline-config</code> parameter.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/caches/{cacheName}/x-site/backups/{siteName}/take-offline-config</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Infinispan response includes <code>after_failures</code> and <code>min_wait</code> fields as
follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">after_failures</span><span class="delimiter">&quot;</span></span>: <span class="integer">2</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">min_wait</span><span class="delimiter">&quot;</span></span>: <span class="integer">1000</span>
}</code></pre>
</div>
</div>
</li>
<li>
<p>Modify take offline parameters in the body of <code>PUT</code> requests.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>PUT /v2/caches/{cacheName}/x-site/backups/{siteName}/take-offline-config</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns <code>204 (No Content)</code>.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_cancel_receive_state"><a class="anchor" href="#rest_v2_xsite_cancel_receive_state"></a>Canceling State Transfer from Receiving Sites</h5>
<div class="paragraph">
<p>If the connection between two backup locations breaks, you can cancel state
transfer on the site that is receiving the push.</p>
</div>
<div class="paragraph">
<p>Cancel state transfer from a remote site and keep the current state of the
local cache with the <code>?action=cancel-receive-state</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /v2/caches/{cacheName}/x-site/backups/{siteName}?action=cancel-receive-state</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_rolling_upgrades"><a class="anchor" href="#rest_v2_rolling_upgrades"></a>2.1.32. Rolling Upgrades</h4>
<div class="paragraph">
<p>Perform rolling upgrades of cache data between Infinispan clusters</p>
</div>
<div class="sect4">
<h5 id="rest_v2_sync_data"><a class="anchor" href="#rest_v2_sync_data"></a>Connecting Source Clusters</h5>
<div class="paragraph">
<p>Connect a target cluster to the source cluster with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /v2/caches/{cacheName}?action=connect-source</code></pre>
</div>
</div>
<div class="paragraph">
<p>You must provide a <code>remote-store</code> definition in JSON format as the body:</p>
</div>
<div class="listingblock">
<div class="title">JSON</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">remote-store</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cache</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my-cache</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">shared</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">raw-values</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">socket-timeout</span><span class="delimiter">&quot;</span></span>: <span class="integer">60000</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">protocol-version</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">2.9</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">remote-server</span><span class="delimiter">&quot;</span></span>: [
      {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">host</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">127.0.0.2</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">port</span><span class="delimiter">&quot;</span></span>: <span class="integer">12222</span>
      }
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">connection-pool</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">max-active</span><span class="delimiter">&quot;</span></span>: <span class="integer">110</span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">exhausted-action</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">CREATE_NEW</span><span class="delimiter">&quot;</span></span>
    },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">async-executor</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">properties</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="integer">4</span>
      }
    },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">authentication</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">server-name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">servername</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">digest</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">realm</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">realm</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">sasl-mechanism</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">DIGEST-MD5</span><span class="delimiter">&quot;</span></span>
        }
      },
      <span class="key"><span class="delimiter">&quot;</span><span class="content">encryption</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">protocol</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">TLSv1.2</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">sni-hostname</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">snihostname</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">keystore</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">filename</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/path/to/keystore_client.jks</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">certificate-password</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">key-alias</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">JKS</span><span class="delimiter">&quot;</span></span>
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">truststore</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">filename</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/path/to/gca.jks</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">JKS</span><span class="delimiter">&quot;</span></span>
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Several elements are optional such as <code>security</code>, <code>async-executor</code> and <code>connection-pool</code>.
The configuration must contain minimally the cache name, the <code>raw-values</code> set to <code>false</code> and the
host/ip of the single port in the source cluster. For details about the <code>remote-store</code> configuration,
consult the <a href="https://infinispan.org/schemas/infinispan-cachestore-remote-config-12.0.xsd">XSD Schema</a>.</p>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns 204 (No Content).</p>
</div>
</div>
<div class="sect4">
<h5 id="synchronizing_data"><a class="anchor" href="#synchronizing_data"></a>Synchronizing Data</h5>
<div class="paragraph">
<p>Synchronize data from a source cluster to a target cluster with <code>POST</code> requests
and the <code>?action=sync-data</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /v2/caches/{cacheName}?action=sync-data</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the operation completes, Infinispan responds with the total number of
entries copied to the target cluster.</p>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_disconnect_source"><a class="anchor" href="#rest_v2_disconnect_source"></a>Disconnecting Source Clusters</h5>
<div class="paragraph">
<p>After you synchronize data to target clusters, disconnect from the source
cluster with <code>POST</code> requests and the <code>?action=disconnect-source</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /v2/caches/{cacheName}?action=disconnect-source</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns <code>204 (No Content)</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_counters"><a class="anchor" href="#rest_v2_counters"></a>2.2. Creating and Managing Counters</h3>
<div class="paragraph">
<p>Create, delete, and modify counters via the REST API.</p>
</div>
<div class="sect3">
<h4 id="rest_server_counters_create"><a class="anchor" href="#rest_server_counters_create"></a>2.2.1. Creating Counters</h4>
<div class="paragraph">
<p>Create counters with <code>POST</code> requests that include configuration in the payload.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/counters/{counterName}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example Weak Counter</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">weak-counter</span><span class="delimiter">&quot;</span></span>:{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">initial-value</span><span class="delimiter">&quot;</span></span>:<span class="integer">5</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">storage</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">PERSISTENT</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">concurrency-level</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example Strong Counter</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">strong-counter</span><span class="delimiter">&quot;</span></span>:{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">initial-value</span><span class="delimiter">&quot;</span></span>:<span class="integer">3</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">storage</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">PERSISTENT</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">upper-bound</span><span class="delimiter">&quot;</span></span>:<span class="integer">5</span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_delete"><a class="anchor" href="#rest_server_counters_delete"></a>2.2.2. Deleting Counters</h4>
<div class="paragraph">
<p>Remove specific counters with <code>DELETE</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>DELETE /rest/v2/counters/{counterName}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_config"><a class="anchor" href="#rest_server_counters_config"></a>2.2.3. Retrieving Counter Configuration</h4>
<div class="paragraph">
<p>Retrieve configuration for specific counters with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/counters/{counterName}/config</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with the counter configuration in JSON format.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_get"><a class="anchor" href="#rest_server_counters_get"></a>2.2.4. Getting Counter Values</h4>
<div class="paragraph">
<p>Retrieve counter values with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/counters/{counterName}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 17. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><a href="#rest_accept">Accept</a></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The required format to return the content. Supported formats are <em>application/json</em> and <em>text/plain</em>. JSON is assumed if no header is provided.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_server_counters_reset"><a class="anchor" href="#rest_server_counters_reset"></a>2.2.5. Resetting Counters</h4>
<div class="paragraph">
<p>Restore the initial value of counters without <code>POST</code> requests and the
<code>?action=reset</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/counters/{counterName}?action=reset</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns <code>204 (No Content)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_inc_weak"><a class="anchor" href="#rest_server_counters_inc_weak"></a>2.2.6. Incrementing Counters</h4>
<div class="paragraph">
<p>Increment counter values with <code>POST</code> request` and the <code>?action=increment</code>
parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/counters/{counterName}?action=increment</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>WEAK</code> counters never respond after operations and return <code>204 (No Content)</code>.</p>
</div>
<div class="paragraph">
<p><code>STRONG</code> counters return <code>200 (OK)</code> and the current value after each operation.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_add_weak"><a class="anchor" href="#rest_server_counters_add_weak"></a>2.2.7. Adding Deltas to Counters</h4>
<div class="paragraph">
<p>Add arbitrary values to counters with <code>POST</code> requests that include the
<code>?action=add</code> and <code>delta</code> parameters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/counters/{counterName}?action=add&amp;delta={delta}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>WEAK</code> counters never respond after operations and return <code>204 (No Content)</code>.</p>
</div>
<div class="paragraph">
<p><code>STRONG</code> counters return <code>200 (OK)</code> and the current value after each operation.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_dec"><a class="anchor" href="#rest_server_counters_dec"></a>2.2.8. Decrementing Counter Values</h4>
<div class="paragraph">
<p>Decrement counter values with <code>POST</code> requests and the <code>?action=decrement</code>
parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/counters/{counterName}?action=decrement</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>WEAK</code> counters never respond after operations and return <code>204 (No Content)</code>.</p>
</div>
<div class="paragraph">
<p><code>STRONG</code> counters return <code>200 (OK)</code> and the current value after each operation.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_cmpset"><a class="anchor" href="#rest_server_counters_cmpset"></a>2.2.9. Performing compareAndSet Operations on Strong Counters</h4>
<div class="paragraph">
<p>Atomically set values for strong counters with <code>GET</code> requests and the
<code>compareAndSet</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/counters/{counterName}?action=compareAndSet&amp;expect={expect}&amp;update={update}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan atomically sets the value to <code>{update}</code> if the current value is
<code>{expect}</code>. If the operation is successful, Infinispan returns <code><em>true</em></code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_cmpswp"><a class="anchor" href="#rest_server_counters_cmpswp"></a>2.2.10. Performing compareAndSwap Operations on Strong Counters</h4>
<div class="paragraph">
<p>Atomically set values for strong counters with <code>GET</code> requests and the
<code>compareAndSwap</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/counters/{counterName}?action=compareAndSwap&amp;expect={expect}&amp;update={update}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan atomically sets the value to <code>{update}</code> if the current value is
<code>{expect}</code>. If the operation is successful, Infinispan returns the previous
value in the payload.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_list"><a class="anchor" href="#rest_server_counters_list"></a>2.2.11. Listing Counters</h4>
<div class="paragraph">
<p>Retrieve a list of counters in Infinispan clusters with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/counters/</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_protobuf_schemas"><a class="anchor" href="#rest_v2_protobuf_schemas"></a>2.3. Working with Protobuf Schemas</h3>
<div class="paragraph">
<p>Create and manage Protobuf schemas, <code>.proto</code> files, via the Infinispan REST
API.</p>
</div>
<div class="sect3">
<h4 id="rest_v2_create_protobuf"><a class="anchor" href="#rest_v2_create_protobuf"></a>2.3.1. Creating Protobuf Schemas</h4>
<div class="paragraph">
<p>Create Protobuf schemas across Infinispan clusters with <code>POST</code> requests that
include the content of a protobuf file in the payload.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/schemas/{schemaName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the schema already exists, Infinispan returns HTTP <code>409 (Conflict)</code>.
If the schema is not valid, either because of syntax errors, or because some of its dependencies are missing,
Infinispan stores the schema and returns the error in the response body.</p>
</div>
<div class="paragraph">
<p>Infinispan responds with the schema name and any errors.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">users.proto</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">error</span><span class="delimiter">&quot;</span></span> : {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">message</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Schema users.proto has errors</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cause</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.IllegalStateException:Syntax error in error.proto at 3:8: unexpected label: messoge</span><span class="delimiter">&quot;</span></span>
  }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code> is the name of the Protobuf schema.</p>
</li>
<li>
<p><code>error</code> is <code>null</code> for valid Protobuf schemas. If Infinispan cannot successfully validate the schema, it returns errors.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns <code>201 (Created)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_get_protobuf"><a class="anchor" href="#rest_v2_get_protobuf"></a>2.3.2. Reading Protobuf Schemas</h4>
<div class="paragraph">
<p>Retrieve Protobuf schema from Infinispan with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/schemas/{schemaName}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_update_protobuf"><a class="anchor" href="#rest_v2_update_protobuf"></a>2.3.3. Updating Protobuf Schemas</h4>
<div class="paragraph">
<p>Modify Protobuf schemas with <code>PUT</code> requests that include the content of a protobuf file in the payload.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>PUT /rest/v2/schemas/{schemaName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the schema is not valid, either because of syntax errors, or because some of its dependencies are missing,
Infinispan updates the schema and returns the error in the response body.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">users.proto</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">error</span><span class="delimiter">&quot;</span></span> : {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">message</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Schema users.proto has errors</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cause</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.IllegalStateException:Syntax error in error.proto at 3:8: unexpected label: messoge</span><span class="delimiter">&quot;</span></span>
  }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code> is the name of the Protobuf schema.</p>
</li>
<li>
<p><code>error</code> is <code>null</code> for valid Protobuf schemas. If Infinispan cannot successfully validate the schema, it returns errors.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_delete_protobuf"><a class="anchor" href="#rest_v2_delete_protobuf"></a>2.3.4. Deleting Protobuf Schemas</h4>
<div class="paragraph">
<p>Remove Protobuf schemas from Infinispan clusters with <code>DELETE</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>DELETE /rest/v2/schemas/{schemaName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns <code>204 (No Content)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_list_protobuf"><a class="anchor" href="#rest_v2_list_protobuf"></a>2.3.5. Listing Protobuf Schemas</h4>
<div class="paragraph">
<p>List all available Protobuf schemas with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/schemas/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a list of all schemas available on the cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">[ {
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">users.proto</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">error</span><span class="delimiter">&quot;</span></span> : {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">message</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Schema users.proto has errors</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cause</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.IllegalStateException:Syntax error in error.proto at 3:8: unexpected label: messoge</span><span class="delimiter">&quot;</span></span>
  }
}, {
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">people.proto</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">error</span><span class="delimiter">&quot;</span></span> : <span class="value">null</span>
}]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code> is the name of the Protobuf schema.</p>
</li>
<li>
<p><code>error</code> is <code>null</code> for valid Protobuf schemas. If Infinispan cannot successfully validate the schema, it returns errors.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_cache_managers"><a class="anchor" href="#rest_v2_cache_managers"></a>2.4. Working with Cache Managers</h3>
<div class="paragraph">
<p>Interact with Infinispan Cache Managers to get cluster and usage statistics.</p>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_manager_info"><a class="anchor" href="#rest_v2_cache_manager_info"></a>2.4.1. Getting Basic Cache Manager Information</h4>
<div class="paragraph">
<p>Retrieving information about Cache Managers with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with information in JSON format, as in the following
example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">xx.x.x-FINAL</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">coordinator</span><span class="delimiter">&quot;</span></span>:<span class="value">true</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_configuration_names</span><span class="delimiter">&quot;</span></span>:[
        <span class="string"><span class="delimiter">&quot;</span><span class="content">___protobuf_metadata</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">cache2</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">CacheManagerResourceTest</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">cache1</span><span class="delimiter">&quot;</span></span>
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cluster_name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">ISPN</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">physical_addresses</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">[127.0.0.1:35770]</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">coordinator_address</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">CacheManagerResourceTest-NodeA-49696</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_manager_status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">RUNNING</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">created_cache_count</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">3</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">running_cache_count</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">3</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">node_address</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">CacheManagerResourceTest-NodeA-49696</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cluster_members</span><span class="delimiter">&quot;</span></span>:[
        <span class="string"><span class="delimiter">&quot;</span><span class="content">CacheManagerResourceTest-NodeA-49696</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">CacheManagerResourceTest-NodeB-28120</span><span class="delimiter">&quot;</span></span>
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cluster_members_physical_addresses</span><span class="delimiter">&quot;</span></span>:[
        <span class="string"><span class="delimiter">&quot;</span><span class="content">127.0.0.1:35770</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">127.0.0.1:60031</span><span class="delimiter">&quot;</span></span>
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cluster_size</span><span class="delimiter">&quot;</span></span>:<span class="integer">2</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">defined_caches</span><span class="delimiter">&quot;</span></span>:[
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">CacheManagerResourceTest</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">started</span><span class="delimiter">&quot;</span></span>:<span class="value">true</span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">cache1</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">started</span><span class="delimiter">&quot;</span></span>:<span class="value">true</span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">___protobuf_metadata</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">started</span><span class="delimiter">&quot;</span></span>:<span class="value">true</span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">cache2</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">started</span><span class="delimiter">&quot;</span></span>:<span class="value">true</span>
        }
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">local_site</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">LON</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">site_coordinator</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">site_coordinators_address</span><span class="delimiter">&quot;</span></span>: [
      <span class="string"><span class="delimiter">&quot;</span><span class="content">CacheManagerResourceTest-NodeA-49696</span><span class="delimiter">&quot;</span></span>
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">sites_view</span><span class="delimiter">&quot;</span></span>: [
        <span class="string"><span class="delimiter">&quot;</span><span class="content">LON</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">NYC</span><span class="delimiter">&quot;</span></span>
    ]
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>version</code> contains the Infinispan version</p>
</li>
<li>
<p><code>name</code> contains the name of the cache manager as defined in the configuration</p>
</li>
<li>
<p><code>coordinator</code> is true if the cache manager is the coordinator of the cluster</p>
</li>
<li>
<p><code>cache_configuration_names</code> contains an array of all caches configurations defined in the cache manager</p>
</li>
<li>
<p><code>cluster_name</code> contains the name of the cluster as defined in the configuration</p>
</li>
<li>
<p><code>physical_addresses</code> contains the physical network addresses associated with the cache manager</p>
</li>
<li>
<p><code>coordinator_address</code> contains the physical network addresses of the coordinator of the cluster</p>
</li>
<li>
<p><code>cache_manager_status</code> the lifecycle status of the cache manager.
For possible values, check the <a href="https://docs.jboss.org/infinispan/9.4/apidocs/org/infinispan/lifecycle/ComponentStatus.html"><code>org.infinispan.lifecycle.ComponentStatus</code></a> documentation</p>
</li>
<li>
<p><code>created_cache_count</code> number of created caches, excludes all internal and private caches</p>
</li>
<li>
<p><code>running_cache_count</code> number of created caches that are running</p>
</li>
<li>
<p><code>node_address</code> contains the logical address of the cache manager</p>
</li>
<li>
<p><code>cluster_members</code> and <code>cluster_members_physical_addresses</code> an array of logical and physical addresses of the members of the cluster</p>
</li>
<li>
<p><code>cluster_size</code> number of members in the cluster</p>
</li>
<li>
<p><code>defined_caches</code> A list of all caches defined in the cache manager, excluding private caches but including internal caches that are accessible</p>
</li>
<li>
<p><code>local_site</code> The name of the local site.<br>
If cross-site replication is not configured, Infinispan returns "local".</p>
</li>
<li>
<p><code>site_coordinator</code> is true if the cache manager is a site coordinator.</p>
</li>
<li>
<p><code>site_coordinators_address</code> is an array of logical addresses of site coordinators.</p>
</li>
<li>
<p><code>sites_view</code> The list of sites that participate in cross-site replication.<br>
If cross-site replication is not configured, Infinispan returns an empty list.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_manager_health"><a class="anchor" href="#rest_v2_cache_manager_health"></a>2.4.2. Getting Cluster Health</h4>
<div class="paragraph">
<p>Retrieve health information for Infinispan clusters with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/health</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with cluster health information in JSON format, as in the
following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cluster_health</span><span class="delimiter">&quot;</span></span>:{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">cluster_name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">ISPN</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">health_status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">HEALTHY</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">number_of_nodes</span><span class="delimiter">&quot;</span></span>:<span class="integer">2</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">node_names</span><span class="delimiter">&quot;</span></span>:[
            <span class="string"><span class="delimiter">&quot;</span><span class="content">NodeA-36229</span><span class="delimiter">&quot;</span></span>,
            <span class="string"><span class="delimiter">&quot;</span><span class="content">NodeB-28703</span><span class="delimiter">&quot;</span></span>
        ]
    },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_health</span><span class="delimiter">&quot;</span></span>:[
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">HEALTHY</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">___protobuf_metadata</span><span class="delimiter">&quot;</span></span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">HEALTHY</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">cache2</span><span class="delimiter">&quot;</span></span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">HEALTHY</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">mycache</span><span class="delimiter">&quot;</span></span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">HEALTHY</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">cache_name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">cache1</span><span class="delimiter">&quot;</span></span>
        }
    ]

}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cluster_health</code> contains the health of the cluster</p>
<div class="ulist">
<ul>
<li>
<p><code>cluster_name</code> specifies the name of the cluster as defined in the configuration.</p>
</li>
<li>
<p><code>health_status</code> provides one of the following:</p>
<div class="ulist">
<ul>
<li>
<p><code>DEGRADED</code> indicates at least one of the caches is in degraded mode.</p>
</li>
<li>
<p><code>HEALTHY_REBALANCING</code> indicates at least one cache is in the rebalancing state.</p>
</li>
<li>
<p><code>HEALTHY</code> indicates all cache instances in the cluster are operating as expected.</p>
</li>
<li>
<p><code>FAILED</code> indicates the cache failed to start with the provided configuration.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>number_of_nodes</code> displays the total number of cluster members.
Returns a value of <code>0</code> for non-clustered (standalone) servers.</p>
</li>
<li>
<p><code>node_names</code> is an array of all cluster members.
Empty for standalone servers.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>cache_health</code> contains health information per-cache</p>
<div class="ulist">
<ul>
<li>
<p><code>status</code>  HEALTHY, DEGRADED, HEALTHY_REBALANCING or FAILED</p>
</li>
<li>
<p><code>cache_name</code> the name of the cache as defined in the configuration.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_manager_health_status"><a class="anchor" href="#rest_v2_cache_manager_health_status"></a>2.4.3. Getting Cache Manager Health Status</h4>
<div class="paragraph">
<p>Retrieve the health status of Cache Managers with <code>GET</code> requests that do not require authentication.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/health/status</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with one of the following in <code>text/plain</code> format:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>HEALTHY</code></p>
</li>
<li>
<p><code>HEALTHY_REBALANCING</code></p>
</li>
<li>
<p><code>DEGRADED</code></p>
</li>
<li>
<p><code>FAILED</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_manager_availability"><a class="anchor" href="#rest_v2_cache_manager_availability"></a>2.4.4. Checking REST Endpoint Availability</h4>
<div class="paragraph">
<p>Verify Infinispan server REST endpoint availability with <code>HEAD</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>HEAD /rest/v2/cache-managers/{cacheManagerName}/health</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you receive a successful response code then the Infinispan REST server is
running and serving requests.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_manager_config"><a class="anchor" href="#rest_v2_cache_manager_config"></a>2.4.5. Obtaining Global Configuration for Cache Managers</h4>
<div class="paragraph">
<p>Retrieve global configuration for Cache Managers with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/config</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 18. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><a href="#rest_accept">Accept</a></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The required format to return the content. Supported formats are <em>application/json</em> and <em>application/xml</em>. JSON is assumed if no header is provided.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Reference</div>
<p><a href="https://docs.jboss.org/infinispan/13.0/apidocs/org/infinispan/configuration/global/GlobalConfiguration.html">GlobalConfiguration</a></p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_manager_caches_config"><a class="anchor" href="#rest_v2_cache_manager_caches_config"></a>2.4.6. Obtaining Configuration for All Caches</h4>
<div class="paragraph">
<p>Retrieve the configuration for all caches with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/cache-configs</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with <code>JSON</code> arrays that contain each cache and cache
configuration, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">[
  {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">cache1</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">configuration</span><span class="delimiter">&quot;</span></span>:{
          <span class="key"><span class="delimiter">&quot;</span><span class="content">distributed-cache</span><span class="delimiter">&quot;</span></span>:{
              <span class="key"><span class="delimiter">&quot;</span><span class="content">mode</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">SYNC</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">partition-handling</span><span class="delimiter">&quot;</span></span>:{
                  <span class="key"><span class="delimiter">&quot;</span><span class="content">when-split</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">DENY_READ_WRITES</span><span class="delimiter">&quot;</span></span>
              },
              <span class="key"><span class="delimiter">&quot;</span><span class="content">statistics</span><span class="delimiter">&quot;</span></span>:<span class="value">true</span>
          }
      }
  },
  {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">cache2</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">configuration</span><span class="delimiter">&quot;</span></span>:{
          <span class="key"><span class="delimiter">&quot;</span><span class="content">distributed-cache</span><span class="delimiter">&quot;</span></span>:{
              <span class="key"><span class="delimiter">&quot;</span><span class="content">mode</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">SYNC</span><span class="delimiter">&quot;</span></span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">transaction</span><span class="delimiter">&quot;</span></span>:{
                  <span class="key"><span class="delimiter">&quot;</span><span class="content">mode</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">NONE</span><span class="delimiter">&quot;</span></span>
              }
          }
      }
  }
]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_manager_cache_templates"><a class="anchor" href="#rest_v2_cache_manager_cache_templates"></a>2.4.7. Listing Available Cache Templates</h4>
<div class="paragraph">
<p>Retrieve all available Infinispan cache templates with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/cache-configs/templates</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>See <a href="#rest_v2_create_cache_template">Creating Caches with Templates</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_manager_cache_list"><a class="anchor" href="#rest_v2_cache_manager_cache_list"></a>2.4.8. (Experimental) Obtaining Cache Status and Information</h4>
<div class="paragraph">
<p>Retrieve a list of all available caches for a Cache Manager, along with cache statuses and details, with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/caches</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with JSON arrays that lists and describes each available
cache, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">[ {
  <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">RUNNING</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">cache1</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">local-cache</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">simple_cache</span><span class="delimiter">&quot;</span></span> : <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">transactional</span><span class="delimiter">&quot;</span></span> : <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">persistent</span><span class="delimiter">&quot;</span></span> : <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">bounded</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">secured</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">indexed</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">has_remote_backup</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">health</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">HEALTHY</span><span class="delimiter">&quot;</span></span>
}, {
  <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">RUNNING</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">cache2</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">distributed-cache</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">simple_cache</span><span class="delimiter">&quot;</span></span> : <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">transactional</span><span class="delimiter">&quot;</span></span> : <span class="value">true</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">persistent</span><span class="delimiter">&quot;</span></span> : <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">bounded</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">secured</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">indexed</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">has_remote_backup</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">health</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">HEALTHY</span><span class="delimiter">&quot;</span></span>
}]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_manager_stats"><a class="anchor" href="#rest_v2_cache_manager_stats"></a>2.4.9. Getting Cache Manager Statistics</h4>
<div class="paragraph">
<p>Retrieve the statistics for Cache Managers with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/stats</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with Cache Manager statistics in JSON format, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">statistics_enabled</span><span class="delimiter">&quot;</span></span>:<span class="value">true</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">read_write_ratio</span><span class="delimiter">&quot;</span></span>:<span class="float">0.0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">time_since_start</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">time_since_reset</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">number_of_entries</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">total_number_of_entries</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">off_heap_memory_used</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">data_memory_used</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">misses</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">remove_hits</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">remove_misses</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">evictions</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_read_time</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_read_time_nanos</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_write_time</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_write_time_nanos</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_remove_time</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">average_remove_time_nanos</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">required_minimum_number_of_nodes</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">hits</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">stores</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">current_number_of_entries_in_memory</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">hit_ratio</span><span class="delimiter">&quot;</span></span>:<span class="float">0.0</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">retrievals</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>statistics_enabled</code> is <code>true</code> if statistics collection is enabled for the Cache Manager.</p>
</li>
<li>
<p><code>read_write_ratio</code> displays the read/write ratio across all caches.</p>
</li>
<li>
<p><code>time_since_start</code> shows the time, in seconds, since the Cache Manager started.</p>
</li>
<li>
<p><code>time_since_reset</code> shows the number of seconds since the Cache Manager statistics were last reset.</p>
</li>
<li>
<p><code>number_of_entries</code> shows the total number of entries currently in all caches from the Cache Manager. This statistic returns entries in the local cache instances only.</p>
</li>
<li>
<p><code>total_number_of_entries</code> shows the number of store operations performed across all caches for the Cache Manager.</p>
</li>
<li>
<p><code>off_heap_memory_used</code> shows the amount, in <code>bytes[]</code>, of off-heap memory used by this cache container.</p>
</li>
<li>
<p><code>data_memory_used</code> shows the amount, in <code>bytes[]</code>, that the current eviction algorithm estimates is in use for data across all caches. Returns <code>0</code> if eviction is not enabled.</p>
</li>
<li>
<p><code>misses</code> shows the number of <code>get()</code> misses across all caches.</p>
</li>
<li>
<p><code>remove_hits</code> shows the number of removal hits across all caches.</p>
</li>
<li>
<p><code>remove_misses</code> shows the number of removal misses across all caches.</p>
</li>
<li>
<p><code>evictions</code> shows the number of evictions across all caches.</p>
</li>
<li>
<p><code>average_read_time</code> shows the average number of milliseconds taken for <code>get()</code> operations across all caches.</p>
</li>
<li>
<p><code>average_read_time_nanos</code> same as <code>average_read_time</code> but in nanoseconds.</p>
</li>
<li>
<p><code>average_remove_time</code> shows the average number of milliseconds for <code>remove()</code> operations across all caches.</p>
</li>
<li>
<p><code>average_remove_time_nanos</code> same as <code>average_remove_time</code> but in nanoseconds.</p>
</li>
<li>
<p><code>required_minimum_number_of_nodes</code> shows the required minimum number of nodes to guarantee data consistency.</p>
</li>
<li>
<p><code>hits</code> provides the number of <code>get()</code> hits across all caches.</p>
</li>
<li>
<p><code>stores</code> provides the number of <code>put()</code> operations across all caches.</p>
</li>
<li>
<p><code>current_number_of_entries_in_memory</code> shows the total number of entries currently in all caches, excluding passivated entries.</p>
</li>
<li>
<p><code>hit_ratio</code> provides the total percentage hit/(hit+miss) ratio for all caches.</p>
</li>
<li>
<p><code>retrievals</code> shows the total number of <code>get()</code> operations.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_manager_enable_rebalancing"><a class="anchor" href="#rest_v2_cache_manager_enable_rebalancing"></a>2.4.10. Enabling rebalancing for all caches</h4>
<div class="paragraph">
<p>Turn on automatic rebalancing for all caches.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/cache-managers/{cacheManagerName}?action=enable-rebalancing</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_manager_disable_rebalancing"><a class="anchor" href="#rest_v2_cache_manager_disable_rebalancing"></a>2.4.11. Disabling rebalancing for all caches</h4>
<div class="paragraph">
<p>Turn off automatic rebalancing for all caches.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/cache-managers/{cacheManagerName}?action=disable-rebalancing</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_manager_create"><a class="anchor" href="#rest_v2_backup_manager_create"></a>2.4.12. Backing Up Infinispan Cache Managers</h4>
<div class="paragraph">
<p>Create backup archives, <code>application/zip</code>, that contain resources (caches, cache
templates, counters, Protobuf schemas, server tasks, and so on) currently
stored in the cache manager.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/cache-managers/{cacheManagerName}/backups/{backupName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a backup with the same name already exists, the service responds with <code>409 (Conflict)</code>.
If the <code>directory</code> parameter is not valid, the service returns <code>400 (Bad Request)</code>.
A <code>202</code> response indicates that the backup request is accepted for processing.</p>
</div>
<div class="paragraph">
<p>Optionally include a JSON payload with your request that contains parameters
for the backup operation, as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 19. JSON Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>directory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a location on the server to create and store the backup archive.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resources</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the resources to back up, in JSON format. The default is to back up all resources. If you specify one or more resources, then Infinispan backs up only those resources. See the <em>Resource Parameters</em> table for more information.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 20. Resource Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>caches</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of cache names to back up or <code>*</code> for all caches.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache-configs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of cache templates to back up or <code>*</code> for all templates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>counters</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines either an array of counter names to back up or <code>*</code> for all counters.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>proto-schemas</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines either an array of Protobuf schema names to back up or <code>*</code> for all schemas.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tasks</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of server tasks to back up or <code>*</code> for all tasks.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following example creates a backup archive with all counters and caches
named <code>[cache1,cache2]</code> in a specified directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">directory</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/some/path/accessible/to/the/server</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">resources</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">caches</span><span class="delimiter">&quot;</span></span>: [<span class="string"><span class="delimiter">&quot;</span><span class="content">cache1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">cache2</span><span class="delimiter">&quot;</span></span>],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">counters</span><span class="delimiter">&quot;</span></span>: [<span class="string"><span class="delimiter">&quot;</span><span class="content">*</span><span class="delimiter">&quot;</span></span>]
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_manager_list"><a class="anchor" href="#rest_v2_backup_manager_list"></a>2.4.13. Listing Backups</h4>
<div class="paragraph">
<p>Retrieve the names of all backup operations that are in progress, completed, or
failed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/backups</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with an Array of all backup names as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">[<span class="string"><span class="delimiter">&quot;</span><span class="content">backup1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">backup2</span><span class="delimiter">&quot;</span></span>]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_manager_head"><a class="anchor" href="#rest_v2_backup_manager_head"></a>2.4.14. Checking Backup Availability</h4>
<div class="paragraph">
<p>Verify that a backup operation is complete.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>HEAD /rest/v2/cache-managers/{cacheManagerName}/backups/{backupName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>200</code> response indicates the backup archive is available.
A <code>202</code> response indicates the backup operation is in progress.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_manager_get"><a class="anchor" href="#rest_v2_backup_manager_get"></a>2.4.15. Downloading Backup Archives</h4>
<div class="paragraph">
<p>Download backup archives from the server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/backups/{backupName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>200</code> response indicates the backup archive is available.
A <code>202</code> response indicates the backup operation is in progress.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_manager_delete"><a class="anchor" href="#rest_v2_backup_manager_delete"></a>2.4.16. Deleting Backup Archives</h4>
<div class="paragraph">
<p>Remove backup archives from the server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>DELETE /rest/v2/cache-managers/{cacheManagerName}/backups/{backupName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>204</code> response indicates that the backup archive is deleted. A <code>202</code> response
indicates that the backup operation is in progress but will be deleted when the
operation completes.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_restore_manager"><a class="anchor" href="#rest_v2_restore_manager"></a>2.4.17. Restoring Infinispan Resources from Backup Archives</h4>
<div class="paragraph">
<p>Restore Infinispan resources from backup archives. The provided
<code>{restoreName}</code> is for tracking restore progress, and is independent of the name of
backup file being restored.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can restore resources only if the container name in the backup archive
matches <code>{cacheManagerName}</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/cache-managers/{cacheManagerName}/restores/{restoreName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>202</code> response indicates
that the restore request has been accepted for processing.</p>
</div>
<div class="sect4">
<h5 id="restoring_from_backup_archives_on_infinispan_server"><a class="anchor" href="#restoring_from_backup_archives_on_infinispan_server"></a>Restoring from Backup Archives on Infinispan Server</h5>
<div class="paragraph">
<p>Use the <code>application/json</code> content type with your POST request to back up from
an archive that is available on the server.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 21. JSON Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>location</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the path of the backup archive to restore.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resources</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the resources to restore, in JSON format. The default is to restore all resources. If you specify one or more resources, then Infinispan restores only those resources. See the <em>Resource Parameters</em> table for more information.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 22. Resource Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>caches</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of cache names to back up or <code>*</code> for all caches.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache-configs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of cache templates to back up or <code>*</code> for all templates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>counters</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines either an array of counter names to back up or <code>*</code> for all counters.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>proto-schemas</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines either an array of Protobuf schema names to back up or <code>*</code> for all schemas.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tasks</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of server tasks to back up or <code>*</code> for all tasks.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following example restores all counters from a backup archive on the server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">location</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/some/path/accessible/to/the/server/backup-to-restore.zip</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">resources</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">counters</span><span class="delimiter">&quot;</span></span>: [<span class="string"><span class="delimiter">&quot;</span><span class="content">*</span><span class="delimiter">&quot;</span></span>]
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="restoring_from_local_backup_archives"><a class="anchor" href="#restoring_from_local_backup_archives"></a>Restoring from Local Backup Archives</h5>
<div class="paragraph">
<p>Use the <code>multipart/form-data</code> content type with your POST request to upload a
local backup archive to the server.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 23. Form Data</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Content-Type</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>backup</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application/zip</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the bytes of the backup archive to restore.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resources</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application/json</code>, <code>text/plain</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a JSON object of request parameters.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example Request</div>
<div class="content">
<pre>Content-Type: multipart/form-data; boundary=5ec9bc07-f069-4662-a535-46069afeda32
Content-Length: 7721

--5ec9bc07-f069-4662-a535-46069afeda32
Content-Disposition: form-data; name="resources"
Content-Length: 23

{"scripts":["test.js"]}
--5ec9bc07-f069-4662-a535-46069afeda32
Content-Disposition: form-data; name="backup"; filename="testManagerRestoreParameters.zip"
Content-Type: application/zip
Content-Length: 7353

&lt;zip-bytes&gt;
--5ec9bc07-f069-4662-a535-46069afeda32--</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_restore_manager_list"><a class="anchor" href="#rest_v2_restore_manager_list"></a>2.4.18. Listing Restores</h4>
<div class="paragraph">
<p>Retrieve the names of all restore requests that are in progress, completed, or
failed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/restores</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with an Array of all restore names as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">[<span class="string"><span class="delimiter">&quot;</span><span class="content">restore1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">restore2</span><span class="delimiter">&quot;</span></span>]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_restore_manager_head"><a class="anchor" href="#rest_v2_restore_manager_head"></a>2.4.19. Checking Restore Progress</h4>
<div class="paragraph">
<p>Verify that a restore operation is complete.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>HEAD /rest/v2/cache-managers/{cacheManagerName}/restores/{restoreName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>201 (Created)</code> response indicates the restore operation is completed.
A <code>202 (Accepted)</code> response indicates the backup operation is in progress.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_restore_manager_delete"><a class="anchor" href="#rest_v2_restore_manager_delete"></a>2.4.20. Deleting Restore Metadata</h4>
<div class="paragraph">
<p>Remove metadata for restore requests from the server. This action removes all metadata
associated with restore requests but does not delete any restored content. If you delete
the request metadata, you can use the request name to perform subsequent restore operations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>DELETE /rest/v2/cache-managers/{cacheManagerName}/restores/{restoreName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>204 (No Content)</code> response indicates that the restore metadata is deleted.
A <code>202 (Accepted)</code> response indicates that the restore operation is in progress and will be deleted when the operation
completes.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_container_configuration_listen"><a class="anchor" href="#rest_v2_container_configuration_listen"></a>2.4.21. Listening to container configuration events</h4>
<div class="paragraph">
<p>Receive events about configuration changes using <a href="https://html.spec.whatwg.org/multipage/server-sent-events.html">Server-Sent Events</a>.
The <code>event</code> value will be one of <code>cache-created</code>, <code>cache-removed</code>.
The <code>data</code> value will contain the declarative configuration of the entity that has been created. Remove events will only contain the name of the removed entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/container/config?action=listen</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 24. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Accept</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the required format to return content. Supported formats are <code>application/yaml</code>, <code>application/json</code> and <code>application/xml</code>. The default is <code>application/yaml</code>. See <a href="#rest_accept">Accept</a> for more information.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_xsite_cache_manager"><a class="anchor" href="#rest_v2_xsite_cache_manager"></a>2.4.22. Cross-Site Operations with Cache Managers</h4>
<div class="paragraph">
<p>Perform cross-site operations with Cache Managers to apply the operations to
all caches.</p>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_site_status"><a class="anchor" href="#rest_v2_cache_manager_site_status"></a>Getting Status of Backup Locations</h5>
<div class="paragraph">
<p>Retrieve the status of all backup locations from Cache Managers with <code>GET</code>
requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cache-managers/{cacheManagerName}/x-site/backups/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with status in JSON format, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
   <span class="key"><span class="delimiter">&quot;</span><span class="content">SFO-3</span><span class="delimiter">&quot;</span></span>:{
      <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">online</span><span class="delimiter">&quot;</span></span>
   },
   <span class="key"><span class="delimiter">&quot;</span><span class="content">NYC-2</span><span class="delimiter">&quot;</span></span>:{
      <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">mixed</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">online</span><span class="delimiter">&quot;</span></span>:[
         <span class="string"><span class="delimiter">&quot;</span><span class="content">CACHE_1</span><span class="delimiter">&quot;</span></span>
      ],
      <span class="key"><span class="delimiter">&quot;</span><span class="content">offline</span><span class="delimiter">&quot;</span></span>:[
         <span class="string"><span class="delimiter">&quot;</span><span class="content">CACHE_2</span><span class="delimiter">&quot;</span></span>
      ]
   }
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 25. Returned Status</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>online</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All nodes in the local cluster have a cross-site view with the backup location.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>offline</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No nodes in the local cluster have a cross-site view with the backup location.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mixed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Some nodes in the local cluster have a cross-site view with the backup location, other nodes in the local cluster do not have a cross-site view. The response indicates status for each node.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_take_offline"><a class="anchor" href="#rest_v2_cache_manager_take_offline"></a>Taking Backup Locations Offline</h5>
<div class="paragraph">
<p>Take backup locations offline with the <code>?action=take-offline</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/cache-managers/{cacheManagerName}/x-site/backups/{siteName}?action=take-offline</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_bring_online"><a class="anchor" href="#rest_v2_cache_manager_bring_online"></a>Bringing Backup Locations Online</h5>
<div class="paragraph">
<p>Bring backup locations online with the <code>?action=bring-online</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/cache-managers/{cacheManagerName}/x-site/backups/{siteName}?action=bring-online</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_get_state_transfer_mode"><a class="anchor" href="#rest_v2_cache_manager_get_state_transfer_mode"></a>Retrieving the State Transfer Mode</h5>
<div class="paragraph">
<p>Check the state transfer mode with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/caches/{cacheName}/x-site/backups/{site}/state-transfer-mode</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_set_state_transfer_mode"><a class="anchor" href="#rest_v2_cache_manager_set_state_transfer_mode"></a>Setting the State Transfer Mode</h5>
<div class="paragraph">
<p>Configure the state transfer mode with the <code>?action=set</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/caches/{cacheName}/x-site/backups/{site}/state-transfer-mode?action=set&amp;mode={mode}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_start_push"><a class="anchor" href="#rest_v2_cache_manager_start_push"></a>Starting State Transfer</h5>
<div class="paragraph">
<p>Push state of all caches to remote sites with the <code>?action=start-push-state</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/cache-managers/{cacheManagerName}/x-site/backups/{siteName}?action=start-push-state</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_cancel_push"><a class="anchor" href="#rest_v2_cache_manager_cancel_push"></a>Canceling State Transfer</h5>
<div class="paragraph">
<p>Cancel ongoing state transfer operations with the <code>?action=cancel-push-state</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/cache-managers/{cacheManagerName}/x-site/backups/{siteName}?action=cancel-push-state</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_server"><a class="anchor" href="#rest_v2_server"></a>2.5. Working with Infinispan Servers</h3>
<div class="paragraph">
<p>Monitor and manage Infinispan server instances.</p>
</div>
<div class="sect3">
<h4 id="rest_v2_server_info"><a class="anchor" href="#rest_v2_server_info"></a>2.5.1. Retrieving Basic Server Information</h4>
<div class="paragraph">
<p>View basic information about Infinispan servers with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/server</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with the server name, codename, and version in JSON format
as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Infinispan 'Codename' xx.x.x.Final</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_server_cm"><a class="anchor" href="#rest_v2_server_cm"></a>2.5.2. Getting Cache Managers</h4>
<div class="paragraph">
<p>Retrieve lists of cache managers for Infinispan servers with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/server/cache-managers</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with an array of the cache manager names configured for
the server.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Infinispan currently supports one cache manager per server only.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_ignore"><a class="anchor" href="#rest_v2_cache_ignore"></a>2.5.3. Adding Caches to Ignore Lists</h4>
<div class="paragraph">
<p>Configure Infinispan to temporarily exclude specific caches from client
requests. Send empty <code>POST</code> requests that include the names of the cache manager
name and the cache.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /v2/server/ignored-caches/{cache-manager}/{cache}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with <code>204 (No Content)</code> if the cache is successfully added to the ignore list or <code>404 (Not Found)</code> if the cache or cache manager are not found.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Infinispan currently supports one cache manager per server only. For future
compatibility you must provide the cache manager name in the requests.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_ignore_remove"><a class="anchor" href="#rest_v2_cache_ignore_remove"></a>2.5.4. Removing Caches from Ignore Lists</h4>
<div class="paragraph">
<p>Remove caches from the ignore list with <code>DELETE</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>DELETE /v2/server/ignored-caches/{cache-manager}/{cache}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with <code>204 (No Content)</code> if the cache is successfully removed from ignore list or <code>404 (Not Found)</code> if the cache or cache manager are not found.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_ignore_confirm"><a class="anchor" href="#rest_v2_cache_ignore_confirm"></a>2.5.5. Confirming Ignored Caches</h4>
<div class="paragraph">
<p>Confirm that caches are ignored with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /v2/server/ignored-caches/{cache-manager}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_server_config"><a class="anchor" href="#rest_v2_server_config"></a>2.5.6. Obtaining Server Configuration</h4>
<div class="paragraph">
<p>Retrieve Infinispan server configurations with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/server/config</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with the configuration in JSON format, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">server</span><span class="delimiter">&quot;</span></span>:{
        <span class="key"><span class="delimiter">&quot;</span><span class="content">interfaces</span><span class="delimiter">&quot;</span></span>:{
            <span class="key"><span class="delimiter">&quot;</span><span class="content">interface</span><span class="delimiter">&quot;</span></span>:{
                <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span>,
                <span class="key"><span class="delimiter">&quot;</span><span class="content">inet-address</span><span class="delimiter">&quot;</span></span>:{
                    <span class="key"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">127.0.0.1</span><span class="delimiter">&quot;</span></span>
                }
            }
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">socket-bindings</span><span class="delimiter">&quot;</span></span>:{
            <span class="key"><span class="delimiter">&quot;</span><span class="content">port-offset</span><span class="delimiter">&quot;</span></span>:<span class="integer">0</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">default-interface</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">socket-binding</span><span class="delimiter">&quot;</span></span>:[
                {
                    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">memcached</span><span class="delimiter">&quot;</span></span>,
                    <span class="key"><span class="delimiter">&quot;</span><span class="content">port</span><span class="delimiter">&quot;</span></span>:<span class="integer">11221</span>,
                    <span class="key"><span class="delimiter">&quot;</span><span class="content">interface</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">memcached</span><span class="delimiter">&quot;</span></span>
                }
            ]
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>:{
            <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realms</span><span class="delimiter">&quot;</span></span>:{
                <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realm</span><span class="delimiter">&quot;</span></span>:{
                    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>
                }
            }
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">endpoints</span><span class="delimiter">&quot;</span></span>:{
            <span class="key"><span class="delimiter">&quot;</span><span class="content">socket-binding</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">security-realm</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">hotrod-connector</span><span class="delimiter">&quot;</span></span>:{
                <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">hotrod</span><span class="delimiter">&quot;</span></span>
            },
            <span class="key"><span class="delimiter">&quot;</span><span class="content">rest-connector</span><span class="delimiter">&quot;</span></span>:{
                <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">rest</span><span class="delimiter">&quot;</span></span>
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_server_env"><a class="anchor" href="#rest_v2_server_env"></a>2.5.7. Getting Environment Variables</h4>
<div class="paragraph">
<p>Retrieve all environment variables for Infinispan servers with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/server/env</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_server_memory"><a class="anchor" href="#rest_v2_server_memory"></a>2.5.8. Getting JVM Memory Details</h4>
<div class="paragraph">
<p>Retrieve JVM memory usage information for Infinispan servers with <code>GET</code>
requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/server/memory</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with heap and non-heap memory statistics, direct memory
usage, and information about memory pools and garbage collection in JSON
format.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_server_threads"><a class="anchor" href="#rest_v2_server_threads"></a>2.5.9. Getting JVM Thread Dumps</h4>
<div class="paragraph">
<p>Retrieve the current thread dump for the JVM with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/server/threads</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with the current thread dump in <code>text/plain</code> format.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_server_report"><a class="anchor" href="#rest_v2_server_report"></a>2.5.10. Getting Diagnostic Reports for Infinispan Servers</h4>
<div class="paragraph">
<p>Retrieve aggregated reports for Infinispan servers with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/server/report</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a <code>tar.gz</code> archive that contains an aggregated report
with diagnostic information about both the Infinispan server and the host. The
report provides details about CPU, memory, open files, network sockets and
routing, threads, in addition to configuration and log files.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_server_stop"><a class="anchor" href="#rest_v2_server_stop"></a>2.5.11. Stopping Infinispan Servers</h4>
<div class="paragraph">
<p>Stop Infinispan servers with <code>POST</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/server?action=stop</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with <code>204 (No Content)</code> and then stops running.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_cluster"><a class="anchor" href="#rest_v2_cluster"></a>2.6. Working with Infinispan Clusters</h3>
<div class="paragraph">
<p>Monitor and perform administrative tasks on Infinispan clusters.</p>
</div>
<div class="sect3">
<h4 id="rest_v2_cluster_stop"><a class="anchor" href="#rest_v2_cluster_stop"></a>2.6.1. Stopping Infinispan Clusters</h4>
<div class="paragraph">
<p>Shut down entire Infinispan clusters with <code>POST</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/cluster?action=stop</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with <code>204 (No Content)</code> and then performs an orderly shutdown of
the entire cluster.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_stop_cluster_server"><a class="anchor" href="#rest_v2_stop_cluster_server"></a>2.6.2. Stopping Specific Infinispan Servers in Clusters</h4>
<div class="paragraph">
<p>Shut down one or more specific servers in Infinispan clusters with <code>GET</code>
requests and the <code>?action=stop&amp;server</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/cluster?action=stop&amp;server={server1_host}&amp;server={server2_host}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with <code>204 (No Content)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_cluster"><a class="anchor" href="#rest_v2_backup_cluster"></a>2.6.3. Backing Up Infinispan Clusters</h4>
<div class="paragraph">
<p>Create backup archives, <code>application/zip</code>, that contain resources (caches, templates, counters, Protobuf schemas, server tasks,
and so on) currently stored in the cache container for the cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/cluster/backups/{backupName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Optionally include a JSON payload with your request that contains parameters
for the backup operation, as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 26. JSON Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>directory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a location on the server to create and store the backup archive.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If the backup operation successfully completes, the service returns <code>202 (Accepted)</code>.
If a backup with the same name already exists, the service returns  <code>409 (Conflict)</code>.
If the <code>directory</code> parameter is not valid, the service returns <code>400 (Bad Request)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_cluster_list"><a class="anchor" href="#rest_v2_backup_cluster_list"></a>2.6.4. Listing Backups</h4>
<div class="paragraph">
<p>Retrieve the names of all backup operations that are in progress, completed, or
failed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cluster/backups</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with an Array of all backup names as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">[<span class="string"><span class="delimiter">&quot;</span><span class="content">backup1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">backup2</span><span class="delimiter">&quot;</span></span>]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_cluster_head"><a class="anchor" href="#rest_v2_backup_cluster_head"></a>2.6.5. Checking Backup Availability</h4>
<div class="paragraph">
<p>Verify that a backup operation is complete. A <code>200</code> response indicates the
backup archive is available. A <code>202</code> response indicates the backup operation is
in progress.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>HEAD /rest/v2/cluster/backups/{backupName}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_cluster_get"><a class="anchor" href="#rest_v2_backup_cluster_get"></a>2.6.6. Downloading Backup Archives</h4>
<div class="paragraph">
<p>Download backup archives from the server. A <code>200</code> response indicates the
backup archive is available. A <code>202</code> response indicates the backup operation is
in progress.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cluster/backups/{backupName}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_cluster_delete"><a class="anchor" href="#rest_v2_backup_cluster_delete"></a>2.6.7. Deleting Backup Archives</h4>
<div class="paragraph">
<p>Remove backup archives from the server. A <code>204</code> response indicates that the
backup archive is deleted. A <code>202</code> response indicates that the backup operation
is in progress but will be deleted when the operation completes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>DELETE /rest/v2/cluster/backups/{backupName}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_restore_cluster"><a class="anchor" href="#rest_v2_restore_cluster"></a>2.6.8. Restoring Infinispan Cluster Resources</h4>
<div class="paragraph">
<p>Apply resources in a backup archive to restore Infinispan clusters. The provided
<code>{restoreName}</code> is for tracking restore progress, and is independent of the name of
backup file being restored.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can restore resources only if the container name in the backup archive
matches the container name for the cluster.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/cluster/restores/{restoreName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>202</code> response indicates that the restore request is accepted for processing.</p>
</div>
<div class="sect4">
<h5 id="restoring_from_backup_archives_on_infinispan_server_2"><a class="anchor" href="#restoring_from_backup_archives_on_infinispan_server_2"></a>Restoring from Backup Archives on Infinispan Server</h5>
<div class="paragraph">
<p>Use the <code>application/json</code> content type with your POST request to back up from
an archive that is available on the server.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 27. JSON Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>location</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the path of the backup archive to restore.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resources</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the resources to restore, in JSON format. The default is to restore all resources. If you specify one or more resources, then Infinispan restores only those resources. See the <em>Resource Parameters</em> table for more information.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 28. Resource Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>caches</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of cache names to back up or <code>*</code> for all caches.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache-configs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of cache templates to back up or <code>*</code> for all templates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>counters</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines either an array of counter names to back up or <code>*</code> for all counters.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>proto-schemas</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines either an array of Protobuf schema names to back up or <code>*</code> for all schemas.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tasks</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of server tasks to back up or <code>*</code> for all tasks.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following example restores all counters from a backup archive on the server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">location</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/some/path/accessible/to/the/server/backup-to-restore.zip</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">resources</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">counters</span><span class="delimiter">&quot;</span></span>: [<span class="string"><span class="delimiter">&quot;</span><span class="content">*</span><span class="delimiter">&quot;</span></span>]
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="restoring_from_local_backup_archives_2"><a class="anchor" href="#restoring_from_local_backup_archives_2"></a>Restoring from Local Backup Archives</h5>
<div class="paragraph">
<p>Use the <code>multipart/form-data</code> content type with your POST request to upload a
local backup archive to the server.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 29. Form Data</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Content-Type</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>backup</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application/zip</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the bytes of the backup archive to restore.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example Request</div>
<div class="content">
<pre>Content-Type: multipart/form-data; boundary=5ec9bc07-f069-4662-a535-46069afeda32
Content-Length: 7798

--5ec9bc07-f069-4662-a535-46069afeda32
Content-Disposition: form-data; name="backup"; filename="testManagerRestoreParameters.zip"
Content-Type: application/zip
Content-Length: 7353

&lt;zip-bytes&gt;
--5ec9bc07-f069-4662-a535-46069afeda32--</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_restore_cluster_list"><a class="anchor" href="#rest_v2_restore_cluster_list"></a>2.6.9. Listing Restores</h4>
<div class="paragraph">
<p>Retrieve the names of all restore requests that are in progress, completed, or
failed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/cluster/restores</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with an Array of all restore names as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">[<span class="string"><span class="delimiter">&quot;</span><span class="content">restore1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">restore2</span><span class="delimiter">&quot;</span></span>]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_restore_cluster_head"><a class="anchor" href="#rest_v2_restore_cluster_head"></a>2.6.10. Checking Restore Progress</h4>
<div class="paragraph">
<p>Verify that a restore operation is complete.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>HEAD /rest/v2/cluster/restores/{restoreName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>201 (Created)</code> response indicates the restore operation is completed.
A <code>202</code> response indicates the backup operation is in progress.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_restore_cluster_delete"><a class="anchor" href="#rest_v2_restore_cluster_delete"></a>2.6.11. Deleting Restore Metadata</h4>
<div class="paragraph">
<p>Remove metadata for restore requests from the server. This action removes all metadata
associated with restore requests but does not delete any restored content. If you delete
the request metadata, you can use the request name to perform subsequent restore operations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>DELETE /rest/v2/cluster/restores/{restoreName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>204</code> response indicates that the restore metadata is deleted.
A <code>202</code> response indicates that the restore operation is in progress and will be deleted when the operation
completes.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_logging"><a class="anchor" href="#rest_v2_logging"></a>2.7. Infinispan Server logging configuration</h3>
<div class="paragraph">
<p>View and modify the logging configuration on Infinispan clusters at runtime.</p>
</div>
<div class="sect3">
<h4 id="rest_v2_logging_list_appenders"><a class="anchor" href="#rest_v2_logging_list_appenders"></a>2.7.1. Listing the logging appenders</h4>
<div class="paragraph">
<p>View a list of all configured appenders with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/logging/appenders</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a list of appenders in JSON format as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">STDOUT</span><span class="delimiter">&quot;</span></span> : {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">STDOUT</span><span class="delimiter">&quot;</span></span>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">JSON-FILE</span><span class="delimiter">&quot;</span></span> : {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">JSON-FILE</span><span class="delimiter">&quot;</span></span>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">HR-ACCESS-FILE</span><span class="delimiter">&quot;</span></span> : {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">HR-ACCESS-FILE</span><span class="delimiter">&quot;</span></span>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">FILE</span><span class="delimiter">&quot;</span></span> : {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">FILE</span><span class="delimiter">&quot;</span></span>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">REST-ACCESS-FILE</span><span class="delimiter">&quot;</span></span> : {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">REST-ACCESS-FILE</span><span class="delimiter">&quot;</span></span>
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_logging_list_loggers"><a class="anchor" href="#rest_v2_logging_list_loggers"></a>2.7.2. Listing the loggers</h4>
<div class="paragraph">
<p>View a list of all configured loggers with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/logging/loggers</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a list of loggers in JSON format as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">[ {
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">level</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">INFO</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">appenders</span><span class="delimiter">&quot;</span></span> : [ <span class="string"><span class="delimiter">&quot;</span><span class="content">STDOUT</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">FILE</span><span class="delimiter">&quot;</span></span> ]
}, {
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">org.infinispan.HOTROD_ACCESS_LOG</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">level</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">INFO</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">appenders</span><span class="delimiter">&quot;</span></span> : [ <span class="string"><span class="delimiter">&quot;</span><span class="content">HR-ACCESS-FILE</span><span class="delimiter">&quot;</span></span> ]
}, {
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">com.arjuna</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">level</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">appenders</span><span class="delimiter">&quot;</span></span> : [ ]
}, {
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">org.infinispan.REST_ACCESS_LOG</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">level</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">INFO</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">appenders</span><span class="delimiter">&quot;</span></span> : [ <span class="string"><span class="delimiter">&quot;</span><span class="content">REST-ACCESS-FILE</span><span class="delimiter">&quot;</span></span> ]
} ]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_logging_set_logger"><a class="anchor" href="#rest_v2_logging_set_logger"></a>2.7.3. Creating/modifying a logger</h4>
<div class="paragraph">
<p>Create a new logger or modify an existing one with <code>PUT</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>PUT /rest/v2/logging/loggers/{loggerName}?level={level}&amp;appender={appender}&amp;appender={appender}...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan sets the level of the logger identified by <code>{loggerName}</code> to <code>{level}</code>.
Optionally, it is possible to set one or more appenders for the logger.
If no appenders are specified, those specified in the root logger will be used.</p>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns <code>204 (No Content)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_logging_remove_logger"><a class="anchor" href="#rest_v2_logging_remove_logger"></a>2.7.4. Removing a logger</h4>
<div class="paragraph">
<p>Remove an existing logger with <code>DELETE</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>DELETE /rest/v2/logging/loggers/{loggerName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan removes the logger identified by <code>{loggerName}</code>, effectively reverting to the use of the root logger configuration.</p>
</div>
<div class="paragraph">
<p>If operation processed successfully, the service returns a response code <code>204 (No Content)</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_tasks"><a class="anchor" href="#rest_v2_tasks"></a>2.8. Using Server Tasks</h3>
<div class="paragraph">
<p>Retrieve, execute, and upload Infinispan server tasks.</p>
</div>
<div class="sect3">
<h4 id="rest_v2_tasks_list"><a class="anchor" href="#rest_v2_tasks_list"></a>2.8.1. Retrieving Server Tasks Information</h4>
<div class="paragraph">
<p>View information about available server tasks with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/tasks</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 30. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>user</code>: will exclude internal (admin) tasks from the results</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Infinispan responds with a list of available tasks. The list includes the
names of tasks, the engines that handle tasks, the named parameters for tasks,
the execution modes of tasks, either <code>ONE_NODE</code> or <code>ALL_NODES</code>, and the allowed
security role in <code>JSON</code> format, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">[
  {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SimpleTask</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">TaskEngine</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">parameters</span><span class="delimiter">&quot;</span></span>: [
      <span class="string"><span class="delimiter">&quot;</span><span class="content">p1</span><span class="delimiter">&quot;</span></span>,
      <span class="string"><span class="delimiter">&quot;</span><span class="content">p2</span><span class="delimiter">&quot;</span></span>
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">execution_mode</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ONE_NODE</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">allowed_role</span><span class="delimiter">&quot;</span></span>: <span class="value">null</span>
  },
  {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">RunOnAllNodesTask</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">TaskEngine</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">parameters</span><span class="delimiter">&quot;</span></span>: [
      <span class="string"><span class="delimiter">&quot;</span><span class="content">p1</span><span class="delimiter">&quot;</span></span>
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">execution_mode</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ALL_NODES</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">allowed_role</span><span class="delimiter">&quot;</span></span>: <span class="value">null</span>
  },
  {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SecurityAwareTask</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">TaskEngine</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">parameters</span><span class="delimiter">&quot;</span></span>: [],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">execution_mode</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ONE_NODE</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">allowed_role</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">MyRole</span><span class="delimiter">&quot;</span></span>
  }
]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_tasks_execute"><a class="anchor" href="#rest_v2_tasks_execute"></a>2.8.2. Executing Tasks</h4>
<div class="paragraph">
<p>Execute tasks with <code>POST</code> requests that include the task name and required parameters prefixed with <code>param</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/tasks/SimpleTask?action=exec&amp;param.p1=v1&amp;param.p2=v2</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with the task result.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_tasks_upload"><a class="anchor" href="#rest_v2_tasks_upload"></a>2.8.3. Uploading Script Tasks</h4>
<div class="paragraph">
<p>Upload script tasks with <code>PUT</code> or <code>POST</code> requests.</p>
</div>
<div class="paragraph">
<p>Supply the script as the content payload of the request. After Infinispan
uploads the script, you can execute it with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/tasks/taskName</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_security"><a class="anchor" href="#rest_v2_security"></a>2.9. Working with Infinispan Security</h3>
<div class="paragraph">
<p>View and modify security information.</p>
</div>
<div class="sect3">
<h4 id="rest_v2_get_user_acl"><a class="anchor" href="#rest_v2_get_user_acl"></a>2.9.1. Retrieving the ACL of a user</h4>
<div class="paragraph">
<p>View information about the user&#8217;s principals and access-control list.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/security/user/acl</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with information about the user who has performed the request.
The list includes the principals of the user, and a list of resources and the permissions that user has when accessing them.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">subject</span><span class="delimiter">&quot;</span></span>: [
    {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">deployer</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">NamePrincipal</span><span class="delimiter">&quot;</span></span>
    }
  ],
  <span class="key"><span class="delimiter">&quot;</span><span class="content">global</span><span class="delimiter">&quot;</span></span>: [
    <span class="string"><span class="delimiter">&quot;</span><span class="content">READ</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">WRITE</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">EXEC</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">LISTEN</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">BULK_READ</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">BULK_WRITE</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">CREATE</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">MONITOR</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">ALL_READ</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">ALL_WRITE</span><span class="delimiter">&quot;</span></span>  ],
  <span class="key"><span class="delimiter">&quot;</span><span class="content">caches</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">___protobuf_metadata</span><span class="delimiter">&quot;</span></span>: [
      <span class="string"><span class="delimiter">&quot;</span><span class="content">READ</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">WRITE</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">EXEC</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">LISTEN</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">BULK_READ</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">BULK_WRITE</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">CREATE</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">MONITOR</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">ALL_READ</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">ALL_WRITE</span><span class="delimiter">&quot;</span></span>
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">mycache</span><span class="delimiter">&quot;</span></span>: [
      <span class="string"><span class="delimiter">&quot;</span><span class="content">LIFECYCLE</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">READ</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">WRITE</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">EXEC</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">LISTEN</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">BULK_READ</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">BULK_WRITE</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">ADMIN</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">CREATE</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">MONITOR</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">ALL_READ</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">ALL_WRITE</span><span class="delimiter">&quot;</span></span>
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">___script_cache</span><span class="delimiter">&quot;</span></span>: [
      <span class="string"><span class="delimiter">&quot;</span><span class="content">READ</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">WRITE</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">EXEC</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">LISTEN</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">BULK_READ</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">BULK_WRITE</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">CREATE</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">MONITOR</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">ALL_READ</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">ALL_WRITE</span><span class="delimiter">&quot;</span></span>
    ]
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_flush_acl_cache"><a class="anchor" href="#rest_v2_flush_acl_cache"></a>2.9.2. Flushing the ACL cache</h4>
<div class="paragraph">
<p>Flush the access-control list cache across the cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>POST /rest/v2/security/cache?action=flush</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_get_roles"><a class="anchor" href="#rest_v2_get_roles"></a>2.9.3. Retrieving the available roles</h4>
<div class="paragraph">
<p>View all the available roles defined in the server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/security/roles</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a list of available roles.
If authorization is enabled, only a user with the <code>ADMIN</code> permission can call this API.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">[<span class="string"><span class="delimiter">&quot;</span><span class="content">observer</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">application</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">admin</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">monitor</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">deployer</span><span class="delimiter">&quot;</span></span>]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_get_principal_roles"><a class="anchor" href="#rest_v2_get_principal_roles"></a>2.9.4. Retrieving the roles for a principal</h4>
<div class="paragraph">
<p>View all the roles which map to a principal.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>GET /rest/v2/security/roles/some_principal</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a list of available roles for the specified principal.
The principal need not exist in the realm in use.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json">[<span class="string"><span class="delimiter">&quot;</span><span class="content">observer</span><span class="delimiter">&quot;</span></span>]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_grant_principal_roles"><a class="anchor" href="#rest_v2_grant_principal_roles"></a>2.9.5. Granting roles to a principal</h4>
<div class="paragraph">
<p>Grant one or more new roles to a principal.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>PUT /v2/security/roles/some_principal?action=grant&amp;role=role1&amp;role=role2</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 31. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>role</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of a role</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_deny_principal_roles"><a class="anchor" href="#rest_v2_deny_principal_roles"></a>2.9.6. Denying roles to a principal</h4>
<div class="paragraph">
<p>Remove one or more roles that were previously granted to a principal.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>PUT /v2/security/roles/some_principal?action=deny&amp;role=role1&amp;role=role2</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 32. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>role</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of a role</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rest_client_code"><a class="anchor" href="#rest_client_code"></a>3. REST Client Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Part of the point of a RESTful service is that you don&#8217;t need to have tightly coupled client libraries/bindings. All you need is a HTTP client library. For Java, Apache HTTP Commons Client works just fine (and is used in the integration tests), or you can use java.net API.</p>
</div>
<div class="sect2">
<h3 id="rest_server_client_ruby"><a class="anchor" href="#rest_server_client_ruby"></a>3.1. Ruby REST Example</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># Shows how to interact with the REST api from ruby.</span>
<span class="comment"># No special libraries, just standard net/http</span>
<span class="comment">#</span>
<span class="comment"># Author: Michael Neale</span>
<span class="comment">#</span>
require <span class="string"><span class="delimiter">'</span><span class="content">net/http</span><span class="delimiter">'</span></span>

uri = <span class="constant">URI</span>.parse(<span class="string"><span class="delimiter">'</span><span class="content">http://localhost:11222/rest/v2/caches/default/MyKey</span><span class="delimiter">'</span></span>)
http = <span class="constant">Net</span>::<span class="constant">HTTP</span>.new(uri.host, uri.port)

<span class="comment">#Create new entry</span>

post = <span class="constant">Net</span>::<span class="constant">HTTP</span>::<span class="constant">Post</span>.new(uri.path, {<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>})
post.basic_auth(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">pass</span><span class="delimiter">'</span></span>)
post.body = <span class="string"><span class="delimiter">&quot;</span><span class="content">DATA HERE</span><span class="delimiter">&quot;</span></span>

resp = http.request(post)

puts <span class="string"><span class="delimiter">&quot;</span><span class="content">POST response code : </span><span class="delimiter">&quot;</span></span> + resp.code

<span class="comment">#get it back</span>

get = <span class="constant">Net</span>::<span class="constant">HTTP</span>::<span class="constant">Get</span>.new(uri.path)
get.basic_auth(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">pass</span><span class="delimiter">'</span></span>)
resp = http.request(get)

puts <span class="string"><span class="delimiter">&quot;</span><span class="content">GET response code: </span><span class="delimiter">&quot;</span></span> + resp.code
puts <span class="string"><span class="delimiter">&quot;</span><span class="content">GET Body: </span><span class="delimiter">&quot;</span></span> + resp.body

<span class="comment">#use PUT to overwrite</span>

put = <span class="constant">Net</span>::<span class="constant">HTTP</span>::<span class="constant">Put</span>.new(uri.path, {<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>})
put.basic_auth(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">pass</span><span class="delimiter">'</span></span>)
put.body = <span class="string"><span class="delimiter">&quot;</span><span class="content">ANOTHER DATA HERE</span><span class="delimiter">&quot;</span></span>

resp = http.request(put)

puts <span class="string"><span class="delimiter">&quot;</span><span class="content">PUT response code : </span><span class="delimiter">&quot;</span></span> + resp.code

<span class="comment">#and remove...</span>
delete = <span class="constant">Net</span>::<span class="constant">HTTP</span>::<span class="constant">Delete</span>.new(uri.path)
delete.basic_auth(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">pass</span><span class="delimiter">'</span></span>)

resp = http.request(delete)

puts <span class="string"><span class="delimiter">&quot;</span><span class="content">DELETE response code : </span><span class="delimiter">&quot;</span></span> + resp.code

<span class="comment">#Create binary data like this... just the same...</span>

uri = <span class="constant">URI</span>.parse(<span class="string"><span class="delimiter">'</span><span class="content">http://localhost:11222/rest/v2/caches/default/MyLogo</span><span class="delimiter">'</span></span>)
put = <span class="constant">Net</span>::<span class="constant">HTTP</span>::<span class="constant">Put</span>.new(uri.path, {<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">application/octet-stream</span><span class="delimiter">&quot;</span></span>})
put.basic_auth(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">pass</span><span class="delimiter">'</span></span>)
put.body = <span class="constant">File</span>.read(<span class="string"><span class="delimiter">'</span><span class="content">./logo.png</span><span class="delimiter">'</span></span>)

resp = http.request(put)

puts <span class="string"><span class="delimiter">&quot;</span><span class="content">PUT response code : </span><span class="delimiter">&quot;</span></span> + resp.code

<span class="comment">#and if you want to do json...</span>
require <span class="string"><span class="delimiter">'</span><span class="content">rubygems</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">json</span><span class="delimiter">'</span></span>

<span class="comment">#now for fun, lets do some JSON !</span>
uri = <span class="constant">URI</span>.parse(<span class="string"><span class="delimiter">'</span><span class="content">http://localhost:11222/rest/v2/caches/jsonCache/user</span><span class="delimiter">'</span></span>)
put = <span class="constant">Net</span>::<span class="constant">HTTP</span>::<span class="constant">Put</span>.new(uri.path, {<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>})
put.basic_auth(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">pass</span><span class="delimiter">'</span></span>)

data = {<span class="symbol">:name</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">michael</span><span class="delimiter">&quot;</span></span>, <span class="symbol">:age</span> =&gt; <span class="integer">42</span> }
put.body = data.to_json

resp = http.request(put)

puts <span class="string"><span class="delimiter">&quot;</span><span class="content">PUT response code : </span><span class="delimiter">&quot;</span></span> + resp.code

get = <span class="constant">Net</span>::<span class="constant">HTTP</span>::<span class="constant">Get</span>.new(uri.path)
get.basic_auth(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">pass</span><span class="delimiter">'</span></span>)
resp = http.request(get)

puts <span class="string"><span class="delimiter">&quot;</span><span class="content">GET Body: </span><span class="delimiter">&quot;</span></span> + resp.body</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_server_client_python"><a class="anchor" href="#rest_server_client_python"></a>3.2. Python 3 REST Example</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">import</span> <span class="include">urllib.request</span>

<span class="comment"># Setup basic auth</span>
base_uri = <span class="string"><span class="delimiter">'</span><span class="content">http://localhost:11222/rest/v2/caches/default</span><span class="delimiter">'</span></span>
auth_handler = urllib.request.HTTPBasicAuthHandler()
auth_handler.add_password(user=<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, passwd=<span class="string"><span class="delimiter">'</span><span class="content">pass</span><span class="delimiter">'</span></span>, realm=<span class="string"><span class="delimiter">'</span><span class="content">ApplicationRealm</span><span class="delimiter">'</span></span>, uri=base_uri)
opener = urllib.request.build_opener(auth_handler)
urllib.request.install_opener(opener)

<span class="comment"># putting data in</span>
data = <span class="string"><span class="delimiter">&quot;</span><span class="content">SOME DATA HERE </span><span class="content">\!</span><span class="delimiter">&quot;</span></span>

req = urllib.request.Request(url=base_uri + <span class="string"><span class="delimiter">'</span><span class="content">/Key</span><span class="delimiter">'</span></span>, data=data.encode(<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span>), method=<span class="string"><span class="delimiter">'</span><span class="content">PUT</span><span class="delimiter">'</span></span>,
                             headers={<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>})
<span class="keyword">with</span> urllib.request.urlopen(req) <span class="keyword">as</span> f:
    <span class="keyword">pass</span>

print(f.status)
print(f.reason)

<span class="comment"># getting data out</span>
resp = urllib.request.urlopen(base_uri + <span class="string"><span class="delimiter">'</span><span class="content">/Key</span><span class="delimiter">'</span></span>)
print(resp.read().decode(<span class="string"><span class="delimiter">'</span><span class="content">utf-8</span><span class="delimiter">'</span></span>))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_server_client_java"><a class="anchor" href="#rest_server_client_java"></a>3.3. Java REST Example</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.infinispan</span>;

<span class="keyword">import</span> <span class="include">java.io.BufferedReader</span>;
<span class="keyword">import</span> <span class="include">java.io.IOException</span>;
<span class="keyword">import</span> <span class="include">java.io.InputStreamReader</span>;
<span class="keyword">import</span> <span class="include">java.io.OutputStreamWriter</span>;
<span class="keyword">import</span> <span class="include">java.net.HttpURLConnection</span>;
<span class="keyword">import</span> <span class="include">java.net.URL</span>;
<span class="keyword">import</span> <span class="include">java.util.Base64</span>;

<span class="comment">/**
 * Rest example accessing a cache.
 *
 * @author Samuel Tauil (samuel@redhat.com)
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">RestExample</span> {

    <span class="comment">/**
     * Method that puts a String value in cache.
     *
     * @param urlServerAddress URL containing the cache and the key to insert
     * @param value            Text to insert
     * @param user             Used for basic auth
     * @param password         Used for basic auth
     */</span>
    <span class="directive">public</span> <span class="type">void</span> putMethod(<span class="predefined-type">String</span> urlServerAddress, <span class="predefined-type">String</span> value, <span class="predefined-type">String</span> user, <span class="predefined-type">String</span> password) <span class="directive">throws</span> <span class="exception">IOException</span> {
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Executing PUT</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">URL</span> address = <span class="keyword">new</span> <span class="predefined-type">URL</span>(urlServerAddress);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">executing request </span><span class="delimiter">&quot;</span></span> + urlServerAddress);
        <span class="predefined-type">HttpURLConnection</span> connection = (<span class="predefined-type">HttpURLConnection</span>) address.openConnection();
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Executing put method of value: </span><span class="delimiter">&quot;</span></span> + value);
        connection.setRequestMethod(<span class="string"><span class="delimiter">&quot;</span><span class="content">PUT</span><span class="delimiter">&quot;</span></span>);
        connection.setRequestProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>);
        addAuthorization(connection, user, password);
        connection.setDoOutput(<span class="predefined-constant">true</span>);

        <span class="predefined-type">OutputStreamWriter</span> outputStreamWriter = <span class="keyword">new</span> <span class="predefined-type">OutputStreamWriter</span>(connection.getOutputStream());
        outputStreamWriter.write(value);

        connection.connect();
        outputStreamWriter.flush();
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println(connection.getResponseCode() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span> + connection.getResponseMessage());
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
        connection.disconnect();
    }

    <span class="comment">/**
     * Method that gets a value by a key in url as param value.
     *
     * @param urlServerAddress URL containing the cache and the key to read
     * @param user             Used for basic auth
     * @param password         Used for basic auth
     * @return String value
     */</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getMethod(<span class="predefined-type">String</span> urlServerAddress, <span class="predefined-type">String</span> user, <span class="predefined-type">String</span> password) <span class="directive">throws</span> <span class="exception">IOException</span> {
        <span class="predefined-type">String</span> line;
        <span class="predefined-type">StringBuilder</span> stringBuilder = <span class="keyword">new</span> <span class="predefined-type">StringBuilder</span>();

        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Executing GET</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);

        <span class="predefined-type">URL</span> address = <span class="keyword">new</span> <span class="predefined-type">URL</span>(urlServerAddress);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">executing request </span><span class="delimiter">&quot;</span></span> + urlServerAddress);

        <span class="predefined-type">HttpURLConnection</span> connection = (<span class="predefined-type">HttpURLConnection</span>) address.openConnection();
        connection.setRequestMethod(<span class="string"><span class="delimiter">&quot;</span><span class="content">GET</span><span class="delimiter">&quot;</span></span>);
        connection.setRequestProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>);
        addAuthorization(connection, user, password);
        connection.setDoOutput(<span class="predefined-constant">true</span>);

        <span class="predefined-type">BufferedReader</span> bufferedReader = <span class="keyword">new</span> <span class="predefined-type">BufferedReader</span>(<span class="keyword">new</span> <span class="predefined-type">InputStreamReader</span>(connection.getInputStream()));

        connection.connect();

        <span class="keyword">while</span> ((line = bufferedReader.readLine()) != <span class="predefined-constant">null</span>) {
            stringBuilder.append(line).append(<span class="string"><span class="delimiter">'</span><span class="content">\n</span><span class="delimiter">'</span></span>);
        }

        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Executing get method of value: </span><span class="delimiter">&quot;</span></span> + stringBuilder.toString());

        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println(connection.getResponseCode() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span> + connection.getResponseMessage());
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);

        connection.disconnect();

        <span class="keyword">return</span> stringBuilder.toString();
    }

    <span class="directive">private</span> <span class="type">void</span> addAuthorization(<span class="predefined-type">HttpURLConnection</span> connection, <span class="predefined-type">String</span> user, <span class="predefined-type">String</span> pass) {
        <span class="predefined-type">String</span> credentials = user + <span class="string"><span class="delimiter">&quot;</span><span class="content">:</span><span class="delimiter">&quot;</span></span> + pass;
        <span class="predefined-type">String</span> basic = Base64.getEncoder().encodeToString(credentials.getBytes());
        connection.setRequestProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">Authorization</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Basic </span><span class="delimiter">&quot;</span></span> + basic);
    }

    <span class="comment">/**
     * Main method example.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">IOException</span> {
        RestExample restExample = <span class="keyword">new</span> RestExample();
        <span class="predefined-type">String</span> user = <span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>;
        <span class="predefined-type">String</span> pass = <span class="string"><span class="delimiter">&quot;</span><span class="content">pass</span><span class="delimiter">&quot;</span></span>;
        restExample.putMethod(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:11222/rest/v2/caches/default/1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Infinispan REST Test</span><span class="delimiter">&quot;</span></span>, user, pass);
        restExample.getMethod(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:11222/rest/v2/caches/default/1</span><span class="delimiter">&quot;</span></span>, user, pass);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_server_client_http"><a class="anchor" href="#rest_server_client_http"></a>3.4. <code>HttpClient</code> API REST Example</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.infinispan</span>;

<span class="keyword">import</span> <span class="include">java.io.IOException</span>;
<span class="keyword">import</span> <span class="include">java.net.URI</span>;
<span class="keyword">import</span> <span class="include">java.net.http.HttpClient</span>;
<span class="keyword">import</span> <span class="include">java.net.http.HttpRequest</span>;
<span class="keyword">import</span> <span class="include">java.net.http.HttpResponse</span>;
<span class="keyword">import</span> <span class="include">java.util.Base64</span>;

<span class="comment">/**
 * RestExample class shows you how to access your cache via HttpClient API with Java 11 or later.
 *
 * @author Gustavo Lira (glira@redhat.com)
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">RestExample</span> {
   <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> SERVER_ADDRESS = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:11222</span><span class="delimiter">&quot;</span></span>;
   <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> CACHE_URI = <span class="string"><span class="delimiter">&quot;</span><span class="content">/rest/v2/caches/default</span><span class="delimiter">&quot;</span></span>;

   <span class="comment">/**
    * postMethod create a named cache.
    * @param httpClient HTTP client that sends requests and receives responses
    * @param builder    Encapsulates HTTP requests
    * @throws IOException
    * @throws InterruptedException
    */</span>
   <span class="directive">public</span> <span class="type">void</span> postMethod(HttpClient httpClient, HttpRequest.Builder builder) <span class="directive">throws</span> <span class="exception">IOException</span>, <span class="exception">InterruptedException</span> {
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Executing POST</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);

      HttpRequest request = builder.POST(HttpRequest.BodyPublishers.noBody()).build();
      HttpResponse&lt;<span class="predefined-type">Void</span>&gt; response = httpClient.send(request, HttpResponse.BodyHandlers.discarding());

      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(response.statusCode());
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
   }

   <span class="comment">/**
    * putMethod stores a String value in your cache.
    * @param httpClient HTTP client that sends requests and receives responses
    * @param builder    Encapsulates HTTP requests
    * @throws IOException
    * @throws InterruptedException
    */</span>
   <span class="directive">public</span> <span class="type">void</span> putMethod(HttpClient httpClient, HttpRequest.Builder builder) <span class="directive">throws</span> <span class="exception">IOException</span>, <span class="exception">InterruptedException</span> {
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Executing PUT</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);

      <span class="predefined-type">String</span> cacheValue = <span class="string"><span class="delimiter">&quot;</span><span class="content">Infinispan REST Test</span><span class="delimiter">&quot;</span></span>;
      HttpRequest request = builder.PUT(HttpRequest.BodyPublishers.ofString(cacheValue)).build();
      HttpResponse&lt;<span class="predefined-type">Void</span>&gt; response = httpClient.send(request, HttpResponse.BodyHandlers.discarding());

      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(response.statusCode());
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
   }

   <span class="comment">/**
    * getMethod get a String value from your cache.
    * @param httpClient HTTP client that sends requests and receives responses
    * @param builder    Encapsulates HTTP requests
    * @return           String value
    * @throws IOException
    */</span>
   <span class="directive">public</span> <span class="predefined-type">String</span> getMethod(HttpClient httpClient, HttpRequest.Builder builder) <span class="directive">throws</span> <span class="exception">IOException</span>, <span class="exception">InterruptedException</span> {
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Executing GET</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);

      HttpRequest request = builder.GET().build();
      HttpResponse&lt;<span class="predefined-type">String</span>&gt; response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());

      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Executing get method of value: </span><span class="delimiter">&quot;</span></span> + response.body());

      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">System</span>.out.println(response.statusCode());
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">----------------------------------------</span><span class="delimiter">&quot;</span></span>);

      <span class="keyword">return</span> response.body();
   }

   <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">IOException</span>, <span class="exception">InterruptedException</span> {
      RestExample restExample = <span class="keyword">new</span> RestExample();
      HttpClient httpClient = HttpClient.newBuilder().version(HttpClient.Version.HTTP_1_1).build();

      restExample.postMethod(httpClient, getHttpReqestBuilder(<span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">%s%s</span><span class="delimiter">&quot;</span></span>, SERVER_ADDRESS, CACHE_URI)));
      restExample.putMethod(httpClient, getHttpReqestBuilder(<span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">%s%s/1</span><span class="delimiter">&quot;</span></span>, SERVER_ADDRESS, CACHE_URI)));
      restExample.getMethod(httpClient, getHttpReqestBuilder(<span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">%s%s/1</span><span class="delimiter">&quot;</span></span>, SERVER_ADDRESS, CACHE_URI)));
   }

   <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">String</span> basicAuth(<span class="predefined-type">String</span> username, <span class="predefined-type">String</span> password) {
      <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Basic </span><span class="delimiter">&quot;</span></span> + Base64.getEncoder().encodeToString((username + <span class="string"><span class="delimiter">&quot;</span><span class="content">:</span><span class="delimiter">&quot;</span></span> + password).getBytes());
   }

   <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> HttpRequest.Builder getHttpReqestBuilder(<span class="predefined-type">String</span> url) {
      <span class="keyword">return</span> HttpRequest.newBuilder()
            .uri(<span class="predefined-type">URI</span>.create(url))
            .header(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
            .header(<span class="string"><span class="delimiter">&quot;</span><span class="content">Authorization</span><span class="delimiter">&quot;</span></span>, basicAuth(<span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">pass</span><span class="delimiter">&quot;</span></span>));
   }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-08-30 06:20:16 -0400
</div>
</div>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid currentColor;opacity:.35;padding:0 .5em 0 0}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains('stemblock')) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8601422-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>
