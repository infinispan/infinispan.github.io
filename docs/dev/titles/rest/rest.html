<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>Using the Infinispan REST API</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/styles/github.min.css">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GPD7V946LB"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-GPD7V946LB');
</script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.1/themes/default/style.min.css">
<link rel="stylesheet" href="../../css/css.css">
<link rel="stylesheet" href="/assets/css/clipboard.css">
<link rel="stylesheet" href="/assets/css/cookieconsent.css">
<link rel="shortcut icon" type="image/png" href="/favicon.ico" >
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.1/jstree.min.js"></script>
<script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
<script src="/assets/javascript/copy.js" type="text/javascript"></script>
<script src="/assets/javascript/cookieconsent.umd.js" type="text/javascript"></script>
<script src="/assets/javascript/cookieconsent.config.js" type="module"></script>
<script src="../../js/js.js"></script>
<link rel="canonical" href="https://infinispan.org/docs/stable/titles/rest/rest.html">
<style>
.hidden {
    display: none;
}

.switch {
    border-width: 1px 1px 0 1px;
    border-style: solid;
    border-color: #7a2518;
    display: inline-block;
}

.switch--item {
    padding: 10px;
    background-color: #ffffff;
    color: #7a2518;
    display: inline-block;
    cursor: pointer;
}

.switch--item.selected {
    background-color: #7a2519;
    color: #ffffff;
}

</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
<script type="text/javascript">
function addBlockSwitches() {
    $('.primary').each(function() {
        primary = $(this);
        createSwitchItem(primary, createBlockSwitch(primary)).item.addClass("selected");
        primary.children('.title').remove();
    });
    $('.secondary').each(function(idx, node) {
        secondary = $(node);
        primary = findPrimary(secondary);
        switchItem = createSwitchItem(secondary, primary.children('.switch'));
        switchItem.content.addClass('hidden');
        findPrimary(secondary).append(switchItem.content);
        secondary.remove();
    });
}

function createBlockSwitch(primary) {
    blockSwitch = $('<div class="switch"></div>');
    primary.prepend(blockSwitch);
    return blockSwitch;
}

function findPrimary(secondary) {
    candidate = secondary.prev();
    while (!candidate.is('.primary')) {
        candidate = candidate.prev();
    }
    return candidate;
}

function createSwitchItem(block, blockSwitch) {
    blockName = block.children('.title').text();
    content = block.children('.content').first().append(block.next('.colist'));
    item = $('<div class="switch--item">' + blockName + '</div>');
    item.on('click', '', content, function(e) {
        $(this).addClass('selected');
        $(this).siblings().removeClass('selected');
        e.data.siblings('.content').addClass('hidden');
        e.data.removeClass('hidden');
    });
    blockSwitch.append(item);
    return {'item': item, 'content': content};
}

$(addBlockSwitches);

</script>

</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Using the Infinispan REST API</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#rest_server">1. Infinispan REST Endpoint</a>
<ul class="sectlevel2">
<li><a href="#rest_security">1.1. REST Authentication</a></li>
<li><a href="#rest_supported_protocols">1.2. Supported Protocols</a></li>
<li><a href="#rest_data_formats">1.3. Data Formats and the REST API</a>
<ul class="sectlevel3">
<li><a href="#rest_server_data_format_support">1.3.1. Supported Formats</a></li>
<li><a href="#rest_accept">1.3.2. Accept Headers</a></li>
<li><a href="#rest_encoded_names">1.3.3. Names with Special Characters</a></li>
<li><a href="#rest_key_content_type">1.3.4. Key-Content-Type Headers</a></li>
<li><a href="#rest_json_proto_conversion">1.3.5. JSON/ProtoStream Conversion</a></li>
</ul>
</li>
<li><a href="#rest_cors">1.4. Cross-Origin Resource Sharing (CORS) Requests</a>
<ul class="sectlevel3">
<li><a href="#allowing_all_cors_permissions_for_some_origins">1.4.1. Allowing all CORS permissions for some origins</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#rest_v2_api">2. Interacting with the Infinispan REST API</a>
<ul class="sectlevel2">
<li><a href="#rest_v2_cache_operations">2.1. Creating and Managing Caches</a>
<ul class="sectlevel3">
<li><a href="#rest_v2_create_cache">2.1.1. Creating Caches</a>
<ul class="sectlevel4">
<li><a href="#cache-configuration_rest">Cache configuration</a></li>
</ul>
</li>
<li><a href="#rest_v2_modify_cache">2.1.2. Modifying Caches</a></li>
<li><a href="#rest_v2_cache_exists">2.1.3. Verifying Caches</a></li>
<li><a href="#rest_v2_create_cache_template">2.1.4. Creating Caches with Templates</a></li>
<li><a href="#rest_v2_cache_configuration">2.1.5. Retrieving Cache Configuration</a></li>
<li><a href="#rest_v2_cache_config_convert">2.1.6. Converting Cache Configurations between XML, JSON and YAML</a></li>
<li><a href="#rest_v2_cache_config_compare">2.1.7. Comparing Cache Configurations</a></li>
<li><a href="#rest_v2_cache_detail">2.1.8. Retrieving All Cache Details</a></li>
<li><a href="#rest_v2_cache_reset_stats">2.1.9. Resetting All Cache Statistics</a></li>
<li><a href="#rest_v2_cache_distribution">2.1.10. Retrieving Data Distribution of a Cache</a></li>
<li><a href="#rest_v2_cache_mutable_attributes">2.1.11. Retrieving all mutable cache configuration attributes</a></li>
<li><a href="#rest_v2_cache_mutable_attribute_set">2.1.12. Updating cache configuration attributes</a></li>
<li><a href="#rest_v2_cache_assign_alias">2.1.13. Assign cache alias</a></li>
<li><a href="#rest_v2_add_entries">2.1.14. Adding Entries</a></li>
<li><a href="#rest_v2_replace_entries">2.1.15. Replacing Entries</a></li>
<li><a href="#rest_v2_retrieve_cache">2.1.16. Retrieving Data By Keys</a></li>
<li><a href="#rest_v2_check_entries">2.1.17. Checking if Entries Exist</a></li>
<li><a href="#rest_v2_delete_entries">2.1.18. Deleting Entries</a></li>
<li><a href="#rest_v2_distribution_entries">2.1.19. Checking distribution of cache entries</a></li>
<li><a href="#rest_v2_remove_cache">2.1.20. Deleting Caches</a></li>
<li><a href="#rest_v2_get_keys">2.1.21. Retrieving All Keys from Caches</a></li>
<li><a href="#rest_v2_get_entries">2.1.22. Retrieving All Entries from Caches</a></li>
<li><a href="#rest_v2_clear_cache">2.1.23. Clearing Caches</a></li>
<li><a href="#rest_v2_cache_size">2.1.24. Getting Cache Size</a></li>
<li><a href="#rest_v2_cache_stats">2.1.25. Getting Cache Statistics</a></li>
<li><a href="#rest_v2_list_caches">2.1.26. Listing Caches</a></li>
<li><a href="#rest_v2_cache_list_detailed">2.1.27. Obtaining Caches Status and Information</a></li>
<li><a href="#rest_v2_list_caches_by_role">2.1.28. Listing accessible caches for a role</a></li>
<li><a href="#rest_v2_cache_listen">2.1.29. Listening to cache events</a></li>
<li><a href="#rest_v2_caches_enable_rebalancing">2.1.30. Enabling rebalancing</a></li>
<li><a href="#rest_v2_caches_disable_rebalancing">2.1.31. Disabling rebalancing</a></li>
<li><a href="#rest_v2_caches_get_availability">2.1.32. Getting Cache Availability</a></li>
<li><a href="#rest_v2_caches_set_availability">2.1.33. Setting Cache Availability</a></li>
<li><a href="#rest_v2_caches_set_topology_stable">2.1.34. Set a Stable Topology</a></li>
<li><a href="#rest_v2_query_cache">2.1.35. Indexing and Querying with the REST API</a>
<ul class="sectlevel4">
<li><a href="#rest_v2_query_delete">Delete by query</a></li>
<li><a href="#rest_v2_query_reindex">Rebuilding indexes</a></li>
<li><a href="#rest_v2_query_updateIndexSchema">Updating index schema</a></li>
<li><a href="#rest_v2_query_purge_index">Purging indexes</a></li>
<li><a href="#rest_v2_query_get_index_schema">Get Indexes Metamodel</a></li>
<li><a href="#rest_v2_search_stats">Retrieving Query and Index Statistics</a></li>
<li><a href="#rest_v2_search_stats_clear">Clearing Query Statistics</a></li>
<li><a href="#rest_v2_query_index_stats">Retrieving Index Statistics (Deprecated)</a></li>
<li><a href="#rest_v2_query_stats">Retrieving Query Statistics (Deprecated)</a></li>
<li><a href="#rest_v2_query_stats_clear">Clearing Query Statistics (Deprecated)</a></li>
</ul>
</li>
<li><a href="#rest_v2_xsite_cache">2.1.36. Cross-Site Operations with Caches</a>
<ul class="sectlevel4">
<li><a href="#rest_v2_xsite_sites_status_rest">Getting status of all backup locations</a></li>
<li><a href="#rest_v2_xsite_site_status_rest">Getting status of specific backup locations</a></li>
<li><a href="#rest_v2_xsite_take_site_offline_rest">Taking backup locations offline</a></li>
<li><a href="#rest_v2_xsite_bring_backup_online_rest">Bringing backup locations online</a></li>
<li><a href="#rest_v2_xsite_start_push_rest">Pushing state to backup locations</a></li>
<li><a href="#rest_v2_xsite_cancel_state_push_rest">Canceling state transfer</a></li>
<li><a href="#rest_v2_xsite_state_push_rest">Getting state transfer status</a></li>
<li><a href="#rest_v2_xsite_clear_transfer_status_rest">Clearing state transfer status</a></li>
<li><a href="#rest_v2_xsite_tuning_takeoffline_rest">Modifying take offline conditions</a></li>
<li><a href="#rest_v2_xsite_cancel_receive_state_rest">Canceling state transfer from receiving sites</a></li>
</ul>
</li>
<li><a href="#rest_v2_rolling_upgrades">2.1.37. Rolling Upgrades</a>
<ul class="sectlevel4">
<li><a href="#rest_v2_sync_data">Connecting Source Clusters</a></li>
<li><a href="#obtaining_source_cluster_connection_details">Obtaining Source Cluster connection details</a></li>
<li><a href="#checking_if_a_cache_is_connected">Checking if a Cache is connected</a></li>
<li><a href="#synchronizing_data">Synchronizing Data</a></li>
<li><a href="#rest_v2_disconnect_source">Disconnecting Source Clusters</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#rest_v2_counters">2.2. Creating and Managing Counters</a>
<ul class="sectlevel3">
<li><a href="#rest_server_counters_create">2.2.1. Creating Counters</a></li>
<li><a href="#rest_server_counters_delete">2.2.2. Deleting Counters</a></li>
<li><a href="#rest_server_counters_config">2.2.3. Retrieving Counter Configuration</a></li>
<li><a href="#rest_server_counters_get">2.2.4. Getting Counter Values</a></li>
<li><a href="#rest_server_counters_reset">2.2.5. Resetting Counters</a></li>
<li><a href="#rest_server_counters_inc_weak">2.2.6. Incrementing Counters</a></li>
<li><a href="#rest_server_counters_add_weak">2.2.7. Adding Deltas to Counters</a></li>
<li><a href="#rest_server_counters_dec">2.2.8. Decrementing Counter Values</a></li>
<li><a href="#rest_server_counters_set">2.2.9. Performing <code>getAndSet</code> atomic operations on Strong Counters</a></li>
<li><a href="#rest_server_counters_cmpset">2.2.10. Performing compareAndSet Operations on Strong Counters</a></li>
<li><a href="#rest_server_counters_cmpswp">2.2.11. Performing compareAndSwap Operations on Strong Counters</a></li>
<li><a href="#rest_server_counters_list">2.2.12. Listing Counters</a></li>
</ul>
</li>
<li><a href="#rest_v2_protobuf_schemas">2.3. Working with Protobuf Schemas</a>
<ul class="sectlevel3">
<li><a href="#rest_v2_create_protobuf">2.3.1. Creating Protobuf Schemas</a></li>
<li><a href="#rest_v2_get_protobuf">2.3.2. Reading Protobuf Schemas</a></li>
<li><a href="#rest_v2_update_protobuf">2.3.3. Updating Protobuf Schemas</a></li>
<li><a href="#rest_v2_delete_protobuf">2.3.4. Deleting Protobuf Schemas</a></li>
<li><a href="#rest_v2_list_protobuf">2.3.5. Listing Protobuf Schemas</a></li>
<li><a href="#rest_v2_list_protobuf_types">2.3.6. Listing Protobuf Types</a></li>
</ul>
</li>
<li><a href="#rest_v2_cache_managers">2.4. Working with Cache Managers</a>
<ul class="sectlevel3">
<li><a href="#rest_v2_container_info">2.4.1. Getting Basic Container Information</a></li>
<li><a href="#rest_v2_container_health">2.4.2. Getting Cluster Health</a></li>
<li><a href="#rest_v2_container_health_status">2.4.3. Getting Container Health Status</a></li>
<li><a href="#rest_v2_container_availability">2.4.4. Checking REST Endpoint Availability</a></li>
<li><a href="#rest_v2_container_config">2.4.5. Obtaining Global Configuration</a></li>
<li><a href="#rest_v2_container_caches_config">2.4.6. Obtaining Configuration for All Caches</a></li>
<li><a href="#rest_v2_container_cache_templates">2.4.7. Listing Available Cache Templates</a></li>
<li><a href="#rest_v2_container_stats">2.4.8. Getting Container Statistics</a></li>
<li><a href="#rest_v2_container_stats_reset">2.4.9. Resetting Container Statistics</a></li>
<li><a href="#rest_v2_container_shutdown">2.4.10. Shutdown all container caches</a></li>
<li><a href="#rest_v2_container_enable_rebalancing">2.4.11. Enabling rebalancing for all caches</a></li>
<li><a href="#rest_v2_container_disable_rebalancing">2.4.12. Disabling rebalancing for all caches</a></li>
<li><a href="#rest_v2_backup_manager_create">2.4.13. Backing Up Infinispan</a></li>
<li><a href="#rest_v2_backup_manager_list">2.4.14. Listing Backups</a></li>
<li><a href="#rest_v2_backup_manager_head">2.4.15. Checking Backup Availability</a></li>
<li><a href="#rest_v2_backup_manager_get">2.4.16. Downloading Backup Archives</a></li>
<li><a href="#rest_v2_backup_manager_delete">2.4.17. Deleting Backup Archives</a></li>
<li><a href="#rest_v2_restore_manager">2.4.18. Restoring Infinispan Resources from Backup Archives</a>
<ul class="sectlevel4">
<li><a href="#restoring_from_backup_archives_on_infinispan_server">Restoring from Backup Archives on Infinispan Server</a></li>
<li><a href="#restoring_from_local_backup_archives">Restoring from Local Backup Archives</a></li>
</ul>
</li>
<li><a href="#rest_v2_restore_manager_list">2.4.19. Listing Restores</a></li>
<li><a href="#rest_v2_restore_manager_head">2.4.20. Checking Restore Progress</a></li>
<li><a href="#rest_v2_restore_manager_delete">2.4.21. Deleting Restore Metadata</a></li>
<li><a href="#rest_v2_container_configuration_listen">2.4.22. Listening to container configuration events</a></li>
<li><a href="#rest_v2_container_listen">2.4.23. Listening to container events</a></li>
<li><a href="#rest_v2_xsite_cache_manager">2.4.24. Cross-Site Operations with Cache Managers</a>
<ul class="sectlevel4">
<li><a href="#rest_v2_cache_manager_site_status_rest">Getting status of backup locations</a></li>
<li><a href="#rest_v2_cache_manager_take_offline_rest">Taking backup locations offline</a></li>
<li><a href="#rest_v2_cache_manager_bring_online_rest">Bringing backup locations online</a></li>
<li><a href="#rest_v2_cache_manager_get_state_transfer_mode_rest">Retrieving the state transfer mode</a></li>
<li><a href="#rest_v2_cache_manager_set_state_transfer_mode_rest">Setting the state transfer mode</a></li>
<li><a href="#rest_v2_cache_manager_start_push_rest">Starting state transfer</a></li>
<li><a href="#rest_v2_cache_manager_cancel_push_rest">Canceling state transfer</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#rest_v2_server">2.5. Working with Infinispan Servers</a>
<ul class="sectlevel3">
<li><a href="#rest_v2_server_info">2.5.1. Retrieving Basic Server Information</a></li>
<li><a href="#rest_v2_server_cm">2.5.2. Getting Cache Managers</a></li>
<li><a href="#rest_v2_cache_ignore">2.5.3. Adding Caches to Ignore Lists</a></li>
<li><a href="#rest_v2_cache_ignore_remove">2.5.4. Removing Caches from Ignore Lists</a></li>
<li><a href="#rest_v2_cache_ignore_confirm">2.5.5. Confirming Ignored Caches</a></li>
<li><a href="#rest_v2_server_config">2.5.6. Obtaining Server Configuration</a></li>
<li><a href="#rest_v2_server_env">2.5.7. Getting Environment Variables</a></li>
<li><a href="#rest_v2_server_memory_statistics">2.5.8. Getting JVM Memory Details</a></li>
<li><a href="#rest_v2_server_heap_dump">2.5.9. Getting JVM Heap Dumps</a></li>
<li><a href="#rest_v2_server_threads">2.5.10. Getting JVM Thread Dumps</a></li>
<li><a href="#rest_v2_server_report">2.5.11. Getting Diagnostic Reports for Infinispan Servers</a></li>
<li><a href="#rest_v2_server_stop">2.5.12. Stopping Infinispan Servers</a></li>
<li><a href="#rest_v2_server_connections">2.5.13. Retrieving Client Connection Information</a></li>
<li><a href="#rest_v2_server_caches_defaults">2.5.14. Retrieving Default values for Cache Configuration</a></li>
</ul>
</li>
<li><a href="#rest_v2_cluster">2.6. Working with Infinispan Clusters</a>
<ul class="sectlevel3">
<li><a href="#rest_v2_cluster_stop">2.6.1. Stopping Infinispan Clusters</a></li>
<li><a href="#rest_v2_stop_cluster_server">2.6.2. Stopping Specific Infinispan Servers in Clusters</a></li>
<li><a href="#rest_v2_backup_cluster">2.6.3. Backing Up Infinispan Clusters</a></li>
<li><a href="#rest_v2_backup_cluster_list">2.6.4. Listing Backups</a></li>
<li><a href="#rest_v2_backup_cluster_head">2.6.5. Checking Backup Availability</a></li>
<li><a href="#rest_v2_backup_cluster_get">2.6.6. Downloading Backup Archives</a></li>
<li><a href="#rest_v2_backup_cluster_delete">2.6.7. Deleting Backup Archives</a></li>
<li><a href="#rest_v2_restore_cluster">2.6.8. Restoring Infinispan Cluster Resources</a>
<ul class="sectlevel4">
<li><a href="#restoring_from_backup_archives_on_infinispan_server_2">Restoring from Backup Archives on Infinispan Server</a></li>
<li><a href="#restoring_from_local_backup_archives_2">Restoring from Local Backup Archives</a></li>
</ul>
</li>
<li><a href="#rest_v2_restore_cluster_list">2.6.9. Listing Restores</a></li>
<li><a href="#rest_v2_restore_cluster_head">2.6.10. Checking Restore Progress</a></li>
<li><a href="#rest_v2_restore_cluster_delete">2.6.11. Deleting Restore Metadata</a></li>
<li><a href="#rest_v2_cluster_distribution">2.6.12. Checking Cluster Distribution</a></li>
<li><a href="#rest_v2_cluster_members">2.6.13. Getting Cluster Members Information</a></li>
</ul>
</li>
<li><a href="#rest_v2_logging">2.7. Infinispan Server logging configuration</a>
<ul class="sectlevel3">
<li><a href="#rest_v2_logging_list_appenders">2.7.1. Listing the logging appenders</a></li>
<li><a href="#rest_v2_logging_list_loggers">2.7.2. Listing the loggers</a></li>
<li><a href="#rest_v2_logging_set_logger">2.7.3. Creating/modifying a logger</a></li>
<li><a href="#rest_v2_logging_remove_logger">2.7.4. Removing a logger</a></li>
</ul>
</li>
<li><a href="#rest_v2_tasks">2.8. Using Server Tasks</a>
<ul class="sectlevel3">
<li><a href="#rest_v2_tasks_list">2.8.1. Retrieving Server Tasks Information</a></li>
<li><a href="#rest_v2_tasks_execute">2.8.2. Executing Tasks</a></li>
<li><a href="#rest_v2_tasks_upload">2.8.3. Uploading Script Tasks</a></li>
<li><a href="#rest_v2_tasks_download">2.8.4. Downloading Script Tasks</a></li>
</ul>
</li>
<li><a href="#rest_v2_security">2.9. Working with Infinispan Security</a>
<ul class="sectlevel3">
<li><a href="#rest_v2_get_user_acl">2.9.1. Retrieving the ACL of a user</a></li>
<li><a href="#rest_v2_flush_acl_cache">2.9.2. Flushing the security caches</a></li>
<li><a href="#rest_v2_get_roles">2.9.3. Retrieving the available roles</a></li>
<li><a href="#rest_v2_get_roles_detailed">2.9.4. Retrieving the available roles detailed</a></li>
<li><a href="#rest_v2_get_principal_roles">2.9.5. Retrieving the roles for a principal</a></li>
<li><a href="#rest_v2_grant_principal_roles">2.9.6. Granting roles to a principal</a></li>
<li><a href="#rest_v2_deny_principal_roles">2.9.7. Denying roles to a principal</a></li>
<li><a href="#rest_v2_list_principals">2.9.8. Listing principals</a></li>
<li><a href="#rest_v2_create_role">2.9.9. Creating roles</a></li>
<li><a href="#rest_v2_update_role">2.9.10. Updating roles</a></li>
<li><a href="#rest_v2_delete_role">2.9.11. Deleting roles</a></li>
<li><a href="#rest_v2_get_permission_roles">2.9.12. Retrieving the permissions for a role</a></li>
</ul>
</li>
<li><a href="#rest_v2_tracing_propagation">2.10. Enabling Tracing Propagation</a>
<ul class="sectlevel3">
<li><a href="#propagation_rest_tracing_rest">2.10.1. Enabling tracing propagation between Infinispan Server and REST API</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#rest_client_code">3. REST Client Examples</a>
<ul class="sectlevel2">
<li><a href="#rest_server_client_ruby">3.1. Ruby REST Example</a></li>
<li><a href="#rest_server_client_python">3.2. Python 3 REST Example</a></li>
<li><a href="#rest_server_client_java">3.3. Java REST Example</a></li>
<li><a href="#rest_server_client_http">3.4. <code>HttpClient</code> API REST Example</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This guide provides details to help you do things like configure the Infinispan REST endpoint to use cross-origin resource sharing (CORS) requests, learn about using different data formats with the REST API, as well as listing and describing REST operations for interacting with Infinispan.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rest_server"><a class="anchor" href="#rest_server"></a>1. Infinispan REST Endpoint</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Infinispan servers provide <a href="http://en.wikipedia.org/wiki/Representational_State_Transfer">RESTful</a> HTTP
access to data through a REST endpoint built on <a href="https://github.com/netty/netty">Netty</a>.</p>
</div>
<div class="sect2">
<h3 id="rest_security"><a class="anchor" href="#rest_security"></a>1.1. REST Authentication</h3>
<div class="paragraph">
<p>Configure authentication to the REST endpoint with the Infinispan command line
interface (CLI) and the <strong>user</strong> command.
The CLI lets you create and manage
users, passwords, and authorization roles for accessing the REST endpoint.</p>
</div>
<div class="paragraph">
<p>When running the Docker image, configure authentication with the <code>APP_USER</code> and
<code>APP_PASS</code> command line arguments.</p>
</div>
<div class="ulist">
<div class="title">Reference</div>
<ul>
<li>
<p><a href="../server/server.html#creating-users_server-getting-started">Creating Infinispan users</a></p>
</li>
<li>
<p><a href="../server/server.html#authentication-mechanisms">Configuring Endpoint Authentication Mechanisms</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="rest_supported_protocols"><a class="anchor" href="#rest_supported_protocols"></a>1.2. Supported Protocols</h3>
<div class="paragraph">
<p>The Infinispan REST endpoint supports <code>HTTP/1.1</code> and <code>HTTP/2</code> protocols.</p>
</div>
<div class="paragraph">
<p>You can do either of the following to use <code>HTTP/2</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Perform an <a href="https://http2.github.io/http2-spec/#discover-http">HTTP/1.1 upgrade</a>.</p>
</li>
<li>
<p>Negotiate the communication protocol using a <a href="https://http2.github.io/http2-spec/#versioning">TLS/ALPN extension</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="rest_data_formats"><a class="anchor" href="#rest_data_formats"></a>1.3. Data Formats and the REST API</h3>
<div class="paragraph">
<p>Infinispan caches store data in formats that you can define with a
<a href="https://en.wikipedia.org/wiki/Media_type">MediaType</a>.</p>
</div>
<div class="paragraph">
<p>See the <a href="../encoding/encoding.html">Cache Encoding and Marshalling</a> for more information about MediaTypes and encoding data with Infinispan.</p>
</div>
<div class="paragraph">
<p>The following example configures the storage format for entries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">&lt;distributed-cache&gt;
   &lt;encoding&gt;
      &lt;key media-type="application/x-java-object"/&gt;
      &lt;value media-type="application/xml; charset=UTF-8"/&gt;
   &lt;/encoding&gt;
&lt;/distributed-cache&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you do not configure a MediaType, Infinispan defaults to
<code>application/octet-stream</code> for both keys and values. However, if the cache is
indexed, Infinispan defaults to <code>application/x-protostream</code>.</p>
</div>
<div class="sect3">
<h4 id="rest_server_data_format_support"><a class="anchor" href="#rest_server_data_format_support"></a>1.3.1. Supported Formats</h4>
<div class="paragraph">
<p>You can write and read data in different formats and Infinispan can convert
between those formats when required.</p>
</div>
<div class="paragraph">
<p>The following "standard" formats are interchangeable:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>application/x-java-object</code></p>
</li>
<li>
<p><code>application/octet-stream</code></p>
</li>
<li>
<p><code>application/x-www-form-urlencoded</code></p>
</li>
<li>
<p><code>text/plain</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also convert the preceding data formats into the following formats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>application/xml</code></p>
</li>
<li>
<p><code>application/json</code></p>
</li>
<li>
<p><code>application/x-jboss-marshalling</code></p>
</li>
<li>
<p><code>application/x-protostream</code></p>
</li>
<li>
<p><code>application/x-java-serialized</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Infinispan also lets you convert between <code>application/x-protostream</code> and <code>application/json</code>.</p>
</div>
<div class="paragraph">
<p>All calls to the REST API can provide headers describing the content written or
the required format of the content when reading. Infinispan supports the
standard HTTP/1.1 headers "Content-Type" and "Accept" that are applied for
values, plus the "Key-Content-Type" with similar effect for keys.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_accept"><a class="anchor" href="#rest_accept"></a>1.3.2. Accept Headers</h4>
<div class="paragraph">
<p>The Infinispan REST endpoint is compliant with the <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html">RFC-2616</a> Accept
header and negotiates the correct MediaType based on the conversions supported.</p>
</div>
<div class="paragraph">
<p>For example, send the following header when reading data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">Accept: text/plain;q=0.7, application/json;q=0.8, */*;q=0.6</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding header causes Infinispan to first return content in JSON format
(higher priority 0.8). If it is not possible to convert the storage format
to JSON, Infinispan attempts the next format of <code>text/plain</code> (second highest
priority 0.7). Finally, Infinispan falls back to <em>*/*</em>, which picks a suitable
format based on the cache configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_encoded_names"><a class="anchor" href="#rest_encoded_names"></a>1.3.3. Names with Special Characters</h4>
<div class="paragraph">
<p>The creation of any REST resource requires a name that is part of the URL,
and in case this name contains any special characters as defined in
<a href="https://tools.ietf.org/html/rfc3986#section-2.2">Section 2.2 of the RFC 3986 spec</a>, it is necessary to encode it with the <a href="https://en.wikipedia.org/wiki/Percent-encoding">Percent encoding</a> mechanism.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_key_content_type"><a class="anchor" href="#rest_key_content_type"></a>1.3.4. Key-Content-Type Headers</h4>
<div class="paragraph">
<p>Most REST API calls have the Key included in the URL. Infinispan assumes the
Key is a <code>java.lang.String</code> when handling those calls, but you can use a
specific header <code>Key-Content-Type</code> for keys in different formats.</p>
</div>
<div class="ulist">
<div class="title">Key-Content-Type Header Examples</div>
<ul>
<li>
<p>Specifying a byte[] Key as a Base64 string:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>API call:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`PUT /my-cache/AQIDBDM=`</pre>
</div>
</div>
<div class="paragraph">
<p>Headers:</p>
</div>
<div class="paragraph">
<p><code>Key-Content-Type: application/octet-stream</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specifying a byte[] Key as a hexadecimal string:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>API call:</p>
</div>
<div class="paragraph">
<p><code>GET /my-cache/0x01CA03042F</code></p>
</div>
<div class="paragraph">
<p>Headers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">Key-Content-Type: application/octet-stream; encoding=hex</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Specifying a double Key:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>API call:</p>
</div>
<div class="paragraph">
<p><code>POST /my-cache/3.141456</code></p>
</div>
<div class="paragraph">
<p>Headers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">Key-Content-Type: application/x-java-object;type=java.lang.Double</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>type</em> parameter for <code>application/x-java-object</code> is restricted to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Primitive wrapper types</p>
</li>
<li>
<p><code>java.lang.String</code></p>
</li>
<li>
<p>Bytes, making <code>application/x-java-object;type=Bytes</code> equivalent to <code>application/octet-stream;encoding=hex</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_json_proto_conversion"><a class="anchor" href="#rest_json_proto_conversion"></a>1.3.5. JSON/ProtoStream Conversion</h4>
<div class="paragraph">
<p>When caches are indexed, or specifically configured to store <code>application/x-protostream</code>, you can send and receive JSON documents that are automatically converted to and from Protobuf.</p>
</div>
<div class="paragraph">
<p>You must register a Protobuf schema for the conversion to work.</p>
</div>
<div class="paragraph">
<p>To register protobuf schemas via REST, invoke a <code>POST</code> or <code>PUT</code> in the <code><em>___protobuf_metadata</em></code> cache as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">curl -u user:password -X POST --data-binary @./schema.proto http://127.0.0.1:11222/rest/v2/caches/___protobuf_metadata/schema.proto</code></pre>
</div>
</div>
<div class="paragraph">
<p>When writing JSON documents, a special field <strong><em>_type</em></strong> must be present in the document to identity the Protobuf <em>Message</em>  that corresponds to the document.</p>
</div>
<div class="listingblock primary">
<div class="title">Person.proto</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-protobuf hljs" data-lang="protobuf">message Person  {
  required string name = 1;
  required int32 age = 2;
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Person.json</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
   "_type": "Person",
   "name": "user1",
   "age": 32
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_cors"><a class="anchor" href="#rest_cors"></a>1.4. Cross-Origin Resource Sharing (CORS) Requests</h3>
<div class="paragraph">
<p>The Infinispan REST connector supports
<a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">CORS</a>, including
preflight and rules based on the request origin.</p>
</div>
<div class="paragraph">
<p>The following shows an example REST connector configuration with CORS rules:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">&lt;rest-connector name="rest1" socket-binding="rest" cache-container="default"&gt;
   &lt;cors-rules&gt;
      &lt;cors-rule name="restrict host1"
                 allow-credentials="false"&gt;
         &lt;allowed-origins&gt;http://host1,https://host1&lt;/allowed-origins&gt;
         &lt;allowed-methods&gt;GET&lt;/allowed-methods&gt;
      &lt;/cors-rule&gt;
      &lt;cors-rule name="allow ALL"
                 allow-credentials="true"
                 max-age-seconds="2000"&gt;
         &lt;allowed-origins&gt;*&lt;/allowed-origins&gt;
         &lt;allowed-methods&gt;GET,OPTIONS,POST,PUT,DELETE&lt;/allowed-methods&gt;
         &lt;allowed-headers&gt;Key-Content-Type&lt;/allowed-headers&gt;
      &lt;/cors-rule&gt;
   &lt;/cors-rules&gt;
&lt;/rest-connector&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan evaluates CORS rules sequentially based on the "Origin" header set
by the browser.</p>
</div>
<div class="paragraph">
<p>In the preceding example, if the origin is either "http://host1" or
"https://host1", then the rule "restrict host1" applies. If the origin is
different, then the next rule is tested.</p>
</div>
<div class="paragraph">
<p>Because the "allow ALL" rule permits all origins, any script that has an origin
other than "http://host1" or "https://host1" can perform the allowed methods
and use the supplied headers.</p>
</div>
<div class="paragraph">
<p>For information about configuring CORS rules, see the <a href="../../configuration-schema/index.html">Infinispan Server Configuration Schema</a>.</p>
</div>
<div class="sect3">
<h4 id="allowing_all_cors_permissions_for_some_origins"><a class="anchor" href="#allowing_all_cors_permissions_for_some_origins"></a>1.4.1. Allowing all CORS permissions for some origins</h4>
<div class="paragraph">
<p>The VM property <code>infinispan.server.rest.cors-allow</code> can be used when starting the server to allow all permissions to one or more origins.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">./bin/server.sh -Dinfinispan.server.rest.cors-allow=http://192.168.1.78:11222,http://host.mydomain.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>All origins specified using this method will take precedence over the configured rules.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rest_v2_api"><a class="anchor" href="#rest_v2_api"></a>2. Interacting with the Infinispan REST API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Infinispan REST API lets you monitor, maintain, and manage Infinispan
deployments and provides access to your data.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By default Infinispan REST API operations return <code>200 (OK)</code> when successful.
However, when some operations are processed successfully, they return an HTTP status code such as <code>204</code> or <code>202</code> instead of <code>200</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="rest_v2_cache_operations"><a class="anchor" href="#rest_v2_cache_operations"></a>2.1. Creating and Managing Caches</h3>
<div class="paragraph">
<p>Create and manage Infinispan caches and perform operations on data.</p>
</div>
<div class="sect3">
<h4 id="rest_v2_create_cache"><a class="anchor" href="#rest_v2_create_cache"></a>2.1.1. Creating Caches</h4>
<div class="paragraph">
<p>Create named caches across Infinispan clusters with <code>POST</code> requests that
include XML or JSON configuration in the payload.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the <a href="https://en.wikipedia.org/wiki/Media_type">MediaType</a> for the
Infinispan configuration payload; either <code>application/xml</code> or
<code>application/json</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to set <a href="https://https://infinispan.org.org/infinispan/10.0/apidocs/org/infinispan/commons/api/CacheContainerAdmin.AdminFlag.html">AdminFlags</a></p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="cache-configuration_rest"><a class="anchor" href="#cache-configuration_rest"></a>Cache configuration</h5>
<div class="paragraph">
<p>You can create declarative cache configuration in XML, JSON, and YAML format.</p>
</div>
<div class="paragraph">
<p>All declarative caches must conform to the Infinispan schema.
Configuration in JSON format must follow the structure of an XML configuration, elements correspond to objects and attributes correspond to fields.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Infinispan restricts characters to a maximum of <code>255</code> for a cache name or a cache template name.
If you exceed this character limit, Infinispan throws an exception.
Write succinct cache names and cache template names.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A file system might set a limitation for the length of a file name, so ensure that a cache&#8217;s name does not exceed this limitation.
If a cache name exceeds a file system&#8217;s naming limitation, general operations or initialing operations towards that cache might fail.
Write succinct file names.</p>
</div>
</td>
</tr>
</table>
</div>
<h6 id="distributed_caches" class="discrete">Distributed caches</h6>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">&lt;distributed-cache owners="2"
                   segments="256"
                   capacity-factor="1.0"
                   l1-lifespan="5s"
                   mode="SYNC"
                   statistics="true"&gt;
  &lt;encoding media-type="application/x-protostream"/&gt;
  &lt;locking isolation="REPEATABLE_READ"/&gt;
  &lt;transaction mode="FULL_XA"
               locking="OPTIMISTIC"/&gt;
  &lt;expiration lifespan="5s"
              max-idle="1s" /&gt;
  &lt;memory max-count="1000000"
          when-full="REMOVE"/&gt;
  &lt;indexing enabled="true"
            storage="local-heap"&gt;
    &lt;index-reader refresh-interval="1s"/&gt;
    &lt;indexed-entities&gt;
      &lt;indexed-entity&gt;org.infinispan.Person&lt;/indexed-entity&gt;
    &lt;/indexed-entities&gt;
  &lt;/indexing&gt;
  &lt;partition-handling when-split="ALLOW_READ_WRITES"
                      merge-policy="PREFERRED_NON_NULL"/&gt;
  &lt;persistence passivation="false"&gt;
    &lt;!-- Persistent storage configuration. --&gt;
  &lt;/persistence&gt;
&lt;/distributed-cache&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "distributed-cache": {
    "mode": "SYNC",
    "owners": "2",
    "segments": "256",
    "capacity-factor": "1.0",
    "l1-lifespan": "5000",
    "statistics": "true",
    "encoding": {
      "media-type": "application/x-protostream"
    },
    "locking": {
      "isolation": "REPEATABLE_READ"
    },
    "transaction": {
      "mode": "FULL_XA",
      "locking": "OPTIMISTIC"
    },
    "expiration" : {
      "lifespan" : "5000",
      "max-idle" : "1000"
    },
    "memory": {
      "max-count": "1000000",
      "when-full": "REMOVE"
    },
    "indexing" : {
          "enabled" : true,
          "storage" : "local-heap",
          "index-reader" : {
            "refresh-interval" : "1000"
          },
          "indexed-entities": [
            "org.infinispan.Person"
          ]
    },
    "partition-handling" : {
      "when-split" : "ALLOW_READ_WRITES",
      "merge-policy" : "PREFERRED_NON_NULL"
    },
    "persistence" : {
      "passivation" : false
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-yaml hljs" data-lang="yaml">distributedCache:
  mode: "SYNC"
  owners: "2"
  segments: "256"
  capacityFactor: "1.0"
  l1Lifespan: "5000"
  statistics: "true"
  encoding:
    mediaType: "application/x-protostream"
  locking:
    isolation: "REPEATABLE_READ"
  transaction:
    mode: "FULL_XA"
    locking: "OPTIMISTIC"
  expiration:
    lifespan: "5000"
    maxIdle: "1000"
  memory:
    maxCount: "1000000"
    whenFull: "REMOVE"
  indexing:
    enabled: "true"
    storage: "local-heap"
    indexReader:
      refreshInterval: "1000"
    indexedEntities:
      - "org.infinispan.Person"
  partitionHandling:
    whenSplit: "ALLOW_READ_WRITES"
    mergePolicy: "PREFERRED_NON_NULL"
  persistence:
    passivation: "false"
    # Persistent storage configuration.</code></pre>
</div>
</div>
<h6 id="replicated_caches" class="discrete">Replicated caches</h6>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">&lt;replicated-cache segments="256"
                  mode="SYNC"
                  statistics="true"&gt;
  &lt;encoding media-type="application/x-protostream"/&gt;
  &lt;locking isolation="REPEATABLE_READ"/&gt;
  &lt;transaction mode="FULL_XA"
               locking="OPTIMISTIC"/&gt;
  &lt;expiration lifespan="5s"
              max-idle="1s" /&gt;
  &lt;memory max-count="1000000"
          when-full="REMOVE"/&gt;
  &lt;indexing enabled="true"
            storage="local-heap"&gt;
    &lt;index-reader refresh-interval="1s"/&gt;
    &lt;indexed-entities&gt;
      &lt;indexed-entity&gt;org.infinispan.Person&lt;/indexed-entity&gt;
    &lt;/indexed-entities&gt;
  &lt;/indexing&gt;
  &lt;partition-handling when-split="ALLOW_READ_WRITES"
                      merge-policy="PREFERRED_NON_NULL"/&gt;
  &lt;persistence passivation="false"&gt;
    &lt;!-- Persistent storage configuration. --&gt;
  &lt;/persistence&gt;
&lt;/replicated-cache&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "replicated-cache": {
    "mode": "SYNC",
    "segments": "256",
    "statistics": "true",
    "encoding": {
      "media-type": "application/x-protostream"
    },
    "locking": {
      "isolation": "REPEATABLE_READ"
    },
    "transaction": {
      "mode": "FULL_XA",
      "locking": "OPTIMISTIC"
    },
    "expiration" : {
      "lifespan" : "5000",
      "max-idle" : "1000"
    },
    "memory": {
      "max-count": "1000000",
      "when-full": "REMOVE"
    },
    "indexing" : {
      "enabled" : true,
      "storage" : "local-heap",
      "index-reader" : {
        "refresh-interval" : "1000"
        },
      "indexed-entities": [
        "org.infinispan.Person"
      ]
    },
    "partition-handling" : {
      "when-split" : "ALLOW_READ_WRITES",
      "merge-policy" : "PREFERRED_NON_NULL"
    },
    "persistence" : {
      "passivation" : false
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-yaml hljs" data-lang="yaml">replicatedCache:
  mode: "SYNC"
  segments: "256"
  statistics: "true"
  encoding:
    mediaType: "application/x-protostream"
  locking:
    isolation: "REPEATABLE_READ"
  transaction:
    mode: "FULL_XA"
    locking: "OPTIMISTIC"
  expiration:
    lifespan: "5000"
    maxIdle: "1000"
  memory:
    maxCount: "1000000"
    whenFull: "REMOVE"
  indexing:
    enabled: "true"
    storage: "local-heap"
    indexReader:
      refreshInterval: "1000"
    indexedEntities:
      - "org.infinispan.Person"
  partitionHandling:
    whenSplit: "ALLOW_READ_WRITES"
    mergePolicy: "PREFERRED_NON_NULL"
  persistence:
    passivation: "false"
    # Persistent storage configuration.</code></pre>
</div>
</div>
<h6 id="multiple_caches" class="discrete">Multiple caches</h6>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">&lt;infinispan
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="urn:infinispan:config:16.0 https://infinispan.org/schemas/infinispan-config-16.0.xsd
                          urn:infinispan:server:16.0 https://infinispan.org/schemas/infinispan-server-16.0.xsd"
      xmlns="urn:infinispan:config:16.0"
      xmlns:server="urn:infinispan:server:16.0"&gt;
  &lt;cache-container name="default"
                   statistics="true"&gt;
    &lt;distributed-cache name="mycacheone"
                       mode="ASYNC"
                       statistics="true"&gt;
      &lt;encoding media-type="application/x-protostream"/&gt;
      &lt;expiration lifespan="5m"/&gt;
      &lt;memory max-size="400MB"
              when-full="REMOVE"/&gt;
    &lt;/distributed-cache&gt;
    &lt;distributed-cache name="mycachetwo"
                       mode="SYNC"
                       statistics="true"&gt;
      &lt;encoding media-type="application/x-protostream"/&gt;
      &lt;expiration lifespan="5m"/&gt;
      &lt;memory max-size="400MB"
              when-full="REMOVE"/&gt;
    &lt;/distributed-cache&gt;
  &lt;/cache-container&gt;
&lt;/infinispan&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JSON</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "infinispan" : {
    "cache-container" : {
      "name" : "default",
      "statistics" : "true",
      "caches" : {
        "mycacheone" : {
          "distributed-cache" : {
            "mode": "ASYNC",
            "statistics": "true",
            "encoding": {
              "media-type": "application/x-protostream"
            },
            "expiration" : {
              "lifespan" : "300000"
            },
            "memory": {
              "max-size": "400MB",
              "when-full": "REMOVE"
            }
          }
        },
        "mycachetwo" : {
          "distributed-cache" : {
            "mode": "SYNC",
            "statistics": "true",
            "encoding": {
              "media-type": "application/x-protostream"
            },
            "expiration" : {
              "lifespan" : "300000"
            },
            "memory": {
              "max-size": "400MB",
              "when-full": "REMOVE"
            }
          }
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-yaml hljs" data-lang="yaml">infinispan:
  cacheContainer:
    name: "default"
    statistics: "true"
    caches:
      mycacheone:
       distributedCache:
          mode: "ASYNC"
          statistics: "true"
          encoding:
            mediaType: "application/x-protostream"
          expiration:
            lifespan: "300000"
          memory:
            maxSize: "400MB"
            whenFull: "REMOVE"
      mycachetwo:
        distributedCache:
          mode: "SYNC"
          statistics: "true"
          encoding:
            mediaType: "application/x-protostream"
          expiration:
            lifespan: "300000"
          memory:
            maxSize: "400MB"
            whenFull: "REMOVE"</code></pre>
</div>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="../../configuration-schema/index.html">Infinispan configuration schema reference</a></p>
</li>
<li>
<p><a href="https://infinispan.org/schemas/infinispan-config-16.0.xsd">infinispan-config-16.0.xsd</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_modify_cache"><a class="anchor" href="#rest_v2_modify_cache"></a>2.1.2. Modifying Caches</h4>
<div class="paragraph">
<p>Make changes to attributes in cache configurations across Infinispan clusters with <code>PUT</code> requests that include XML or JSON configuration in the payload.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can modify a cache only if the changes are compatible with the existing configuration.</p>
</div>
<div class="paragraph">
<p>For example you cannot use a replicated cache configuration to modify a distributed cache.
Likewise if you create a cache configuration with a specific attribute, you cannot modify the configuration to use a different attribute instead.
For example, attempting to modify cache configuration by specifying a value for the <code>max-count</code> attribute results in invalid configuration if the <code>max-size</code> is already set.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">PUT /rest/v2/caches/{cacheName}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the <a href="https://en.wikipedia.org/wiki/Media_type">MediaType</a> for the
Infinispan configuration payload; either <code>application/xml</code> or
<code>application/json</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to set <a href="../../apidocs/org/infinispan/commons/api/CacheContainerAdmin.AdminFlag.html">AdminFlags</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_exists"><a class="anchor" href="#rest_v2_cache_exists"></a>2.1.3. Verifying Caches</h4>
<div class="paragraph">
<p>Check if a cache exists in Infinispan clusters with <code>HEAD</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">HEAD /rest/v2/caches/{cacheName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retrieve a caches health with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}?action=health</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_create_cache_template"><a class="anchor" href="#rest_v2_create_cache_template"></a>2.1.4. Creating Caches with Templates</h4>
<div class="paragraph">
<p>Create caches from Infinispan templates with <code>POST</code> requests and the
<code>?template=</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}?template={templateName}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>See <a href="#rest_v2_cache_manager_cache_templates">Listing Available Cache Templates</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_configuration"><a class="anchor" href="#rest_v2_cache_configuration"></a>2.1.5. Retrieving Cache Configuration</h4>
<div class="paragraph">
<p>Retrieve Infinispan cache configurations with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{name}?action=config</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Accept</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the required format to return content. Supported formats are <code>application/xml</code> and <code>application/json</code>. The default is <code>application/json</code>. See <a href="#rest_accept">Accept</a> for more information.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_config_convert"><a class="anchor" href="#rest_v2_cache_config_convert"></a>2.1.6. Converting Cache Configurations between XML, JSON and YAML</h4>
<div class="paragraph">
<p>Invoke a <code>POST</code> request with valid configuration and the <code>?action=convert</code>
parameter. Infinispan responds with the equivalent representation of the
configuration in the type specified by the <code>Accept</code> header.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches?action=convert</code></pre>
</div>
</div>
<div class="paragraph">
<p>To convert cache configuration you must specify the input format for the configuration with the <code>Content-Type</code> header and the desired output format with the <code>Accept</code> header.
For example, the following command converts the replicated cache configuration from XML to YAML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">curl localhost:11222/rest/v2/caches?action=convert \
--digest -u username:password \
-X POST -H "Accept: application/yaml" -H "Content-Type: application/xml" \
-d '&lt;replicated-cache mode="SYNC" statistics="false"&gt;&lt;encoding media-type="application/x-protostream"/&gt;&lt;expiration lifespan="300000" /&gt;&lt;memory max-size="400MB" when-full="REMOVE"/&gt;&lt;/replicated-cache&gt;'</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_config_compare"><a class="anchor" href="#rest_v2_cache_config_compare"></a>2.1.7. Comparing Cache Configurations</h4>
<div class="paragraph">
<p>Invoke a <code>POST</code> request with a <code>multipart/form-data</code> body containing two cache configurations and the <code>?action=compare</code>
parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches?action=compare</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Add the <code>ignoreMutable=true</code> parameter to ignore mutable attributes in the comparison.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Infinispan responds with <code>204 (No Content)</code> in case the configurations are equal, and <code>409 (Conflict)</code> in case they are different.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_detail"><a class="anchor" href="#rest_v2_cache_detail"></a>2.1.8. Retrieving All Cache Details</h4>
<div class="paragraph">
<p>Invoke a <code>GET</code> request to retrieve all details for Infinispan caches.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{name}?action=stats</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan provides a JSON response such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json"> {
  "stats": {
    "time_since_start": -1,
    "time_since_reset": -1,
    "hits": -1,
    "current_number_of_entries": -1,
    "current_number_of_entries_in_memory": -1,
    "stores": -1,
    "off_heap_memory_used": -1,
    "data_memory_used": -1,
    "retrievals": -1,
    "misses": -1,
    "remove_hits": -1,
    "remove_misses": -1,
    "evictions": -1,
    "average_read_time": -1,
    "average_read_time_nanos": -1,
    "average_write_time": -1,
    "average_write_time_nanos": -1,
    "average_remove_time": -1,
    "average_remove_time_nanos": -1,
    "required_minimum_number_of_nodes": -1
  },
  "size": 0,
  "configuration": {
    "distributed-cache": {
      "mode": "SYNC",
      "transaction": {
        "stop-timeout": 0,
        "mode": "NONE"
      }
    }
  },
  "rehash_in_progress": false,
  "rebalancing_enabled": true,
  "bounded": false,
  "indexed": false,
  "persistent": false,
  "transactional": false,
  "secured": false,
  "has_remote_backup": false,
  "tracing": true,
  "indexing_in_progress": false,
  "statistics": false,
  "mode" : "DIST_SYNC",
  "storage_type": "HEAP",
  "max_size": "",
  "max_size_bytes" : -1
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>stats</code> current stats of the cache.</p>
</li>
<li>
<p><code>size</code> the estimated size for the cache.</p>
</li>
<li>
<p><code>configuration</code> the cache configuration.</p>
</li>
<li>
<p><code>rehash_in_progress</code> true when a rehashing is in progress.</p>
</li>
<li>
<p><code>indexing_in_progress</code> true when indexing is in progress.</p>
</li>
<li>
<p><code>rebalancing_enabled</code> is true if rebalancing is enabled. Fetching this property might fail on the server. In that case the property won&#8217;t be present in the payload.</p>
</li>
<li>
<p><code>bounded</code> when expiration is enabled.</p>
</li>
<li>
<p><code>indexed</code> true if the cache is indexed.</p>
</li>
<li>
<p><code>persistent</code> true if the cache is persisted.</p>
</li>
<li>
<p><code>transactional</code> true if the cache is transactional.</p>
</li>
<li>
<p><code>secured</code> true if the cache is secured.</p>
</li>
<li>
<p><code>tracing</code> true if the cache has tracing enabled.</p>
</li>
<li>
<p><code>has_remote_backup</code> true if the cache has remote backups.</p>
</li>
<li>
<p><code>key_storage</code> the media type of the cache keys.</p>
</li>
<li>
<p><code>value_storage</code> the media type of the cache values.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>key_storage</code> and <code>value_storage</code> matches encoding configuration of the cache.
For server caches with no encoding, Infinispan assumes <code>application/x-protostream</code> when a cache is indexed and <code>application/unknown</code> otherwise.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_reset_stats"><a class="anchor" href="#rest_v2_cache_reset_stats"></a>2.1.9. Resetting All Cache Statistics</h4>
<div class="paragraph">
<p>Invoke a <code>POST</code> request to reset all statistics for Infinispan caches.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{name}?action=stats-reset</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_distribution"><a class="anchor" href="#rest_v2_cache_distribution"></a>2.1.10. Retrieving Data Distribution of a Cache</h4>
<div class="paragraph">
<p>Invoke a <code>GET</code> request to retrieve all details for data distribution of Infinispan caches.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{name}?action=distribution</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan provides a JSON response such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">[
  {
    "node_name": "NodeA",
    "node_addresses": [
      "127.0.0.1:44175"
    ],
    "memory_entries": 0,
    "total_entries": 0,
    "memory_used": 528512
  },
  {
    "node_name":"NodeB",
    "node_addresses": [
      "127.0.0.1:44187"
    ],
    "memory_entries": 0,
    "total_entries": 0,
    "memory_used": 528512
  }
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each element in the list represents a node. The properties are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>node_name</code> is the node name</p>
</li>
<li>
<p><code>node_addresses</code> is a list with all the node&#8217;s physical addresses.</p>
</li>
<li>
<p><code>memory_entries</code> the number of entries the node holds in memory belonging to the cache.</p>
</li>
<li>
<p><code>total_entries</code> the number of entries the node has in memory and disk belonging to the cache.</p>
</li>
<li>
<p><code>memory_used</code> the value in bytes the eviction algorithm estimates the cache occupies. Returns -1 if eviction is not enabled.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_mutable_attributes"><a class="anchor" href="#rest_v2_cache_mutable_attributes"></a>2.1.11. Retrieving all mutable cache configuration attributes</h4>
<div class="paragraph">
<p>Invoke a <code>GET</code> request to retrieve all mutable cache configuration attributes for Infinispan caches.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{name}?action=get-mutable-attributes</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan provides a JSON response such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">[
  "jmx-statistics.statistics",
  "locking.acquire-timeout",
  "transaction.single-phase-auto-commit",
  "expiration.max-idle",
  "transaction.stop-timeout",
  "clustering.remote-timeout",
  "expiration.lifespan",
  "expiration.interval",
  "memory.max-count",
  "memory.max-size"
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the <code>full</code> parameter to obtain values and type information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/mycache?action=get-mutable-attributes&amp;full=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan provides a JSON response such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "jmx-statistics.statistics": {
    "value": true,
    "type": "boolean"
  },
  "locking.acquire-timeout": {
    "value": 15000,
    "type": "long"
  },
  "transaction.single-phase-auto-commit": {
    "value": false,
    "type": "boolean"
  },
  "expiration.max-idle": {
    "value": -1,
    "type": "long"
  },
  "transaction.stop-timeout": {
    "value": 30000,
    "type": "long"
  },
  "clustering.remote-timeout": {
    "value": 17500,
    "type": "long"
  },
  "expiration.lifespan": {
    "value": -1,
    "type": "long"
  },
  "expiration.interval": {
    "value": 60000,
    "type": "long"
  },
  "memory.max-count": {
    "value": -1,
    "type": "long"
  },
  "memory.max-size": {
    "value": null,
    "type": "string"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For attributes of type <code>enum</code>, an additional <code>universe</code> property will contain the set of possible values.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_mutable_attribute_set"><a class="anchor" href="#rest_v2_cache_mutable_attribute_set"></a>2.1.12. Updating cache configuration attributes</h4>
<div class="paragraph">
<p>Invoke a <code>POST</code> request to change a mutable cache configuration attribute.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{name}?action=set-mutable-attributes&amp;attribute-name={attributeName}&amp;attribute-value={attributeValue}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_assign_alias"><a class="anchor" href="#rest_v2_cache_assign_alias"></a>2.1.13. Assign cache alias</h4>
<div class="paragraph">
<p>Invoke a <code>POST</code> request to assign an alias to a cache. If the alias is already assigned to a different cache, it will
be reassigned to the specified one.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{name}?action=assign-alias&amp;alias={aliasName}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_add_entries"><a class="anchor" href="#rest_v2_add_entries"></a>2.1.14. Adding Entries</h4>
<div class="paragraph">
<p>Add entries to caches with <code>POST</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}/{cacheKey}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding request places the payload, or request body, in the <code>cacheName</code>
cache with the <code>cacheKey</code> key. The request replaces any data that already
exists and updates the <code>Time-To-Live</code> and <code>Last-Modified</code> values, if they apply.</p>
</div>
<div class="paragraph">
<p>If the entry is created successfully, the service returns <code>204 (No Content)</code>.</p>
</div>
<div class="paragraph">
<p>If a value already exists for the specified key, the <code>POST</code> request returns
<code>409 (Conflict)</code> and does not modify the value.
To update values, you
should use <code>PUT</code> requests. See <a href="#rest_v2_replace_entries">Replacing Entries</a>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Key-Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the content type for the key in the request. See <a href="#rest_key_content_type">Key-Content-Type</a> for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the <a href="https://en.wikipedia.org/wiki/Media_type">MediaType</a> of the value for the key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timeToLiveSeconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the number of seconds before the entry is automatically deleted. If you do not set this parameter, Infinispan uses the default value from the configuration. If you set a negative value, the entry is never deleted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxIdleTimeSeconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the number of seconds that entries can be idle. If a read or write operation does not occur for an entry after the maximum idle time elapses, the entry is automatically deleted. If you do not set this parameter, Infinispan uses the default value from the configuration. If you set a negative value, the entry is never deleted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The flags used to add the entry. See <a href="https://infinispan.org/docs/stable/apidocs/org/infinispan/context/Flag.html">Flag</a> for more information.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>flags</code> header also applies to all other operations involving data manipulation on the cache,
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If both <code>timeToLiveSeconds</code> and <code>maxIdleTimeSeconds</code> have a value of <code>0</code>, Infinispan uses the default <code>lifespan</code> and <code>maxIdle</code> values from the configuration.</p>
</div>
<div class="paragraph">
<p>If <em>only</em> <code>maxIdleTimeSeconds</code> has a value of <code>0</code>, Infinispan uses:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the default <code>maxIdle</code> value from the configuration.</p>
</li>
<li>
<p>the value for <code>timeToLiveSeconds</code> that you pass as a request parameter or a value of <code>-1</code> if you do not pass a value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <em>only</em> <code>timeToLiveSeconds</code> has a value of <code>0</code>, Infinispan uses:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the default <code>lifespan</code> value from the configuration.</p>
</li>
<li>
<p>the value for <code>maxIdle</code> that you pass as a request parameter or a value of <code>-1</code> if you do not pass a value.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_replace_entries"><a class="anchor" href="#rest_v2_replace_entries"></a>2.1.15. Replacing Entries</h4>
<div class="paragraph">
<p>Replace entries in caches with <code>PUT</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">PUT /rest/v2/caches/{cacheName}/{cacheKey}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a value already exists for the specified key, the <code>PUT</code> request updates the
value. If you do not want to modify existing values, use <code>POST</code> requests that
return <code>409 (Conflict)</code> instead of modifying values. See
<a href="#rest_v2_add_entries">Adding Values</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_retrieve_cache"><a class="anchor" href="#rest_v2_retrieve_cache"></a>2.1.16. Retrieving Data By Keys</h4>
<div class="paragraph">
<p>Retrieve data for specific keys with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}/{cacheKey}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The server returns data from the given cache, <code>cacheName</code>, under the given key,
<code>cacheKey</code>, in the response body. Responses contain <code>Content-Type</code> headers that
correspond to the <code>MediaType</code> negotiation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Browsers can also access caches directly, for example as a content delivery
network (CDN). Infinispan returns a unique
<a href="http://en.wikipedia.org/wiki/HTTP_ETag">ETag</a> for each entry along with the
<code>Last-Modified</code> and <code>Expires</code> header fields.</p>
</div>
<div class="paragraph">
<p>These fields provide information about the state of the data that is returned
in your request. ETags allow browsers and other clients to request only data
that has changed, which conserves bandwidth.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Key-Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the content type for the key in the request. The default is <code>application/x-java-object; type=java.lang.String</code>. See <a href="#rest_key_content_type">Key-Content-Type</a> for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Accept</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the required format to return content. See <a href="#rest_accept">Accept</a> for more information.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Append the <code>extended</code> parameter to the query string to get additional information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}/{cacheKey}?extended</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding request returns custom headers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Cluster-Primary-Owner</code> returns the node name that is the primary owner of the key.</p>
</li>
<li>
<p><code>Cluster-Node-Name</code> returns the JGroups node name of the server that handled the request.</p>
</li>
<li>
<p><code>Cluster-Physical-Address</code> returns the physical JGroups address of the server that handled the request.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_check_entries"><a class="anchor" href="#rest_v2_check_entries"></a>2.1.17. Checking if Entries Exist</h4>
<div class="paragraph">
<p>Verify that specific entries exists with <code>HEAD</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">HEAD /rest/v2/caches/{cacheName}/{cacheKey}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding request returns only the header fields and the same content that
you stored with the entry. For example, if you stored a String, the request
returns a String. If you stored binary, base64-encoded, blobs or serialized
Java objects, Infinispan does not de-serialize the content in the request.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>HEAD</code> requests also support the <code>extended</code> parameter.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Key-Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the content type for the key in the request. The default is <code>application/x-java-object; type=java.lang.String</code>. See <a href="#rest_key_content_type">Key-Content-Type</a> for more information.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_delete_entries"><a class="anchor" href="#rest_v2_delete_entries"></a>2.1.18. Deleting Entries</h4>
<div class="paragraph">
<p>Remove entries from caches with <code>DELETE</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">DELETE /rest/v2/caches/{cacheName}/{cacheKey}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Key-Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the content type for the key in the request. The default is <code>application/x-java-object; type=java.lang.String</code>. See <a href="#rest_key_content_type">Key-Content-Type</a> for more information.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_distribution_entries"><a class="anchor" href="#rest_v2_distribution_entries"></a>2.1.19. Checking distribution of cache entries</h4>
<div class="paragraph">
<p>Invoke this endpoint to retrieve details for data distribution of Infinispan cache entry.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}/{cacheKey}?action=distribution</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan provides a JSON response such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "contains_key": true,
  "owners": [
    {
      "node_name": "NodeA",
      "primary": true,
      "node_addresses": [
        "127.0.0.1:39492"
      ]
    },
    {
      "node_name": "NodeB",
      "primary": false,
      "node_addresses": [
        "127.0.0.1:38195"
      ]
    }
  ]
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>contains_key</code> returns <code>true</code> if the cache contains the key</p>
</li>
<li>
<p><code>owners</code> provides a list of nodes that contain the key</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>List of owners includes the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>node_name</code> shows the name of the node</p>
</li>
<li>
<p><code>primary</code> identifies a node that is the primary owner</p>
</li>
<li>
<p><code>node_addresses</code> shows the IP addresses and ports where the node can be accessed</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_remove_cache"><a class="anchor" href="#rest_v2_remove_cache"></a>2.1.20. Deleting Caches</h4>
<div class="paragraph">
<p>Remove caches from Infinispan clusters with <code>DELETE</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">DELETE /rest/v2/caches/{cacheName}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_get_keys"><a class="anchor" href="#rest_v2_get_keys"></a>2.1.21. Retrieving All Keys from Caches</h4>
<div class="paragraph">
<p>Invoke <code>GET</code> requests to retrieve all the keys in a cache in JSON format.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}?action=keys</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>limit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the maximum number of keys to retrieve using an InputStream. A negative value retrieves all keys. The default value is <code>-1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>batch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the internal batch size when retrieving the keys. The default value is <code>1000</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_get_entries"><a class="anchor" href="#rest_v2_get_entries"></a>2.1.22. Retrieving All Entries from Caches</h4>
<div class="paragraph">
<p>Invoke <code>GET</code> requests to retrieve all the entries in a cache in JSON format.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}?action=entries</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metadata</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Includes metadata for each entry in the response. The default value is <code>false</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>limit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the maximum number of keys to include in the response. A negative value retrieves all keys. The default value is <code>-1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>batch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the internal batch size when retrieving the keys. The default value is <code>1000</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>content-negotiation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, will convert keys and values to a readable format.
For caches with text encodings (e.g., text/plain, xml, json), the server returns keys and values as plain text.
For caches with binary encodings, the server will return the entries as JSON if the conversion is supported, otherwise in a text hexadecimal format, e.g., <code>0xA123CF98</code>.
When content-negotiation is used, the response will contain two headers: <code>key-content-type</code> and <code>value-content-type</code> to described the negotiated format.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Infinispan provides a JSON response such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">[
    {
        "key": 1,
        "value": "value1",
        "timeToLiveSeconds": -1,
        "maxIdleTimeSeconds": -1,
        "created": -1,
        "lastUsed": -1,
        "expireTime": -1
    },
    {
        "key": 2,
        "value": "value2",
        "timeToLiveSeconds": 10,
        "maxIdleTimeSeconds": 45,
        "created": 1607966017944,
        "lastUsed": 1607966017944,
        "expireTime": 1607966027944,
        "version": 7
    },
    {
        "key": 3,
        "value": "value2",
        "timeToLiveSeconds": 10,
        "maxIdleTimeSeconds": 45,
        "created": 1607966017944,
        "lastUsed": 1607966017944,
        "expireTime": 1607966027944,
        "version": 7,
        "topologyId": 9
    }
]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>key</code> The key for the entry.</p>
</li>
<li>
<p><code>value</code> The value of the entry.</p>
</li>
<li>
<p><code>timeToLiveSeconds</code> Based on the entry lifespan but in seconds, or <code>-1</code> if the entry never expires. It&#8217;s not returned unless you set metadata="true".</p>
</li>
<li>
<p><code>maxIdleTimeSeconds</code> Maximum idle time, in seconds, or <code>-1</code> if entry never expires. It&#8217;s not returned unless you set metadata="true".</p>
</li>
<li>
<p><code>created</code> Time the entry was created or or <code>-1</code> for immortal entries. It&#8217;s not returned unless you set metadata="true".</p>
</li>
<li>
<p><code>lastUsed</code> Last time an operation was performed on the entry or <code>-1</code> for immortal entries. It&#8217;s not returned unless you set metadata="true".</p>
</li>
<li>
<p><code>expireTime</code> Time when the entry expires or <code>-1</code> for immortal entries. It&#8217;s not returned unless you set metadata="true".</p>
</li>
<li>
<p><code>version</code> The metadata version related to the cache entry. Only if the value is present.</p>
</li>
<li>
<p><code>topologyId</code> The topology Id of a clustered version metadata. Only if the value is present.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_clear_cache"><a class="anchor" href="#rest_v2_clear_cache"></a>2.1.23. Clearing Caches</h4>
<div class="paragraph">
<p>To delete all data from a cache, invoke a <code>POST</code> request with the
<code>?action=clear</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}?action=clear</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns <code>204 (No Content)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_size"><a class="anchor" href="#rest_v2_cache_size"></a>2.1.24. Getting Cache Size</h4>
<div class="paragraph">
<p>Retrieve the size of caches across the entire cluster with <code>GET</code> requests and
the <code>?action=size</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}?action=size</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_stats"><a class="anchor" href="#rest_v2_cache_stats"></a>2.1.25. Getting Cache Statistics</h4>
<div class="paragraph">
<p>Obtain runtime statistics for caches with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}?action=stats</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_list_caches"><a class="anchor" href="#rest_v2_list_caches"></a>2.1.26. Listing Caches</h4>
<div class="paragraph">
<p>List all available caches in Infinispan clusters with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_list_detailed"><a class="anchor" href="#rest_v2_cache_list_detailed"></a>2.1.27. Obtaining Caches Status and Information</h4>
<div class="paragraph">
<p>Retrieve a list of all available caches for the cache manager, along with cache statuses and details, with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches?action=detailed</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with JSON arrays that lists and describes each available
cache, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">[ {
  "status" : "RUNNING",
  "name" : "cache1",
  "type" : "local-cache",
  "simple_cache" : false,
  "transactional" : false,
  "persistent" : false,
  "bounded": false,
  "secured": false,
  "indexed": true,
  "has_remote_backup": true,
  "tracing": false,
  "health":"HEALTHY",
  "rebalancing_enabled": true
}, {
  "status" : "RUNNING",
  "name" : "cache2",
  "type" : "distributed-cache",
  "simple_cache" : false,
  "transactional" : true,
  "persistent" : false,
  "bounded": false,
  "secured": false,
  "indexed": true,
  "has_remote_backup": true,
  "tracing": true,
  "health":"HEALTHY",
  "rebalancing_enabled": false
}]</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. Request parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pretty</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code> returns formatted content, including additional spacing and line separators which improve readability but increase payload size. The default is <code>false</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_list_caches_by_role"><a class="anchor" href="#rest_v2_list_caches_by_role"></a>2.1.28. Listing accessible caches for a role</h4>
<div class="paragraph">
<p>When security is enabled, retrieve a list of all the accessible caches for a role.
This operation requires ADMIN permission.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches?action=role-accessible&amp;role=observer</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with JSON as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "secured" : ["securedCache1", "securedCache2"],
  "non-secured" : ["cache1", "cache2", "cache3"]
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. Request parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pretty</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code> returns formatted content, including additional spacing and line separators which improve readability but increase payload size. The default is <code>false</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_listen"><a class="anchor" href="#rest_v2_cache_listen"></a>2.1.29. Listening to cache events</h4>
<div class="paragraph">
<p>Receive cache events using <a href="https://html.spec.whatwg.org/multipage/server-sent-events.html">Server-Sent Events</a>.
The <code>event</code> value will be one of <code>cache-entry-created</code>, <code>cache-entry-removed</code>, <code>cache-entry-updated</code>, <code>cache-entry-expired</code>.
The <code>data</code> value will contain the key of the entry that has fired the event in the format set by the <code>Accept</code> header.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{name}?action=listen</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Accept</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the required format to return content. Supported formats are <code>text/plain</code> and <code>application/json</code>. The default is <code>application/json</code>. See <a href="#rest_accept">Accept</a> for more information.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_caches_enable_rebalancing"><a class="anchor" href="#rest_v2_caches_enable_rebalancing"></a>2.1.30. Enabling rebalancing</h4>
<div class="paragraph">
<p>Turn on automatic rebalancing for a specific cache.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}?action=enable-rebalancing</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_caches_disable_rebalancing"><a class="anchor" href="#rest_v2_caches_disable_rebalancing"></a>2.1.31. Disabling rebalancing</h4>
<div class="paragraph">
<p>Turn off automatic rebalancing for a specific cache.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}?action=disable-rebalancing</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_caches_get_availability"><a class="anchor" href="#rest_v2_caches_get_availability"></a>2.1.32. Getting Cache Availability</h4>
<div class="paragraph">
<p>Retrieve the availability of a cache.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}?action=get-availability</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can get the availability of internal caches but this is subject to change in future Infinispan versions.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_caches_set_availability"><a class="anchor" href="#rest_v2_caches_set_availability"></a>2.1.33. Setting Cache Availability</h4>
<div class="paragraph">
<p>Change the availability of clustered caches when using either the DENY_READ_WRITES or ALLOW_READS partition handling strategy.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}?action=set-availability&amp;availability={AVAILABILITY}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>availability</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVAILABLE or DEGRADED_MODE</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p><code>AVAILABLE</code> makes caches available to all nodes in a network partition.</p>
</li>
<li>
<p><code>DEGRADED_MODE</code> prevents read and write operations on caches when network partitions occur.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can set the availability of internal caches but this is subject to change in future Infinispan versions.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_caches_set_topology_stable"><a class="anchor" href="#rest_v2_caches_set_topology_stable"></a>2.1.34. Set a Stable Topology</h4>
<div class="paragraph">
<p>By default, after a cluster shutdown, Infinispan waits for all nodes to join the cluster and restore the topology.
However, you can define the current cluster topology as stable for a specific cache using a REST operation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}?action=initialize&amp;force={FORCE}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>force</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true or false.</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p><code>force</code> is required when the number of missing nodes in the current topology is greater or equal to the number of owners.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Manually installing a topology can lead to data loss, only perform this operation if the initial topology cannot be recreated.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_query_cache"><a class="anchor" href="#rest_v2_query_cache"></a>2.1.35. Indexing and Querying with the REST API</h4>
<div class="paragraph">
<p>Query remote caches with <code>GET</code> requests and the <code>?action=search&amp;query</code> parameter from any HTTP client.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}?action=search&amp;query={ickle query}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Infinispan response</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "hit_count" : 150,
  "hit_count_exact" : true,
  "hits" : [ {
    "hit" : {
      "name" : "user1",
      "age" : 35
    }
  }, {
    "hit" : {
       "name" : "user2",
       "age" : 42
    }
  }, {
    "hit" : {
       "name" : "user3",
       "age" : 12
    }
  } ]
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hit_count</code> shows the total number of results from the query.</p>
</li>
<li>
<p><code>hit_count_exact</code> is <code>true</code> which means the <code>hit_count</code> is exact. When it&#8217;s <code>false</code>, it implies that the hit count value is a lower bound.</p>
</li>
<li>
<p><code>hits</code> represents an array of individual matches from the query.</p>
</li>
<li>
<p><code>hit</code> refers to each object that corresponds to a match in the query.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Hits can contain all fields or a subset of fields if you use a <code>Select</code> clause.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>query</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the query string.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>offset</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the index of the first result to return. The default is <code>0</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>max_results</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the number of results to return. The default is <code>10</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hit_count_accuracy</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Limits the required accuracy of the hit count for the indexed queries to an upper-bound. The default is <code>10_000</code>. You can change the default limit by setting the <code>query.hit-count-accuracy</code> cache property.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>local</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When <code>true</code>, the query is restricted to the data present in node that process the request. The default is <code>false</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To use the body of the request instead of specifying query parameters, invoke
<code>POST</code> requests as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}?action=search</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Query in request body</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
 "query":"from Entity where name:\"user1\"",
 "max_results":20,
 "offset":10
}</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_query_delete"><a class="anchor" href="#rest_v2_query_delete"></a>Delete by query</h5>
<div class="paragraph">
<p>Delete multiple entries using delete by query in remote caches with <code>DELETE</code> requests and the <code>?action=deleteByQuery&amp;query</code> parameter from any HTTP client.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">DELETE /rest/v2/caches/{cacheName}?action=deleteByQuery&amp;query={ickle query}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>query</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the query string.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>local</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When <code>true</code>, the query is restricted to the data present in node that process the request. The default is <code>false</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To use the body of the request instead of specifying query parameters, invoke
<code>POST</code> requests as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}?action=deleteByQuery</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Delete statement in request body</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
 "query":"DELETE from Entity where name:\"user1\""
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_query_reindex"><a class="anchor" href="#rest_v2_query_reindex"></a>Rebuilding indexes</h5>
<div class="paragraph">
<p>When you delete fields or change index field definitions, you must rebuild the index to ensure the index is consistent with data in the cache.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Rebuilding Protobuf schema using REST, CLI, Infinispan Console or remote client might lead to inconsistencies.
Remote clients might have different versions of the ProtoStream entity and this might lead to unreliable behavior.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Reindex all data in caches with <code>POST</code> requests and the <code>?action=reindex</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}/search/indexes?action=reindex</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 17. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Values for the <code>mode</code> parameter are as follows:</p>
<p class="tableblock">* <code>sync</code> returns <code>204 (No Content)</code> only after the re-indexing operation is complete.</p>
<p class="tableblock">* <code>async</code> returns <code>204 (No Content)</code> immediately and the re-indexing operation continues
running in the cluster. You can check the status with
the <a href="#rest_v2_query_index_stats">Index Statistics</a> REST call.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>local</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When <code>true</code>, only the data from node that process the request is re-indexed. The default is <code>false</code>, meaning all data cluster-wide is re-indexed.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="rest_v2_query_updateIndexSchema"><a class="anchor" href="#rest_v2_query_updateIndexSchema"></a>Updating index schema</h5>
<div class="paragraph">
<p>The update index schema operation lets you add schema changes with a minimal downtime.
Instead of removing previously indexed data and recreating the index schema, Infinispan adds new fields to the existing schema.</p>
</div>
<div class="paragraph">
<p>Update the index schema of values in your cache using <code>POST</code> requests and the <code>?action=updateSchema</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}/search/indexes?action=updateSchema</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_query_purge_index"><a class="anchor" href="#rest_v2_query_purge_index"></a>Purging indexes</h5>
<div class="paragraph">
<p>Delete all indexes from caches with <code>POST</code> requests and the <code>?action=clear</code>
parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}/search/indexes?action=clear</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns <code>204 (No Content)</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_query_get_index_schema"><a class="anchor" href="#rest_v2_query_get_index_schema"></a>Get Indexes Metamodel</h5>
<div class="paragraph">
<p>Present the full index schema metamodel of all indexes defined on this cache.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}/search/indexes/metamodel</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Infinispan response</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">[{
    "entity-name": "org.infinispan.query.test.Book",
    "java-class": "org.infinispan.query.test.Book",
    "index-name": "org.infinispan.query.test.Book",
    "value-fields": {
        "description": {
            "multi-valued": false,
            "multi-valued-in-root": false,
            "type": "java.lang.String",
            "projection-type": "java.lang.String",
            "argument-type": "java.lang.String",
            "searchable": true,
            "sortable": false,
            "projectable": false,
            "aggregable": false,
            "analyzer": "standard"
        },
        "name": {
            "multi-valued": false,
            "multi-valued-in-root": true,
            "type": "java.lang.String",
            "projection-type": "java.lang.String",
            "argument-type": "java.lang.String",
            "searchable": true,
            "sortable": false,
            "projectable": false,
            "aggregable": false,
            "analyzer": "standard"
        },
        "surname": {
            "multi-valued": false,
            "multi-valued-in-root": true,
            "type": "java.lang.String",
            "projection-type": "java.lang.String",
            "argument-type": "java.lang.String",
            "searchable": true,
            "sortable": false,
            "projectable": false,
            "aggregable": false
        },
        "title": {
            "multi-valued": false,
            "multi-valued-in-root": false,
            "type": "java.lang.String",
            "projection-type": "java.lang.String",
            "argument-type": "java.lang.String",
            "searchable": true,
            "sortable": false,
            "projectable": false,
            "aggregable": false
        }
    },
    "object-fields": {
        "authors": {
            "multi-valued": true,
            "multi-valued-in-root": true,
            "nested": true,
            "value-fields": {
                "name": {
                    "multi-valued": false,
                    "multi-valued-in-root": true,
                    "type": "java.lang.String",
                    "projection-type": "java.lang.String",
                    "argument-type": "java.lang.String",
                    "searchable": true,
                    "sortable": false,
                    "projectable": false,
                    "aggregable": false,
                    "analyzer": "standard"
                },
                "surname": {
                    "multi-valued": false,
                    "multi-valued-in-root": true,
                    "type": "java.lang.String",
                    "projection-type": "java.lang.String",
                    "argument-type": "java.lang.String",
                    "searchable": true,
                    "sortable": false,
                    "projectable": false,
                    "aggregable": false
                }
            }
        }
    }
}, {
    "entity-name": "org.infinispan.query.test.Author",
    "java-class": "org.infinispan.query.test.Author",
    "index-name": "org.infinispan.query.test.Author",
    "value-fields": {
        "surname": {
            "multi-valued": false,
            "multi-valued-in-root": false,
            "type": "java.lang.String",
            "projection-type": "java.lang.String",
            "argument-type": "java.lang.String",
            "searchable": true,
            "sortable": false,
            "projectable": false,
            "aggregable": false
        },
        "name": {
            "multi-valued": false,
            "multi-valued-in-root": false,
            "type": "java.lang.String",
            "projection-type": "java.lang.String",
            "argument-type": "java.lang.String",
            "searchable": true,
            "sortable": false,
            "projectable": false,
            "aggregable": false,
            "analyzer": "standard"
        }
    }
}]</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_search_stats"><a class="anchor" href="#rest_v2_search_stats"></a>Retrieving Query and Index Statistics</h5>
<div class="paragraph">
<p>Obtain information about queries and indexes in caches with <code>GET</code> requests.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You must enable statistics in the cache configuration or results are empty.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}/search/stats</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 18. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scope</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use <code>cluster</code> to retrieve consolidated statistics for all members of the cluster. When omitted, Infinispan returns statistics for the local queries and indexes.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Infinispan response</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "query": {
    "indexed_local": {
      "count": 1,
      "average": 12344.2,
      "max": 122324,
      "slowest": "FROM Entity WHERE field &gt; 4"
    },
    "indexed_distributed": {
      "count": 0,
      "average": 0.0,
      "max": -1,
      "slowest": "FROM Entity WHERE field &gt; 4"
    },
    "hybrid": {
      "count": 0,
      "average": 0.0,
      "max": -1,
      "slowest": "FROM Entity WHERE field &gt; 4 AND desc = 'value'"
    },
    "non_indexed": {
      "count": 0,
      "average": 0.0,
      "max": -1,
      "slowest": "FROM Entity WHERE desc = 'value'"
    },
    "entity_load": {
      "count": 123,
      "average": 10.0,
      "max": 120
    }
  },
  "index": {
    "types": {
      "org.infinispan.same.test.Entity": {
        "count": 5660001,
        "size": 0
      },
      "org.infinispan.same.test.AnotherEntity": {
        "count": 40,
        "size": 345560
      }
    },
    "reindexing": false
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the <code><code>query</code></code> section:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>indexed_local</code> Provides details about indexed queries.</p>
</li>
<li>
<p><code>indexed_distributed</code> Provides details about distributed indexed queries.</p>
</li>
<li>
<p><code>hybrid</code> Provides details about queries that used the index only partially.</p>
</li>
<li>
<p><code>non_indexed</code> Provides details about queries that didn&#8217;t use the index.</p>
</li>
<li>
<p><code>entity_load</code> Provides details about cache operations to fetch objects after indexed queries execution.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Time is always measured in nanoseconds.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the <code><code>index</code></code> section:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>types</code> Provide details about each indexed type (class name or protobuf message) that is configured in the cache.</p>
<div class="ulist">
<ul>
<li>
<p><code>count</code> The number of entities indexed for the type.</p>
</li>
<li>
<p><code>size</code> Usage in bytes of the type.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>reindexing</code> If the value is <code>true</code>, the <code>Indexer</code> is running in the cache.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_search_stats_clear"><a class="anchor" href="#rest_v2_search_stats_clear"></a>Clearing Query Statistics</h5>
<div class="paragraph">
<p>Reset runtime statistics with <code>POST</code> requests and the <code>?action=clear</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}/search/stats?action=clear</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan resets only query execution times for the local node only.
This operation does not clear index statistics.</p>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_query_index_stats"><a class="anchor" href="#rest_v2_query_index_stats"></a>Retrieving Index Statistics (Deprecated)</h5>
<div class="paragraph">
<p>Obtain information about indexes in caches with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}/search/indexes/stats</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Infinispan response</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
    "indexed_class_names": ["org.infinispan.sample.User"],
    "indexed_entities_count": {
        "org.infinispan.sample.User": 4
    },
    "index_sizes": {
        "cacheName_protobuf": 14551
    },
    "reindexing": false
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>indexed_class_names</code> Provides the class names of the indexes present in the cache. For Protobuf the value is always <code>org.infinispan.server.core.query.impl.indexing.ProtobufValueWrapper</code>.</p>
</li>
<li>
<p><code>indexed_entities_count</code> Provides the number of entities indexed per class.</p>
</li>
<li>
<p><code>index_sizes</code> Provides the size, in bytes, for each index in the cache.</p>
</li>
<li>
<p><code>reindexing</code> Indicates if a re-indexing operation was performed for the cache. If the value is <code>true</code>, the <code>MassIndexer</code> was started in the cache.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_query_stats"><a class="anchor" href="#rest_v2_query_stats"></a>Retrieving Query Statistics (Deprecated)</h5>
<div class="paragraph">
<p>Get information about the queries that have been run in caches with <code>GET</code>
requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}/search/query/stats</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Infinispan response</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
    "search_query_execution_count":20,
    "search_query_total_time":5,
    "search_query_execution_max_time":154,
    "search_query_execution_avg_time":2,
    "object_loading_total_time":1,
    "object_loading_execution_max_time":1,
    "object_loading_execution_avg_time":1,
    "objects_loaded_count":20,
    "search_query_execution_max_time_query_string": "FROM entity"
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>search_query_execution_count</code> Provides the number of queries that have been run.</p>
</li>
<li>
<p><code>search_query_total_time</code> Provides the total time spent on queries.</p>
</li>
<li>
<p><code>search_query_execution_max_time</code> Provides the maximum time taken for a query.</p>
</li>
<li>
<p><code>search_query_execution_avg_time</code> Provides the average query time.</p>
</li>
<li>
<p><code>object_loading_total_time</code> Provides the total time spent loading objects from the cache after query execution.</p>
</li>
<li>
<p><code>object_loading_execution_max_time</code> Provides the maximum time spent loading objects execution.</p>
</li>
<li>
<p><code>object_loading_execution_avg_time</code> Provides the average time spent loading objects execution.</p>
</li>
<li>
<p><code>objects_loaded_count</code> Provides the count of objects loaded.</p>
</li>
<li>
<p><code>search_query_execution_max_time_query_string</code> Provides the slowest query executed.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_query_stats_clear"><a class="anchor" href="#rest_v2_query_stats_clear"></a>Clearing Query Statistics (Deprecated)</h5>
<div class="paragraph">
<p>Reset runtime statistics with <code>POST</code> requests and the <code>?action=clear</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}/search/query/stats?action=clear</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_xsite_cache"><a class="anchor" href="#rest_v2_xsite_cache"></a>2.1.36. Cross-Site Operations with Caches</h4>
<div class="paragraph">
<p>Perform cross-site replication operations with the Infinispan REST API.</p>
</div>
<div class="paragraph">
<p>See <a href="../xsite/xsite.html">Cross Site replication</a> for more details about this feature.</p>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_sites_status_rest"><a class="anchor" href="#rest_v2_xsite_sites_status_rest"></a>Getting status of all backup locations</h5>
<div class="paragraph">
<p>Retrieve the status of all backup locations with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}/x-site/backups/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with the status of each backup location in JSON format, as
in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "NYC": {
    "status": "online"
  },
  "LON": {
    "status": "mixed",
    "online": [
      "NodeA"
    ],
    "offline": [
      "NodeB"
    ]
  }
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 19. Returned Status</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>online</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All nodes in the local cluster have a cross-site view with the backup location.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>offline</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No nodes in the local cluster have a cross-site view with the backup location.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mixed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Some nodes in the local cluster have a cross-site view with the backup location, other nodes in the local cluster do not have a cross-site view. The response indicates status for each node.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_site_status_rest"><a class="anchor" href="#rest_v2_xsite_site_status_rest"></a>Getting status of specific backup locations</h5>
<div class="paragraph">
<p>Retrieve the status of a backup location with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}/x-site/backups/{siteName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with the status of each node in the site in JSON
format, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "NodeA":"offline",
  "NodeB":"online"
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 20. Returned Status</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>online</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The node is online.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>offline</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The node is offline.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>failed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not possible to retrieve status. The remote cache could be shutting down or a network error occurred during the request.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_take_site_offline_rest"><a class="anchor" href="#rest_v2_xsite_take_site_offline_rest"></a>Taking backup locations offline</h5>
<div class="paragraph">
<p>Take backup locations offline with <code>POST</code> requests and the
<code>?action=take-offline</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}/x-site/backups/{siteName}?action=take-offline</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_bring_backup_online_rest"><a class="anchor" href="#rest_v2_xsite_bring_backup_online_rest"></a>Bringing backup locations online</h5>
<div class="paragraph">
<p>Bring backup locations online with the <code>?action=bring-online</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}/x-site/backups/{siteName}?action=bring-online</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_start_push_rest"><a class="anchor" href="#rest_v2_xsite_start_push_rest"></a>Pushing state to backup locations</h5>
<div class="paragraph">
<p>Push cache state to a backup location with the <code>?action=start-push-state</code>
parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}/x-site/backups/{siteName}?action=start-push-state</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_cancel_state_push_rest"><a class="anchor" href="#rest_v2_xsite_cancel_state_push_rest"></a>Canceling state transfer</h5>
<div class="paragraph">
<p>Cancel state transfer operations with the <code>?action=cancel-push-state</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}/x-site/backups/{siteName}?action=cancel-push-state</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_state_push_rest"><a class="anchor" href="#rest_v2_xsite_state_push_rest"></a>Getting state transfer status</h5>
<div class="paragraph">
<p>Retrieve status of state transfer operations with the
<code>?action=push-state-status</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}/x-site/backups?action=push-state-status</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with the status of state transfer for each backup location
in JSON format, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
   "NYC":"CANCELED",
   "LON":"OK"
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 21. Returned status</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SENDING</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State transfer to the backup location is in progress.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>OK</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State transfer completed successfully.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ERROR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An error occurred with state transfer. Check log files.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CANCELLING</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State transfer cancellation is in progress.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_clear_transfer_status_rest"><a class="anchor" href="#rest_v2_xsite_clear_transfer_status_rest"></a>Clearing state transfer status</h5>
<div class="paragraph">
<p>Clear state transfer status for sending sites with the
<code>?action=clear-push-state-status</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}/x-site/local?action=clear-push-state-status</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_tuning_takeoffline_rest"><a class="anchor" href="#rest_v2_xsite_tuning_takeoffline_rest"></a>Modifying take offline conditions</h5>
<div class="paragraph">
<p>Sites go offline if certain conditions are met. Modify the take offline
parameters to control when backup locations automatically go offline.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Check configured take offline parameters with <code>GET</code> requests and the
<code>take-offline-config</code> parameter.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}/x-site/backups/{siteName}/take-offline-config</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Infinispan response includes <code>after_failures</code> and <code>min_wait</code> fields as
follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "after_failures": 2,
  "min_wait": 1000
}</code></pre>
</div>
</div>
</li>
<li>
<p>Modify take offline parameters in the body of <code>PUT</code> requests.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">PUT /rest/v2/caches/{cacheName}/x-site/backups/{siteName}/take-offline-config</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns <code>204 (No Content)</code>.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_xsite_cancel_receive_state_rest"><a class="anchor" href="#rest_v2_xsite_cancel_receive_state_rest"></a>Canceling state transfer from receiving sites</h5>
<div class="paragraph">
<p>If the connection between two backup locations breaks, you can cancel state
transfer on the site that is receiving the push.</p>
</div>
<div class="paragraph">
<p>Cancel state transfer from a remote site and keep the current state of the
local cache with the <code>?action=cancel-receive-state</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}/x-site/backups/{siteName}?action=cancel-receive-state</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_rolling_upgrades"><a class="anchor" href="#rest_v2_rolling_upgrades"></a>2.1.37. Rolling Upgrades</h4>
<div class="paragraph">
<p>Perform rolling upgrades of cache data between Infinispan clusters</p>
</div>
<div class="sect4">
<h5 id="rest_v2_sync_data"><a class="anchor" href="#rest_v2_sync_data"></a>Connecting Source Clusters</h5>
<div class="paragraph">
<p>Connect a target cluster to the source cluster with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}/rolling-upgrade/source-connection</code></pre>
</div>
</div>
<div class="paragraph">
<p>You must provide a <code>remote-store</code> definition in JSON format as the body:</p>
</div>
<div class="listingblock">
<div class="title">JSON</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "remote-store": {
    "cache": "my-cache",
    "shared": true,
    "socket-timeout": 60000,
    "protocol-version": "2.9",
    "remote-server": [
      {
        "host": "127.0.0.2",
        "port": 12222
      }
    ],
    "async-executor": {
      "properties": {
        "name": 4
      }
    },
    "security": {
      "authentication": {
        "server-name": "servername",
        "digest": {
          "username": "username",
          "password": "password",
          "realm": "realm",
          "sasl-mechanism": "DIGEST-MD5"
        }
      },
      "encryption": {
        "protocol": "TLSv1.2",
        "sni-hostname": "snihostname",
        "keystore": {
          "filename": "/path/to/keystore_client.jks",
          "password": "secret",
          "certificate-password": "secret",
          "key-alias": "hotrod",
          "type": "JKS"
        },
        "truststore": {
          "filename": "/path/to/gca.jks",
          "password": "secret",
          "type": "JKS"
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Several elements are optional such as <code>security</code>, <code>async-executor</code> and <code>connection-pool</code>.
The configuration must contain minimally the cache name and the
host/ip of the single port in the source cluster. For details about the <code>remote-store</code> configuration,
consult the <a href="https://infinispan.org/schemas/infinispan-cachestore-remote-config-12.0.xsd">XSD Schema</a>.</p>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns 204 (No Content). If the target cluster is already connected to the source cluster, it returns status 304 (Not Modified).</p>
</div>
</div>
<div class="sect4">
<h5 id="obtaining_source_cluster_connection_details"><a class="anchor" href="#obtaining_source_cluster_connection_details"></a>Obtaining Source Cluster connection details</h5>
<div class="paragraph">
<p>To obtain the <code>remote-store</code> definition of a cache, use a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}/rolling-upgrade/source-connection</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the cache was previously connected, it returns the configuration of the associated <code>remote-store</code> in JSON format and status 200 (OK),
otherwise a 404 (Not Found) status.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This is not a cluster wide operation, and it only returns the remote-store of the cache in the node where the REST invocation is handled.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="checking_if_a_cache_is_connected"><a class="anchor" href="#checking_if_a_cache_is_connected"></a>Checking if a Cache is connected</h5>
<div class="paragraph">
<p>To check if a cache have been connected to a remote cluster, use a <code>HEAD</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">HEAD /rest/v2/caches/{cacheName}/rolling-upgrade/source-connection</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns status 200 (OK) if for all nodes of the cluster, <code>cacheName</code> has a single remote store configured, and 404 (NOT_FOUND) otherwise.</p>
</div>
</div>
<div class="sect4">
<h5 id="synchronizing_data"><a class="anchor" href="#synchronizing_data"></a>Synchronizing Data</h5>
<div class="paragraph">
<p>Synchronize data from a source cluster to a target cluster with <code>POST</code> requests
and the <code>?action=sync-data</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}?action=sync-data</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the operation completes, Infinispan responds with the total number of
entries copied to the target cluster.</p>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_disconnect_source"><a class="anchor" href="#rest_v2_disconnect_source"></a>Disconnecting Source Clusters</h5>
<div class="paragraph">
<p>After you synchronize data to target clusters, disconnect from the source
cluster with <code>DELETE</code> requests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">DELETE /rest/v2/caches/{cacheName}/rolling-upgrade/source-connection</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns <code>204 (No Content)</code>.
It no source was connected, it returns code 304 (Not Modified).</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_counters"><a class="anchor" href="#rest_v2_counters"></a>2.2. Creating and Managing Counters</h3>
<div class="paragraph">
<p>Create, delete, and modify counters via the REST API.</p>
</div>
<div class="sect3">
<h4 id="rest_server_counters_create"><a class="anchor" href="#rest_server_counters_create"></a>2.2.1. Creating Counters</h4>
<div class="paragraph">
<p>Create counters with <code>POST</code> requests that include configuration in the payload.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/counters/{counterName}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example Weak Counter</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
    "weak-counter":{
        "initial-value":5,
        "storage":"PERSISTENT",
        "concurrency-level":1
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example Strong Counter</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
    "strong-counter":{
        "initial-value":3,
        "storage":"PERSISTENT",
        "upper-bound":5
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_delete"><a class="anchor" href="#rest_server_counters_delete"></a>2.2.2. Deleting Counters</h4>
<div class="paragraph">
<p>Remove specific counters with <code>DELETE</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">DELETE /rest/v2/counters/{counterName}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_config"><a class="anchor" href="#rest_server_counters_config"></a>2.2.3. Retrieving Counter Configuration</h4>
<div class="paragraph">
<p>Retrieve configuration for specific counters with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/counters/{counterName}/config</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with the counter configuration in JSON format.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_get"><a class="anchor" href="#rest_server_counters_get"></a>2.2.4. Getting Counter Values</h4>
<div class="paragraph">
<p>Retrieve counter values with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/counters/{counterName}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 22. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><a href="#rest_accept">Accept</a></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The required format to return the content. Supported formats are <em>application/json</em> and <em>text/plain</em>. JSON is assumed if no header is provided.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_server_counters_reset"><a class="anchor" href="#rest_server_counters_reset"></a>2.2.5. Resetting Counters</h4>
<div class="paragraph">
<p>Restore the initial value of counters without <code>POST</code> requests and the
<code>?action=reset</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/counters/{counterName}?action=reset</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns <code>204 (No Content)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_inc_weak"><a class="anchor" href="#rest_server_counters_inc_weak"></a>2.2.6. Incrementing Counters</h4>
<div class="paragraph">
<p>Increment counter values with <code>POST</code> request` and the <code>?action=increment</code>
parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/counters/{counterName}?action=increment</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>WEAK</code> counters never respond after operations and return <code>204 (No Content)</code>.</p>
</div>
<div class="paragraph">
<p><code>STRONG</code> counters return <code>200 (OK)</code> and the current value after each operation.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_add_weak"><a class="anchor" href="#rest_server_counters_add_weak"></a>2.2.7. Adding Deltas to Counters</h4>
<div class="paragraph">
<p>Add arbitrary values to counters with <code>POST</code> requests that include the
<code>?action=add</code> and <code>delta</code> parameters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/counters/{counterName}?action=add&amp;delta={delta}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>WEAK</code> counters never respond after operations and return <code>204 (No Content)</code>.</p>
</div>
<div class="paragraph">
<p><code>STRONG</code> counters return <code>200 (OK)</code> and the current value after each operation.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_dec"><a class="anchor" href="#rest_server_counters_dec"></a>2.2.8. Decrementing Counter Values</h4>
<div class="paragraph">
<p>Decrement counter values with <code>POST</code> requests and the <code>?action=decrement</code>
parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/counters/{counterName}?action=decrement</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>WEAK</code> counters never respond after operations and return <code>204 (No Content)</code>.</p>
</div>
<div class="paragraph">
<p><code>STRONG</code> counters return <code>200 (OK)</code> and the current value after each operation.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_set"><a class="anchor" href="#rest_server_counters_set"></a>2.2.9. Performing <code>getAndSet</code> atomic operations on Strong Counters</h4>
<div class="paragraph">
<p>Atomically set values for strong counters with <code>POST</code> requests and the <code>getAndSet</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/counters/{counterName}?action=getAndSet&amp;value={value}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the operation is successful, Infinispan returns the previous value in the payload.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_cmpset"><a class="anchor" href="#rest_server_counters_cmpset"></a>2.2.10. Performing compareAndSet Operations on Strong Counters</h4>
<div class="paragraph">
<p>Atomically set values for strong counters with <code>GET</code> requests and the
<code>compareAndSet</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/counters/{counterName}?action=compareAndSet&amp;expect={expect}&amp;update={update}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan atomically sets the value to <code>{update}</code> if the current value is
<code>{expect}</code>.
If the operation is successful, Infinispan returns <code><em>true</em></code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_cmpswp"><a class="anchor" href="#rest_server_counters_cmpswp"></a>2.2.11. Performing compareAndSwap Operations on Strong Counters</h4>
<div class="paragraph">
<p>Atomically set values for strong counters with <code>GET</code> requests and the
<code>compareAndSwap</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/counters/{counterName}?action=compareAndSwap&amp;expect={expect}&amp;update={update}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan atomically sets the value to <code>{update}</code> if the current value is
<code>{expect}</code>.
If the operation is successful, Infinispan returns the previous value in the payload.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_server_counters_list"><a class="anchor" href="#rest_server_counters_list"></a>2.2.12. Listing Counters</h4>
<div class="paragraph">
<p>Retrieve a list of counters in Infinispan clusters with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/counters/</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_protobuf_schemas"><a class="anchor" href="#rest_v2_protobuf_schemas"></a>2.3. Working with Protobuf Schemas</h3>
<div class="paragraph">
<p>Create and manage Protobuf schemas, <code>.proto</code> files, via the Infinispan REST
API.</p>
</div>
<div class="sect3">
<h4 id="rest_v2_create_protobuf"><a class="anchor" href="#rest_v2_create_protobuf"></a>2.3.1. Creating Protobuf Schemas</h4>
<div class="paragraph">
<p>Create Protobuf schemas across Infinispan clusters with <code>POST</code> requests that
include the content of a protobuf file in the payload.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/schemas/{schemaName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the schema already exists, Infinispan returns HTTP <code>409 (Conflict)</code>.
If the schema is not valid, either because of syntax errors, or because some of its dependencies are missing,
Infinispan stores the schema and returns the error in the response body.</p>
</div>
<div class="paragraph">
<p>Infinispan responds with the schema name and any errors.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "name" : "users.proto",
  "error" : {
    "message": "Schema users.proto has errors",
    "cause": "java.lang.IllegalStateException:Syntax error in error.proto at 3:8: unexpected label: messoge"
  }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code> is the name of the Protobuf schema.</p>
</li>
<li>
<p><code>error</code> is <code>null</code> for valid Protobuf schemas. If Infinispan cannot successfully validate the schema, it returns errors.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns <code>201 (Created)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_get_protobuf"><a class="anchor" href="#rest_v2_get_protobuf"></a>2.3.2. Reading Protobuf Schemas</h4>
<div class="paragraph">
<p>Retrieve Protobuf schema from Infinispan with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/schemas/{schemaName}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_update_protobuf"><a class="anchor" href="#rest_v2_update_protobuf"></a>2.3.3. Updating Protobuf Schemas</h4>
<div class="paragraph">
<p>Modify Protobuf schemas with <code>PUT</code> requests that include the content of a protobuf file in the payload.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When you make changes to the existing Protobuf schema definition, you must either update or rebuild the index schema.
If the changes involve modifying the existing fields, then you must rebuild the index.
When you add new fields without touching existing schema, you can update the index schema instead of rebuilding it.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">PUT /rest/v2/schemas/{schemaName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the schema is not valid, either because of syntax errors, or because some of its dependencies are missing,
Infinispan updates the schema and returns the error in the response body.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "name" : "users.proto",
  "error" : {
    "message": "Schema users.proto has errors",
    "cause": "java.lang.IllegalStateException:Syntax error in error.proto at 3:8: unexpected label: messoge"
  }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code> is the name of the Protobuf schema.</p>
</li>
<li>
<p><code>error</code> is <code>null</code> for valid Protobuf schemas. If Infinispan cannot successfully validate the schema, it returns errors.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_delete_protobuf"><a class="anchor" href="#rest_v2_delete_protobuf"></a>2.3.4. Deleting Protobuf Schemas</h4>
<div class="paragraph">
<p>Remove Protobuf schemas from Infinispan clusters with <code>DELETE</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">DELETE /rest/v2/schemas/{schemaName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns <code>204 (No Content)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_list_protobuf"><a class="anchor" href="#rest_v2_list_protobuf"></a>2.3.5. Listing Protobuf Schemas</h4>
<div class="paragraph">
<p>List all available Protobuf schemas with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/schemas/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a list of all schemas available on the cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">[ {
  "name" : "users.proto",
  "error" : {
    "message": "Schema users.proto has errors",
    "cause": "java.lang.IllegalStateException:Syntax error in error.proto at 3:8: unexpected label: messoge"
  }
}, {
  "name" : "people.proto",
  "error" : null
}]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code> is the name of the Protobuf schema.</p>
</li>
<li>
<p><code>error</code> is <code>null</code> for valid Protobuf schemas. If Infinispan cannot successfully validate the schema, it returns errors.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_list_protobuf_types"><a class="anchor" href="#rest_v2_list_protobuf_types"></a>2.3.6. Listing Protobuf Types</h4>
<div class="paragraph">
<p>List all available Protobuf types with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/schemas?action=types</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a list of all types available on the cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">["org.infinispan.Person", "org.infinispan.Phone"]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_cache_managers"><a class="anchor" href="#rest_v2_cache_managers"></a>2.4. Working with Cache Managers</h3>
<div class="paragraph">
<p>Interact with Infinispan Cache Managers to get cluster and usage statistics.</p>
</div>
<div class="sect3">
<h4 id="rest_v2_container_info"><a class="anchor" href="#rest_v2_container_info"></a>2.4.1. Getting Basic Container Information</h4>
<div class="paragraph">
<p>Retrieving information about the cache manager with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/container</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with information in JSON format, as in the following example:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Information about caches with security authorization is available only to users with the specific roles and permissions assigned to them.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
    "version":"xx.x.x-FINAL",
    "name":"default",
    "coordinator":true,
    "cache_configuration_names":[
        "___protobuf_metadata",
        "cache2",
        "CacheManagerResourceTest",
        "cache1"
    ],
    "cluster_name":"ISPN",
    "physical_addresses":"[127.0.0.1:35770]",
    "coordinator_address":"CacheManagerResourceTest-NodeA-49696",
    "cache_manager_status":"RUNNING",
    "created_cache_count":"3",
    "running_cache_count":"3",
    "node_address":"CacheManagerResourceTest-NodeA-49696",
    "cluster_members":[
        "CacheManagerResourceTest-NodeA-49696",
        "CacheManagerResourceTest-NodeB-28120"
    ],
    "cluster_members_physical_addresses":[
        "127.0.0.1:35770",
        "127.0.0.1:60031"
    ],
    "cluster_size":2,
    "defined_caches":[
        {
            "name":"CacheManagerResourceTest",
            "started":true
        },
        {
            "name":"cache1",
            "started":true
        },
        {
            "name":"___protobuf_metadata",
            "started":true
        },
        {
            "name":"cache2",
            "started":true
        }
    ],
    "local_site": "LON",
    "relay_node": true,
    "relay_nodes_address": [
      "CacheManagerResourceTest-NodeA-49696"
    ],
    "sites_view": [
        "LON",
        "NYC"
    ],
    "tracing": true,
    "rebalancing_enabled": true
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>version</code> contains the Infinispan version</p>
</li>
<li>
<p><code>name</code> contains the name of the Cache Manager as defined in the configuration</p>
</li>
<li>
<p><code>coordinator</code> is true if the Cache Manager is the coordinator of the cluster</p>
</li>
<li>
<p><code>cache_configuration_names</code> contains an array of all caches configurations defined in the Cache Manager that are accessible to the current user</p>
</li>
<li>
<p><code>cluster_name</code> contains the name of the cluster as defined in the configuration</p>
</li>
<li>
<p><code>physical_addresses</code> contains the physical network addresses associated with the Cache Manager</p>
</li>
<li>
<p><code>coordinator_address</code> contains the physical network addresses of the coordinator of the cluster</p>
</li>
<li>
<p><code>cache_manager_status</code> the lifecycle status of the Cache Manager.
For possible values, check the <a href="https://infinispan.org/docs/stable/apidocs/org/infinispan/lifecycle/ComponentStatus.html"><code>org.infinispan.lifecycle.ComponentStatus</code></a> documentation</p>
</li>
<li>
<p><code>created_cache_count</code> number of created caches, excludes all internal and private caches</p>
</li>
<li>
<p><code>running_cache_count</code> number of created caches that are running</p>
</li>
<li>
<p><code>node_address</code> contains the logical address of the Cache Manager</p>
</li>
<li>
<p><code>cluster_members</code> and <code>cluster_members_physical_addresses</code> an array of logical and physical addresses of the members of the cluster</p>
</li>
<li>
<p><code>cluster_size</code> number of members in the cluster</p>
</li>
<li>
<p><code>defined_caches</code> A list of all caches defined in the Cache Manager, excluding private caches but including internal caches that are accessible</p>
</li>
<li>
<p><code>local_site</code> The name of the local site.<br>
If cross-site replication is not configured, Infinispan returns "local".</p>
</li>
<li>
<p><code>relay_node</code> is true if the node handles RELAY messages between clusters.</p>
</li>
<li>
<p><code>relay_nodes_address</code> is an array of logical addresses for relay nodes.</p>
</li>
<li>
<p><code>sites_view</code> The list of sites that participate in cross-site replication.<br>
If cross-site replication is not configured, Infinispan returns an empty list.</p>
</li>
<li>
<p><code>rebalancing_enabled</code> is true if rebalancing is enabled. Fetching this property might fail on the server. In that case the property won&#8217;t be present in the payload.</p>
</li>
<li>
<p><code>tracing_enabled</code> is true if tracing is enabled.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_container_health"><a class="anchor" href="#rest_v2_container_health"></a>2.4.2. Getting Cluster Health</h4>
<div class="paragraph">
<p>Retrieve health information for Infinispan clusters with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/container/health</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with cluster health information in JSON format, as in the
following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
    "cluster_health":{
        "cluster_name":"ISPN",
        "health_status":"HEALTHY",
        "number_of_nodes":2,
        "node_names":[
            "NodeA-36229",
            "NodeB-28703"
        ]
    },
    "cache_health":[
        {
            "status":"HEALTHY",
            "cache_name":"___protobuf_metadata"
        },
        {
            "status":"HEALTHY",
            "cache_name":"cache2"
        },
        {
            "status":"HEALTHY",
            "cache_name":"mycache"
        },
        {
            "status":"HEALTHY",
            "cache_name":"cache1"
        }
    ]
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cluster_health</code> contains the health of the cluster</p>
<div class="ulist">
<ul>
<li>
<p><code>cluster_name</code> specifies the name of the cluster as defined in the configuration.</p>
</li>
<li>
<p><code>health_status</code> provides one of the following:</p>
<div class="ulist">
<ul>
<li>
<p><code>DEGRADED</code> indicates at least one of the caches is in degraded mode.</p>
</li>
<li>
<p><code>HEALTHY_REBALANCING</code> indicates at least one cache is in the rebalancing state.</p>
</li>
<li>
<p><code>HEALTHY</code> indicates all cache instances in the cluster are operating as expected.</p>
</li>
<li>
<p><code>FAILED</code> indicates the cache failed to start with the provided configuration.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>number_of_nodes</code> displays the total number of cluster members.
Returns a value of <code>0</code> for non-clustered (standalone) servers.</p>
</li>
<li>
<p><code>node_names</code> is an array of all cluster members.
Empty for standalone servers.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>cache_health</code> contains health information per-cache</p>
<div class="ulist">
<ul>
<li>
<p><code>status</code>  HEALTHY, DEGRADED, HEALTHY_REBALANCING or FAILED</p>
</li>
<li>
<p><code>cache_name</code> the name of the cache as defined in the configuration.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_container_health_status"><a class="anchor" href="#rest_v2_container_health_status"></a>2.4.3. Getting Container Health Status</h4>
<div class="paragraph">
<p>Retrieve the health status of the Infinispan container with <code>GET</code> requests that do not require authentication.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/container/health/status</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with one of the following in <code>text/plain</code> format:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>HEALTHY</code></p>
</li>
<li>
<p><code>HEALTHY_REBALANCING</code></p>
</li>
<li>
<p><code>DEGRADED</code></p>
</li>
<li>
<p><code>FAILED</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_container_availability"><a class="anchor" href="#rest_v2_container_availability"></a>2.4.4. Checking REST Endpoint Availability</h4>
<div class="paragraph">
<p>Verify Infinispan server REST endpoint availability with <code>HEAD</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">HEAD /rest/v2/container/health</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you receive a successful response code then the Infinispan REST server is
running and serving requests.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_container_config"><a class="anchor" href="#rest_v2_container_config"></a>2.4.5. Obtaining Global Configuration</h4>
<div class="paragraph">
<p>Retrieve global configuration for the data container with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/container/config</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 23. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><a href="#rest_accept">Accept</a></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The required format to return the content. Supported formats are <em>application/json</em> and <em>application/xml</em>. JSON is assumed if no header is provided.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 24. Request parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pretty</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code> returns formatted content, including additional spacing and line separators which improve readability but increase payload size. The default is <code>false</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Reference</div>
<p><a href="../../apidocs/org/infinispan/configuration/global/GlobalConfiguration.html">GlobalConfiguration</a></p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_container_caches_config"><a class="anchor" href="#rest_v2_container_caches_config"></a>2.4.6. Obtaining Configuration for All Caches</h4>
<div class="paragraph">
<p>Retrieve the configuration for all caches with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/container/cache-configs</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with <code>JSON</code> arrays that contain each cache and cache
configuration, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">[
  {
      "name":"cache1",
      "configuration":{
          "distributed-cache":{
              "mode":"SYNC",
              "partition-handling":{
                  "when-split":"DENY_READ_WRITES"
              },
              "statistics":true
          }
      }
  },
  {
      "name":"cache2",
      "configuration":{
          "distributed-cache":{
              "mode":"SYNC",
              "transaction":{
                  "mode":"NONE"
              }
          }
      }
  }
]</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 25. Request parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pretty</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code> returns formatted content, including additional spacing and line separators which improve readability but increase payload size. The default is <code>false</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_container_cache_templates"><a class="anchor" href="#rest_v2_container_cache_templates"></a>2.4.7. Listing Available Cache Templates</h4>
<div class="paragraph">
<p>Retrieve all available Infinispan cache templates with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/cache-configs/templates</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>See <a href="#rest_v2_create_cache_template">Creating Caches with Templates</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 26. Request parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pretty</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code> returns formatted content, including additional spacing and line separators which improve readability but increase payload size. The default is <code>false</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_container_stats"><a class="anchor" href="#rest_v2_container_stats"></a>2.4.8. Getting Container Statistics</h4>
<div class="paragraph">
<p>Retrieve the statistics of the container with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/container/stats</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with Cache Manager statistics in JSON format, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
    "statistics_enabled":true,
    "read_write_ratio":0.0,
    "time_since_start":1,
    "time_since_reset":1,
    "number_of_entries":0,
    "off_heap_memory_used":0,
    "data_memory_used":0,
    "misses":0,
    "remove_hits":0,
    "remove_misses":0,
    "evictions":0,
    "average_read_time":0,
    "average_read_time_nanos":0,
    "average_write_time":0,
    "average_write_time_nanos":0,
    "average_remove_time":0,
    "average_remove_time_nanos":0,
    "required_minimum_number_of_nodes":1,
    "hits":0,
    "stores":0,
    "current_number_of_entries_in_memory":0,
    "hit_ratio":0.0,
    "retrievals":0
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>statistics_enabled</code> is <code>true</code> if statistics collection is enabled for the Cache Manager.</p>
</li>
<li>
<p><code>read_write_ratio</code> displays the read/write ratio across all caches.</p>
</li>
<li>
<p><code>time_since_start</code> shows the time, in seconds, since the Cache Manager started.</p>
</li>
<li>
<p><code>time_since_reset</code> shows the number of seconds since the Cache Manager statistics were last reset.</p>
</li>
<li>
<p><code>number_of_entries</code> shows the total number of entries currently in all caches from the Cache Manager. This statistic returns entries in the local cache instances only.</p>
</li>
<li>
<p><code>off_heap_memory_used</code> shows the amount, in <code>bytes[]</code>, of off-heap memory used by this cache container.</p>
</li>
<li>
<p><code>data_memory_used</code> shows the amount, in <code>bytes[]</code>, that the current eviction algorithm estimates is in use for data across all caches. Returns <code>0</code> if eviction is not enabled.</p>
</li>
<li>
<p><code>misses</code> shows the number of <code>get()</code> misses across all caches.</p>
</li>
<li>
<p><code>remove_hits</code> shows the number of removal hits across all caches.</p>
</li>
<li>
<p><code>remove_misses</code> shows the number of removal misses across all caches.</p>
</li>
<li>
<p><code>evictions</code> shows the number of evictions across all caches.</p>
</li>
<li>
<p><code>average_read_time</code> shows the average number of milliseconds taken for <code>get()</code> operations across all caches.</p>
</li>
<li>
<p><code>average_read_time_nanos</code> same as <code>average_read_time</code> but in nanoseconds.</p>
</li>
<li>
<p><code>average_remove_time</code> shows the average number of milliseconds for <code>remove()</code> operations across all caches.</p>
</li>
<li>
<p><code>average_remove_time_nanos</code> same as <code>average_remove_time</code> but in nanoseconds.</p>
</li>
<li>
<p><code>required_minimum_number_of_nodes</code> shows the required minimum number of nodes to guarantee data consistency.</p>
</li>
<li>
<p><code>hits</code> provides the number of <code>get()</code> hits across all caches.</p>
</li>
<li>
<p><code>stores</code> provides the number of <code>put()</code> operations across all caches.</p>
</li>
<li>
<p><code>current_number_of_entries_in_memory</code> shows the total number of entries currently in all caches, excluding passivated entries.</p>
</li>
<li>
<p><code>hit_ratio</code> provides the total percentage hit/(hit+miss) ratio for all caches.</p>
</li>
<li>
<p><code>retrievals</code> shows the total number of <code>get()</code> operations.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_container_stats_reset"><a class="anchor" href="#rest_v2_container_stats_reset"></a>2.4.9. Resetting Container Statistics</h4>
<div class="paragraph">
<p>Reset the statistics with <code>POST</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/container/stats?action=reset</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_container_shutdown"><a class="anchor" href="#rest_v2_container_shutdown"></a>2.4.10. Shutdown all container caches</h4>
<div class="paragraph">
<p>Shut down the Infinispan container on the server with <code>POST</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/container?action=shutdown</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with <code>204 (No Content)</code> and then shutdowns all caches in the container. The servers remain running with active endpoints
and clustering, however REST calls to container resources will result in a 503 Service Unavailable response.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This method is primarily intended for use by the Infinispan Operator. The expectation is that the Server processes will
be manually terminated shortly after this endpoint is invoked. Once this method has been called, it&#8217;s not possible to
restart the container state.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_container_enable_rebalancing"><a class="anchor" href="#rest_v2_container_enable_rebalancing"></a>2.4.11. Enabling rebalancing for all caches</h4>
<div class="paragraph">
<p>Turn on automatic rebalancing for all caches.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/container?action=enable-rebalancing</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_container_disable_rebalancing"><a class="anchor" href="#rest_v2_container_disable_rebalancing"></a>2.4.12. Disabling rebalancing for all caches</h4>
<div class="paragraph">
<p>Turn off automatic rebalancing for all caches.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/container?action=disable-rebalancing</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_manager_create"><a class="anchor" href="#rest_v2_backup_manager_create"></a>2.4.13. Backing Up Infinispan</h4>
<div class="paragraph">
<p>Create backup archives, <code>application/zip</code>, that contain resources (caches, cache
templates, counters, Protobuf schemas, server tasks, and so on) currently
stored in the Infinispan</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/container/backups/{backupName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a backup with the same name already exists, the service responds with <code>409 (Conflict)</code>.
If the <code>directory</code> parameter is not valid, the service returns <code>400 (Bad Request)</code>.
A <code>202</code> response indicates that the backup request is accepted for processing.</p>
</div>
<div class="paragraph">
<p>Optionally include a JSON payload with your request that contains parameters
for the backup operation, as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 27. JSON Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>directory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a location on the server to create and store the backup archive.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resources</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the resources to back up, in JSON format. The default is to back up all resources. If you specify one or more resources, then Infinispan backs up only those resources. See the <em>Resource Parameters</em> table for more information.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 28. Resource Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>caches</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of cache names to back up or <code>*</code> for all caches.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache-configs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of cache templates to back up or <code>*</code> for all templates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>counters</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines either an array of counter names to back up or <code>*</code> for all counters.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>proto-schemas</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines either an array of Protobuf schema names to back up or <code>*</code> for all schemas.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>process</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of server tasks to back up or <code>*</code> for all tasks.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following example creates a backup archive with all counters and caches
named <code>[cache1,cache2]</code> in a specified directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "directory": "/path/accessible/to/the/server",
  "resources": {
    "caches": ["cache1", "cache2"],
    "counters": ["*"]
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_manager_list"><a class="anchor" href="#rest_v2_backup_manager_list"></a>2.4.14. Listing Backups</h4>
<div class="paragraph">
<p>Retrieve the names of all backup operations that are in progress, completed, or
failed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/container/backups</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with an Array of all backup names as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">["backup1", "backup2"]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_manager_head"><a class="anchor" href="#rest_v2_backup_manager_head"></a>2.4.15. Checking Backup Availability</h4>
<div class="paragraph">
<p>Verify that a backup operation is complete.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">HEAD /rest/v2/container/backups/{backupName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>200</code> response indicates the backup archive is available.
A <code>202</code> response indicates the backup operation is in progress.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_manager_get"><a class="anchor" href="#rest_v2_backup_manager_get"></a>2.4.16. Downloading Backup Archives</h4>
<div class="paragraph">
<p>Download backup archives from the server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/container/backups/{backupName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>200</code> response indicates the backup archive is available.
A <code>202</code> response indicates the backup operation is in progress.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_manager_delete"><a class="anchor" href="#rest_v2_backup_manager_delete"></a>2.4.17. Deleting Backup Archives</h4>
<div class="paragraph">
<p>Remove backup archives from the server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">DELETE /rest/v2/container/backups/{backupName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>204</code> response indicates that the backup archive is deleted. A <code>202</code> response
indicates that the backup operation is in progress but will be deleted when the
operation completes.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_restore_manager"><a class="anchor" href="#rest_v2_restore_manager"></a>2.4.18. Restoring Infinispan Resources from Backup Archives</h4>
<div class="paragraph">
<p>Restore Infinispan resources from backup archives. The provided
<code>{restoreName}</code> is for tracking restore progress, and is independent of the name of
backup file being restored.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/container/restores/{restoreName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>202</code> response indicates
that the restore request has been accepted for processing.</p>
</div>
<div class="sect4">
<h5 id="restoring_from_backup_archives_on_infinispan_server"><a class="anchor" href="#restoring_from_backup_archives_on_infinispan_server"></a>Restoring from Backup Archives on Infinispan Server</h5>
<div class="paragraph">
<p>Use the <code>application/json</code> content type with your POST request to back up from
an archive that is available on the server.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 29. JSON Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>location</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the path of the backup archive to restore.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resources</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the resources to restore, in JSON format. The default is to restore all resources. If you specify one or more resources, then Infinispan restores only those resources. See the <em>Resource Parameters</em> table for more information.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 30. Resource Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>caches</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of cache names to back up or <code>*</code> for all caches.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache-configs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of cache templates to back up or <code>*</code> for all templates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>counters</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines either an array of counter names to back up or <code>*</code> for all counters.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>proto-schemas</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines either an array of Protobuf schema names to back up or <code>*</code> for all schemas.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>process</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of server tasks to back up or <code>*</code> for all tasks.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following example restores all counters from a backup archive on the server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "location": "/path/accessible/to/the/server/backup-to-restore.zip",
  "resources": {
    "counters": ["*"]
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="restoring_from_local_backup_archives"><a class="anchor" href="#restoring_from_local_backup_archives"></a>Restoring from Local Backup Archives</h5>
<div class="paragraph">
<p>Use the <code>multipart/form-data</code> content type with your POST request to upload a
local backup archive to the server.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 31. Form Data</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Content-Type</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>backup</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application/zip</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the bytes of the backup archive to restore.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resources</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application/json</code>, <code>text/plain</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a JSON object of request parameters.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example Request</div>
<div class="content">
<pre>Content-Type: multipart/form-data; boundary=5ec9bc07-f069-4662-a535-46069afeda32
Content-Length: 7721

--5ec9bc07-f069-4662-a535-46069afeda32
Content-Disposition: form-data; name="resources"
Content-Length: 23

{"scripts":["test.js"]}
--5ec9bc07-f069-4662-a535-46069afeda32
Content-Disposition: form-data; name="backup"; filename="testManagerRestoreParameters.zip"
Content-Type: application/zip
Content-Length: 7353

&lt;zip-bytes&gt;
--5ec9bc07-f069-4662-a535-46069afeda32--</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_restore_manager_list"><a class="anchor" href="#rest_v2_restore_manager_list"></a>2.4.19. Listing Restores</h4>
<div class="paragraph">
<p>Retrieve the names of all restore requests that are in progress, completed, or
failed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/container/restores</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with an Array of all restore names as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">["restore1", "restore2"]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_restore_manager_head"><a class="anchor" href="#rest_v2_restore_manager_head"></a>2.4.20. Checking Restore Progress</h4>
<div class="paragraph">
<p>Verify that a restore operation is complete.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">HEAD /rest/v2/container/restores/{restoreName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>201 (Created)</code> response indicates the restore operation is completed.
A <code>202 (Accepted)</code> response indicates the backup operation is in progress.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_restore_manager_delete"><a class="anchor" href="#rest_v2_restore_manager_delete"></a>2.4.21. Deleting Restore Metadata</h4>
<div class="paragraph">
<p>Remove metadata for restore requests from the server. This action removes all metadata
associated with restore requests but does not delete any restored content. If you delete
the request metadata, you can use the request name to perform subsequent restore operations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">DELETE /rest/v2/container/restores/{restoreName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>204 (No Content)</code> response indicates that the restore metadata is deleted.
A <code>202 (Accepted)</code> response indicates that the restore operation is in progress and will be deleted when the operation
completes.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_container_configuration_listen"><a class="anchor" href="#rest_v2_container_configuration_listen"></a>2.4.22. Listening to container configuration events</h4>
<div class="paragraph">
<p>Receive events about configuration changes using <a href="https://html.spec.whatwg.org/multipage/server-sent-events.html">Server-Sent Events</a>.
The <code>event</code> value will be one of <code>create-cache</code>, <code>remove-cache</code>, <code>update-cache</code>, <code>create-template</code>, <code>remove-template</code> or <code>update-template</code>.
The <code>data</code> value will contain the declarative configuration of the entity that has been created. Remove events will only contain the name of the removed entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/container/config?action=listen</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 32. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Accept</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the required format to return content. Supported formats are <code>application/yaml</code>, <code>application/json</code> and <code>application/xml</code>. The default is <code>application/yaml</code>. See <a href="#rest_accept">Accept</a> for more information.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 33. Request parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>includeCurrentState</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, the results include the state of the existing configuration in addition to the changes. If set to <code>false</code>, the request returns only the changes. The default value is <code>false</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pretty</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code> returns formatted content, including additional spacing and line separators which improve readability but increase payload size. The default is <code>false</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_container_listen"><a class="anchor" href="#rest_v2_container_listen"></a>2.4.23. Listening to container events</h4>
<div class="paragraph">
<p>Receive events from the container using <a href="https://html.spec.whatwg.org/multipage/server-sent-events.html">Server-Sent Events</a>.
The emitted events come from logged information, so each event contains an identifier associated with the message.
The <code>event</code> value will be <code>lifecycle-event</code>. The <code>data</code> has the logged information, which includes the <code>message</code>,
<code>category</code>, <code>level</code>, <code>timestamp</code>, <code>owner</code>, <code>context</code>, and <code>scope</code>, some of which may be empty.
Currently, we expose only <code>LIFECYCLE</code> events.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/container?action=listen</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 34. Headers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Accept</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the required format to return content. Supported formats are <code>application/yaml</code>, <code>application/json</code> and <code>application/xml</code>. The default is <code>application/yaml</code>. See <a href="#rest_accept">Accept</a> for more information.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 35. Request parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>includeCurrentState</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, the results include the state of the existing configuration in addition to the changes. If set to <code>false</code>, the request returns only the changes. The default value is <code>false</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pretty</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code> returns formatted content, including additional spacing and line separators which improve readability but increase payload size. The default is <code>false</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_xsite_cache_manager"><a class="anchor" href="#rest_v2_xsite_cache_manager"></a>2.4.24. Cross-Site Operations with Cache Managers</h4>
<div class="paragraph">
<p>Perform cross-site operations with Cache Managers to apply the operations to
all caches.</p>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_site_status_rest"><a class="anchor" href="#rest_v2_cache_manager_site_status_rest"></a>Getting status of backup locations</h5>
<div class="paragraph">
<p>Retrieve the status of all backup locations with <code>GET</code>
requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/container/x-site/backups/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with status in JSON format, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
   "SFO-3":{
      "status":"online"
   },
   "NYC-2":{
      "status":"mixed",
      "online":[
         "CACHE_1"
      ],
      "offline":[
         "CACHE_2"
      ],
      "mixed": [
         "CACHE_3"
      ]
   }
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 36. Returned status</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>online</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All nodes in the local cluster have a cross-site view with the backup location.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>offline</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No nodes in the local cluster have a cross-site view with the backup location.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mixed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Some nodes in the local cluster have a cross-site view with the backup location, other nodes in the local cluster do not have a cross-site view. The response indicates status for each node.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/container/x-site/backups/{site}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns the status for a single backup location.</p>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_take_offline_rest"><a class="anchor" href="#rest_v2_cache_manager_take_offline_rest"></a>Taking backup locations offline</h5>
<div class="paragraph">
<p>Take backup locations offline with the <code>?action=take-offline</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/container/x-site/backups/{siteName}?action=take-offline</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_bring_online_rest"><a class="anchor" href="#rest_v2_cache_manager_bring_online_rest"></a>Bringing backup locations online</h5>
<div class="paragraph">
<p>Bring backup locations online with the <code>?action=bring-online</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/container/x-site/backups/{siteName}?action=bring-online</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_get_state_transfer_mode_rest"><a class="anchor" href="#rest_v2_cache_manager_get_state_transfer_mode_rest"></a>Retrieving the state transfer mode</h5>
<div class="paragraph">
<p>Check the state transfer mode with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/caches/{cacheName}/x-site/backups/{site}/state-transfer-mode</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_set_state_transfer_mode_rest"><a class="anchor" href="#rest_v2_cache_manager_set_state_transfer_mode_rest"></a>Setting the state transfer mode</h5>
<div class="paragraph">
<p>Configure the state transfer mode with the <code>?action=set</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/caches/{cacheName}/x-site/backups/{site}/state-transfer-mode?action=set&amp;mode={mode}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_start_push_rest"><a class="anchor" href="#rest_v2_cache_manager_start_push_rest"></a>Starting state transfer</h5>
<div class="paragraph">
<p>Push state of all caches to remote sites with the <code>?action=start-push-state</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/container/x-site/backups/{siteName}?action=start-push-state</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="rest_v2_cache_manager_cancel_push_rest"><a class="anchor" href="#rest_v2_cache_manager_cancel_push_rest"></a>Canceling state transfer</h5>
<div class="paragraph">
<p>Cancel ongoing state transfer operations with the <code>?action=cancel-push-state</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/container/x-site/backups/{siteName}?action=cancel-push-state</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_server"><a class="anchor" href="#rest_v2_server"></a>2.5. Working with Infinispan Servers</h3>
<div class="paragraph">
<p>Monitor and manage Infinispan server instances.</p>
</div>
<div class="sect3">
<h4 id="rest_v2_server_info"><a class="anchor" href="#rest_v2_server_info"></a>2.5.1. Retrieving Basic Server Information</h4>
<div class="paragraph">
<p>View basic information about Infinispan Servers with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/server</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with the server name, codename, and version in JSON format
as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "version":"Infinispan 'Codename' xx.x.x.Final"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_server_cm"><a class="anchor" href="#rest_v2_server_cm"></a>2.5.2. Getting Cache Managers</h4>
<div class="paragraph">
<p>Retrieve lists of Cache Managers for Infinispan Servers with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/server/cache-managers</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with an array of the Cache Manager names configured for
the server.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Infinispan currently supports one Cache Manager per server only.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_ignore"><a class="anchor" href="#rest_v2_cache_ignore"></a>2.5.3. Adding Caches to Ignore Lists</h4>
<div class="paragraph">
<p>Configure Infinispan to temporarily exclude specific caches from client
requests. Send empty <code>POST</code> requests that include the names of the Cache Manager
name and the cache.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/server/ignored-caches/{cache}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with <code>204 (No Content)</code> if the cache is successfully added to the ignore list or <code>404 (Not Found)</code> if the cache or Cache Manager are not found.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Infinispan currently supports one Cache Manager per server only. For future
compatibility you must provide the Cache Manager name in the requests.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_ignore_remove"><a class="anchor" href="#rest_v2_cache_ignore_remove"></a>2.5.4. Removing Caches from Ignore Lists</h4>
<div class="paragraph">
<p>Remove caches from the ignore list with <code>DELETE</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">DELETE /rest/v2/server/ignored-caches/{cache}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with <code>204 (No Content)</code> if the cache is successfully removed from ignore list or <code>404 (Not Found)</code> if the cache or Cache Manager are not found.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cache_ignore_confirm"><a class="anchor" href="#rest_v2_cache_ignore_confirm"></a>2.5.5. Confirming Ignored Caches</h4>
<div class="paragraph">
<p>Confirm that caches are ignored with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/server/ignored-caches/</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_server_config"><a class="anchor" href="#rest_v2_server_config"></a>2.5.6. Obtaining Server Configuration</h4>
<div class="paragraph">
<p>Retrieve Infinispan Server configurations with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/server/config</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with the configuration in JSON format, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
    "server":{
        "interfaces":{
            "interface":{
                "name":"public",
                "inet-address":{
                    "value":"127.0.0.1"
                }
            }
        },
        "socket-bindings":{
            "port-offset":0,
            "default-interface":"public",
            "socket-binding":[
                {
                    "name":"memcached",
                    "port":11221,
                    "interface":"memcached"
                }
            ]
        },
        "security":{
            "security-realms":{
                "security-realm":{
                    "name":"default"
                }
            }
        },
        "endpoints":{
            "socket-binding":"default",
            "security-realm":"default",
            "hotrod-connector":{
                "name":"hotrod"
            },
            "rest-connector":{
                "name":"rest"
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_server_env"><a class="anchor" href="#rest_v2_server_env"></a>2.5.7. Getting Environment Variables</h4>
<div class="paragraph">
<p>Retrieve all environment variables for Infinispan Servers with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/server/env</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_server_memory_statistics"><a class="anchor" href="#rest_v2_server_memory_statistics"></a>2.5.8. Getting JVM Memory Details</h4>
<div class="paragraph">
<p>Retrieve JVM memory usage information for Infinispan Servers with <code>GET</code>
requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/server/memory</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with heap and non-heap memory statistics, direct memory
usage, and information about memory pools and garbage collection in JSON
format.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_server_heap_dump"><a class="anchor" href="#rest_v2_server_heap_dump"></a>2.5.9. Getting JVM Heap Dumps</h4>
<div class="paragraph">
<p>Generate JVM heap dumps for Infinispan Servers with <code>POST</code>
requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/server/memory?action=heap-dump[&amp;live=true|false]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan generates a heap dump file in HPROF format in the server data directory and responds
with the full path of the file in JSON format.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_server_threads"><a class="anchor" href="#rest_v2_server_threads"></a>2.5.10. Getting JVM Thread Dumps</h4>
<div class="paragraph">
<p>Retrieve the current thread dump for the JVM with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/server/threads</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with the current thread dump in <code>text/plain</code> format.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_server_report"><a class="anchor" href="#rest_v2_server_report"></a>2.5.11. Getting Diagnostic Reports for Infinispan Servers</h4>
<div class="paragraph">
<p>Retrieve aggregated reports for Infinispan Servers with <code>GET</code> requests.
To retrieve the report for the requested server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/server/report</code></pre>
</div>
</div>
<div class="paragraph">
<p>To retrieve the report of another server in the cluster, reference the node by name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/server/report/{nodeName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a <code>tar.gz</code> archive that contains an aggregated report
with diagnostic information about both the Infinispan Server and the host. The
report provides details about CPU, memory, open files, network sockets and
routing, threads, in addition to configuration and log files.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_server_stop"><a class="anchor" href="#rest_v2_server_stop"></a>2.5.12. Stopping Infinispan Servers</h4>
<div class="paragraph">
<p>Stop Infinispan Servers with <code>POST</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/server?action=stop</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with <code>204 (No Content)</code> and then stops running.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_server_connections"><a class="anchor" href="#rest_v2_server_connections"></a>2.5.13. Retrieving Client Connection Information</h4>
<div class="paragraph">
<p>List information about clients connected to Infinispan Servers with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/server/connections</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with details about all active client connections in JSON format as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">[
  {
    "id": 2,
    "name": "flower",
    "created": "2023-05-18T14:54:37.882566188Z",
    "principal": "admin",
    "local-address": "/127.0.0.1:11222",
    "remote-address": "/127.0.0.1:58230",
    "protocol-version": "RESP3",
    "client-library": null,
    "client-version": null,
    "ssl-application-protocol": "http/1.1",
    "ssl-cipher-suite": "TLS_AES_256_GCM_SHA384",
    "ssl-protocol": "TLSv1.3"
  },
  {
    "id": 0,
    "name": null,
    "created": "2023-05-18T14:54:07.727775875Z",
    "principal": "admin",
    "local-address": "/127.0.0.1:11222",
    "remote-address": "/127.0.0.1:35716",
    "protocol-version": "HTTP/1.1",
    "client-library": "Infinispan CLI 15.0.0-SNAPSHOT",
    "client-version": null,
    "ssl-application-protocol": "http/1.1",
    "ssl-cipher-suite": "TLS_AES_256_GCM_SHA384",
    "ssl-protocol": "TLSv1.3"
  }
]</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 37. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>global</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code>: will collect connections from all servers in the cluster</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_server_caches_defaults"><a class="anchor" href="#rest_v2_server_caches_defaults"></a>2.5.14. Retrieving Default values for Cache Configuration</h4>
<div class="paragraph">
<p>Retrieve default values for cache configuration with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/server/caches/defaults</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with the default values for cache configuration in JSON format.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_cluster"><a class="anchor" href="#rest_v2_cluster"></a>2.6. Working with Infinispan Clusters</h3>
<div class="paragraph">
<p>Monitor and perform administrative tasks on Infinispan clusters.</p>
</div>
<div class="sect3">
<h4 id="rest_v2_cluster_stop"><a class="anchor" href="#rest_v2_cluster_stop"></a>2.6.1. Stopping Infinispan Clusters</h4>
<div class="paragraph">
<p>Shut down entire Infinispan clusters with <code>POST</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/cluster?action=stop</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with <code>204 (No Content)</code> and then performs an orderly shutdown of
the entire cluster.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_stop_cluster_server"><a class="anchor" href="#rest_v2_stop_cluster_server"></a>2.6.2. Stopping Specific Infinispan Servers in Clusters</h4>
<div class="paragraph">
<p>Shut down one or more specific servers in Infinispan clusters with <code>GET</code>
requests and the <code>?action=stop&amp;server</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/cluster?action=stop&amp;server={server1_host}&amp;server={server2_host}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with <code>204 (No Content)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_cluster"><a class="anchor" href="#rest_v2_backup_cluster"></a>2.6.3. Backing Up Infinispan Clusters</h4>
<div class="paragraph">
<p>Create backup archives, <code>application/zip</code>, that contain resources (caches, templates, counters, Protobuf schemas, server tasks,
and so on) currently stored in the cache container for the cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/cluster/backups/{backupName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Optionally include a JSON payload with your request that contains parameters
for the backup operation, as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 38. JSON Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>directory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a location on the server to create and store the backup archive.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If the backup operation successfully completes, the service returns <code>202 (Accepted)</code>.
If a backup with the same name already exists, the service returns  <code>409 (Conflict)</code>.
If the <code>directory</code> parameter is not valid, the service returns <code>400 (Bad Request)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_cluster_list"><a class="anchor" href="#rest_v2_backup_cluster_list"></a>2.6.4. Listing Backups</h4>
<div class="paragraph">
<p>Retrieve the names of all backup operations that are in progress, completed, or
failed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/cluster/backups</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with an Array of all backup names as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">["backup1", "backup2"]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_cluster_head"><a class="anchor" href="#rest_v2_backup_cluster_head"></a>2.6.5. Checking Backup Availability</h4>
<div class="paragraph">
<p>Verify that a backup operation is complete. A <code>200</code> response indicates the
backup archive is available. A <code>202</code> response indicates the backup operation is
in progress.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">HEAD /rest/v2/cluster/backups/{backupName}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_cluster_get"><a class="anchor" href="#rest_v2_backup_cluster_get"></a>2.6.6. Downloading Backup Archives</h4>
<div class="paragraph">
<p>Download backup archives from the server. A <code>200</code> response indicates the
backup archive is available. A <code>202</code> response indicates the backup operation is
in progress.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/cluster/backups/{backupName}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_backup_cluster_delete"><a class="anchor" href="#rest_v2_backup_cluster_delete"></a>2.6.7. Deleting Backup Archives</h4>
<div class="paragraph">
<p>Remove backup archives from the server. A <code>204</code> response indicates that the
backup archive is deleted. A <code>202</code> response indicates that the backup operation
is in progress but will be deleted when the operation completes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">DELETE /rest/v2/cluster/backups/{backupName}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_restore_cluster"><a class="anchor" href="#rest_v2_restore_cluster"></a>2.6.8. Restoring Infinispan Cluster Resources</h4>
<div class="paragraph">
<p>Apply resources in a backup archive to restore Infinispan clusters. The provided
<code>{restoreName}</code> is for tracking restore progress, and is independent of the name of
backup file being restored.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can restore resources only if the container name in the backup archive
matches the container name for the cluster.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/cluster/restores/{restoreName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>202</code> response indicates that the restore request is accepted for processing.</p>
</div>
<div class="sect4">
<h5 id="restoring_from_backup_archives_on_infinispan_server_2"><a class="anchor" href="#restoring_from_backup_archives_on_infinispan_server_2"></a>Restoring from Backup Archives on Infinispan Server</h5>
<div class="paragraph">
<p>Use the <code>application/json</code> content type with your POST request to back up from
an archive that is available on the server.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 39. JSON Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>location</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the path of the backup archive to restore.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resources</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the resources to restore, in JSON format. The default is to restore all resources. If you specify one or more resources, then Infinispan restores only those resources. See the <em>Resource Parameters</em> table for more information.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 40. Resource Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>caches</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of cache names to back up or <code>*</code> for all caches.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache-configs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of cache templates to back up or <code>*</code> for all templates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>counters</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines either an array of counter names to back up or <code>*</code> for all counters.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>proto-schemas</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines either an array of Protobuf schema names to back up or <code>*</code> for all schemas.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>process</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies either an array of server tasks to back up or <code>*</code> for all tasks.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following example restores all counters from a backup archive on the server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "location": "/path/accessible/to/the/server/backup-to-restore.zip",
  "resources": {
    "counters": ["*"]
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="restoring_from_local_backup_archives_2"><a class="anchor" href="#restoring_from_local_backup_archives_2"></a>Restoring from Local Backup Archives</h5>
<div class="paragraph">
<p>Use the <code>multipart/form-data</code> content type with your POST request to upload a
local backup archive to the server.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 41. Form Data</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Content-Type</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>backup</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application/zip</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the bytes of the backup archive to restore.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example Request</div>
<div class="content">
<pre>Content-Type: multipart/form-data; boundary=5ec9bc07-f069-4662-a535-46069afeda32
Content-Length: 7798

--5ec9bc07-f069-4662-a535-46069afeda32
Content-Disposition: form-data; name="backup"; filename="testManagerRestoreParameters.zip"
Content-Type: application/zip
Content-Length: 7353

&lt;zip-bytes&gt;
--5ec9bc07-f069-4662-a535-46069afeda32--</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_restore_cluster_list"><a class="anchor" href="#rest_v2_restore_cluster_list"></a>2.6.9. Listing Restores</h4>
<div class="paragraph">
<p>Retrieve the names of all restore requests that are in progress, completed, or
failed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/cluster/restores</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with an Array of all restore names as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">["restore1", "restore2"]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_restore_cluster_head"><a class="anchor" href="#rest_v2_restore_cluster_head"></a>2.6.10. Checking Restore Progress</h4>
<div class="paragraph">
<p>Verify that a restore operation is complete.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">HEAD /rest/v2/cluster/restores/{restoreName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>201 (Created)</code> response indicates the restore operation is completed.
A <code>202</code> response indicates the backup operation is in progress.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_restore_cluster_delete"><a class="anchor" href="#rest_v2_restore_cluster_delete"></a>2.6.11. Deleting Restore Metadata</h4>
<div class="paragraph">
<p>Remove metadata for restore requests from the server. This action removes all metadata
associated with restore requests but does not delete any restored content. If you delete
the request metadata, you can use the request name to perform subsequent restore operations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">DELETE /rest/v2/cluster/restores/{restoreName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>204</code> response indicates that the restore metadata is deleted.
A <code>202</code> response indicates that the restore operation is in progress and will be deleted when the operation
completes.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cluster_distribution"><a class="anchor" href="#rest_v2_cluster_distribution"></a>2.6.12. Checking Cluster Distribution</h4>
<div class="paragraph">
<p>Retrieve the distribution details about all servers in the Infinispan cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/cluster?action=distribution</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns a JSON array of each Infinispan server statistics in the cluster with the format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">[
  {
    "node_name": "NodeA",
    "node_addresses": [
      "127.0.0.1:39313"
    ],
    "memory_available": 466180016,
    "memory_used": 56010832
  },
  {
    "node_name": "NodeB",
    "node_addresses": [
      "127.0.0.1:47477"
    ],
    "memory_available": 467548568,
    "memory_used": 54642280
  }
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each element in the array represents an Infinispan node. If the statistics collection is
disabled, information about memory usage values is -1. The properties are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>node_name</code> is the node name.</p>
</li>
<li>
<p><code>node_addresses</code> is a list with all the node&#8217;s physical addresses.</p>
</li>
<li>
<p><code>memory_available</code> the node available memory in bytes.</p>
</li>
<li>
<p><code>memory_used</code> the node used memory in bytes.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_cluster_members"><a class="anchor" href="#rest_v2_cluster_members"></a>2.6.13. Getting Cluster Members Information</h4>
<div class="paragraph">
<p>Retrieving information about each cache manager member in the cluster with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/cluster/members</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with information in JSON format, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
    "rolling_upgrade" : true,
    "members" : [ {
        "node_address" : "NodeA",
        "cache_manager_status" : "RUNNING",
        "version" : "16.0.1.Final",
        "physical_addresses" : "[127.0.0.1:64217]"
    },{
        "node_address" : "NodeB",
        "cache_manager_status" : "RUNNING",
        "version" : "16.0.8.Final",
        "physical_addresses" : "[127.0.0.1:64218]"
    } ]
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>rolling_upgrade</code> contains a flag indicate a rolling upgrade going on</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For each container x</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>version</code> contains the Infinispan version</p>
</li>
<li>
<p><code>physical_addresses</code> contains the physical network addresses associated with the Cache Manager</p>
</li>
<li>
<p><code>cache_manager_status</code> the lifecycle status of the Cache Manager.
For possible values, check the <a href="https://infinispan.org/docs/stable/apidocs/org/infinispan/lifecycle/ComponentStatus.html"><code>org.infinispan.lifecycle.ComponentStatus</code></a> documentation</p>
</li>
<li>
<p><code>node_address</code> contains the logical address of the Cache Manager</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_logging"><a class="anchor" href="#rest_v2_logging"></a>2.7. Infinispan Server logging configuration</h3>
<div class="paragraph">
<p>View and modify the logging configuration on Infinispan clusters at runtime.</p>
</div>
<div class="sect3">
<h4 id="rest_v2_logging_list_appenders"><a class="anchor" href="#rest_v2_logging_list_appenders"></a>2.7.1. Listing the logging appenders</h4>
<div class="paragraph">
<p>View a list of all configured appenders with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/logging/appenders</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a list of appenders in JSON format as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "STDOUT" : {
    "name" : "STDOUT"
  },
  "JSON-FILE" : {
    "name" : "JSON-FILE"
  },
  "HR-ACCESS-FILE" : {
    "name" : "HR-ACCESS-FILE"
  },
  "FILE" : {
    "name" : "FILE"
  },
  "REST-ACCESS-FILE" : {
    "name" : "REST-ACCESS-FILE"
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_logging_list_loggers"><a class="anchor" href="#rest_v2_logging_list_loggers"></a>2.7.2. Listing the loggers</h4>
<div class="paragraph">
<p>View a list of all configured loggers with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/logging/loggers</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a list of loggers in JSON format as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">[ {
  "name" : "",
  "level" : "INFO",
  "appenders" : [ "STDOUT", "FILE" ]
}, {
  "name" : "org.infinispan.HOTROD_ACCESS_LOG",
  "level" : "INFO",
  "appenders" : [ "HR-ACCESS-FILE" ]
}, {
  "name" : "com.arjuna",
  "level" : "WARN",
  "appenders" : [ ]
}, {
  "name" : "org.infinispan.REST_ACCESS_LOG",
  "level" : "INFO",
  "appenders" : [ "REST-ACCESS-FILE" ]
} ]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_logging_set_logger"><a class="anchor" href="#rest_v2_logging_set_logger"></a>2.7.3. Creating/modifying a logger</h4>
<div class="paragraph">
<p>Create a new logger or modify an existing one with <code>PUT</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">PUT /rest/v2/logging/loggers/{loggerName}?level={level}&amp;appender={appender}&amp;appender={appender}...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan sets the level of the logger identified by <code>{loggerName}</code> to <code>{level}</code>.
Optionally, it is possible to set one or more appenders for the logger.
If no appenders are specified, those specified in the root logger will be used.</p>
</div>
<div class="paragraph">
<p>If the operation successfully completes, the service returns <code>204 (No Content)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_logging_remove_logger"><a class="anchor" href="#rest_v2_logging_remove_logger"></a>2.7.4. Removing a logger</h4>
<div class="paragraph">
<p>Remove an existing logger with <code>DELETE</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">DELETE /rest/v2/logging/loggers/{loggerName}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan removes the logger identified by <code>{loggerName}</code>, effectively reverting to the use of the root logger configuration.</p>
</div>
<div class="paragraph">
<p>If operation processed successfully, the service returns a response code <code>204 (No Content)</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_tasks"><a class="anchor" href="#rest_v2_tasks"></a>2.8. Using Server Tasks</h3>
<div class="paragraph">
<p>Retrieve, execute, and upload Infinispan server tasks.</p>
</div>
<div class="sect3">
<h4 id="rest_v2_tasks_list"><a class="anchor" href="#rest_v2_tasks_list"></a>2.8.1. Retrieving Server Tasks Information</h4>
<div class="paragraph">
<p>View information about available server tasks with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/tasks</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 42. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>user</code>: will exclude internal (admin) tasks from the results</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Infinispan responds with a list of available tasks. The list includes the
names of tasks, the engines that handle tasks, the named parameters for tasks,
the execution modes of tasks, either <code>ONE_NODE</code> or <code>ALL_NODES</code>, and the allowed
security role in <code>JSON</code> format, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">[
  {
    "name": "SimpleTask",
    "type": "TaskEngine",
    "parameters": [
      "p1",
      "p2"
    ],
    "execution_mode": "ONE_NODE",
    "allowed_role": null
  },
  {
    "name": "RunOnAllNodesTask",
    "type": "TaskEngine",
    "parameters": [
      "p1"
    ],
    "execution_mode": "ALL_NODES",
    "allowed_role": null
  },
  {
    "name": "SecurityAwareTask",
    "type": "TaskEngine",
    "parameters": [],
    "execution_mode": "ONE_NODE",
    "allowed_role": "MyRole"
  }
]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_tasks_execute"><a class="anchor" href="#rest_v2_tasks_execute"></a>2.8.2. Executing Tasks</h4>
<div class="paragraph">
<p>Execute tasks with <code>POST</code> requests that include the task name, an optional
cache name and required parameters prefixed with <code>param</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/tasks/SimpleTask?action=exec&amp;cache=mycache&amp;param.p1=v1&amp;param.p2=v2</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with the task result.</p>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_tasks_upload"><a class="anchor" href="#rest_v2_tasks_upload"></a>2.8.3. Uploading Script Tasks</h4>
<div class="paragraph">
<p>Upload script tasks with <code>PUT</code> or <code>POST</code> requests.</p>
</div>
<div class="paragraph">
<p>Supply the script as the content payload of the request. After Infinispan
uploads the script, you can execute it with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/tasks/taskName</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_tasks_download"><a class="anchor" href="#rest_v2_tasks_download"></a>2.8.4. Downloading Script Tasks</h4>
<div class="paragraph">
<p>Download script tasks with <code>GET</code> requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/tasks/taskName?action=script</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_security"><a class="anchor" href="#rest_v2_security"></a>2.9. Working with Infinispan Security</h3>
<div class="paragraph">
<p>View and modify security information.</p>
</div>
<div class="sect3">
<h4 id="rest_v2_get_user_acl"><a class="anchor" href="#rest_v2_get_user_acl"></a>2.9.1. Retrieving the ACL of a user</h4>
<div class="paragraph">
<p>View information about the user&#8217;s principals and access-control list.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/security/user/acl</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with information about the user who has performed the request.
The list includes the principals of the user, and a list of resources and the permissions that user has when accessing them.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "subject": [
    {
      "name": "deployer",
      "type": "NamePrincipal"
    }
  ],
  "global": [
    "READ", "WRITE", "EXEC", "LISTEN", "BULK_READ", "BULK_WRITE", "CREATE", "MONITOR", "ALL_READ", "ALL_WRITE"  ],
  "caches": {
    "___protobuf_metadata": [
      "READ", "WRITE", "EXEC", "LISTEN", "BULK_READ", "BULK_WRITE", "CREATE", "MONITOR", "ALL_READ", "ALL_WRITE"
    ],
    "mycache": [
      "LIFECYCLE", "READ", "WRITE", "EXEC", "LISTEN", "BULK_READ", "BULK_WRITE", "ADMIN", "CREATE", "MONITOR", "ALL_READ", "ALL_WRITE"
    ],
    "___script_cache": [
      "READ", "WRITE", "EXEC", "LISTEN", "BULK_READ", "BULK_WRITE", "CREATE", "MONITOR", "ALL_READ", "ALL_WRITE"
    ]
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_flush_acl_cache"><a class="anchor" href="#rest_v2_flush_acl_cache"></a>2.9.2. Flushing the security caches</h4>
<div class="paragraph">
<p>Flush the security caches across the cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/security/cache?action=flush</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_get_roles"><a class="anchor" href="#rest_v2_get_roles"></a>2.9.3. Retrieving the available roles</h4>
<div class="paragraph">
<p>View all the available roles defined in the server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/security/roles</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a list of available roles.
If authorization is enabled, only a user with the <code>ADMIN</code> permission can call this API.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">["observer","application","admin","monitor","deployer"]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_get_roles_detailed"><a class="anchor" href="#rest_v2_get_roles_detailed"></a>2.9.4. Retrieving the available roles detailed</h4>
<div class="paragraph">
<p>View all the available roles defined in the server with their full detail.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/security/roles?action=detailed</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a list of available roles and their detail.
If authorization is enabled, only a user with the <code>ADMIN</code> permission can call this API.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "observer": {
    "inheritable": true,
    "permissions": [
      "MONITOR",
      "ALL_READ"
    ],
    "implicit": true,
    "description": "..."
  },
  "application": {
    "inheritable": true,
    "permissions": [
      "MONITOR",
      "ALL_WRITE",
      "EXEC",
      "LISTEN",
      "ALL_READ"
    ],
    "implicit": true,
    "description": "..."
  },
  "admin": {
    "inheritable": true,
    "permissions": [
      "ALL"
    ],
    "implicit": true,
    "description": "..."
  },
  "monitor": {
    "inheritable": true,
    "permissions": [
      "MONITOR"
    ],
    "implicit": true,
    "description": "..."
  },
  "deployer": {
    "inheritable": true,
    "permissions": [
      "CREATE",
      "MONITOR",
      "ALL_WRITE",
      "EXEC",
      "LISTEN",
      "ALL_READ"
    ],
    "implicit": true,
    "description": "..."
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_get_principal_roles"><a class="anchor" href="#rest_v2_get_principal_roles"></a>2.9.5. Retrieving the roles for a principal</h4>
<div class="paragraph">
<p>View all the roles which map to a principal.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/security/roles/some_principal</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a list of available roles for the specified principal.
The principal need not exist in the realm in use.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">["observer"]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_grant_principal_roles"><a class="anchor" href="#rest_v2_grant_principal_roles"></a>2.9.6. Granting roles to a principal</h4>
<div class="paragraph">
<p>Grant one or more new roles to a principal.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">PUT /rest/v2/security/roles/some_principal?action=grant&amp;role=role1&amp;role=role2</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 43. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>role</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of a role</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_deny_principal_roles"><a class="anchor" href="#rest_v2_deny_principal_roles"></a>2.9.7. Denying roles to a principal</h4>
<div class="paragraph">
<p>Remove one or more roles that were previously granted to a principal.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">PUT /rest/v2/security/roles/some_principal?action=deny&amp;role=role1&amp;role=role2</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 44. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>role</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of a role</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_list_principals"><a class="anchor" href="#rest_v2_list_principals"></a>2.9.8. Listing principals</h4>
<div class="paragraph">
<p>List the principal names for all security realms that can enumerate users (<code>properties</code>, <code>ldap</code>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/security/principals</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a list of principals keyed to each realm</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{"default:properties":["admin","user1","user2"]}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_create_role"><a class="anchor" href="#rest_v2_create_role"></a>2.9.9. Creating roles</h4>
<div class="paragraph">
<p>Create a role by defining a name, its permissions and an optional description in the request body.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/security/permissions/somerole?permission=permission1&amp;permission=permission2</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 45. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>permission</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of a permission</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_update_role"><a class="anchor" href="#rest_v2_update_role"></a>2.9.10. Updating roles</h4>
<div class="paragraph">
<p>Update an existing role permissions and/or description.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">POST /rest/v2/security/permissions/somerole?permission=permission1&amp;permission=permission2</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 46. Request Parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required or Optional</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>permission</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQUIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of a permission</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rest_v2_delete_role"><a class="anchor" href="#rest_v2_delete_role"></a>2.9.11. Deleting roles</h4>
<div class="paragraph">
<p>Delete an existing role.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">DELETE /rest/v2/security/permissions/somerole</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest_v2_get_permission_roles"><a class="anchor" href="#rest_v2_get_permission_roles"></a>2.9.12. Retrieving the permissions for a role</h4>
<div class="paragraph">
<p>View all the permissions of a role.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">GET /rest/v2/security/permissions/somerole</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan responds with a list of available roles for the specified principal.
The principal need not exist in the realm in use.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "name" : "application",
  "permissions" : [ "LISTEN","ALL_READ","MONITOR","ALL_WRITE","EXEC" ],
  "inheritable": true,
  "implicit": true,
  "description": "..."
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_v2_tracing_propagation"><a class="anchor" href="#rest_v2_tracing_propagation"></a>2.10. Enabling Tracing Propagation</h3>
<div class="paragraph">
<p>Tracing with Infinispan Server and REST API lets you monitor and analyze the flow of requests and track the execution path across different components.</p>
</div>
<div class="sect3">
<h4 id="propagation_rest_tracing_rest"><a class="anchor" href="#propagation_rest_tracing_rest"></a>2.10.1. Enabling tracing propagation between Infinispan Server and REST API</h4>
<div class="paragraph">
<p>When you enable tracing propagation between the Infinispan Server and REST API, you must configure tracing on both the client side and the server side.</p>
</div>
<div class="paragraph">
<p>To propagate the OpenTelemetry tracing spans to the Infinispan spans, you must set the trace context on each REST invocation.</p>
</div>
<div class="ulist">
<div class="title">Prerequisite</div>
<ul>
<li>
<p>Have tracing enabled on Infinispan Server and remote client side.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Extract the current tracing context using the <code>io.opentelemetry.api.trace.propagation.W3CTraceContextPropagator</code>.</p>
<div class="paragraph">
<p>The extraction produces a context map that stores trace context information.</p>
</div>
</li>
<li>
<p>Pass the context map in the header of the REST call to ensure that the trace context is preserved.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">HashMap&lt;String, String&gt; contextMap = new HashMap&lt;&gt;();

// Inject the request with the *current* Context, which contains our current Span.
W3CTraceContextPropagator.getInstance().inject(Context.current(), contextMap,
(carrier, key, value) -&gt; carrier.put(key, value));

// Pass the context map in the header
RestCacheClient client = restClient.cache(CACHE_NAME);
client.put("aaa", MediaType.TEXT_PLAIN.toString(),RestEntity.create(MediaType.TEXT_PLAIN, "bbb"), contextMap);</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The tracing spans that the client application generates are correlated with the dependent spans generated by the Infinispan Server.</p>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="../server/server.html#opentelemetry-tracing">Enabling Infinispan tracing</a></p>
</li>
<li>
<p><a href="../hotrod_java/hotrod_java.html#propagation-hotrod-client-tracing">Hot Rod client tracing propagation</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rest_client_code"><a class="anchor" href="#rest_client_code"></a>3. REST Client Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Part of the point of a RESTful service is that you don&#8217;t need to have tightly coupled client libraries/bindings. All you need is a HTTP client library. For Java, Apache HTTP Commons Client works just fine (and is used in the integration tests), or you can use java.net API.</p>
</div>
<div class="sect2">
<h3 id="rest_server_client_ruby"><a class="anchor" href="#rest_server_client_ruby"></a>3.1. Ruby REST Example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># Shows how to interact with the REST api from ruby.
# No special libraries, just standard net/http
#
# Author: Michael Neale
#
require 'net/http'

uri = URI.parse('http://localhost:11222/rest/v2/caches/default/MyKey')
http = Net::HTTP.new(uri.host, uri.port)

#Create new entry

post = Net::HTTP::Post.new(uri.path, {"Content-Type" =&gt; "text/plain"})
post.basic_auth('user','pass')
post.body = "DATA HERE"

resp = http.request(post)

puts "POST response code : " + resp.code

#get it back

get = Net::HTTP::Get.new(uri.path)
get.basic_auth('user','pass')
resp = http.request(get)

puts "GET response code: " + resp.code
puts "GET Body: " + resp.body

#use PUT to overwrite

put = Net::HTTP::Put.new(uri.path, {"Content-Type" =&gt; "text/plain"})
put.basic_auth('user','pass')
put.body = "ANOTHER DATA HERE"

resp = http.request(put)

puts "PUT response code : " + resp.code

#and remove...
delete = Net::HTTP::Delete.new(uri.path)
delete.basic_auth('user','pass')

resp = http.request(delete)

puts "DELETE response code : " + resp.code

#Create binary data like this... just the same...

uri = URI.parse('http://localhost:11222/rest/v2/caches/default/MyLogo')
put = Net::HTTP::Put.new(uri.path, {"Content-Type" =&gt; "application/octet-stream"})
put.basic_auth('user','pass')
put.body = File.read('./logo.png')

resp = http.request(put)

puts "PUT response code : " + resp.code

#and if you want to do json...
require 'rubygems'
require 'json'

#now for fun, lets do some JSON !
uri = URI.parse('http://localhost:11222/rest/v2/caches/jsonCache/user')
put = Net::HTTP::Put.new(uri.path, {"Content-Type" =&gt; "application/json"})
put.basic_auth('user','pass')

data = {:name =&gt; "michael", :age =&gt; 42 }
put.body = data.to_json

resp = http.request(put)

puts "PUT response code : " + resp.code

get = Net::HTTP::Get.new(uri.path)
get.basic_auth('user','pass')
resp = http.request(get)

puts "GET Body: " + resp.body</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_server_client_python"><a class="anchor" href="#rest_server_client_python"></a>3.2. Python 3 REST Example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import urllib.request

# Setup basic auth
base_uri = 'http://localhost:11222/rest/v2/caches/default'
auth_handler = urllib.request.HTTPBasicAuthHandler()
auth_handler.add_password(user='user', passwd='pass', realm='ApplicationRealm', uri=base_uri)
opener = urllib.request.build_opener(auth_handler)
urllib.request.install_opener(opener)

# putting data in
data = "SOME DATA HERE \!"

req = urllib.request.Request(url=base_uri + '/Key', data=data.encode("UTF-8"), method='PUT',
                             headers={"Content-Type": "text/plain"})
with urllib.request.urlopen(req) as f:
    pass

print(f.status)
print(f.reason)

# getting data out
resp = urllib.request.urlopen(base_uri + '/Key')
print(resp.read().decode('utf-8'))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_server_client_java"><a class="anchor" href="#rest_server_client_java"></a>3.3. Java REST Example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.infinispan;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.Base64;

/**
 * Rest example accessing a cache.
 *
 * @author Samuel Tauil (samuel@redhat.com)
 */
public class RestExample {

    /**
     * Method that puts a String value in cache.
     *
     * @param urlServerAddress URL containing the cache and the key to insert
     * @param value            Text to insert
     * @param user             Used for basic auth
     * @param password         Used for basic auth
     */
    public void putMethod(String urlServerAddress, String value, String user, String password) throws IOException {
        System.out.println("----------------------------------------");
        System.out.println("Executing PUT");
        System.out.println("----------------------------------------");
        URL address = new URL(urlServerAddress);
        System.out.println("executing request " + urlServerAddress);
        HttpURLConnection connection = (HttpURLConnection) address.openConnection();
        System.out.println("Executing put method of value: " + value);
        connection.setRequestMethod("PUT");
        connection.setRequestProperty("Content-Type", "text/plain");
        addAuthorization(connection, user, password);
        connection.setDoOutput(true);

        OutputStreamWriter outputStreamWriter = new OutputStreamWriter(connection.getOutputStream());
        outputStreamWriter.write(value);

        connection.connect();
        outputStreamWriter.flush();
        System.out.println("----------------------------------------");
        System.out.println(connection.getResponseCode() + " " + connection.getResponseMessage());
        System.out.println("----------------------------------------");
        connection.disconnect();
    }

    /**
     * Method that gets a value by a key in url as param value.
     *
     * @param urlServerAddress URL containing the cache and the key to read
     * @param user             Used for basic auth
     * @param password         Used for basic auth
     * @return String value
     */
    public String getMethod(String urlServerAddress, String user, String password) throws IOException {
        String line;
        StringBuilder stringBuilder = new StringBuilder();

        System.out.println("----------------------------------------");
        System.out.println("Executing GET");
        System.out.println("----------------------------------------");

        URL address = new URL(urlServerAddress);
        System.out.println("executing request " + urlServerAddress);

        HttpURLConnection connection = (HttpURLConnection) address.openConnection();
        connection.setRequestMethod("GET");
        connection.setRequestProperty("Content-Type", "text/plain");
        addAuthorization(connection, user, password);
        connection.setDoOutput(true);

        BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(connection.getInputStream()));

        connection.connect();

        while ((line = bufferedReader.readLine()) != null) {
            stringBuilder.append(line).append('\n');
        }

        System.out.println("Executing get method of value: " + stringBuilder.toString());

        System.out.println("----------------------------------------");
        System.out.println(connection.getResponseCode() + " " + connection.getResponseMessage());
        System.out.println("----------------------------------------");

        connection.disconnect();

        return stringBuilder.toString();
    }

    private void addAuthorization(HttpURLConnection connection, String user, String pass) {
        String credentials = user + ":" + pass;
        String basic = Base64.getEncoder().encodeToString(credentials.getBytes());
        connection.setRequestProperty("Authorization", "Basic " + basic);
    }

    /**
     * Main method example.
     */
    public static void main(String[] args) throws IOException {
        RestExample restExample = new RestExample();
        String user = "user";
        String pass = "pass";
        restExample.putMethod("http://localhost:11222/rest/v2/caches/default/1", "Infinispan REST Test", user, pass);
        restExample.getMethod("http://localhost:11222/rest/v2/caches/default/1", user, pass);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest_server_client_http"><a class="anchor" href="#rest_server_client_http"></a>3.4. <code>HttpClient</code> API REST Example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.infinispan;

import java.io.IOException;
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;
import java.util.Base64;

/**
 * RestExample class shows you how to access your cache via the JDK HttpClient API available since Java 11
 *
 * @author Gustavo Lira (glira@redhat.com)
 */
public class RestExample {
   private static final String SERVER_ADDRESS = "http://localhost:11222";
   private static final String CACHE_URI = "/rest/v2/caches/default";

   /**
    * postMethod create a named cache.
    * @param httpClient HTTP client that sends requests and receives responses
    * @param builder    Encapsulates HTTP requests
    * @throws IOException
    * @throws InterruptedException
    */
   public void postMethod(HttpClient httpClient, HttpRequest.Builder builder) throws IOException, InterruptedException {
      System.out.println("----------------------------------------");
      System.out.println("Executing POST");
      System.out.println("----------------------------------------");

      HttpRequest request = builder.POST(HttpRequest.BodyPublishers.noBody()).build();
      HttpResponse&lt;Void&gt; response = httpClient.send(request, HttpResponse.BodyHandlers.discarding());

      System.out.println("----------------------------------------");
      System.out.println(response.statusCode());
      System.out.println("----------------------------------------");
   }

   /**
    * putMethod stores a String value in your cache.
    * @param httpClient HTTP client that sends requests and receives responses
    * @param builder    Encapsulates HTTP requests
    * @throws IOException
    * @throws InterruptedException
    */
   public void putMethod(HttpClient httpClient, HttpRequest.Builder builder) throws IOException, InterruptedException {
      System.out.println("----------------------------------------");
      System.out.println("Executing PUT");
      System.out.println("----------------------------------------");

      String cacheValue = "Infinispan REST Test";
      HttpRequest request = builder.PUT(HttpRequest.BodyPublishers.ofString(cacheValue)).build();
      HttpResponse&lt;Void&gt; response = httpClient.send(request, HttpResponse.BodyHandlers.discarding());

      System.out.println("----------------------------------------");
      System.out.println(response.statusCode());
      System.out.println("----------------------------------------");
   }

   /**
    * getMethod get a String value from your cache.
    * @param httpClient HTTP client that sends requests and receives responses
    * @param builder    Encapsulates HTTP requests
    * @return           String value
    * @throws IOException
    */
   public String getMethod(HttpClient httpClient, HttpRequest.Builder builder) throws IOException, InterruptedException {
      System.out.println("----------------------------------------");
      System.out.println("Executing GET");
      System.out.println("----------------------------------------");

      HttpRequest request = builder.GET().build();
      HttpResponse&lt;String&gt; response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());

      System.out.println("Executing get method of value: " + response.body());

      System.out.println("----------------------------------------");
      System.out.println(response.statusCode());
      System.out.println("----------------------------------------");

      return response.body();
   }

   public static void main(String[] args) throws IOException, InterruptedException {
      RestExample restExample = new RestExample();
      HttpClient httpClient = HttpClient.newBuilder().version(HttpClient.Version.HTTP_1_1).build();

      restExample.postMethod(httpClient, getHttpReqestBuilder(String.format("%s%s", SERVER_ADDRESS, CACHE_URI)));
      restExample.putMethod(httpClient, getHttpReqestBuilder(String.format("%s%s/1", SERVER_ADDRESS, CACHE_URI)));
      restExample.getMethod(httpClient, getHttpReqestBuilder(String.format("%s%s/1", SERVER_ADDRESS, CACHE_URI)));
   }

   private static String basicAuth(String username, String password) {
      return "Basic " + Base64.getEncoder().encodeToString((username + ":" + password).getBytes());
   }

   private static final HttpRequest.Builder getHttpReqestBuilder(String url) {
      return HttpRequest.newBuilder()
            .uri(URI.create(url))
            .header("Content-Type", "text/plain")
            .header("Authorization", basicAuth("user", "pass"));
   }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-10-15 09:42:19 UTC
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/highlight.min.js"></script>
<script>
if (!hljs.initHighlighting.called) {
  hljs.initHighlighting.called = true
  ;[].slice.call(document.querySelectorAll('pre.highlight > code[data-lang]')).forEach(function (el) { hljs.highlightBlock(el) })
}
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>