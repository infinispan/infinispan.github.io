<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="generator" content="Asciidoctor 1.5.8"> <title>Technical Overview: Infinispan 10.0</title> <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"> <style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock pre.nowrap,.literalblock pre.nowrap pre,.listingblock pre.nowrap,.listingblock pre.nowrap pre{white-space:pre;word-wrap:normal}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #dddddf}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> <style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style> <link rel="canonical" href="http://infinispan.org/docs/stable/user_guide/user_guide.html"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.1/themes/default/style.min.css"> <link rel="stylesheet" href="../../css/css.css"> <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.1/jstree.min.js"></script> <script src="../../js/js.js"></script> </head> <body class="book toc2 toc-left"> <div id="header"> <h1>Technical Overview: Infinispan 10.0</h1> <div id="toc" class="toc2"> <div id="toctitle">Table of Contents</div> <ul class="sectlevel1"> <li><a href="#introduction">1. Introduction</a> <ul class="sectlevel2"> <li><a href="#what_is_infinispan">1.1. What is Infinispan ?</a></li> <li><a href="#why_use_infinispan">1.2. Why use Infinispan ?</a> <ul class="sectlevel3"> <li><a href="#as_a_local_cache">1.2.1. As a local cache</a></li> <li><a href="#as_a_clustered_cache">1.2.2. As a clustered cache</a></li> <li><a href="#as_a_clustering_building_block_for_your_applications">1.2.3. As a clustering building block for your applications</a></li> <li><a href="#as_a_remote_cache">1.2.4. As a remote cache</a></li> <li><a href="#as_a_data_grid">1.2.5. As a data grid</a></li> <li><a href="#as_a_geographical_backup_for_your_data">1.2.6. As a geographical backup for your data</a></li> </ul> </li> </ul> </li> <li><a href="#arch_overview">2. Architectural Overview</a> <ul class="sectlevel2"> <li><a href="#cache_hierarchy">2.1. Cache hierarchy</a></li> <li><a href="#arch_commands">2.2. Commands</a></li> <li><a href="#visitors">2.3. Visitors</a></li> <li><a href="#interceptors">2.4. Interceptors</a></li> <li><a href="#putting_it_all_together">2.5. Putting it all together</a></li> <li><a href="#subsystem_managers">2.6. Subsystem Managers</a> <ul class="sectlevel3"> <li><a href="#distributionmanager">2.6.1. DistributionManager</a></li> <li><a href="#transactionmanager">2.6.2. TransactionManager</a></li> <li><a href="#rpcmanager">2.6.3. RpcManager</a></li> <li><a href="#lockmanager">2.6.4. LockManager</a></li> <li><a href="#persistencemanager">2.6.5. PersistenceManager</a></li> <li><a href="#datacontainer">2.6.6. DataContainer</a></li> <li><a href="#configuration">2.6.7. Configuration</a></li> </ul> </li> <li><a href="#componentregistry">2.7. ComponentRegistry</a></li> <li><a href="#project_questions">2.8. Project questions</a> <ul class="sectlevel3"> <li><a href="#what_is_infinispan_2">2.8.1. What is Infinispan?</a></li> <li><a href="#what_would_i_use_infinispan_for">2.8.2. What would I use Infinispan for?</a></li> <li><a href="#how_is_infinispan_related_to_jboss_cache">2.8.3. How is Infinispan related to JBoss Cache?</a></li> <li><a href="#what_version_of_java_does_infinispan_need_to_run_does_infinispan_need_an_application_server_to_run">2.8.4. What version of Java does Infinispan need to run? Does Infinispan need an application server to run?</a></li> <li><a href="#will_there_be_a_pojo_cache_replacement_in_infinispan">2.8.5. Will there be a POJO Cache replacement in Infinispan?</a></li> <li><a href="#how_come_infinispans_first_release_is_4_0_0_this_sounds_weird">2.8.6. How come Infinispan's first release is 4.0.0? This sounds weird!</a></li> <li><a href="#how_is_this_related_to_jsr_107_the_jcache_specification">2.8.7. How is this related to JSR 107, the JCACHE specification?</a></li> <li><a href="#can_i_use_infinispan_with_hibernate">2.8.8. Can I use Infinispan with Hibernate?</a></li> </ul> </li> <li><a href="#technical_questions">2.9. Technical questions</a> <ul class="sectlevel3"> <li><a href="#general_questions">2.9.1. General questions</a> <ul class="sectlevel4"> <li><a href="#what_apis_does_infinispan_offer">What APIs does Infinispan offer?</a></li> <li><a href="#which_jvms_jdks_does_infinispan_work_with">Which JVMs (JDKs) does Infinispan work with?</a></li> <li><a href="#does_infinispan_store_data_by_value_or_by_reference">Does Infinispan store data by value or by reference?</a></li> <li><a href="#can_i_use_infinispan_with_groovy_what_about_jython_clojure_jruby_or_scala_etc">Can I use Infinispan with Groovy? What about Jython, Clojure, JRuby or Scala etc.?</a></li> </ul> </li> <li><a href="#cache_loader_and_cache_store_questions">2.9.2. Cache Loader and Cache Store questions</a> <ul class="sectlevel4"> <li><a href="#are_modifications_to_asynchronous_cache_stores_coalesced_or_aggregated">Are modifications to asynchronous cache stores coalesced or aggregated?</a></li> <li><a href="#what_does_the_passivation_flag_do">What does the passivation flag do?</a></li> <li><a href="#what_if_i_get_ioexception_unsupported_protocol_version_48_with_jdbcstringbasedcachestore">What if I get IOException "Unsupported protocol version 48" with JdbcStringBasedCacheStore?</a></li> <li><a href="#is_there_any_way_i_can_boost_cache_stores_performance">Is there any way I can boost cache store&#8217;s performance?</a></li> </ul> </li> <li><a href="#locking_and_transaction_questions">2.9.3. Locking and Transaction questions</a> <ul class="sectlevel4"> <li><a href="#does_infinispan_support_distributed_eager_locking">Does Infinispan support distributed eager locking?</a></li> <li><a href="#how_does_infinispan_support_explicit_eager_locking">How does Infinispan support explicit eager locking?</a></li> <li><a href="#what_isolation_levels_does_infinispan_support">What isolation levels does Infinispan support?</a></li> <li><a href="#when_using_atomikos_transaction_manager_distributed_caches_are_not_distributing_data_what_is_the_problem">When using Atomikos transaction manager, distributed caches are not distributing data, what is the problem?</a></li> </ul> </li> <li><a href="#eviction_and_expiration_questions">2.9.4. Eviction and Expiration questions</a> <ul class="sectlevel4"> <li><a href="#expiration_does_not_work_what_is_the_problem">Expiration does not work, what is the problem?</a></li> </ul> </li> <li><a href="#cache_manager_questions">2.9.5. Cache Manager questions</a> <ul class="sectlevel4"> <li><a href="#can_i_create_caches_using_different_cache_modes_using_the_same_cache_manager">Can I create caches using different cache modes using the same cache manager?</a></li> <li><a href="#can_transactions_span_different_cache_instances_from_the_same_cache_manager">Can transactions span different Cache instances from the same cache manager?</a></li> <li><a href="#how_does_multi_tenancy_work">How does multi-tenancy work?</a></li> <li><a href="#infinispan_allows_me_to_create_several_caches_from_a_single_cachemanager_are_there_any_reasons_to_create_separate_cachemanagers">Infinispan allows me to create several Caches from a single CacheManager. Are there any reasons to create separate CacheManagers?</a></li> </ul> </li> <li><a href="#cache_mode_questions">2.9.6. Cache Mode questions</a> <ul class="sectlevel4"> <li><a href="#what_is_the_difference_between_a_replicated_cache_and_a_distributed_cache">What is the difference between a replicated cache and a distributed cache?</a></li> <li><a href="#does_dist_support_both_synchronous_and_asynchronous_communications">Does DIST support both synchronous and asynchronous communications?</a></li> <li><a href="#i_notice_that_when_using_dist_the_cache_does_a_remote_get_before_a_write_command_why_is_this">I notice that when using DIST, the cache does a remote get before a write command. Why is this?</a> <ul class="sectlevel5"> <li><a href="#isnt_that_expensive_how_can_i_optimize_this_away">Isn&#8217;t that expensive? How can I optimize this away?</a></li> </ul> </li> <li><a href="#i_use_a_clustered_cache_i_want_the_guarantees_of_synchronous_replication_with_the_parallelism_of_asynchronous_replication_what_can_i_do">I use a clustered cache. I want the guarantees of synchronous replication with the parallelism of asynchronous replication. What can I do?</a></li> <li><a href="#what_is_the_l1_cache">What is the L1 cache?</a></li> <li><a href="#what_consistency_guarantees_do_i_have_with_different_asynchronous_processing_settings">What consistency guarantees do I have with different Asynchronous processing settings ?</a></li> <li><a href="#grouping_api_vs_key_affinity_service">Grouping API vs Key Affinity Service</a></li> </ul> </li> <li><a href="#listener_questions">2.9.7. Listener questions</a> <ul class="sectlevel4"> <li><a href="#in_a_cache_entry_modified_listener_can_the_modified_value_be_retrieved_via_cache_get_when_isprefalse">In a cache entry modified listener, can the modified value be retrieved via Cache.get() when isPre=false?</a></li> <li><a href="#when_annotating_a_method_with_cacheentrycreated_how_do_i_retrieve_the_value_of_the_cache_entry_added">When annotating a method with CacheEntryCreated, how do I retrieve the value of the cache entry added?</a></li> <li><a href="#what_is_the_difference_between_classes_in_org_infinispan_notifications_cachelistener_filter_vs_org_infinispan_filter">What is the difference between classes in <code>org.infinispan.notifications.cachelistener.filter</code> vs <code>org.infinispan.filter</code>?</a></li> </ul> </li> <li><a href="#iaascloud_infrastructure_questions">2.9.8. IaaS/Cloud Infrastructure questions</a> <ul class="sectlevel4"> <li><a href="#how_do_you_make_infinispan_send_replication_traffic_over_a_specific_network_when_you_dont_know_the_ip_address">How do you make Infinispan send replication traffic over a specific network when you don&#8217;t know the IP address?</a></li> </ul> </li> <li><a href="#demo_questions">2.9.9. Demo questions</a> <ul class="sectlevel4"> <li><a href="#when_using_the_gui_demo_ive_just_put_an_entry_in_the_cache_with_lifespan_of_1_why_do_i_see_it_as_having_a_lifespan_of_60000">When using the GUI Demo, I&#8217;ve just put an entry in the cache with lifespan of -1. Why do I see it as having a lifespan of 60,000?</a></li> </ul> </li> <li><a href="#logging_questions">2.9.10. Logging questions</a> <ul class="sectlevel4"> <li><a href="#how_can_i_enable_logging">How can I enable logging?</a></li> </ul> </li> <li><a href="#third_party_container_questions">2.9.11. Third Party Container questions</a> <ul class="sectlevel4"> <li><a href="#can_i_use_infinispan_on_google_app_engine_for_java">Can I use Infinispan on Google App Engine for Java?</a></li> <li><a href="#when_running_on_glassfish_or_apache_creating_a_cache_throws_an_exception_saying_unable_to_construct_a_globalcomponentregistry_what_is_it_wrong">When running on Glassfish or Apache, creating a cache throws an exception saying "Unable to construct a GlobalComponentRegistry", what is it wrong?</a></li> </ul> </li> <li><a href="#marshalling_and_unmarshalling">2.9.12. Marshalling and Unmarshalling</a> <ul class="sectlevel4"> <li><a href="#best_practices_implementing_java_io_externalizable">Best practices implementing java.io.Externalizable</a></li> <li><a href="#do_externalizer_implementations_need_to_access_internal_externalizer_implementations">Do Externalizer implementations need to access internal Externalizer implementations?</a></li> <li><a href="#during_state_transfer_the_state_receiver_logs_an_eofexception_when_applying_state_saying_read_past_end_of_file_should_i_worry_about_this">During state transfer, the state receiver logs an EOFException when applying state saying "Read past end of file". Should I worry about this?</a></li> <li><a href="#why_am_i_getting_invalid_data_passed_to_readexternal">Why am I getting invalid data passed to readExternal?</a></li> </ul> </li> <li><a href="#tuning_questions">2.9.13. Tuning questions</a> <ul class="sectlevel4"> <li><a href="#when_running_infinispan_under_load_i_see_rejectedexecutionexception_how_can_i_fix_it">When running Infinispan under load, I see RejectedExecutionException, how can I fix it?</a></li> </ul> </li> <li><a href="#jndi_questions">2.9.14. JNDI questions</a> <ul class="sectlevel4"> <li><a href="#can_i_bind_cache_or_cachemanager_to_jndi">Can I bind Cache or CacheManager to JNDI?</a></li> </ul> </li> <li><a href="#hibernate_2nd_level_cache_questions">2.9.15. Hibernate 2nd Level Cache questions</a> <ul class="sectlevel4"> <li><a href="#can_i_use_infinispan_as_a_remote_jpa_or_hibernate_second_level_cache">Can I use Infinispan as a remote JPA or Hibernate second level cache?</a></li> <li><a href="#what_are_the_pitfalls_of_not_using_a_non_jta_transaction_factory_such_as_jdbctransactionfactory_with_hibernate_when_infinispan_is_used_as_2nd_level_cache_provider">What are the pitfalls of not using a non-JTA transaction factory such as JDBCTransactionFactory with Hibernate when Infinispan is used as 2nd level cache provider?</a></li> </ul> </li> <li><a href="#cache_server_questions">2.9.16. Cache Server questions</a> <ul class="sectlevel4"> <li><a href="#is_there_a_way_to_do_a_bulk_get_on_a_remote_cache">Is there a way to do a Bulk Get on a remote cache?</a></li> </ul> </li> <li><a href="#debugging_questions">2.9.17. Debugging questions</a> <ul class="sectlevel4"> <li><a href="#how_can_i_get_infinispan_to_show_the_full_byte_array_the_log_only_shows_partial_contents_of_byte_arrays">How can I get Infinispan to show the full byte array? The log only shows partial contents of byte arrays&#8230;&#8203;</a></li> </ul> </li> <li><a href="#clustering_transport_questions">2.9.18. Clustering Transport questions</a> <ul class="sectlevel4"> <li><a href="#how_do_i_retrieve_the_clustering_physical_address">How do I retrieve the clustering physical address?</a></li> </ul> </li> <li><a href="#security_questions">2.9.19. Security questions</a> <ul class="sectlevel4"> <li><a href="#using_kerberos_with_the_ibm_jdk">Using Kerberos with the IBM JDK</a></li> </ul> </li> </ul> </li> <li><a href="#2_phase_commit">2.10. 2-phase commit</a></li> <li><a href="#atomicity_consistency_isolation_durability_acid">2.11. Atomicity, Consistency, Isolation, Durability (ACID)</a></li> <li><a href="#basically_available_soft_state_eventually_consistent_base">2.12. Basically Available, Soft-state, Eventually-consistent (BASE)</a></li> <li><a href="#consistency_availability_and_partition_tolerance_cap_theorem">2.13. Consistency, Availability and Partition-tolerance (CAP) Theorem</a></li> <li><a href="#consistent_hash">2.14. Consistent Hash</a></li> <li><a href="#data_grid">2.15. Data grid</a></li> <li><a href="#deadlock">2.16. Deadlock</a></li> <li><a href="#distributed_hash_table_dht">2.17. Distributed Hash Table (DHT)</a></li> <li><a href="#externalizer">2.18. Externalizer</a></li> <li><a href="#hot_rod">2.19. Hot Rod</a></li> <li><a href="#in_memory_data_grid">2.20. In-memory data grid</a></li> <li><a href="#isolation_level">2.21. Isolation level</a></li> <li><a href="#jta_synchronization">2.22. JTA synchronization</a></li> <li><a href="#livelock">2.23. Livelock</a></li> <li><a href="#memcached">2.24. Memcached</a></li> <li><a href="#multiversion_concurrency_control_mvcc">2.25. Multiversion Concurrency Control (MVCC)</a></li> <li><a href="#near_cache">2.26. Near Cache</a></li> <li><a href="#network_partition">2.27. Network partition</a></li> <li><a href="#nosql">2.28. NoSQL</a></li> <li><a href="#optimistic_locking">2.29. Optimistic locking</a></li> <li><a href="#pessimistic_locking">2.30. Pessimistic locking</a></li> <li><a href="#read_committed">2.31. READ COMMITTED</a></li> <li><a href="#relational_database_management_system_rdbms">2.32. Relational Database Management System (RDBMS)</a></li> <li><a href="#repeatable_read">2.33. REPEATABLE READ</a></li> <li><a href="#representational_state_transfer_rest">2.34. Representational State Transfer (ReST)</a></li> <li><a href="#split_brain">2.35. Split brain</a></li> <li><a href="#structured_query_language_sql">2.36. Structured Query Language (SQL)</a></li> <li><a href="#write_behind">2.37. Write-behind</a></li> <li><a href="#write_skew">2.38. Write skew</a></li> <li><a href="#write_through">2.39. Write-through</a></li> <li><a href="#xa_resource">2.40. XA resource</a></li> <li><a href="#upgrading_from_9_4_to_10_0">2.41. Upgrading from 9.4 to 10.0</a> <ul class="sectlevel3"> <li><a href="#hot_rod_3_0">2.41.1. Hot Rod 3.0</a></li> <li><a href="#total_order_transaction_protocol_is_deprecated">2.41.2. Total Order transaction protocol is deprecated</a></li> <li><a href="#removed_the_infinispan_server_hotrod_workerthreads_system_property">2.41.3. Removed the infinispan.server.hotrod.workerThreads system property</a></li> <li><a href="#removed_atomicmap_and_finegrainedatomicmap">2.41.4. Removed AtomicMap and FineGrainedAtomicMap</a></li> <li><a href="#removed_delta_and_deltaaware">2.41.5. Removed Delta and DeltaAware</a></li> <li><a href="#removed_compatibility_mode">2.41.6. Removed compatibility mode</a></li> <li><a href="#removed_the_implicit_default_cache">2.41.7. Removed the implicit default cache</a></li> <li><a href="#removed_distributedexecutor">2.41.8. Removed DistributedExecutor</a></li> <li><a href="#removed_the_tree_module">2.41.9. Removed the Tree module</a></li> <li><a href="#the_jdbc_pooledconnectionfactory_now_utilises_agroal">2.41.10. The JDBC PooledConnectionFactory now utilises Agroal</a></li> <li><a href="#xml_configuration_changes">2.41.11. XML configuration changes</a></li> <li><a href="#remotecache_changes">2.41.12. RemoteCache Changes</a> <ul class="sectlevel4"> <li><a href="#the_getbulk_methods_have_been_removed">The getBulk methods have been removed</a></li> </ul> </li> <li><a href="#persistence_changes">2.41.13. Persistence changes</a></li> <li><a href="#clientserver_changes">2.41.14. Client/Server changes</a></li> <li><a href="#skip_listener_notification_flag">2.41.15. SKIP_LISTENER_NOTIFICATION flag</a></li> <li><a href="#performasync_header_removed_from_rest">2.41.16. performAsync header removed from REST</a></li> <li><a href="#default_jgroups_stacks_in_the_xml_configuration">2.41.17. Default JGroups stacks in the XML configuration</a></li> <li><a href="#jgroups_s3_ping_replaced_with_native_s3_ping">2.41.18. JGroups S3_PING replaced with NATIVE_S3_PING</a></li> <li><a href="#cache_and_cache_manager_listeners_can_now_be_configured_to_be_non_blocking">2.41.19. Cache and Cache Manager Listeners can now be configured to be non blocking</a></li> <li><a href="#distributed_streams_operations_no_longer_support_null_values">2.41.20. Distributed Streams operations no longer support null values</a></li> <li><a href="#removed_the_infinispan_cloud_module">2.41.21. Removed the infinispan-cloud module</a></li> <li><a href="#removed_experimental_flag_guaranteed_delivery">2.41.22. Removed experimental flag GUARANTEED_DELIVERY</a></li> <li><a href="#cache_health">2.41.23. Cache Health</a></li> <li><a href="#multi_tenancy">2.41.24. Multi-tenancy</a></li> <li><a href="#offheap_automatic_resizing">2.41.25. OffHeap Automatic Resizing</a></li> </ul> </li> <li><a href="#upgrading_from_9_3_to_9_4">2.42. Upgrading from 9.3 to 9.4</a> <ul class="sectlevel3"> <li><a href="#clientserver_changes_2">2.42.1. Client/Server changes</a> <ul class="sectlevel4"> <li><a href="#compatibility_mode_deprecation">Compatibility mode deprecation</a></li> <li><a href="#memcached_storage">Memcached storage</a></li> <li><a href="#scripts_response">Scripts Response</a></li> <li><a href="#websocket_endpoint_removal">WebSocket endpoint removal</a></li> <li><a href="#hot_rod_client_connection_pool_properties">Hot Rod client connection pool properties</a></li> <li><a href="#server_thread_pools">Server thread pools</a></li> </ul> </li> <li><a href="#persistence_changes_2">2.42.2. Persistence Changes</a> <ul class="sectlevel4"> <li><a href="#shared_and_passivation">Shared and Passivation</a></li> </ul> </li> <li><a href="#query_changes">2.42.3. Query changes</a> <ul class="sectlevel4"> <li><a href="#affinityindexmanager">AffinityIndexManager</a></li> </ul> </li> </ul> </li> <li><a href="#upgrading_from_9_2_to_9_3">2.43. Upgrading from 9.2 to 9.3</a> <ul class="sectlevel3"> <li><a href="#advancedcacheloader_changes">2.43.1. AdvancedCacheLoader changes</a></li> <li><a href="#partition_handling_configuration">2.43.2. Partition Handling Configuration</a></li> <li><a href="#stat_changes">2.43.3. Stat Changes</a></li> <li><a href="#event_log_changes">2.43.4. Event log changes</a></li> <li><a href="#max_idle_expiration_changes">2.43.5. Max Idle Expiration Changes</a></li> <li><a href="#wildfly_modules">2.43.6. Wildfly Modules</a></li> <li><a href="#deserialization_whitelist">2.43.7. Deserialization Whitelist</a></li> </ul> </li> <li><a href="#upgrading_from_9_0_to_9_1">2.44. Upgrading from 9.0 to 9.1</a> <ul class="sectlevel3"> <li><a href="#kubernetes_ping_changes">2.44.1. Kubernetes Ping changes</a></li> <li><a href="#stat_changes_2">2.44.2. Stat Changes</a></li> <li><a href="#finegrainedatomicmap_reimplemented">2.44.3. (FineGrained)AtomicMap reimplemented</a></li> <li><a href="#remotecache_keysetentrysetvalues">2.44.4. RemoteCache keySet/entrySet/values</a></li> <li><a href="#deltaaware_deprecated">2.44.5. DeltaAware deprecated</a></li> <li><a href="#infinispan_query_configuration">2.44.6. Infinispan Query Configuration</a></li> <li><a href="#store_batch_size_changes">2.44.7. Store Batch Size Changes</a></li> <li><a href="#partition_handling_changes">2.44.8. Partition Handling changes</a></li> </ul> </li> <li><a href="#upgrading_from_8_x_to_9_0">2.45. Upgrading from 8.x to 9.0</a> <ul class="sectlevel3"> <li><a href="#default_transaction_mode_changed">2.45.1. Default transaction mode changed</a></li> <li><a href="#removed_eagerlocking_and_eagerlockingsinglenode_configuration_settings">2.45.2. Removed eagerLocking and eagerLockingSingleNode configuration settings</a></li> <li><a href="#removed_async_transaction_support">2.45.3. Removed async transaction support</a></li> <li><a href="#deprecated_all_the_dummy_related_transaction_classes">2.45.4. Deprecated all the dummy related transaction classes.</a></li> <li><a href="#clustering_configuration_changes">2.45.5. Clustering configuration changes</a></li> <li><a href="#default_cache_changes">2.45.6. Default Cache changes</a></li> <li><a href="#marshalling_enhancements_and_store_compatibility">2.45.7. Marshalling Enhancements and Store Compatibility</a></li> <li><a href="#new_cloud_module_for_library_mode">2.45.8. New Cloud module for library mode</a></li> <li><a href="#entry_retriever_is_now_removed">2.45.9. Entry Retriever is now removed</a></li> <li><a href="#map_reduce_is_now_removed">2.45.10. Map / Reduce is now removed</a></li> <li><a href="#spring_4_support_is_now_removed">2.45.11. Spring 4 support is now removed</a></li> <li><a href="#function_classes_have_moved_packages">2.45.12. Function classes have moved packages</a></li> <li><a href="#segmentcompletionlistener_interface_has_moved">2.45.13. SegmentCompletionListener interface has moved</a></li> <li><a href="#spring_module_dependency_changes">2.45.14. Spring module dependency changes</a></li> <li><a href="#total_order_executor_is_now_removed">2.45.15. Total order executor is now removed</a></li> <li><a href="#hikaricp_is_now_the_default_implementation_for_jdbc_pooledconnectionfactory">2.45.16. HikariCP is now the default implementation for JDBC PooledConnectionFactory</a></li> <li><a href="#rocksdb_in_place_of_leveldb">2.45.17. RocksDB in place of LevelDB</a></li> <li><a href="#jdbc_mixed_and_binary_stores_removed">2.45.18. JDBC Mixed and Binary stores removed</a></li> <li><a href="#store_annotation_introduced">2.45.19. @Store Annotation Introduced</a></li> <li><a href="#server_authentication_changes">2.45.20. Server authentication changes</a></li> <li><a href="#package_org_infinispan_util_concurrent_jdk8backported_has_been_removed">2.45.21. Package org.infinispan.util.concurrent.jdk8backported has been removed</a> <ul class="sectlevel4"> <li><a href="#moved_classes">Moved classes</a></li> <li><a href="#removed_classes">Removed classes</a></li> </ul> </li> <li><a href="#store_as_binary_is_deprecated">2.45.22. Store as Binary is deprecated</a></li> <li><a href="#datacontainer_collection_methods_are_deprecated">2.45.23. DataContainer collection methods are deprecated</a></li> </ul> </li> <li><a href="#upgrading_from_8_1_to_8_2">2.46. Upgrading from 8.1 to 8.2</a> <ul class="sectlevel3"> <li><a href="#entry_retriever_is_deprecated">2.46.1. Entry Retriever is deprecated</a></li> <li><a href="#map_reduce_is_deprecated">2.46.2. Map / Reduce is deprecated</a></li> </ul> </li> <li><a href="#upgrading_from_8_x_to_8_1">2.47. Upgrading from 8.x to 8.1</a> <ul class="sectlevel3"> <li><a href="#packaging_changes">2.47.1. Packaging changes</a> <ul class="sectlevel4"> <li><a href="#cdi_module_split">CDI module split</a></li> <li><a href="#spring_module_split">Spring module split</a></li> </ul> </li> <li><a href="#spring_3_support_is_deprecated">2.47.2. Spring 3 support is deprecated</a></li> </ul> </li> <li><a href="#upgrading_from_7_x_to_8_0">2.48. Upgrading from 7.x to 8.0</a> <ul class="sectlevel3"> <li><a href="#configuration_changes">2.48.1. Configuration changes</a> <ul class="sectlevel4"> <li><a href="#removal_of_async_marshalling">Removal of Async Marshalling</a></li> <li><a href="#reenabling_of_isolation_level_configurations_in_server">Reenabling of isolation level configurations in server</a></li> <li><a href="#subsystem_renaming_in_server">Subsystem renaming in server</a></li> <li><a href="#server_domain_mode">Server domain mode</a></li> </ul> </li> </ul> </li> <li><a href="#upgrading_from_6_0_to_7_0">2.49. Upgrading from 6.0 to 7.0</a> <ul class="sectlevel3"> <li><a href="#api_changes">2.49.1. API Changes</a> <ul class="sectlevel4"> <li><a href="#cache_loader">Cache Loader</a></li> <li><a href="#cache_writer">Cache Writer</a></li> <li><a href="#filters">Filters</a></li> </ul> </li> <li><a href="#declarative_configuration">2.49.2. Declarative configuration</a></li> </ul> </li> <li><a href="#upgrading_from_5_3_to_6_0">2.50. Upgrading from 5.3 to 6.0</a> <ul class="sectlevel3"> <li><a href="#declarative_configuration_2">2.50.1. Declarative configuration</a></li> <li><a href="#deprecated_api_removal">2.50.2. Deprecated API removal</a></li> </ul> </li> <li><a href="#upgrading_from_5_2_to_5_3">2.51. Upgrading from 5.2 to 5.3</a> <ul class="sectlevel3"> <li><a href="#declarative_configuration_3">2.51.1. Declarative configuration</a></li> </ul> </li> <li><a href="#upgrading_from_5_1_to_5_2">2.52. Upgrading from 5.1 to 5.2</a> <ul class="sectlevel3"> <li><a href="#declarative_configuration_4">2.52.1. Declarative configuration</a></li> <li><a href="#transaction">2.52.2. Transaction</a></li> <li><a href="#cache_loader_and_store_configuration">2.52.3. Cache Loader and Store configuration</a></li> <li><a href="#virtual_nodes_and_segments">2.52.4. Virtual Nodes and Segments</a></li> </ul> </li> <li><a href="#upgrading_from_5_0_to_5_1">2.53. Upgrading from 5.0 to 5.1</a> <ul class="sectlevel3"> <li><a href="#api">2.53.1. API</a></li> <li><a href="#eviction_and_expiration">2.53.2. Eviction and Expiration</a></li> <li><a href="#transactions">2.53.3. Transactions</a></li> <li><a href="#state_transfer">2.53.4. State transfer</a></li> <li><a href="#configuration_2">2.53.5. Configuration</a></li> <li><a href="#flags_and_classloaders">2.53.6. Flags and ClassLoaders</a></li> <li><a href="#jgroups_bind_address">2.53.7. JGroups Bind Address</a></li> </ul> </li> </ul> </li> </ul> </div> </div> <div id="content"> <div class="sect1"> <h2 id="introduction"><a class="anchor" href="#introduction"></a>1. Introduction</h2> <div class="sectionbody"> <div class="paragraph"> <p>Welcome to the official Infinispan documentation. This comprehensive document will guide you through every last detail of Infinispan. Because of this, it can be a poor starting point if you are new to Infinispan.</p> </div> <div class="sect2"> <h3 id="what_is_infinispan"><a class="anchor" href="#what_is_infinispan"></a>1.1. What is Infinispan ?</h3> <div class="paragraph"> <p>Infinispan is a distributed in-memory key/value data store with optional schema, available under the Apache License 2.0. It can be used both as an embedded Java library and as a language-independent service accessed remotely over a variety of protocols (Hot Rod, REST, Memcached and WebSockets). It offers advanced functionality such as transactions, events, querying and distributed processing as well as numerous integrations with frameworks such as the JCache API standard, CDI, Hibernate, WildFly, Spring Cache, Spring Session, Lucene, Spark and Hadoop.</p> </div> </div> <div class="sect2"> <h3 id="why_use_infinispan"><a class="anchor" href="#why_use_infinispan"></a>1.2. Why use Infinispan ?</h3> <div class="sect3"> <h4 id="as_a_local_cache"><a class="anchor" href="#as_a_local_cache"></a>1.2.1. As a local cache</h4> <div class="paragraph"> <p>The primary use for Infinispan is to provide a fast in-memory cache of frequently accessed data. Suppose you have a slow data source (database, web service, text file, etc): you could load some or all of that data in memory so that it&#8217;s just a memory access away from your code. Using Infinispan is better than using a simple ConcurrentHashMap, since it has additional useful features such as expiration and eviction.</p> </div> </div> <div class="sect3"> <h4 id="as_a_clustered_cache"><a class="anchor" href="#as_a_clustered_cache"></a>1.2.2. As a clustered cache</h4> <div class="paragraph"> <p>If your data doesn&#8217;t fit in a single node, or you want to invalidate entries across multiple instances of your application, Infinispan can scale horizontally to several hundred nodes.</p> </div> </div> <div class="sect3"> <h4 id="as_a_clustering_building_block_for_your_applications"><a class="anchor" href="#as_a_clustering_building_block_for_your_applications"></a>1.2.3. As a clustering building block for your applications</h4> <div class="paragraph"> <p>If you need to make your application cluster-aware, integrate Infinispan and get access to features like topology change notifications, cluster communication and clustered execution.</p> </div> </div> <div class="sect3"> <h4 id="as_a_remote_cache"><a class="anchor" href="#as_a_remote_cache"></a>1.2.4. As a remote cache</h4> <div class="paragraph"> <p>If you want to be able to scale your caching layer independently from your application, or you need to make your data available to different applications, possibly even using different languages / platforms, use Infinispan Server and its various clients.</p> </div> </div> <div class="sect3"> <h4 id="as_a_data_grid"><a class="anchor" href="#as_a_data_grid"></a>1.2.5. As a data grid</h4> <div class="paragraph"> <p>Data you place in Infinispan doesn&#8217;t have to be temporary: use Infinispan as your primary store and use its powerful features such as transactions, notifications, queries, distributed execution, distributed streams, analytics to process data quickly.</p> </div> </div> <div class="sect3"> <h4 id="as_a_geographical_backup_for_your_data"><a class="anchor" href="#as_a_geographical_backup_for_your_data"></a>1.2.6. As a geographical backup for your data</h4> <div class="paragraph"> <p>Infinispan supports replication between clusters, allowing you to backup your data across geographically remote sites.</p> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="arch_overview"><a class="anchor" href="#arch_overview"></a>2. Architectural Overview</h2> <div class="sectionbody"> <div class="paragraph"> <p>This section contains a high level overview of Infinispan&#8217;s internal architecture. This document is geared towards people with an interest in extending or enhancing Infinispan, or just curious about Infinispans internals.</p> </div> <div class="sect2"> <h3 id="cache_hierarchy"><a class="anchor" href="#cache_hierarchy"></a>2.1. Cache hierarchy</h3> <div class="paragraph"> <p>Infinispan&#8217;s Cache interface extends the JRE&#8217;s ConcurrentMap interface which provides for a familiar and easy-to-use API.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">Cache</span>&lt;K, V&gt; <span class="directive">extends</span> BasicCache&lt;K, V&gt; {
 ...
}

<span class="directive">public</span> <span class="type">interface</span> <span class="class">BasicCache</span>&lt;K, V&gt; <span class="directive">extends</span> <span class="predefined-type">ConcurrentMap</span>&lt;K, V&gt; {
 ...
}</code></pre> </div> </div> <div class="paragraph"> <p>Caches are created by using a CacheContainer instance - either the EmbeddedCacheManager or a RemoteCacheManager. In addition to their capabilities as a factory for Caches, CacheContainers also act as a registry for looking up Caches.</p> </div> <div class="paragraph"> <p>EmbeddedCacheManagers create either clustered or standalone Caches that reside in the same JVM. RemoteCacheManagers, on the other hand, create RemoteCaches that connect to a remote cache tier via the Hot Rod protocol.</p> </div> </div> <div class="sect2"> <h3 id="arch_commands"><a class="anchor" href="#arch_commands"></a>2.2. Commands</h3> <div class="paragraph"> <p>Internally, each and every cache operation is encapsulated by a command. These command objects represent the type of operation being performed, and also hold references to necessary parameters. The actual logic of a given command, for example a ReplaceCommand, is encapsulated in the commands perform() method. Very object-oriented and easy to test.</p> </div> <div class="paragraph"> <p>All of these commands implement the VisitableCommand interface which allow a Visitor (described in next section) to process them accordingly.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">PutKeyValueCommand</span> <span class="directive">extends</span> VisitableCommand {
  ...
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">GetKeyValueCommand</span> <span class="directive">extends</span> VisitableCommand {
  ...
}

... etc ...</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="visitors"><a class="anchor" href="#visitors"></a>2.3. Visitors</h3> <div class="paragraph"> <p>Commands are processed by the various Visitors. The visitor interface, displayed below, exposes methods to visit each of the different types of commands in the system. This gives us a type-safe mechanism for adding behaviour to a call. Commands are processed by `Visitor`s. The visitor interface, displayed below, exposes methods to visit each of the different types of commands in the system. This gives us a type-safe mechanism for adding behaviour to a call.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">Vistor</span> {
   <span class="predefined-type">Object</span> visitPutKeyValueCommand(InvocationContext ctx, PutKeyValueCommand command) <span class="directive">throws</span> <span class="predefined-type">Throwable</span>;

   <span class="predefined-type">Object</span> visitRemoveCommand(InvocationContext ctx, RemoveCommand command) <span class="directive">throws</span> <span class="predefined-type">Throwable</span>;

   <span class="predefined-type">Object</span> visitReplaceCommand(InvocationContext ctx, ReplaceCommand command) <span class="directive">throws</span> <span class="predefined-type">Throwable</span>;

   <span class="predefined-type">Object</span> visitClearCommand(InvocationContext ctx, ClearCommand command) <span class="directive">throws</span> <span class="predefined-type">Throwable</span>;

   <span class="predefined-type">Object</span> visitPutMapCommand(InvocationContext ctx, PutMapCommand command) <span class="directive">throws</span> <span class="predefined-type">Throwable</span>;

   ... etc ...
}</code></pre> </div> </div> <div class="paragraph"> <p>An <code>AbstractVisitor</code> class in the <code>org.infinispan.commands</code> package is provided with no-op implementations of each of these methods. Real implementations then only need override the visitor methods for the commands that interest them, allowing for very concise, readable and testable visitor implementations.</p> </div> </div> <div class="sect2"> <h3 id="interceptors"><a class="anchor" href="#interceptors"></a>2.4. Interceptors</h3> <div class="paragraph"> <p>Interceptors are special types of Visitors, which are capable of visiting commands, but also acts in a chain. A chain of interceptors all visit the command, one in turn, until all registered interceptors visit the command.</p> </div> <div class="paragraph"> <p>The class to note is the <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/interceptors/base/CommandInterceptor.html">CommandInterceptor</a>. This abstract class implements the interceptor pattern, and also implements Visitor. Infinispan&#8217;s interceptors extend CommandInterceptor, and these add specific behaviour to specific commands, such as distribution across a network or writing through to disk.</p> </div> <div class="paragraph"> <p>There is also an experimental asynchronous interceptor which can be used. The interface used for asynchronous interceptors is <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/interceptors/AsyncInterceptor.html">AsyncInterceptor</a> and a base implementation which should be used when a custom implementation is desired <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/interceptors/BaseCustomAsyncInterceptor.html">BaseCustomAsyncInterceptor</a>. Note this class also implements the <code>Visitor</code> interface.</p> </div> </div> <div class="sect2"> <h3 id="putting_it_all_together"><a class="anchor" href="#putting_it_all_together"></a>2.5. Putting it all together</h3> <div class="paragraph"> <p>So how does this all come together? Invocations on the cache cause the cache to first create an invocation context for the call. Invocation contexts contain, among other things, transactional characteristics of the call. The cache then creates a command for the call, making use of a command factory which initialises the command instance with parameters and references to other subsystems.</p> </div> <div class="paragraph"> <p>The cache then passes the invocation context and command to the InterceptorChain, which calls each and every registered interceptor in turn to visit the command, adding behaviour to the call. Finally, the commands perform() method is invoked and the return value, if any, is propagated back to the caller.</p> </div> </div> <div class="sect2"> <h3 id="subsystem_managers"><a class="anchor" href="#subsystem_managers"></a>2.6. Subsystem Managers</h3> <div class="paragraph"> <p>The interceptors act as simple interception points and dont contain a lot of logic themselves. Most behavioural logic is encapsulated as managers in various subsystems, a small subset of which are:</p> </div> <div class="sect3"> <h4 id="distributionmanager"><a class="anchor" href="#distributionmanager"></a>2.6.1. DistributionManager</h4> <div class="paragraph"> <p>Manager that controls how entries are distributed across the cluster.</p> </div> </div> <div class="sect3"> <h4 id="transactionmanager"><a class="anchor" href="#transactionmanager"></a>2.6.2. TransactionManager</h4> <div class="paragraph"> <p>Manager than handles transactions, usually supplied by a third party.</p> </div> </div> <div class="sect3"> <h4 id="rpcmanager"><a class="anchor" href="#rpcmanager"></a>2.6.3. RpcManager</h4> <div class="paragraph"> <p>Manager that handles replicating commands between nodes in the cluster.</p> </div> </div> <div class="sect3"> <h4 id="lockmanager"><a class="anchor" href="#lockmanager"></a>2.6.4. LockManager</h4> <div class="paragraph"> <p>Manager that handles locking keys when operations require them.</p> </div> </div> <div class="sect3"> <h4 id="persistencemanager"><a class="anchor" href="#persistencemanager"></a>2.6.5. PersistenceManager</h4> <div class="paragraph"> <p>Manager that handles persisting data to any configured cache stores.</p> </div> </div> <div class="sect3"> <h4 id="datacontainer"><a class="anchor" href="#datacontainer"></a>2.6.6. DataContainer</h4> <div class="paragraph"> <p>Container that holds the actual in memory entries.</p> </div> </div> <div class="sect3"> <h4 id="configuration"><a class="anchor" href="#configuration"></a>2.6.7. Configuration</h4> <div class="paragraph"> <p>A component detailing all of the configuration in this cache.</p> </div> </div> </div> <div class="sect2"> <h3 id="componentregistry"><a class="anchor" href="#componentregistry"></a>2.7. ComponentRegistry</h3> <div class="paragraph"> <p>A registry where the various managers above and components are created and stored for use in the cache. All of the other managers and crucial components are accessible through the registry.</p> </div> <div class="paragraph"> <p>The registry itself is a lightweight dependency injection framework, allowing components and managers to reference and initialise one another. Here is an example of a component declaring a dependency on a DataContainer and a Configuration, and a DataContainerFactory declaring its ability to construct DataContainers on the fly.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Inject</span>
<span class="directive">public</span> <span class="type">void</span> injectDependencies(DataContainer container, <span class="predefined-type">Configuration</span> configuration) {
   <span class="local-variable">this</span>.container = container;
   <span class="local-variable">this</span>.configuration = configuration;
}

<span class="annotation">@DefaultFactoryFor</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">DataContainerFactory</span> <span class="directive">extends</span> AbstractNamedCacheComponentFactory {</code></pre> </div> </div> <div class="paragraph"> <p>Components registered with the ComponentRegistry may also have a lifecycle, and methods annotated with @Start or @Stop will be invoked before and after they are used by the component registry.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Start</span>
<span class="directive">public</span> <span class="type">void</span> init() {
   useWriteSkewCheck = configuration.locking().writeSkewCheck();
}

<span class="annotation">@Stop</span>(priority=<span class="integer">20</span>)
<span class="directive">public</span> <span class="type">void</span> stop() {
   notifier.removeListener(listener);
   executor.shutdownNow();
}</code></pre> </div> </div> <div class="paragraph"> <p>In the example above, the optional priority parameter to @Stop is used to indicate the order in which the component is stopped, in relation to other components. This follows a Unix Sys-V style ordering, where smaller priority methods are called before higher priority ones. The default priority, if not specified, is 10.</p> </div> <div class="paragraph"> <p>Welcome to Infinispan&#8217;s Frequently Asked Questions document. We hope you find the answers to your queries here, however if you don&#8217;t, we encourage you to connect with the Infinispan community and ask any questions you may have on the <a href="http://www.infinispan.org/community">Infinispan User Forums</a>.</p> </div> </div> <div class="sect2"> <h3 id="project_questions"><a class="anchor" href="#project_questions"></a>2.8. Project questions</h3> <div class="sect3"> <h4 id="what_is_infinispan_2"><a class="anchor" href="#what_is_infinispan_2"></a>2.8.1. What is Infinispan?</h4> <div class="paragraph"> <p>Infinispan is an open source data grid platform. It exposes a <a href="http://jcp.org/en/jsr/detail?id=107">JSR-107</a> compatible <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/Cache.html"><code>Cache</code></a> interface (which in turn extends <code>java.util.Map</code>) in which you can store objects. While Infinispan can be run in local mode, its real value is in distributed mode where caches cluster together and expose a large memory heap. Distributed mode is more powerful than simple replication since each data entry is spread out only to a fixed number of replicas thus providing resilience to server failures as well as scalability since the work done to store each entry is constant in relation to a cluster size.</p> </div> <div class="paragraph"> <p>So, why would you use it? Infinispan offers:</p> </div> <div class="ulist"> <ul> <li> <p><em>Massive heap</em> and <em>high availability</em> - If you have 100 blade servers, and each node has 2GB of space to dedicate to a replicated cache, you end up with 2 GB of total data. Every server is just a copy. On the other hand, with a distributed grid - assuming you want 1 copy per data item - you get a 100 GB memory backed virtual heap that is efficiently accessible from anywhere in the grid. If a server fails, the grid simply creates new copies of the lost data, and puts them on other servers. Applications looking for ultimate performance are no longer forced to delegate the majority of their data lookups to a large single database server - a bottleneck that exists in over 80% of enterprise applications!</p> </li> <li> <p><em>Scalability</em> - Since data is evenly distributed there is essentially no major limit to the size of the grid, except group communication on the network - which is minimised to just discovery of new nodes. All data access patterns use peer-to-peer communication where nodes directly speak to each other, which scales very well. Infinispan does not require entire infrastructure shutdown to allow scaling up or down. Simply add/remove machines to your cluster without incurring any down-time.</p> </li> <li> <p><em>Data distribution</em> - Infinispan uses consistent hash algorithm to determine where keys should be located in the cluster. Consistent hashing allows for cheap, fast and above all, deterministic location of keys with no need for further metadata or network traffic. The goal of data distribution is to maintain enough copies of state in the cluster so it can be durable and fault tolerant, but not too many copies to prevent Infinispan from being scalable.</p> </li> <li> <p><em>Persistence</em> - Infinispan exposes a CacheStore interface, and several high-performance implementations - including JDBC cache stores, lesystem-based cache stores, Amazon S3 cache stores, etc. CacheStores can be used for "warm starts", or simply to ensure data in the grid survives complete grid restarts, or even to overow to disk if you really do run out of memory.</p> </li> <li> <p><em>Language bindings</em> (PHP, Python, Ruby, C, etc.) - Infinispan offers support for both the popular memcached protocol - with existing clients for almost every popular programming language - as well as an optimised Infinispan-specific protocol called Hot Rod. This means that Infinispan is not just useful to Java. Any major website or application that wants to take advantage of a fast data grid will be able to do so.</p> </li> <li> <p><em>Management</em> - When you start thinking about running a grid on several hundred servers, management is no longer an extra, it becomes a necessity. Since version 8.0, Infinispan bundles a management console.</p> </li> <li> <p><em>Support for Compute Grids</em> - Infinispan 5 adds the ability to pass a Runnable around the grid. This allows you to push complex processing towards the server where data is local, and pull back results using a Future. This map/reduce style paradigm is common in applications where a large amount of data is needed to compute relatively small results.</p> </li> </ul> </div> <div class="paragraph"> <p>Also see <a href="http://www.infinispan.org/about">this page</a> on the Infinispan website.</p> </div> </div> <div class="sect3"> <h4 id="what_would_i_use_infinispan_for"><a class="anchor" href="#what_would_i_use_infinispan_for"></a>2.8.2. What would I use Infinispan for?</h4> <div class="paragraph"> <p>Most people use Infinispan for one of two reasons. Firstly, as a distributed cache. Putting Infinispan in front of your database, disk-based NoSQL store or any part of your system that is a bottleneck can greatly help improve performance. Often, a simple cache isn&#8217;t enough - for example if your application is clustered and cache coherency is important to data consistency. A distributed cache can greatly help here.</p> </div> <div class="paragraph"> <p>The other major use-case is as a NoSQL data store. In addition to being in memory, Infinispan can also persist data to a more permanent store. We call this a cache store. Cache stores are pluggable, you can easily write your own, and many already exist for you to use.</p> </div> <div class="paragraph"> <p>A less common use case is adding clusterability and high availability to frameworks. Since Infinispan exposes a distributed data structure, frameworks and libraries that also need to be clustered can easily achieve this by embedding Infinispan and delegating all state management to Infinispan. This way, any framework can easily be clustered by letting Infinispan do all the heavy lifting.</p> </div> </div> <div class="sect3"> <h4 id="how_is_infinispan_related_to_jboss_cache"><a class="anchor" href="#how_is_infinispan_related_to_jboss_cache"></a>2.8.3. How is Infinispan related to JBoss Cache?</h4> <div class="paragraph"> <p>Certain design ideas and indeed some code have been borrowed from <a href="http://www.jboss.org/jbosscache/">JBoss Cache</a> 3.x, however JBoss Cache is in no way a dependency. Infinispan is a complete, separate and standalone project. Some may consider this a fork, but the people behind Infinispan and JBoss Cache see it as an evolution, since all future effort will be on Infinispan and not JBoss Cache.</p> </div> </div> <div class="sect3"> <h4 id="what_version_of_java_does_infinispan_need_to_run_does_infinispan_need_an_application_server_to_run"><a class="anchor" href="#what_version_of_java_does_infinispan_need_to_run_does_infinispan_need_an_application_server_to_run"></a>2.8.4. What version of Java does Infinispan need to run? Does Infinispan need an application server to run?</h4> <div class="paragraph"> <p>All that is needed is a Java 8 compatible JVM. An application server is <em>not</em> a requirement.</p> </div> </div> <div class="sect3"> <h4 id="will_there_be_a_pojo_cache_replacement_in_infinispan"><a class="anchor" href="#will_there_be_a_pojo_cache_replacement_in_infinispan"></a>2.8.5. Will there be a POJO Cache replacement in Infinispan?</h4> <div class="paragraph"> <p>Yes, and this is called <a href="http://hibernate.org/ogm/">Hibernate OGM</a> .</p> </div> </div> <div class="sect3"> <h4 id="how_come_infinispans_first_release_is_4_0_0_this_sounds_weird"><a class="anchor" href="#how_come_infinispans_first_release_is_4_0_0_this_sounds_weird"></a>2.8.6. How come Infinispan's first release is 4.0.0? This sounds weird!</h4> <div class="paragraph"> <p>We didn&#8217;t want to release Infinispan as a 1.0, as in all fairness it is not a virgin codebase. A lot of the code, designs and ideas in Infinispan are from JBoss Cache, and has been tried and tested, proven in high stress environments. Infinispan should thus be viewed as a mature and stable platform and not a new, experimental one.</p> </div> </div> <div class="sect3"> <h4 id="how_is_this_related_to_jsr_107_the_jcache_specification"><a class="anchor" href="#how_is_this_related_to_jsr_107_the_jcache_specification"></a>2.8.7. How is this related to JSR 107, the JCACHE specification?</h4> <div class="paragraph"> <p>Infinispan core engineers are on the <a href="http://jcp.org/en/jsr/detail?id=107">JSR 107</a> expert group and starting with version 7.0.0, Infinispan provides a certified compatible implementation of version 1.0.0 of the specification.</p> </div> </div> <div class="sect3"> <h4 id="can_i_use_infinispan_with_hibernate"><a class="anchor" href="#can_i_use_infinispan_with_hibernate"></a>2.8.8. Can I use Infinispan with Hibernate?</h4> <div class="paragraph"> <p>Yes, you can combine one or more of these integrations in the same application:</p> </div> <div class="ulist"> <ul> <li> <p><em>Using Infinispan as a database replacement</em>: using Hibernate OGM you can replace the RDBMS and store your entities and relations directly in Infinispan, interacting with it through the well known JPA 2.1 interface, with some limitations in the query capabilities. Hibernate OGM also automates mapping, encoding and decoding of JPA entities to Protobuf. For more details see <a href="http://hibernate.org/ogm/">Hibernate OGM</a> .</p> </li> <li> <p><em>Caching database access</em>: Hibernate can cache frequently loaded entities and queries in Infinispan, taking advantage of state of the art eviction algorithms, and clustering if needed but it provides a good performance boost in non-clustered deployments too.</p> </li> <li> <p><em>Storing Lucene indexes</em>: When using Hibernate Search to provide full-text capabilities to your Hibernate/JPA enabled application, you need to store an Apache Lucene index separately from the database. You can store the index in Infinispan: this is ideal for clustered applications since it&#8217;s otherwise tricky to share the index with correct locking on shared file systems, but is an interesting option for non-clustered deployments as well as it can combine the benefits of in-memory performance with reliability and write-through to any CacheStore supported by Infinispan.</p> </li> <li> <p><em>Using full-text queries on Infinispan</em>: If you liked the powerful full-text and data mining capabilities of Hibernate Search, but don&#8217;t need JPA or a database, you can use the indexing and query engine only: the Infinispan Query module reuses Hibernate Search internally, depending on some Hibernate libraries but exposing the Search capabilities only.</p> </li> <li> <p>A <em>combination of multiple such integrations</em>: you can use Hibernate OGM as an interface to perform CRUD operations on some Infinispan caches configured for resiliency, while also activating Hibernate 2nd level caching using some different caches configured for high performance read mostly access, and also use Hibernate Search to index your domain model while storing the indexes in Infinispan itself.</p> </li> </ul> </div> </div> </div> <div class="sect2"> <h3 id="technical_questions"><a class="anchor" href="#technical_questions"></a>2.9. Technical questions</h3> <div class="sect3"> <h4 id="general_questions"><a class="anchor" href="#general_questions"></a>2.9.1. General questions</h4> <div class="sect4"> <h5 id="what_apis_does_infinispan_offer"><a class="anchor" href="#what_apis_does_infinispan_offer"></a>What APIs does Infinispan offer?</h5> <div class="paragraph"> <p>Infinispan&#8217;s primary API - <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/Cache.html"><code>org.infinispan.Cache</code></a> - extends <code>java.util.concurrent.ConcurrentMap</code> and closely resembles <code>javax.cache.Cache</code> from <a href="http://jcp.org/en/jsr/detail?id=107">JSR 107</a>. This is the most performant API to use, and should be used for all new projects.</p> </div> </div> <div class="sect4"> <h5 id="which_jvms_jdks_does_infinispan_work_with"><a class="anchor" href="#which_jvms_jdks_does_infinispan_work_with"></a>Which JVMs (JDKs) does Infinispan work with?</h5> <div class="paragraph"> <p>Infinispan is developed and primarily tested against Oracle Java SE 8. It should work with most Java SE 8 implementations, including those from IBM, HP, Apple, Oracle, and OpenJDK.</p> </div> </div> <div class="sect4"> <h5 id="does_infinispan_store_data_by_value_or_by_reference"><a class="anchor" href="#does_infinispan_store_data_by_value_or_by_reference"></a>Does Infinispan store data by value or by reference?</h5> <div class="paragraph"> <p>By default, Infinispan stores data by reference. So once clients store some data, clients can still modify entries via original object references. This means that since client references are valid, clients can make changes to entries in the cache using those references, but these modifications are only local and you still need to call one of the cache&#8217;s put/replace&#8230;&#8203; methods in order for changes to replicate.</p> </div> <div class="paragraph"> <p>Obviously, allowing clients to modify cache contents directly, without any cache invocation, has some risks and that&#8217;s why Infinispan offers the possibility to store data by value instead. The way store-by-value is enabled is by enabling Infinispan to store data in binary format and forcing it to do these binary transformations eagerly.</p> </div> <div class="paragraph"> <p>The reason Infinispan stores data by-reference instead of by-value is performance. Storing data by reference is quicker than doing it by value because it does not have the penalty of having to transform keys and values into their binary format.</p> </div> </div> <div class="sect4"> <h5 id="can_i_use_infinispan_with_groovy_what_about_jython_clojure_jruby_or_scala_etc"><a class="anchor" href="#can_i_use_infinispan_with_groovy_what_about_jython_clojure_jruby_or_scala_etc"></a>Can I use Infinispan with Groovy? What about Jython, Clojure, JRuby or Scala etc.?</h5> <div class="paragraph"> <p>While we haven&#8217;t extensively tested Infinispan on anything other than Java, there is no reason why it cannot be used in any other environment that sits atop a JVM. We encourage you to try, and we&#8217;d love to hear your experiences on using Infinispan from other JVM languages.</p> </div> </div> </div> <div class="sect3"> <h4 id="cache_loader_and_cache_store_questions"><a class="anchor" href="#cache_loader_and_cache_store_questions"></a>2.9.2. Cache Loader and Cache Store questions</h4> <div class="sect4"> <h5 id="are_modifications_to_asynchronous_cache_stores_coalesced_or_aggregated"><a class="anchor" href="#are_modifications_to_asynchronous_cache_stores_coalesced_or_aggregated"></a>Are modifications to asynchronous cache stores coalesced or aggregated?</h5> <div class="paragraph"> <p>Modifications are coalesced or aggregated for the interval that the modification processor thread is currently applying. This means that while changes are being queued, if multiple modifications are made to the same key, only the key&#8217;s last state will be applied, hence reducing the number of calls to the cache store.</p> </div> </div> <div class="sect4"> <h5 id="what_does_the_passivation_flag_do"><a class="anchor" href="#what_does_the_passivation_flag_do"></a>What does the passivation flag do?</h5> <div class="paragraph"> <p>Passivation is a mode of storing entries in the cache store <em>only when</em> they are evicted from memory. The benefit of this approach is to prevent a lot of expensive writes to the cache store if an entry is hot (frequently used) and hence <em>not</em> evicted from memory. The reverse process, known as <em>activation</em>, occurs when a thread attempts to access an entry which is <em>not</em> in memory but is in the store (i.e., a <em>passivated</em> entry). Activation involves loading the entry into memory, and then <em>removing</em> it from the cache store. With passivation enabled, the cache uses the cache store as an overflow tank, akin to <a href="http://en.wikipedia.org/wiki/Paging">swapping memory pages to disk</a> in <a href="http://en.wikipedia.org/wiki/Virtual_memory">virtual memory</a> implementations in operating systems.</p> </div> <div class="paragraph"> <p>If passivation is disabled, the cache store behaves as a write-through (or write-behind if asynchronous) cache, where all entries in memory are also maintained in the cache store. The effect of this is that the cache store will always contain a superset of what is in memory.</p> </div> </div> <div class="sect4"> <h5 id="what_if_i_get_ioexception_unsupported_protocol_version_48_with_jdbcstringbasedcachestore"><a class="anchor" href="#what_if_i_get_ioexception_unsupported_protocol_version_48_with_jdbcstringbasedcachestore"></a>What if I get IOException "Unsupported protocol version 48" with JdbcStringBasedCacheStore?</h5> <div class="paragraph"> <p>You have probably set your data column type to <code>VARCHAR</code>, <code>CLOB</code> or something similar, but it should be <code>BLOB/VARBINARY</code>. Even though it&#8217;s called <code>JdbcStringBasedCacheStore</code>, only the keys are required to be strings; the values can be anything, so they need to be stored in a binary column. See the <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/loaders/jdbc/AbstractNonDelegatingJdbcCacheStoreConfig.html#setDataColumnType%28java.lang.String%29">setDataColumnType javadoc</a> for more details.</p> </div> </div> <div class="sect4"> <h5 id="is_there_any_way_i_can_boost_cache_stores_performance"><a class="anchor" href="#is_there_any_way_i_can_boost_cache_stores_performance"></a>Is there any way I can boost cache store&#8217;s performance?</h5> <div class="paragraph"> <p>If, for put operations, you don&#8217;t need the previous values existing in the cache/store then the following optimisation can be made:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java">cache.getAdvancedCache().withFlags(Flag.SKIP_CACHE_LOAD).put(key, value);</code></pre> </div> </div> <div class="paragraph"> <p>Note that in this case the value returned by <code>cache.put()</code> is not reliable. This optimization skips a cache store read and can have very significant performance improvement effects.</p> </div> </div> </div> <div class="sect3"> <h4 id="locking_and_transaction_questions"><a class="anchor" href="#locking_and_transaction_questions"></a>2.9.3. Locking and Transaction questions</h4> <div class="sect4"> <h5 id="does_infinispan_support_distributed_eager_locking"><a class="anchor" href="#does_infinispan_support_distributed_eager_locking"></a>Does Infinispan support distributed eager locking?</h5> <div class="paragraph"> <p>Yes it does. By default, transactions are optimistic, and locks are only acquired during the prepare phase. However, Infinispan can be configured to lock cache keys eagerly, by using the pessimistic locking mode:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java">ConfigurationBuilder builder = <span class="keyword">new</span> ConfigurationBuilder();
builder.transaction().lockingMode(LockingMode.PESSIMISTIC);</code></pre> </div> </div> <div class="paragraph"> <p>With pessimistic locking, Infinispan will implicitly acquire locks when a transaction modifies one or more keys:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java">tm.begin()
cache.put(K,V)    <span class="comment">// acquire cluster-wide lock on K</span>
cache.put(K2,V2)  <span class="comment">// acquire cluster-wide lock on K2</span>
cache.put(K,V5)   <span class="comment">// no-op, we already own cluster wide lock for K</span>
tm.commit()       <span class="comment">// releases locks</span></code></pre> </div> </div> </div> <div class="sect4"> <h5 id="how_does_infinispan_support_explicit_eager_locking"><a class="anchor" href="#how_does_infinispan_support_explicit_eager_locking"></a>How does Infinispan support explicit eager locking?</h5> <div class="paragraph"> <p>When the cache is configured with pessimistic locking, the <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/AdvancedCache.html#lock-K&#8230;&#8203;-"><code>lock(K&#8230;&#8203;)</code></a> method allows cache users to explicitly lock set of cache keys eagerly during a transaction. Lock call attempts to lock specified cache keys on the proper lock owners and it either succeeds or fails. All locks are released during commit or rollback phase.</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java">tm.begin()
cache.getAdvancedCache().lock(K)  <span class="comment">// acquire cluster-wide lock on K</span>
cache.put(K,V5)                   <span class="comment">// guaranteed to succeed</span>
tm.commit()                       <span class="comment">// releases locks</span></code></pre> </div> </div> </div> <div class="sect4"> <h5 id="what_isolation_levels_does_infinispan_support"><a class="anchor" href="#what_isolation_levels_does_infinispan_support"></a>What isolation levels does Infinispan support?</h5> <div class="paragraph"> <p>Infinispan only supports the isolation levels <strong>READ_COMMITTED</strong> and <strong>REPEATABLE_READ</strong>. Note that exact definition of these levels may differ from traditional database definitions.</p> </div> <div class="paragraph"> <p>The default isolation mode is <strong>READ_COMMITTED</strong>. We consider <strong>READ_COMMITTED</strong> to be good enough for most applications and hence its use as a default.</p> </div> </div> <div class="sect4"> <h5 id="when_using_atomikos_transaction_manager_distributed_caches_are_not_distributing_data_what_is_the_problem"><a class="anchor" href="#when_using_atomikos_transaction_manager_distributed_caches_are_not_distributing_data_what_is_the_problem"></a>When using Atomikos transaction manager, distributed caches are not distributing data, what is the problem?</h5> <div class="paragraph"> <p>For efficiency reasons, Atomikos transaction manager commits transactions in a separate thread to the thread making the cache operations and until 4.2.1.CR1, Infinispan had problems with this type of scenarios and resulted on distributed caches not sending data to other nodes (see <a href="https://issues.jboss.org/browse/ISPN-927">ISPN-927</a> for more details). Please note that replicated, invalidated or local caches would work fine. It&#8217;s only distributed caches that would suffer this problem.</p> </div> <div class="paragraph"> <p>There&#8217;re two ways to get around this issue, either:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Upgrade to Infinispan 4.2.1.CR2 or higher where the issue has been fixed.</p> </li> <li> <p>If using Infinispan 4.2.1.CR1 or earlier, <a href="http://www.atomikos.com/Documentation/JtaProperties">configure Atomikos so that <code>com.atomikos.icatch.threaded_2pc</code> is set to false</a> . This results in commits happening in the same thread that made the cache operations.</p> </li> </ol> </div> </div> </div> <div class="sect3"> <h4 id="eviction_and_expiration_questions"><a class="anchor" href="#eviction_and_expiration_questions"></a>2.9.4. Eviction and Expiration questions</h4> <div class="sect4"> <h5 id="expiration_does_not_work_what_is_the_problem"><a class="anchor" href="#expiration_does_not_work_what_is_the_problem"></a>Expiration does not work, what is the problem?</h5> <div class="paragraph"> <p>Multiple cache operations such as <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/commons/api/BasicCache.html#put-K-V-long-java.util.concurrent.TimeUnit-"><code>put()</code></a> can take a lifespan as parameter which defines the time when the entry should be expired. If you have no eviction configured and and you let this time expire, it can look as Infinispan has not removed the entry. For example, the JMX stats such as number of entries might not updated or the persistent store associated with Infinispan might still contain the entry. To understand what&#8217;s happening, it&#8217;s important to note that Infinispan has marked the entry as expired but has not actually removed it. Removal of <em>expired</em> entries happens in one of 2 ways:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>You try and do a get() or containsKey() for that entry. The entry is then detected as expired and is removed.</p> </li> <li> <p>You have enabled eviction and an eviction thread wakes up periodically and purges expired entries.</p> </li> </ol> </div> <div class="paragraph"> <p>If you have not enabled (2), or your eviction thread wakeup interval is large and you probe jconsole before the eviction thread kicks in, you will still see the expired entry. You can be assured that if you tried to <em>retrieve</em> the entry via a get() or containsKey() though, you won&#8217;t see the entry (and the entry will be removed).</p> </div> </div> </div> <div class="sect3"> <h4 id="cache_manager_questions"><a class="anchor" href="#cache_manager_questions"></a>2.9.5. Cache Manager questions</h4> <div class="sect4"> <h5 id="can_i_create_caches_using_different_cache_modes_using_the_same_cache_manager"><a class="anchor" href="#can_i_create_caches_using_different_cache_modes_using_the_same_cache_manager"></a>Can I create caches using different cache modes using the same cache manager?</h5> <div class="paragraph"> <p>Yes. You can create caches using different cache modes, both synchronous and asynchronous, using the same cache manager.</p> </div> </div> <div class="sect4"> <h5 id="can_transactions_span_different_cache_instances_from_the_same_cache_manager"><a class="anchor" href="#can_transactions_span_different_cache_instances_from_the_same_cache_manager"></a>Can transactions span different Cache instances from the same cache manager?</h5> <div class="paragraph"> <p>Yes. Each cache behaves as a separate, standalone JTA resource. Internally though, components may be shared as an optimization but this in no way affects how the caches interact with a JTA manager.</p> </div> </div> <div class="sect4"> <h5 id="how_does_multi_tenancy_work"><a class="anchor" href="#how_does_multi_tenancy_work"></a>How does multi-tenancy work?</h5> <div class="paragraph"> <p>Multi-tenancy is achieved by namespacing. A single Infinispan cluster can have several named caches (attached to the same CacheManager), and different named caches can have duplicate keys. So this is, in effect, multi-tenancy for your key/value store.</p> </div> </div> <div class="sect4"> <h5 id="infinispan_allows_me_to_create_several_caches_from_a_single_cachemanager_are_there_any_reasons_to_create_separate_cachemanagers"><a class="anchor" href="#infinispan_allows_me_to_create_several_caches_from_a_single_cachemanager_are_there_any_reasons_to_create_separate_cachemanagers"></a>Infinispan allows me to create several Caches from a single CacheManager. Are there any reasons to create separate CacheManagers?</h5> <div class="paragraph"> <p>As far as possible, internal components are shared between Cache instances. Notably, RPC and networking components are shared. If you need caches that have different network characteristics - such as one cache using TCP while another uses UDP - we recommend you create these using different cache managers.</p> </div> </div> </div> <div class="sect3"> <h4 id="cache_mode_questions"><a class="anchor" href="#cache_mode_questions"></a>2.9.6. Cache Mode questions</h4> <div class="sect4"> <h5 id="what_is_the_difference_between_a_replicated_cache_and_a_distributed_cache"><a class="anchor" href="#what_is_the_difference_between_a_replicated_cache_and_a_distributed_cache"></a>What is the difference between a replicated cache and a distributed cache?</h5> <div class="paragraph"> <p>Distribution is a new cache mode in Infinispan, in addition to replication and invalidation. In a replicated cache all nodes in a cluster hold all keys i.e. if a key exists on one node, it will also exist on <em>all</em> other nodes. In a distributed cache, a number of copies are maintained to provide redundancy and fault tolerance, however this is typically far fewer than the number of nodes in the cluster. A distributed cache provides a far greater degree of scalability than a replicated cache.</p> </div> <div class="paragraph"> <p>A distributed cache is also able to transparently locate keys across a cluster, and provides an L1 cache for fast local read access of state that is stored remotely.</p> </div> </div> <div class="sect4"> <h5 id="does_dist_support_both_synchronous_and_asynchronous_communications"><a class="anchor" href="#does_dist_support_both_synchronous_and_asynchronous_communications"></a>Does DIST support both synchronous and asynchronous communications?</h5> <div class="paragraph"> <p>Officially, no. And unofficially, yes. Here&#8217;s the logic. For certain public API methods to have meaningful return values (i.e., to stick to the interface contracts), if you are using DIST , synchronized communications are necessary. For example, you have 3 caches in a cluster, A, B and C. Key K maps to A and B. On C, you perform an operation that requires a return value e.g., Cache.remove(K) . For this to work, the call needs to be forwarded to A and B <em>synchronously</em>, and would have to wait for the result from either A or B to return to the caller. If communications were asynchronous, the return values cannot be guaranteed to be useful - even though the operation would behave as expected.</p> </div> <div class="paragraph"> <p>Now unofficially, we will add a configuration option to allow you to set your cache mode to DIST <em>and</em> use asynchronous communications, but this would be an additional configuration option (perhaps something like break_api_contracts ) so that users are aware of what they are getting into.</p> </div> </div> <div class="sect4"> <h5 id="i_notice_that_when_using_dist_the_cache_does_a_remote_get_before_a_write_command_why_is_this"><a class="anchor" href="#i_notice_that_when_using_dist_the_cache_does_a_remote_get_before_a_write_command_why_is_this"></a>I notice that when using DIST, the cache does a remote get before a write command. Why is this?</h5> <div class="paragraph"> <p>Certain methods, such as Cache.put() , are supposed to return the previous value associated with the specified key according to the java.util.Map contract. If this is performed on an instance that does <em>not</em> own the key in question and the key is not in L1 cache, the only way to reliably provide this return value is to do a remote GET before the put. This GET is <em>always</em> sync (regardless of whether the cache is configured to be sync or async) since we need to wait for that return value.</p> </div> <div class="sect5"> <h6 id="isnt_that_expensive_how_can_i_optimize_this_away"><a class="anchor" href="#isnt_that_expensive_how_can_i_optimize_this_away"></a>Isn&#8217;t that expensive? How can I optimize this away?</h6> <div class="paragraph"> <p>It isn&#8217;t as expensive as it sounds. A remote GET, although sync, will <em>not</em> wait for all responses. It will accept the first valid response and move on, thus making its performance has no relation to cluster size.</p> </div> <div class="paragraph"> <p>If you feel your code has no need for these return values, then this can be disabled completely (by specifying the <code>&lt;unsafe unreliableReturnValues="true" /&gt;</code> configuration element for a cache-wide setting or the <code>Flag.SKIP_REMOTE_LOOKUP</code> for a per-invocation setting). Note that while this will <em>not</em> impair cache operations and accurate functioning of all public methods is still maintained. However, it <em>will</em> break the java.util.Map interface contract by providing unreliable and inaccurate return values to certain methods, so you would need to be certain that your code does not use these return values for anything useful.</p> </div> </div> </div> <div class="sect4"> <h5 id="i_use_a_clustered_cache_i_want_the_guarantees_of_synchronous_replication_with_the_parallelism_of_asynchronous_replication_what_can_i_do"><a class="anchor" href="#i_use_a_clustered_cache_i_want_the_guarantees_of_synchronous_replication_with_the_parallelism_of_asynchronous_replication_what_can_i_do"></a>I use a clustered cache. I want the guarantees of synchronous replication with the parallelism of asynchronous replication. What can I do?</h5> <div class="paragraph"> <p>Infinispan offers a new async API to provide just this. These async methods return Future which can be queried, causing the thread to block till you get a confirmation that any network calls succeeded. You can <a href="http://infinispan.blogspot.com/2009/05/whats-so-cool-about-asynchronous-api.html">read more about it</a> .</p> </div> </div> <div class="sect4"> <h5 id="what_is_the_l1_cache"><a class="anchor" href="#what_is_the_l1_cache"></a>What is the L1 cache?</h5> <div class="paragraph"> <p>An L1 cache (disabled by default) only exists if you set your cache mode to distribution. An L1 cache prevents unnecessary remote fetching of entries mapped to remote caches by storing them locally for a short time after the first time they are accessed. By default, entries in L1 have a lifespan of 60,000 milliseconds (though you can configure how long L1 entries are cached for). L1 entries are also invalidated when the entry is changed elsewhere in the cluster so you are sure you don&#8217;t have stale entries cached in L1. Caches with L1 enabled will consult the L1 cache before fetching an entry from a remote cache.</p> </div> </div> <div class="sect4"> <h5 id="what_consistency_guarantees_do_i_have_with_different_asynchronous_processing_settings"><a class="anchor" href="#what_consistency_guarantees_do_i_have_with_different_asynchronous_processing_settings"></a>What consistency guarantees do I have with different Asynchronous processing settings ?</h5> <div class="paragraph"> <p>There are 3 main configuration settings (modes of usage) that affect the behaviour of Infinispan in terms of Asynchronous processing, summarized in the following table:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Config / Mode of usage</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>API</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Usage of Asynchronous API, i.e. methods of the Cache interface like e.g. putAsync(key, val)</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>Replication</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Configuring a clustered cache to replicate data asychronously. In Infinispan XML configuration this is done by using &lt;sync&gt; or &lt;async&gt; sub-elements under <a href="http://docs.jboss.org/infinispan/5.1/configdocs/urn_infinispan_config_5.1/complexType/configuration.clustering.html">&lt;clustering&gt;</a> element.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Switching to asynchronous mode in each of these areas causes loss of some consistency guarantees. The known problems are summarised here:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 25%;"> <col style="width: 25%;"> <col style="width: 25%;"> <col style="width: 25%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">API</th> <th class="tableblock halign-left valign-top">Replication</th> <th class="tableblock halign-left valign-top">Marshalling</th> <th class="tableblock halign-left valign-top">Consistency problems</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Sync</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Sync</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Sync</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Sync</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>Async</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Sync</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>1</em> - Cache entry is replicated with a delay or not at all in case of network error. <em>2</em> - Node where the operation originated won&#8217;t be notified about errors that happened on network or on the receiving side.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Sync</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>Async</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>Async</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>1, 2</em> <em>3</em> - Calling order of sync API method might not be preserved  depends on which operation finishes marshalling first in the asyncExecutor <em>4</em> - Replication of put operation can be applied on different nodes in different order  this may result in inconsistent values</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>Async</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Sync</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Sync</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>3</em></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>Async</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>Async</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Sync</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>1, 2, 3</em></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>Async</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>Async</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>Async</em></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><em>1, 2, 3, 4</em></p></td> </tr> </tbody> </table> </div> <div class="sect4"> <h5 id="grouping_api_vs_key_affinity_service"><a class="anchor" href="#grouping_api_vs_key_affinity_service"></a>Grouping API vs Key Affinity Service</h5> <div class="paragraph"> <p>The key affinity (for keys generated with the Key Affinity Service) might be lost during topology changes. E.g. if k1 maps to node N1 and another node is added to the system, k1 can me migrated to N2 (affinity is lost). With grouping API you have the guarantee that the same node (you don&#8217;t know/control which node) hosts all the data from the same group even after topology changes.</p> </div> </div> </div> <div class="sect3"> <h4 id="listener_questions"><a class="anchor" href="#listener_questions"></a>2.9.7. Listener questions</h4> <div class="sect4"> <h5 id="in_a_cache_entry_modified_listener_can_the_modified_value_be_retrieved_via_cache_get_when_isprefalse"><a class="anchor" href="#in_a_cache_entry_modified_listener_can_the_modified_value_be_retrieved_via_cache_get_when_isprefalse"></a>In a cache entry modified listener, can the modified value be retrieved via Cache.get() when isPre=false?</h5> <div class="paragraph"> <p>No, it cannot. Use <code>CacheEntryModifiedEvent.getValue()</code> to retrieve the value of the entry that was modified.</p> </div> </div> <div class="sect4"> <h5 id="when_annotating_a_method_with_cacheentrycreated_how_do_i_retrieve_the_value_of_the_cache_entry_added"><a class="anchor" href="#when_annotating_a_method_with_cacheentrycreated_how_do_i_retrieve_the_value_of_the_cache_entry_added"></a>When annotating a method with CacheEntryCreated, how do I retrieve the value of the cache entry added?</h5> <div class="paragraph"> <p>Use <code>CacheEntryCreatedEvent.getValue()</code> to retrieve the value of the entry.</p> </div> </div> <div class="sect4"> <h5 id="what_is_the_difference_between_classes_in_org_infinispan_notifications_cachelistener_filter_vs_org_infinispan_filter"><a class="anchor" href="#what_is_the_difference_between_classes_in_org_infinispan_notifications_cachelistener_filter_vs_org_infinispan_filter"></a>What is the difference between classes in <code>org.infinispan.notifications.cachelistener.filter</code> vs <code>org.infinispan.filter</code>?</h5> <div class="paragraph"> <p>Inside these packages you&#8217;ll find classes that facilitate filtering and data conversion. The difference is that classes in <code>org.infinispan.filter</code> are used for filtering and conversion in multiple areas, such as cache loaders, entry iterators,&#8230;&#8203;etc, whereas classes in <code>org.infinispan.notifications.cachelistener.filter</code> are purely used for listener event filtering, and provide more information than similarly named classes in <code>org.infinispan.filter</code>. More specifically, remote listener event filtering and conversion require <code>CacheEventFilter</code> and <code>CacheEventConverter</code> instances located in <code>org.infinispan.notifications.cachelistener.filter</code> package to be used.</p> </div> </div> </div> <div class="sect3"> <h4 id="iaascloud_infrastructure_questions"><a class="anchor" href="#iaascloud_infrastructure_questions"></a>2.9.8. IaaS/Cloud Infrastructure questions</h4> <div class="sect4"> <h5 id="how_do_you_make_infinispan_send_replication_traffic_over_a_specific_network_when_you_dont_know_the_ip_address"><a class="anchor" href="#how_do_you_make_infinispan_send_replication_traffic_over_a_specific_network_when_you_dont_know_the_ip_address"></a>How do you make Infinispan send replication traffic over a specific network when you don&#8217;t know the IP address?</h5> <div class="paragraph"> <p>Some cloud providers charge you less for traffic over internal IP addresses compared to public IP addresses, in fact, some cloud providers do not even charge a thing for traffic over the internal network (i.e. GoGrid). In these circumstances, it&#8217;s really advantageous to configure Infinispan in such way that replication traffic is sent via the internal network. The problem though is that quite often you don&#8217;t know which internal IP address you&#8217;ll be assigned (unless you use elastic IPs and dyndns.org), so how do you configure Infinispan to cope with those situations?</p> </div> <div class="paragraph"> <p>JGroups, which is the underlying group communication library to interconnect Infinispan instances, has come up with a way to enable users to bind to a type of address rather than to a specific IP address. So now you can configure <code>bind_addr</code> property in JGroups configuration file, or the <code>-Djgroups.bind_addr</code> system property to a keyword rather than a dotted decimal or symbolic IP address:</p> </div> <div class="ulist"> <ul> <li> <p>GLOBAL : pick a public IP address. You want to avoid this for replication traffic</p> </li> <li> <p>SITE_LOCAL : use a private IP address, e.g. 192.168.x.x. This avoids charges for bandwidth from GoGrid, for example</p> </li> <li> <p>LINK_LOCAL : use a 169.x.x.x, 254.0.0.0 address. I&#8217;ve never used this, but this would be for traffic only within 1 box</p> </li> <li> <p>NON_LOOPBACK : use the first address found on an interface (which is up), which is not a 127.x.x.x address</p> </li> </ul> </div> </div> </div> <div class="sect3"> <h4 id="demo_questions"><a class="anchor" href="#demo_questions"></a>2.9.9. Demo questions</h4> <div class="sect4"> <h5 id="when_using_the_gui_demo_ive_just_put_an_entry_in_the_cache_with_lifespan_of_1_why_do_i_see_it_as_having_a_lifespan_of_60000"><a class="anchor" href="#when_using_the_gui_demo_ive_just_put_an_entry_in_the_cache_with_lifespan_of_1_why_do_i_see_it_as_having_a_lifespan_of_60000"></a>When using the GUI Demo, I&#8217;ve just put an entry in the cache with lifespan of -1. Why do I see it as having a lifespan of 60,000?</h5> <div class="paragraph"> <p>This is probably a L1 caching event. When you put an entry in the cache, the entry is mapped to specific nodes in a cluster using a consistent hashing algorithm. This means that key K could map on to caches A and B (or however many owners you have configured). If you happen to have done the cache.put(K, V) on cache C , however, K still maps to A and B (and will be added to caches A and B with their proper lifespans), but it will also be put in cache C&#8217;s L1 cache.</p> </div> </div> </div> <div class="sect3"> <h4 id="logging_questions"><a class="anchor" href="#logging_questions"></a>2.9.10. Logging questions</h4> <div class="sect4"> <h5 id="how_can_i_enable_logging"><a class="anchor" href="#how_can_i_enable_logging"></a>How can I enable logging?</h5> <div class="paragraph"> <p>By default Infinispan uses JBoss Logging 3.0 as logging framework. JBoss Logging acts as a delegator to either JBoss Log Manager, Apache Log4j, Slf4j or JDK Logging. The way it chooses which logging provider to delegate to is by:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>checking whether the JBoss Log Manager is configured (e.g. Infinispan is running in JBoss Application Server 7) and if it is, using it</p> </li> <li> <p>otherwise, checking if <a href="http://logging.apache.org/log4j/1.2/index.html">Apache Log4j</a> is in the classpath (JBoss Logging checks if the classes org.apache.log4j.LogManager and org.apache.log4j.Hierarchy are available) and if it is, using it</p> </li> <li> <p>otherwise, checking if <a href="http://logback.qos.ch/">LogBack</a> in the classpath (JBoss Logging checks if the class ch.qos.logback.classic.Logger is available) and if it is, using it</p> </li> <li> <p>finally, if none of the above are available, using <a href="http://docs.oracle.com/javase/8/docs/technotes/guides/logging/overview.html">JDK logging</a></p> </li> </ol> </div> <div class="paragraph"> <p>You can use this <a href="https://github.com/infinispan/infinispan/blob/master/core/src/test/resources/log4j2.xml">log4j2.xml</a> as base for any Infinispan related logging, and you can pass it to your system via system parameter (e.g., <code>-Dlog4j.configurationFile=file:/path/to/log4j2.xml</code>).</p> </div> </div> </div> <div class="sect3"> <h4 id="third_party_container_questions"><a class="anchor" href="#third_party_container_questions"></a>2.9.11. Third Party Container questions</h4> <div class="sect4"> <h5 id="can_i_use_infinispan_on_google_app_engine_for_java"><a class="anchor" href="#can_i_use_infinispan_on_google_app_engine_for_java"></a>Can I use Infinispan on Google App Engine for Java?</h5> <div class="paragraph"> <p>Not at this moment. Due to GAE/J restricting classes that can be loaded, and restrictions around use of threads, Infinispan will not work on GAE/J. However, we do plan to fix this - if you wish to track the progress of Infinispan on GAE/J, have a look at <a href="https://jira.jboss.org/jira/browse/ISPN-57">ISPN-57</a> .</p> </div> </div> <div class="sect4"> <h5 id="when_running_on_glassfish_or_apache_creating_a_cache_throws_an_exception_saying_unable_to_construct_a_globalcomponentregistry_what_is_it_wrong"><a class="anchor" href="#when_running_on_glassfish_or_apache_creating_a_cache_throws_an_exception_saying_unable_to_construct_a_globalcomponentregistry_what_is_it_wrong"></a>When running on Glassfish or Apache, creating a cache throws an exception saying "Unable to construct a GlobalComponentRegistry", what is it wrong?</h5> <div class="paragraph"> <p>It appears that this happens due to some classloading issue. A workaround that is know to work is to call the following before creating the cache manager or container:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Thread</span>.currentThread().setContextClassLoader(<span class="local-variable">this</span>.getClass().getClassLoader());</code></pre> </div> </div> </div> </div> <div class="sect3"> <h4 id="marshalling_and_unmarshalling"><a class="anchor" href="#marshalling_and_unmarshalling"></a>2.9.12. Marshalling and Unmarshalling</h4> <div class="sect4"> <h5 id="best_practices_implementing_java_io_externalizable"><a class="anchor" href="#best_practices_implementing_java_io_externalizable"></a>Best practices implementing java.io.Externalizable</h5> <div class="paragraph"> <p>If you decide to implement <a href="https://docs.oracle.com/javase/8/docs/api/java/io/Externalizable.html">Externalizable</a> interface, please make sure that the <a href="https://docs.oracle.com/javase/8/docs/api/java/io/Externalizable.html#readExternal(java.io.ObjectInput)">readExternal()</a> method is thread safe, otherwise you run the risk of potential getting corrupted data and <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/OutOfMemoryError.html">OutOfMemoryException</a> , as seen in <a href="http://community.jboss.org/message/609296#609296">this forum post</a> .</p> </div> </div> <div class="sect4"> <h5 id="do_externalizer_implementations_need_to_access_internal_externalizer_implementations"><a class="anchor" href="#do_externalizer_implementations_need_to_access_internal_externalizer_implementations"></a>Do Externalizer implementations need to access internal Externalizer implementations?</h5> <div class="paragraph"> <p>No, they don&#8217;t. Here&#8217;s an example of what should not be done:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">ABCMarshallingExternalizer</span> <span class="directive">implements</span> AdvancedExternalizer&lt;ABCMarshalling&gt; {
   <span class="annotation">@Override</span>
   <span class="directive">public</span> <span class="type">void</span> writeObject(<span class="predefined-type">ObjectOutput</span> output, ABCMarshalling object) <span class="directive">throws</span> <span class="exception">IOException</span> {
      MapExternalizer ma = <span class="keyword">new</span> MapExternalizer();
      ma.writeObject(output, object.getMap());
   }

   <span class="annotation">@Override</span>
   <span class="directive">public</span> ABCMarshalling readObject(<span class="predefined-type">ObjectInput</span> input) <span class="directive">throws</span> <span class="exception">IOException</span>, <span class="exception">ClassNotFoundException</span> {
      ABCMarshalling hi = <span class="keyword">new</span> ABCMarshalling();
      MapExternalizer ma = <span class="keyword">new</span> MapExternalizer();
      hi.setMap((<span class="predefined-type">ConcurrentHashMap</span>&lt;<span class="predefined-type">Long</span>, <span class="predefined-type">Long</span>&gt;) ma.readObject(input));
      <span class="keyword">return</span> hi;
   }

   ...
}</code></pre> </div> </div> <div class="paragraph"> <p>End user externalizers should not need to fiddle with Infinispan internal externalizer classes. Instead, this code should have been written as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">ABCMarshallingExternalizer</span> <span class="directive">implements</span> AdvancedExternalizer&lt;ABCMarshalling&gt; {
   <span class="annotation">@Override</span>
   <span class="directive">public</span> <span class="type">void</span> writeObject(<span class="predefined-type">ObjectOutput</span> output, ABCMarshalling object) <span class="directive">throws</span> <span class="exception">IOException</span> {
      output.writeObject(object.getMap());
   }

   <span class="annotation">@Override</span>
   <span class="directive">public</span> ABCMarshalling readObject(<span class="predefined-type">ObjectInput</span> input) <span class="directive">throws</span> <span class="exception">IOException</span>, <span class="exception">ClassNotFoundException</span> {
      ABCMarshalling hi = <span class="keyword">new</span> ABCMarshalling();
      hi.setMap((<span class="predefined-type">ConcurrentHashMap</span>&lt;<span class="predefined-type">Long</span>, <span class="predefined-type">Long</span>&gt;) input.readObject());
      <span class="keyword">return</span> hi;
   }

   ...
}</code></pre> </div> </div> </div> <div class="sect4"> <h5 id="during_state_transfer_the_state_receiver_logs_an_eofexception_when_applying_state_saying_read_past_end_of_file_should_i_worry_about_this"><a class="anchor" href="#during_state_transfer_the_state_receiver_logs_an_eofexception_when_applying_state_saying_read_past_end_of_file_should_i_worry_about_this"></a>During state transfer, the state receiver logs an EOFException when applying state saying "Read past end of file". Should I worry about this?</h5> <div class="paragraph"> <p>It depends on whether the state provider encountered an error or not when generating the state. For example, sometimes the state provider might already be providing state to another node, so when the node requests the state, the state generator might log:</p> </div> <div class="listingblock"> <div class="content"> <pre>ERROR [org.infinispan.remoting.transport.jgroups.JGroupsTransport] (STREAMING_STATE_TRANSFER-sender-1,{brandname}-Cluster,NodeJ-2368:) Caught while responding to state transfer request
org.infinispan.statetransfer.StateTransferException: java.util.concurrent.TimeoutException: Could not obtain exclusive processing lock
     at org.infinispan.statetransfer.StateTransferManagerImpl.generateState(StateTransferManagerImpl.java:175)
     at org.infinispan.remoting.InboundInvocationHandlerImpl.generateState(InboundInvocationHandlerImpl.java:119)
     at org.infinispan.remoting.transport.jgroups.JGroupsTransport.getState(JGroupsTransport.java:586)
     at org.jgroups.blocks.MessageDispatcher$ProtocolAdapter.handleUpEvent(MessageDispatcher.java:691)
     at org.jgroups.blocks.MessageDispatcher$ProtocolAdapter.up(MessageDispatcher.java:772)
     at org.jgroups.JChannel.up(JChannel.java:1465)
     at org.jgroups.stack.ProtocolStack.up(ProtocolStack.java:954)
     at org.jgroups.protocols.pbcast.FLUSH.up(FLUSH.java:478)
     at org.jgroups.protocols.pbcast.STREAMING_STATE_TRANSFER$StateProviderHandler.process(STREAMING_STATE_TRANSFER.java:653)
     at org.jgroups.protocols.pbcast.STREAMING_STATE_TRANSFER$StateProviderThreadSpawner$1.run(STREAMING_STATE_TRANSFER.java:582)
     at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
     at java.lang.Thread.run(Thread.java:680)
Caused by: java.util.concurrent.TimeoutException: Could not obtain exclusive processing lock
     at org.infinispan.remoting.transport.jgroups.JGroupsDistSync.acquireProcessingLock(JGroupsDistSync.java:71)
     at org.infinispan.statetransfer.StateTransferManagerImpl.generateTransactionLog(StateTransferManagerImpl.java:202)
     at org.infinispan.statetransfer.StateTransferManagerImpl.generateState(StateTransferManagerImpl.java:165)
     ... 12 more</pre> </div> </div> <div class="paragraph"> <p>This exception is basically saying that the state generator was not able to generate the transaction log and so the output to which it was writing is closed. In this situation, it&#8217;s common to see the state receiver log an EOFException , as shown below, when trying to read the transaction log because the sender did not write the transaction log:</p> </div> <div class="listingblock"> <div class="content"> <pre>TRACE [org.infinispan.marshall.VersionAwareMarshaller] (Incoming-2,{brandname}-Cluster,NodeI-38030:) Log exception reported
java.io.EOFException: Read past end of file
     at org.jboss.marshalling.AbstractUnmarshaller.eofOnRead(AbstractUnmarshaller.java:184)
     at org.jboss.marshalling.AbstractUnmarshaller.readUnsignedByteDirect(AbstractUnmarshaller.java:319)
     at org.jboss.marshalling.AbstractUnmarshaller.readUnsignedByte(AbstractUnmarshaller.java:280)
     at org.jboss.marshalling.river.RiverUnmarshaller.doReadObject(RiverUnmarshaller.java:207)
     at org.jboss.marshalling.AbstractUnmarshaller.readObject(AbstractUnmarshaller.java:85)
     at org.infinispan.marshall.jboss.GenericJBossMarshaller.objectFromObjectStream(GenericJBossMarshaller.java:175)
     at org.infinispan.marshall.VersionAwareMarshaller.objectFromObjectStream(VersionAwareMarshaller.java:184)
     at org.infinispan.statetransfer.StateTransferManagerImpl.processCommitLog(StateTransferManagerImpl.java:228)
     at org.infinispan.statetransfer.StateTransferManagerImpl.applyTransactionLog(StateTransferManagerImpl.java:250)
     at org.infinispan.statetransfer.StateTransferManagerImpl.applyState(StateTransferManagerImpl.java:320)
     at org.infinispan.remoting.InboundInvocationHandlerImpl.applyState(InboundInvocationHandlerImpl.java:102)
     at org.infinispan.remoting.transport.jgroups.JGroupsTransport.setState(JGroupsTransport.java:603)
        ...</pre> </div> </div> <div class="paragraph"> <p>The current logic is for the state receiver to back off in these scenarios and retry after a few seconds. Quite often, after the retry the state generator might have already finished dealing with the other node and hence the state receiver will be able to fully receive the state.</p> </div> </div> <div class="sect4"> <h5 id="why_am_i_getting_invalid_data_passed_to_readexternal"><a class="anchor" href="#why_am_i_getting_invalid_data_passed_to_readexternal"></a>Why am I getting invalid data passed to readExternal?</h5> <div class="paragraph"> <p>If you are using Cache.putAsync() you may find your object is modified after serialization starts, thus corrupting the datastream passed to readExternal . To solve this, make sure you synchronize access to the object.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> <div class="title">Read More</div> You can read more about this issue in <a href="http://community.jboss.org/message/609040">this forum thread</a> . </td> </tr> </table> </div> </div> </div> <div class="sect3"> <h4 id="tuning_questions"><a class="anchor" href="#tuning_questions"></a>2.9.13. Tuning questions</h4> <div class="sect4"> <h5 id="when_running_infinispan_under_load_i_see_rejectedexecutionexception_how_can_i_fix_it"><a class="anchor" href="#when_running_infinispan_under_load_i_see_rejectedexecutionexception_how_can_i_fix_it"></a>When running Infinispan under load, I see RejectedExecutionException, how can I fix it?</h5> <div class="paragraph"> <p>Internally Infinispan uses executors to do some processing asynchronously, so the first thing to do is to figure out which of these executors is causing issues. For example, if you see a stacktrace that looks like this, the problem is located in the <a href="http://docs.jboss.org/infinispan/5.0/apidocs/config.html#ce_global_asyncTransportExecutor">asyncTransportExecutor</a> :</p> </div> <div class="listingblock"> <div class="content"> <pre>java.util.concurrent.RejectedExecutionException
  at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:1759)
  at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:767)
  at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:658)
  at java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:92)
  at org.infinispan.remoting.transport.jgroups.CommandAwareRpcDispatcher.invokeRemoteCommands(CommandAwareRpcDispatcher.java:117)
...</pre> </div> </div> <div class="paragraph"> <p>To solve this issue, you should try any of these options:</p> </div> <div class="ulist"> <ul> <li> <p>Increase the maxThreads property in <a href="http://docs.jboss.org/infinispan/5.0/apidocs/config.html#ce_global_asyncTransportExecutor">asyncTransportExecutor</a> . At the time of writing, the default value for this particular executor is 25.</p> </li> <li> <p>Define your own ExecutorFactory which creates an executor with a bigger queue. You can find more information about different queueing strategies in <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ThreadPoolExecutor.html">ThreadPoolExecutor javadoc</a> .</p> </li> <li> <p>Disable async marshalling (see the <a href="http://docs.jboss.org/infinispan/5.1/configdocs/urn_infinispan_config_5.1/complexType/configuration.clustering.async.html">&lt;async &#8230;&#8203; &gt;</a> element for details). This would mean that an executor is <em>not</em> used when replicating, so you will never have a RejectedExecutionException . However this means each put() will take a little longer since marshalling will now happen on the critical path. The RPC is still async though as the thread won&#8217;t wait for a response from the recipient (fire-and-forget).</p> </li> </ul> </div> </div> </div> <div class="sect3"> <h4 id="jndi_questions"><a class="anchor" href="#jndi_questions"></a>2.9.14. JNDI questions</h4> <div class="sect4"> <h5 id="can_i_bind_cache_or_cachemanager_to_jndi"><a class="anchor" href="#can_i_bind_cache_or_cachemanager_to_jndi"></a>Can I bind Cache or CacheManager to JNDI?</h5> <div class="paragraph"> <p>Cache or CacheManager can be bound to JNDI, but only to the java: namespace because they are not designed to be exported outside the Java Virtual Machine. In other words, you shouldn&#8217;t expect that you&#8217;ll be able to access them remotely by binding them to JNDI and downloading a remote proxy to them because neither Cache nor CacheManager are serializable.</p> </div> <div class="paragraph"> <p>To find an example on how to bind Cache or CacheManager to the java: namespace, simply check <a href="https://github.com/infinispan/infinispan/blob/master/core/src/test/java/org/infinispan/jndi/BindingTest.java">this unit test case</a> .</p> </div> </div> </div> <div class="sect3"> <h4 id="hibernate_2nd_level_cache_questions"><a class="anchor" href="#hibernate_2nd_level_cache_questions"></a>2.9.15. Hibernate 2nd Level Cache questions</h4> <div class="sect4"> <h5 id="can_i_use_infinispan_as_a_remote_jpa_or_hibernate_second_level_cache"><a class="anchor" href="#can_i_use_infinispan_as_a_remote_jpa_or_hibernate_second_level_cache"></a>Can I use Infinispan as a remote JPA or Hibernate second level cache?</h5> <div class="paragraph"> <p>See <a href="https://docs.jboss.org/hibernate/orm/5.2/userguide/html_single/Hibernate_User_Guide.html#caching-provider-infinispan-remote">Remote Infinispan Caching</a> section in Hibernate documentation.</p> </div> </div> <div class="sect4"> <h5 id="what_are_the_pitfalls_of_not_using_a_non_jta_transaction_factory_such_as_jdbctransactionfactory_with_hibernate_when_infinispan_is_used_as_2nd_level_cache_provider"><a class="anchor" href="#what_are_the_pitfalls_of_not_using_a_non_jta_transaction_factory_such_as_jdbctransactionfactory_with_hibernate_when_infinispan_is_used_as_2nd_level_cache_provider"></a>What are the pitfalls of not using a non-JTA transaction factory such as JDBCTransactionFactory with Hibernate when Infinispan is used as 2nd level cache provider?</h5> <div class="paragraph"> <p>The problem is that Hibernate will create a Transaction instance via java.sql.Connection and Infinispan will create a transaction via whatever TransactionManager returned by hibernate.transaction.manager_lookup_class . If hibernate.transaction.manager_lookup_class has not been populated, it will default to the dummy transaction manager.</p> </div> <div class="paragraph"> <p>So, any work on the 2nd level cache will be done under a different transaction to the one used to commit the stuff to the database via Hibernate. In other words, your operations on the database and the 2LC are not treated as a single unit. Risks here include failures to update the 2LC leaving it with stale data while the database committed data correctly.</p> </div> </div> </div> <div class="sect3"> <h4 id="cache_server_questions"><a class="anchor" href="#cache_server_questions"></a>2.9.16. Cache Server questions</h4> <div class="sect4"> <h5 id="is_there_a_way_to_do_a_bulk_get_on_a_remote_cache"><a class="anchor" href="#is_there_a_way_to_do_a_bulk_get_on_a_remote_cache"></a>Is there a way to do a Bulk Get on a remote cache?</h5> <div class="paragraph"> <p>There&#8217;s no bulk get operation in Hot Rod, but the Java Hot Rod client has implemented via <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/client/hotrod/RemoteCache.html">RemoteCache</a> the getAsync() operation, which returns a <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/util/concurrent/NotifyingFuture.html">org.infinispan.util.concurrent.NotifyingFuture</a> (extends java.util.concurrent.Future). So, if you want to retrieve multiple keys in parallel, just call multiple times <em>getAsync()</em> and when you need the values, just call <em>Future.get()</em> , or attach a <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/util/concurrent/FutureListener.html"> <em>FutureListener</em> </a> to the <em>NotifyingFuture</em> to get notified when the value is ready.</p> </div> </div> </div> <div class="sect3"> <h4 id="debugging_questions"><a class="anchor" href="#debugging_questions"></a>2.9.17. Debugging questions</h4> <div class="sect4"> <h5 id="how_can_i_get_infinispan_to_show_the_full_byte_array_the_log_only_shows_partial_contents_of_byte_arrays"><a class="anchor" href="#how_can_i_get_infinispan_to_show_the_full_byte_array_the_log_only_shows_partial_contents_of_byte_arrays"></a>How can I get Infinispan to show the full byte array? The log only shows partial contents of byte arrays&#8230;&#8203;</h5> <div class="paragraph"> <p>Since version 4.1, whenever Infinispan needs to print byte arrays to logs, these are partially printed in order to avoid unnecessarily printing potentially big byte arrays. This happens in situations where either, Infinispan caches have been configured with lazy deserialization, or your running an Memcached or Hot Rod server. So in these cases, only the first 10 positions of the byte array are shown in the logs. If you want Infinispan to show the full byte array in the logs, simply pass the <code>-Dinfinispan.arrays.debug=true</code> system property at startup. In the future, this might be controllable at runtime via a JMX call or similar.</p> </div> <div class="paragraph"> <p>Here&#8217;s an example of log message with a partially displayed byte array:</p> </div> <div class="listingblock"> <div class="content"> <pre>TRACE [ReadCommittedEntry] (HotRodWorker-1-1) Updating entry
(key=CacheKey{data=ByteArray{size=19, hashCode=1b3278a,
array=[107, 45, 116, 101, 115, 116, 82, 101, 112, 108, ..]}}
removed=false valid=true changed=true created=true value=CacheValue{data=ByteArray{size=19,
array=[118, 45, 116, 101, 115, 116, 82, 101, 112, 108, ..]},
version=281483566645249}]</pre> </div> </div> <div class="paragraph"> <p>And here&#8217;s a log message where the full byte array is shown:</p> </div> <div class="listingblock"> <div class="content"> <pre>TRACE [ReadCommittedEntry] (Incoming-2,{brandname}-Cluster,eq-6834) Updating entry
(key=CacheKey{data=ByteArray{size=19, hashCode=6cc2a4,
array=[107, 45, 116, 101, 115, 116, 82, 101, 112, 108, 105, 99, 97, 116, 101, 100, 80, 117, 116]}}
removed=false valid=true changed=true created=true value=CacheValue{data=ByteArray{size=19,
array=[118, 45, 116, 101, 115, 116, 82, 101, 112, 108, 105, 99, 97, 116, 101, 100, 80, 117, 116]},
version=281483566645249}]</pre> </div> </div> </div> </div> <div class="sect3"> <h4 id="clustering_transport_questions"><a class="anchor" href="#clustering_transport_questions"></a>2.9.18. Clustering Transport questions</h4> <div class="sect4"> <h5 id="how_do_i_retrieve_the_clustering_physical_address"><a class="anchor" href="#how_do_i_retrieve_the_clustering_physical_address"></a>How do I retrieve the clustering physical address?</h5> <div class="paragraph"> <p>You can retrieve the physical address via <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/remoting/transport/Transport.html#getPhysicalAddresses"><code>AdvancedCache.getRpcManager().getTransport().getPhysicalAddresses()</code></a></p> </div> </div> </div> <div class="sect3"> <h4 id="security_questions"><a class="anchor" href="#security_questions"></a>2.9.19. Security questions</h4> <div class="sect4"> <h5 id="using_kerberos_with_the_ibm_jdk"><a class="anchor" href="#using_kerberos_with_the_ibm_jdk"></a>Using Kerberos with the IBM JDK</h5> <div class="paragraph"> <p>When using Kerberos/GSSAPI authentication over Hot Rod, the IBM JDK implementation sometimes fail to authenticate with the following exception:</p> </div> <div class="listingblock"> <div class="content"> <pre>com.ibm.security.krb5.KrbException, status code: 101
    message: Invalid option in ticket request
    at com.ibm.security.krb5.KrbTgsReq.&lt;init&gt;(KrbTgsReq.java:62)
    at com.ibm.security.krb5.KrbTgsReq.&lt;init&gt;(KrbTgsReq.java:145)
    at com.ibm.security.krb5.internal.k.b(k.java:179)
    at com.ibm.security.krb5.internal.k.a(k.java:215)</pre> </div> </div> <div class="paragraph"> <p>A possible workaround is to perform a login/logout/login on the LoginContext, before using the Subject:</p> </div> <div class="listingblock"> <div class="content"> <pre>LoginContext lc = ...;
lc.login();
lc.logout();
lc = ...;
lc.login();
lc.getSubject();</pre> </div> </div> </div> </div> </div> <div class="sect2"> <h3 id="2_phase_commit"><a class="anchor" href="#2_phase_commit"></a>2.10. 2-phase commit</h3> <div class="paragraph"> <p>2-phase commit protocol (2PC) is a consensus protocol used for atomically commit or rollback distributed transactions.</p> </div> <div class="ulist"> <div class="title">More resources</div> <ul> <li> <p><a href="http://en.wikipedia.org/wiki/Two-phase_commit_protocol">Wikipedia article</a></p> </li> </ul> </div> </div> <div class="sect2"> <h3 id="atomicity_consistency_isolation_durability_acid"><a class="anchor" href="#atomicity_consistency_isolation_durability_acid"></a>2.11. Atomicity, Consistency, Isolation, Durability (ACID)</h3> <div class="paragraph"> <p>According to <a href="http://en.wikipedia.org/wiki/ACID">Wikipedia</a>, ACID (Atomicity, Consistency, Isolation, Durability) is a set of properties that guarantee that database transactions are processed reliably. In the context of databases, a single logical operation on the data is called a transaction. For example, a transfer of funds from one bank account to another, even involving multiple changes such as debiting one account and crediting another, is a single transaction.</p> </div> <div class="ulist"> <div class="title">More resources</div> <ul> <li> <p><a href="http://en.wikipedia.org/wiki/ACID">Wikipedia</a></p> </li> </ul> </div> </div> <div class="sect2"> <h3 id="basically_available_soft_state_eventually_consistent_base"><a class="anchor" href="#basically_available_soft_state_eventually_consistent_base"></a>2.12. Basically Available, Soft-state, Eventually-consistent (BASE)</h3> <div class="paragraph"> <p>BASE, also known as <a href="http://en.wikipedia.org/wiki/Eventual_consistency">Eventual Consistency</a>, is seen as the polar opposite of <em>ACID</em>, properties seen as desirable in traditional database systems.</p> </div> <div class="paragraph"> <p>BASE essentially embraces the fact that true consistency cannot be achieved in the real world, and as such cannot be modelled in highly scalable distributed systems. BASE has roots in Eric Brewer&#8217;s <em>CAP Theorem</em>, and eventual consistency is the underpinning of any distributed system that aims to provide high availability and partition tolerance.</p> </div> <div class="paragraph"> <p>Infinispan has traditionally followed ACID principles as far as possible, however an eventually consistent mode embracing BASE is on the roadmap.</p> </div> <div class="ulist"> <div class="title">More resources</div> <ul> <li> <p>A <a href="http://queue.acm.org/detail.cfm?id=1394128">good article</a> on <a href="http://queue.acm.org/index.cfm">ACM</a> compares BASE versus ACID.</p> </li> <li> <p>An <a href="http://www.infoq.com/presentations/Riak-Core">excellent talk</a> on eventual consistency and BASE in Riak is also available on InfoQ.</p> </li> </ul> </div> </div> <div class="sect2"> <h3 id="consistency_availability_and_partition_tolerance_cap_theorem"><a class="anchor" href="#consistency_availability_and_partition_tolerance_cap_theorem"></a>2.13. Consistency, Availability and Partition-tolerance (CAP) Theorem</h3> <div class="paragraph"> <p>Made famous by <a href="http://en.wikipedia.org/wiki/Eric_Brewer_(computer_scientist)">Eric Brewer</a> at UC Berkeley, this is a theorem of distributed computing that can be simplified to state that one can only practically build a distributed system exhibiting any two of the three desirable characteristics of distributed systems, which are: Consistency, Availability and Partition-tolerance (abbreviated to CAP). The theorem effectively stresses on the unreliability of networks and the effect this unreliability has on predictable behavior and high availability of dependent systems.</p> </div> <div class="paragraph"> <p>Infinispan has traditionally been biased towards Consistency and Availability, sacrificing Partition-tolerance. However, Infinispan does have a Partition-tolerant, eventually-consistent mode in the pipeline. This optional mode of operation will allow users to tune the degree of consistency they expect from their data, sacrificing partition-tolerance for this added consistency.</p> </div> <div class="ulist"> <div class="title">More resources</div> <ul> <li> <p>The theorem is well-discussed online, with many good resources to follow up on, including <a href="http://www.julianbrowne.com/article/viewer/brewers-cap-theorem">this document</a>.</p> </li> <li> <p>A more recent article by Eric Brewer himself appears on InfoQ <a href="http://www.infoq.com/articles/cap-twelve-years-later-how-the-rules-have-changed">a modern analysis of the theorem</a> .</p> </li> </ul> </div> </div> <div class="sect2"> <h3 id="consistent_hash"><a class="anchor" href="#consistent_hash"></a>2.14. Consistent Hash</h3> <div class="paragraph"> <p>A technique of mapping keys to servers such that, given a stable cluster topology, any server in the cluster can locate where a given key is mapped to with minimal computational complexity.</p> </div> <div class="paragraph"> <p>Consistent hashing is a purely algorithmic technique, and doesn&#8217;t rely on any metadata or any network broadcasts to "search" for a key in a cluster. This makes it extremely efficient to use.</p> </div> <div class="ulist"> <div class="title">More resources</div> <ul> <li> <p><a href="http://en.wikipedia.org/wiki/Consistent_hashing">Wikipedia</a></p> </li> </ul> </div> </div> <div class="sect2"> <h3 id="data_grid"><a class="anchor" href="#data_grid"></a>2.15. Data grid</h3> <div class="paragraph"> <p>A data grid is a cluster of (typically commodity) servers, normally residing on a single local-area network, connected to each other using IP based networking. Data grids behave as a single resource, exposing the aggregate storage capacity of all servers in the cluster. Data stored in the grid is usually partitioned, using a variety of techniques, to balance load across all servers in the cluster as evenly as possible. Data is often redundantly stored in the grid to provide resilience to individual servers in the grid failing i.e. more than one copy is stored in the grid, transparently to the application.</p> </div> <div class="paragraph"> <p>Data grids typically behave in a peer-to-peer fashion. Infinispan, for example, makes use of <a href="http://www.jgroups.org">JGroups</a> as a group communication library and is hence biased towards a peer-to-peer design. Such design allows Infinispan to exhibit self-healing characteristics, providing service even when individual servers fail and new nodes are dynamically added to the grid.</p> </div> <div class="paragraph"> <p>Infinispan also makes use of TCP and optionally UDP network protocols, and can be configured to make use of IP multicast for efficiency if supported by the network.</p> </div> </div> <div class="sect2"> <h3 id="deadlock"><a class="anchor" href="#deadlock"></a>2.16. Deadlock</h3> <div class="paragraph"> <p>A deadlock is a situation in which two or more competing actions are each waiting for the other to finish, and thus neither ever does.</p> </div> </div> <div class="sect2"> <h3 id="distributed_hash_table_dht"><a class="anchor" href="#distributed_hash_table_dht"></a>2.17. Distributed Hash Table (DHT)</h3> <div class="paragraph"> <p>A distributed hash table (DHT) is a class of a decentralized distributed system that provides a lookup service similar to a hash table; (key, value) pairs are stored in a DHT, and any participating node can efficiently retrieve the value associated with a given key. Responsibility for maintaining the mapping from keys to values is distributed among the nodes, in such a way that a change in the set of participants causes a minimal amount of disruption. This allows a DHT to scale to extremely large numbers of nodes and to handle continual node arrivals, departures, and failures.</p> </div> </div> <div class="sect2"> <h3 id="externalizer"><a class="anchor" href="#externalizer"></a>2.18. Externalizer</h3> <div class="paragraph"> <p>An <em>Externalizer</em> is a class that knows how to marshall a given object type to a byte array, and how to unmarshall the contents of a byte array into an instance of the object type. Externalizers are effectively an Infinispan extension that allows users to specify how their types are serialized. The underlying Infinispan marshalling infrastructure builds on <a href="http://www.jboss.org/jbossmarshalling">JBoss Marshalling</a> , and offers efficient payloads and stream caching. This provides much better performance than standard Java serialization.</p> </div> </div> <div class="sect2"> <h3 id="hot_rod"><a class="anchor" href="#hot_rod"></a>2.19. Hot Rod</h3> <div class="paragraph"> <p><em>Hot Rod</em> is the name of Infinispan&#8217;s custom TCP client/server protocol which was created in order to overcome the deficiencies of other client/server protocols such as Memcached. HotRod, as opposed to other protocols, has the ability of handling failover on an Infinispan server cluster that undergoes a topology change. To achieve this, the Hot Rod regularly informs the clients of the cluster topology.</p> </div> <div class="paragraph"> <p>Hot Rod enables clients to do smart routing of requests in partitioned, or distributed, Infinispan server clusters. This means that Hot Rod clients can determine the partition in which a key is located and communicate directly with the server that contains the key. This is made possible by Infinispan servers sending the cluster topology to clients, and the clients using the same consistent hash as the servers.</p> </div> </div> <div class="sect2"> <h3 id="in_memory_data_grid"><a class="anchor" href="#in_memory_data_grid"></a>2.20. In-memory data grid</h3> <div class="paragraph"> <p>An in-memory data grid (IMDG) is a special type of data grid. In an IMDG, each server uses its main system memory (RAM) as primary storage for data (as opposed to disk-based storage). This allows for much greater concurrency, as lock-free <a href="http://en.wikipedia.org/wiki/Software_transactional_memory">STM</a> techniques such as <a href="http://en.wikipedia.org/wiki/Compare-and-swap">compare-and-swap</a> can be used to allow hardware threads accessing concurrent datasets. As such, IMDGs are often considered far better optimized for a multi-core and multi-CPU world when compared to disk-based solutions. In addition to greater concurrency, IMDGs offer far lower latency access to data (even when compared to disk-based data grids using <a href="http://en.wikipedia.org/wiki/Solid-state_drive">solid state drives</a> ).</p> </div> <div class="paragraph"> <p>The tradeoff is capacity. Disk-based grids, due to the far greater capacity of hard disks, exhibit two (or even three) orders of magnitude greater capacity for the same hardware cost.</p> </div> </div> <div class="sect2"> <h3 id="isolation_level"><a class="anchor" href="#isolation_level"></a>2.21. Isolation level</h3> <div class="paragraph"> <p>Isolation is a property that defines how/when the changes made by one operation become visible to other concurrent operations. Isolation is one of the <em>ACID</em> properties.</p> </div> <div class="paragraph"> <p>Infinispan ships with REPEATABLE_READ and READ_COMMITTED isolation levels, the latter being the default.</p> </div> </div> <div class="sect2"> <h3 id="jta_synchronization"><a class="anchor" href="#jta_synchronization"></a>2.22. JTA synchronization</h3> <div class="paragraph"> <p>A <a href="https://docs.oracle.com/javaee/7/api/javax/transaction/Synchronization.html">Synchronization</a> is a listener which receives events relating to the transaction lifecycle. A Synchronization implementor receives two events, <em>before completion</em> and <em>after completion</em> . Synchronizations are useful when certain activities are required in the case of a transaction completion; a common usage for a Synchronization is to flush an application&#8217;s caches.</p> </div> </div> <div class="sect2"> <h3 id="livelock"><a class="anchor" href="#livelock"></a>2.23. Livelock</h3> <div class="paragraph"> <p>A livelock is similar to a deadlock, except that the states of the processes involved in the livelock constantly change with regard to one another, none progressing.</p> </div> <div class="paragraph"> <p>A real-world example of livelock occurs when two people meet in a narrow corridor, and each tries to be polite by moving aside to let the other pass, but they end up swaying from side to side without making any progress because they both repeatedly move the same way at the same time.</p> </div> </div> <div class="sect2"> <h3 id="memcached"><a class="anchor" href="#memcached"></a>2.24. Memcached</h3> <div class="paragraph"> <p>Memcached is an in-memory caching system, often used to speed-up database-driven websites. Memcached also defines a text based, client/server, caching protocol, known as the Memcached protocol Infinispan offers a server which speaks the Memcached protocol, allowing Memcached itself to be replaced by Infinispan. Thanks to Infinispan&#8217;s clustering capabilities, it can offer data failover capabilities not present in original Memcached systems.</p> </div> </div> <div class="sect2"> <h3 id="multiversion_concurrency_control_mvcc"><a class="anchor" href="#multiversion_concurrency_control_mvcc"></a>2.25. Multiversion Concurrency Control (MVCC)</h3> <div class="paragraph"> <p>Multiversion concurrency control is a concurrency control method commonly used by database management systems to provide concurrent access to the database and in programming languages to implement transactional memory.</p> </div> <div class="ulist"> <div class="title">More resources</div> <ul> <li> <p><a href="http://en.wikipedia.org/wiki/Multiversion_concurrency_control">Wikipedia</a></p> </li> </ul> </div> </div> <div class="sect2"> <h3 id="near_cache"><a class="anchor" href="#near_cache"></a>2.26. Near Cache</h3> <div class="paragraph"> <p>A technique for caching data in the client when communicating with a remote cache, for example, over the <em>Hot Rod</em> protocol. This technique helps minimize remote calls to retrieve data.</p> </div> </div> <div class="sect2"> <h3 id="network_partition"><a class="anchor" href="#network_partition"></a>2.27. Network partition</h3> <div class="paragraph"> <p>Network partitions happens when multiple parts of a cluster become separated due to some type of network failure, whether permanent or temporary. Often temporary failures heal spontaneously, within a few seconds or at most minutes, but the damage that can occur during a network partition can lead to inconsistent data. Closely tied to <a href="http://en.wikipedia.org/wiki/CAP_theorem">Brewer&#8217;s CAP theorem</a>, distributed systems choose to deal with a network partition by either sacrificing availability (either by shutting down or going into read-only mode) or consistency by allowing concurrent and divergent updates to the same data.</p> </div> <div class="paragraph"> <p>Network partitions are also commonly known as a <em>Split Brain</em>, after the biological condition of the same name.</p> </div> <div class="paragraph"> <p>For more detailed discussion, see <a href="http://codahale.com/you-cant-sacrifice-partition-tolerance/">this blog post</a>.</p> </div> </div> <div class="sect2"> <h3 id="nosql"><a class="anchor" href="#nosql"></a>2.28. NoSQL</h3> <div class="paragraph"> <p>A NoSQL database provides a mechanism for storage and retrieval of data that employs less constrained consistency models than traditional relational databases. Motivations for this approach include simplicity of design, horizontal scaling and finer control over availability. NoSQL databases are often highly optimized keyvalue stores intended for simple retrieval and appending operations, with the goal being significant performance benefits in terms of latency and throughput. NoSQL databases are finding significant and growing industry use in big data and real-time web applications.</p> </div> </div> <div class="sect2"> <h3 id="optimistic_locking"><a class="anchor" href="#optimistic_locking"></a>2.29. Optimistic locking</h3> <div class="paragraph"> <p>Optimistic locking is a concurrency control method that assumes that multiple transactions can complete without affecting each other, and that therefore transactions can proceed without locking the data resources that they affect. Before committing, each transaction verifies that no other transaction has modified its data. If the check reveals conflicting modifications, the committing transaction rolls back.</p> </div> </div> <div class="sect2"> <h3 id="pessimistic_locking"><a class="anchor" href="#pessimistic_locking"></a>2.30. Pessimistic locking</h3> <div class="paragraph"> <p>A lock is used when multiple threads need to access data concurrently. This prevents data from being corrupted or invalidated when multiple threads try to modify the same item of data. Any single thread can only modify data to which it has applied a lock that gives them exclusive access to the record until the lock is released. However, pessimistic locking isn&#8217;t ideal from a throughput perspective, as locking is expensive and serializing writes may not be desired. <em>Optimistic locking</em> is often seen as a preferred alternative in many cases.</p> </div> </div> <div class="sect2"> <h3 id="read_committed"><a class="anchor" href="#read_committed"></a>2.31. READ COMMITTED</h3> <div class="paragraph"> <p>READ_COMMITTED is one of two isolation levels the Infinispan&#8217;s locking infrastructure provides (the other is REPEATABLE_READ). Isolation levels <a href="http://en.wikipedia.org/wiki/Isolation_level#READ_COMMITTED">have their origins</a> in relational databases.</p> </div> <div class="paragraph"> <p>In Infinispan, READ_COMMITTED works slightly differently to databases. READ_COMMITTED says that "data can be read as long as there is no write", however in Infinispan, reads can happen anytime thanks to <em>MVCC</em>. MVCC allows writes to happen on copies of data, rather than on the data itself. Thus, even in the presence of a write, reads can still occur, and all read operations in Infinispan are non-blocking (resulting in increased performance for the end user). On the other hand, write operations are exclusive in Infinispan, (and so work the same way as READ_COMMITTED does in a database).</p> </div> <div class="paragraph"> <p>With READ_COMMITTED, multiple reads of the same key within a transaction can return different results, and this phenomenon is known as <a href="http://en.wikipedia.org/wiki/Isolation_level#Non-repeatable_reads">non-repeatable reads</a>. This issue is avoided with REPETEABLE_READ isolation level.</p> </div> </div> <div class="sect2"> <h3 id="relational_database_management_system_rdbms"><a class="anchor" href="#relational_database_management_system_rdbms"></a>2.32. Relational Database Management System (RDBMS)</h3> <div class="paragraph"> <p>A relational database management system (RDBMS) is a database management system that is based on the relational model. Many popular databases currently in use are based on the relational database model.</p> </div> </div> <div class="sect2"> <h3 id="repeatable_read"><a class="anchor" href="#repeatable_read"></a>2.33. REPEATABLE READ</h3> <div class="paragraph"> <p>REPEATABLE_READ is one of two isolation levels the Infinispan&#8217;s locking infrastructure provides (the other is READ_COMMITTED). Isolation levels <a href="http://en.wikipedia.org/wiki/Isolation_level#REPEATABLE_READ">have their origins</a> in relational databases.</p> </div> <div class="paragraph"> <p>In Infinispan, REPEATABLE_READ works slightly differently to databases. REPEATABLE_READ says that "data can be read as long as there are no writes, and vice versa". This avoids the <a href="http://en.wikipedia.org/wiki/Isolation_level#Non-repeatable_reads">non-repeatable reads</a> phenomenon, because once data has been written, no other transaction can read it, so there&#8217;s no chance of re-reading the data and finding different data.</p> </div> <div class="paragraph"> <p>Some definitions of REPEATABLE_READ say that this isolation level places shared locks on read data; such lock could not be acquired when the entry is being written. However, Infinispan has an MVCC concurrency model that allows it to have non-blocking reads. Infinispan provides REPEATABLE_READ semantics by keeping the previous value whenever an entry is modified. This allows Infinispan to retrieve the previous value if a second read happens within the same transaction, but it allows following phenomena:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java">cache.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">A</span><span class="delimiter">&quot;</span></span>) <span class="comment">// returns 1</span>
cache.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">B</span><span class="delimiter">&quot;</span></span>) <span class="comment">// returns 1</span>

Thread1: tx1.begin()
Thread1: cache.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">A</span><span class="delimiter">&quot;</span></span>, <span class="integer">2</span>)
Thread1: cache.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">B</span><span class="delimiter">&quot;</span></span>, <span class="integer">2</span>)
Thread2:                                       tx2.begin()
Thread2:                                       cache.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">A</span><span class="delimiter">&quot;</span></span>) <span class="comment">// returns 1</span>
Thread1: tx1.commit()
Thread2:                                       cache.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">B</span><span class="delimiter">&quot;</span></span>) <span class="comment">// returns 2</span>
Thread2:                                       tx2.commit()</code></pre> </div> </div> <div class="paragraph"> <p>By default, Infinispan uses REPEATABLE_READ as isolation level.</p> </div> </div> <div class="sect2"> <h3 id="representational_state_transfer_rest"><a class="anchor" href="#representational_state_transfer_rest"></a>2.34. Representational State Transfer (ReST)</h3> <div class="paragraph"> <p>ReST is a software architectural style that promotes accessing resources via a uniform generic interface. HTTP is an implementation of this architecture, and generally when ReST is mentioned, it refers to ReST over HTTP protocol. When HTTP is used, the uniform generic interface for accessing resources is formed of GET, PUT, POST, DELETE and HEAD operations.</p> </div> <div class="paragraph"> <p>Infinispan&#8217;s ReST server offers a ReSTful API based on these HTTP methods, and allow data to be stored, retrieved and deleted.</p> </div> </div> <div class="sect2"> <h3 id="split_brain"><a class="anchor" href="#split_brain"></a>2.35. Split brain</h3> <div class="paragraph"> <p>A colloquial term for a <em>network partition</em>. See <em>network partition</em> for more details.</p> </div> </div> <div class="sect2"> <h3 id="structured_query_language_sql"><a class="anchor" href="#structured_query_language_sql"></a>2.36. Structured Query Language (SQL)</h3> <div class="paragraph"> <p>SQL is a special-purpose programming language designed for managing data held in a relational database management system (RDBMS). Originally based upon relational algebra and tuple relational calculus, SQL consists of a data definition language and a data manipulation language. The scope of SQL includes data insert, query, update and delete, schema creation and modification, and data access control.</p> </div> </div> <div class="sect2"> <h3 id="write_behind"><a class="anchor" href="#write_behind"></a>2.37. Write-behind</h3> <div class="paragraph"> <p><em>Write-behind</em> is a cache store update mode. When this mode is used, updates to the cache are asynchronously written to the cache store. Normally this means that updates to the cache store are not performed in the client thread.</p> </div> <div class="paragraph"> <p>An alternative cache store update mode is <em>write-through</em>.</p> </div> </div> <div class="sect2"> <h3 id="write_skew"><a class="anchor" href="#write_skew"></a>2.38. Write skew</h3> <div class="paragraph"> <p>In a write skew anomaly, two transactions (T1 and T2) concurrently read an overlapping data set (e.g. values V1 and V2), concurrently make disjoint updates (e.g. T1 updates V1, T2 updates V2), and finally concurrently commit, neither having seen the update performed by the other. Were the system serializable, such an anomaly would be impossible, as either T1 or T2 would have to occur "first", and be visible to the other. In contrast, snapshot isolation such as REPEATABLE_READ and READ_COMMITTED permits write skew anomalies.</p> </div> <div class="paragraph"> <p>Infinispan can detect write skews and can be configured to roll back transactions when write skews are detected.</p> </div> </div> <div class="sect2"> <h3 id="write_through"><a class="anchor" href="#write_through"></a>2.39. Write-through</h3> <div class="paragraph"> <p><em>Write-through</em> is a cache store update mode. When this mode is used, clients update a cache entry, e.g. via a Cache.put() invocation, the call will not return until Infinispan has updated the underlying cache store. Normally this means that updates to the cache store are done in the client thread.</p> </div> <div class="paragraph"> <p>An alternative mode in which cache stores can be updated is <em>write-behind</em>.</p> </div> </div> <div class="sect2"> <h3 id="xa_resource"><a class="anchor" href="#xa_resource"></a>2.40. XA resource</h3> <div class="paragraph"> <p>An XA resource is a participant in an XA transaction (also known as a <a href="http://en.wikipedia.org/wiki/X/Open_XA">distributed transaction</a>). For example, given a distributed transaction that operates over a database and Infinispan, XA defines both Infinispan and the database as XA resources.</p> </div> <div class="paragraph"> <p>Java&#8217;s API for XA transactions is <a href="http://en.wikipedia.org/wiki/Java_Transaction_API">JTA</a> and <a href="https://docs.oracle.com/javase/8/docs/api/javax/transaction/xa/XAResource.html">XAResource</a> is the Java interface that describes an XA resource.</p> </div> </div> <div class="sect2"> <h3 id="upgrading_from_9_4_to_10_0"><a class="anchor" href="#upgrading_from_9_4_to_10_0"></a>2.41. Upgrading from 9.4 to 10.0</h3> <div class="sect3"> <h4 id="hot_rod_3_0"><a class="anchor" href="#hot_rod_3_0"></a>2.41.1. Hot Rod 3.0</h4> <div class="paragraph"> <p>Older versions of the Hot Rod protocol treated expiration values greater than the number of milliseconds in 30 days as Unix time. Starting with Hot Rod 3.0 this adjustment no longer happens and expiration is taken literally.</p> </div> </div> <div class="sect3"> <h4 id="total_order_transaction_protocol_is_deprecated"><a class="anchor" href="#total_order_transaction_protocol_is_deprecated"></a>2.41.2. Total Order transaction protocol is deprecated</h4> <div class="paragraph"> <p>Total Order transaction protocol is going to be removed in a future release. Use the default protocol (2PC).</p> </div> </div> <div class="sect3"> <h4 id="removed_the_infinispan_server_hotrod_workerthreads_system_property"><a class="anchor" href="#removed_the_infinispan_server_hotrod_workerthreads_system_property"></a>2.41.3. Removed the infinispan.server.hotrod.workerThreads system property</h4> <div class="paragraph"> <p>The <code>infinispan.server.hotrod.workerThreads</code> property was introduced as a hack to work around the fact that the configuration did not expose it. The property has been removed and endpoint worker threads must now be exclusively configured using the <code>worker-threads</code> attribute.</p> </div> </div> <div class="sect3"> <h4 id="removed_atomicmap_and_finegrainedatomicmap"><a class="anchor" href="#removed_atomicmap_and_finegrainedatomicmap"></a>2.41.4. Removed AtomicMap and FineGrainedAtomicMap</h4> <div class="paragraph"> <p>AtomicMapLookup, AtomicMap and FineGrainedAtomicMap have been removed. Please see FunctionalMaps or Cache#Merge for similar functionality.</p> </div> </div> <div class="sect3"> <h4 id="removed_delta_and_deltaaware"><a class="anchor" href="#removed_delta_and_deltaaware"></a>2.41.5. Removed Delta and DeltaAware</h4> <div class="paragraph"> <p>The previously deprecated Delta and DeltaAware interfaces have been removed.</p> </div> </div> <div class="sect3"> <h4 id="removed_compatibility_mode"><a class="anchor" href="#removed_compatibility_mode"></a>2.41.6. Removed compatibility mode</h4> <div class="paragraph"> <p>The previously deprecated Compatibility Mode has been removed.</p> </div> </div> <div class="sect3"> <h4 id="removed_the_implicit_default_cache"><a class="anchor" href="#removed_the_implicit_default_cache"></a>2.41.7. Removed the implicit default cache</h4> <div class="paragraph"> <p>The default cache must now be named explicitly via the <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/configuration/global/GlobalConfigurationBuilder.html#defaultCacheName(java.lang.String)">GlobalConfigurationBuilder#defaultCacheName()</a> method.</p> </div> </div> <div class="sect3"> <h4 id="removed_distributedexecutor"><a class="anchor" href="#removed_distributedexecutor"></a>2.41.8. Removed DistributedExecutor</h4> <div class="paragraph"> <p>The previously deprecated DistributedExecutor is now removed. References should be updated to use ClusterExecutor.</p> </div> </div> <div class="sect3"> <h4 id="removed_the_tree_module"><a class="anchor" href="#removed_the_tree_module"></a>2.41.9. Removed the Tree module</h4> <div class="paragraph"> <p>TreeCache has been unsupported for a long time and was only intended as a quick stopgap for JBossCache users. The module has now been removed completely.</p> </div> </div> <div class="sect3"> <h4 id="the_jdbc_pooledconnectionfactory_now_utilises_agroal"><a class="anchor" href="#the_jdbc_pooledconnectionfactory_now_utilises_agroal"></a>2.41.10. The JDBC PooledConnectionFactory now utilises Agroal</h4> <div class="paragraph"> <p>Previously the JDBC PooledConnectionFactory provided c3p0 and HikariCP based connection pools. From 10.0 we only provide a PooledConnectionFactory based upon the <a href="https://agroal.github.io/">Agroal project</a>. This means that it is no longer possible to utilise <code>c3p0.properties</code> and <code>hikari.properties</code> files to configure the pool, instead an agroal compatiblet properties file can be provided.</p> </div> </div> <div class="sect3"> <h4 id="xml_configuration_changes"><a class="anchor" href="#xml_configuration_changes"></a>2.41.11. XML configuration changes</h4> <div class="paragraph"> <p>Several configuration elements and attributes that were deprecated since 9.0 have been removed:</p> </div> <div class="ulist"> <ul> <li> <p><code>&lt;eviction&gt;</code> - replaced with <code>memory</code></p> </li> <li> <p><code>&lt;versioning&gt;</code> - automatically enabled</p> </li> <li> <p><code>&lt;data-container&gt;</code> - no longer customizable</p> </li> <li> <p><code>deadlock-detection-spin</code> - always disabled</p> </li> <li> <p><code>write-skew</code> - enabled automatically</p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="remotecache_changes"><a class="anchor" href="#remotecache_changes"></a>2.41.12. RemoteCache Changes</h4> <div class="sect4"> <h5 id="the_getbulk_methods_have_been_removed"><a class="anchor" href="#the_getbulk_methods_have_been_removed"></a>The getBulk methods have been removed</h5> <div class="paragraph"> <p>The getBulk method is an expensive method as it requires holding all keys in memory at once and requires a possibly very single result to populate it. The new retrieveEntries, entrySet, keySet and values methods handle this in a much more efficient way. Therefore the getBulk methods have been removed in favor of them.</p> </div> </div> </div> <div class="sect3"> <h4 id="persistence_changes"><a class="anchor" href="#persistence_changes"></a>2.41.13. Persistence changes</h4> <div class="ulist"> <ul> <li> <p>File-based cache stores (SingleFileStore, SoftIndexFileStore, RocksDBStore) filesystem layout has been normalized so that they will use the <code>GlobalStateConfiguration</code> persistent location as a default location. Additionally, all stores will now use the cache name as part of the data file/directory naming allowing multiple stores to avoid conflicts and ambiguity.</p> </li> <li> <p>The CLI loader (<code>infinispan-persistence-cli</code>) has been removed.</p> </li> <li> <p>The LevelDB store (<code>infinispan-cachestore-leveldb</code>) has been removed. Use the RocksDB store instead, as it is fully backwards compatible.</p> </li> <li> <p>The deprecated <code>singleton</code> store configuration option and the wrapper class <code>SingletonCacheWriter</code> have been removed.</p> <div class="paragraph"> <p>Using <code>shared=true</code> is enough, as only the primary owner of each key will write to a shared store.</p> </div> </li> </ul> </div> </div> <div class="sect3"> <h4 id="clientserver_changes"><a class="anchor" href="#clientserver_changes"></a>2.41.14. Client/Server changes</h4> <div class="ulist"> <ul> <li> <p>The Hot Rod client and server only support protocol versions 2.0 and higher. Support for Hot Rod versions 1.0 to 1.3 has been dropped.</p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="skip_listener_notification_flag"><a class="anchor" href="#skip_listener_notification_flag"></a>2.41.15. SKIP_LISTENER_NOTIFICATION flag</h4> <div class="paragraph"> <p><code>SKIP_LISTENER_NOTIFICATION</code> notification flag has been added in the hotrod client. This flag only works when the client and the server version is 9.4.15 or higher. Spring Session integration uses this flag when a session id has changed. If you are using Spring Session with Infinispan 9.4, consider upgrading the client and the server.</p> </div> </div> <div class="sect3"> <h4 id="performasync_header_removed_from_rest"><a class="anchor" href="#performasync_header_removed_from_rest"></a>2.41.16. performAsync header removed from REST</h4> <div class="paragraph"> <p>The <code>performAsync</code> header was removed from the REST server. Clients that want to perform async operations with the REST server should manage the request and response on their side to avoid blocking.</p> </div> </div> <div class="sect3"> <h4 id="default_jgroups_stacks_in_the_xml_configuration"><a class="anchor" href="#default_jgroups_stacks_in_the_xml_configuration"></a>2.41.17. Default JGroups stacks in the XML configuration</h4> <div class="paragraph"> <p>With the introduction of inline XML JGroups stacks in the configuration, two default stacks are always enabled: <code>udp</code> and <code>tcp</code>. If you are declaring your own stacks with the same names, an exception reporting the conflict will be thrown. Simply rename your own configurations to avoid the conflict.</p> </div> </div> <div class="sect3"> <h4 id="jgroups_s3_ping_replaced_with_native_s3_ping"><a class="anchor" href="#jgroups_s3_ping_replaced_with_native_s3_ping"></a>2.41.18. JGroups S3_PING replaced with NATIVE_S3_PING</h4> <div class="paragraph"> <p>Because of changes in AWS&#8217;s access policy regarding signatures, S3_PING will not work in newer regions and will stop working in older regions too. For this reason, you should migrate to using NATIVE_S3_PING instead.</p> </div> </div> <div class="sect3"> <h4 id="cache_and_cache_manager_listeners_can_now_be_configured_to_be_non_blocking"><a class="anchor" href="#cache_and_cache_manager_listeners_can_now_be_configured_to_be_non_blocking"></a>2.41.19. Cache and Cache Manager Listeners can now be configured to be non blocking</h4> <div class="paragraph"> <p>Listeners in the past that were sync, always ran in the thread that caused the event. We now allow a Listener method to be non-blocking in that it will still fire in the original thread, under the assumption that it will return immediately. Please read the Listener Javadoc for information and examples on this.</p> </div> </div> <div class="sect3"> <h4 id="distributed_streams_operations_no_longer_support_null_values"><a class="anchor" href="#distributed_streams_operations_no_longer_support_null_values"></a>2.41.20. Distributed Streams operations no longer support null values</h4> <div class="paragraph"> <p>Distributed Streams has parts rewritten to utilize non blocking reactive streams based operations. As such null values are not supported as values from operations as per the reactive streams spec. Please utilize other means to denote a null value.</p> </div> </div> <div class="sect3"> <h4 id="removed_the_infinispan_cloud_module"><a class="anchor" href="#removed_the_infinispan_cloud_module"></a>2.41.21. Removed the infinispan-cloud module</h4> <div class="paragraph"> <p>The infinispan-cloud module has been removed and the <code>kubernetes</code>, <code>ec2</code>, <code>google</code> and <code>azure</code> default configurations have been included in <code>infinispan-core</code> and can be referenced as default named JGroups configurations.</p> </div> </div> <div class="sect3"> <h4 id="removed_experimental_flag_guaranteed_delivery"><a class="anchor" href="#removed_experimental_flag_guaranteed_delivery"></a>2.41.22. Removed experimental flag GUARANTEED_DELIVERY</h4> <div class="paragraph"> <p>Almost as soon as GUARANTEED_DELIVERY was added, UNICAST3 and NAKACK2.resend_last_seqno removed the need for it. It was always documented as experimental, so we removed it without deprecation and we also removed the RSVP protocol from the default JGroups stacks.</p> </div> </div> <div class="sect3"> <h4 id="cache_health"><a class="anchor" href="#cache_health"></a>2.41.23. Cache Health</h4> <div class="paragraph"> <p>The possible statuses of the cache health are now HEALTHY, HEALTHY_REBALANCING and DEGRADED to better reflect the fact that <code>rebalancing</code> doesn&#8217;t mean a cluster is unhealthy.</p> </div> </div> <div class="sect3"> <h4 id="multi_tenancy"><a class="anchor" href="#multi_tenancy"></a>2.41.24. Multi-tenancy</h4> <div class="paragraph"> <p>When using multi-tenancy in the Wildfly based server, it&#8217;s necessary to specify the <code>content-path</code> for each of the REST connectors, to match the <code>prefix</code> element under <code>multi-tenancy\rest\prefix</code>.</p> </div> </div> <div class="sect3"> <h4 id="offheap_automatic_resizing"><a class="anchor" href="#offheap_automatic_resizing"></a>2.41.25. OffHeap Automatic Resizing</h4> <div class="paragraph"> <p>Off Heap memory containers now will dynamically resize based on number of entries in the container. Due to this the address count configuration value is now deprecated for APIs and has been removed from the xml parser.</p> </div> </div> </div> <div class="sect2"> <h3 id="upgrading_from_9_3_to_9_4"><a class="anchor" href="#upgrading_from_9_3_to_9_4"></a>2.42. Upgrading from 9.3 to 9.4</h3> <div class="sect3"> <h4 id="clientserver_changes_2"><a class="anchor" href="#clientserver_changes_2"></a>2.42.1. Client/Server changes</h4> <div class="sect4"> <h5 id="compatibility_mode_deprecation"><a class="anchor" href="#compatibility_mode_deprecation"></a>Compatibility mode deprecation</h5> <div class="paragraph"> <p>Compatibility mode has been deprecated and will be removed in the next Infinispan version.</p> </div> <div class="paragraph"> <p>To use a cache from multiple endpoints, it is recommended to store data in binary format and to configure the MediaType for keys and values.</p> </div> <div class="paragraph"> <p>If storing data as unmarshalled objects is still desired, the equivalent of compatibility mode is to configure keys and values to store object content:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;encoding&gt;</span>
   <span class="tag">&lt;key</span> <span class="attribute-name">media-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application/x-java-object</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
   <span class="tag">&lt;value</span> <span class="attribute-name">media-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application/x-java-object</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/encoding&gt;</span></code></pre> </div> </div> </div> <div class="sect4"> <h5 id="memcached_storage"><a class="anchor" href="#memcached_storage"></a>Memcached storage</h5> <div class="paragraph"> <p>For better interoperability between endpoints, the Memcached server no longer stores keys as <code>java.lang.String</code>, but as UTF-8 <code>byte[]</code>.</p> </div> <div class="paragraph"> <p>If using memcached, it&#8217;s recommended to run a rolling upgrade from 9.3 to store data in the new format, or reload the data in the cache.</p> </div> </div> <div class="sect4"> <h5 id="scripts_response"><a class="anchor" href="#scripts_response"></a>Scripts Response</h5> <div class="paragraph"> <p>Distributed scripts with text-based data type no longer return <code>null</code> when the result from each server is null. The response is now a JSON array with each individual result, e.g. <code>"[null, null]"</code></p> </div> </div> <div class="sect4"> <h5 id="websocket_endpoint_removal"><a class="anchor" href="#websocket_endpoint_removal"></a>WebSocket endpoint removal</h5> <div class="paragraph"> <p>The WebSocket endpoint has been unmaintained for several years. It has been removed.</p> </div> </div> <div class="sect4"> <h5 id="hot_rod_client_connection_pool_properties"><a class="anchor" href="#hot_rod_client_connection_pool_properties"></a>Hot Rod client connection pool properties</h5> <div class="paragraph"> <p>Since the Hot Rod client was overhauled in 9.2, the way the connection pool configuration is handled has changed. Infinispan 9.4 introduces a new naming scheme for the connection pool properties which deprecates the old <em>commons-pool</em> names. For a complete reference of the available configuration options for the properties file please refer to <a href="https://docs.jboss.org/infinispan/10.0/apidocs/org/infinispan/client/hotrod/configuration/package-summary.html#package.description">remote client configuration</a> javadoc.</p> </div> </div> <div class="sect4"> <h5 id="server_thread_pools"><a class="anchor" href="#server_thread_pools"></a>Server thread pools</h5> <div class="paragraph"> <p>The threads that handle the child Netty event loops have been renamed from *-ServerWorker to *-ServerIO</p> </div> </div> </div> <div class="sect3"> <h4 id="persistence_changes_2"><a class="anchor" href="#persistence_changes_2"></a>2.42.2. Persistence Changes</h4> <div class="sect4"> <h5 id="shared_and_passivation"><a class="anchor" href="#shared_and_passivation"></a>Shared and Passivation</h5> <div class="paragraph"> <p>A store cannot be configured as both shared and having passivation enabled. Doing so can cause data inconsistencies as there is no way to synchronize data between all the various nodes. As such this configuration will now cause a startup exception. Please update your configuration as appropriate.</p> </div> </div> </div> <div class="sect3"> <h4 id="query_changes"><a class="anchor" href="#query_changes"></a>2.42.3. Query changes</h4> <div class="sect4"> <h5 id="affinityindexmanager"><a class="anchor" href="#affinityindexmanager"></a>AffinityIndexManager</h5> <div class="paragraph"> <p>The default number of shards is down to <code>4</code>, it was previously equals to the number of segments in the cache.</p> </div> </div> </div> </div> <div class="sect2"> <h3 id="upgrading_from_9_2_to_9_3"><a class="anchor" href="#upgrading_from_9_2_to_9_3"></a>2.43. Upgrading from 9.2 to 9.3</h3> <div class="sect3"> <h4 id="advancedcacheloader_changes"><a class="anchor" href="#advancedcacheloader_changes"></a>2.43.1. AdvancedCacheLoader changes</h4> <div class="paragraph"> <p>The AdvancedCacheLoader SPI has been enhanced to provide an alternative method to process and instead allows reactive streams based publishKeys and publishEntries methods which provide benefits in performance, threading and ease of use. Note this change will only affect you if you wish take advantage of it in any custom CacheLoaders you may have implemented.</p> </div> </div> <div class="sect3"> <h4 id="partition_handling_configuration"><a class="anchor" href="#partition_handling_configuration"></a>2.43.2. Partition Handling Configuration</h4> <div class="paragraph"> <p>In 9.3 the default MergePolicy is now MergePolicy.NONE, opposed to MergePolicy.PREFERRED_ALWAYS.</p> </div> </div> <div class="sect3"> <h4 id="stat_changes"><a class="anchor" href="#stat_changes"></a>2.43.3. Stat Changes</h4> <div class="paragraph"> <p>We have reverted the stat changes introduced in 9.1, so average values for read, write and removals are once again returned as milliseconds.</p> </div> </div> <div class="sect3"> <h4 id="event_log_changes"><a class="anchor" href="#event_log_changes"></a>2.43.4. Event log changes</h4> <div class="paragraph"> <p>Several new event log messages have been added, and one message has been removed (ISPN100013).</p> </div> </div> <div class="sect3"> <h4 id="max_idle_expiration_changes"><a class="anchor" href="#max_idle_expiration_changes"></a>2.43.5. Max Idle Expiration Changes</h4> <div class="paragraph"> <p>The max idle entry expiration information is sent between owners in the cluster. However when an entry expires via max idle on a given node, this was not replicated (only removing it locally). Max idle has been enhanced to now expire an entry across the entire cluster, instead of per node. This includes ensuring that max idle expiration is applied across all owners (meaning if another node has accessed the entry within the given time it will prevent that entry from expiring on other nodes that didn&#8217;t have an access).</p> </div> <div class="paragraph"> <p>Max idle in a transactional clustered cache does not remove expired entries on access (although it will not be returned). These entries are only removed via the expiration reaper.</p> </div> <div class="paragraph"> <p>Iteration in a clustered cache will still show entries that are expired via maxIdle to ensure good performance, but could be removed at any point due to expiration reaper.</p> </div> </div> <div class="sect3"> <h4 id="wildfly_modules"><a class="anchor" href="#wildfly_modules"></a>2.43.6. Wildfly Modules</h4> <div class="paragraph"> <p>The Infinispan Wildfly modules are now located in the <code>system/add-ons/ispn</code> dir as per the <a href="https://developer.jboss.org/wiki%20/LayeredDistributionsAndModulePathOrganization">Wildfly module conventions</a>.</p> </div> </div> <div class="sect3"> <h4 id="deserialization_whitelist"><a class="anchor" href="#deserialization_whitelist"></a>2.43.7. Deserialization Whitelist</h4> <div class="paragraph"> <p>Deserialization of content sent by clients to the server are no longer allowed by default. This applies to JSON, XML, and marshalled byte[] that, depending on the cache configuration, will cause the server to convert it to Java Objects either to store it or to perform any operation that cannot be done on a byte[] directly.</p> </div> <div class="paragraph"> <p>The deserialization needs to be enabled using system properties, ether by class name or regular expressions:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code>// Comma separated list of fully qualified class names
-Dinfinispan.deserialization.whitelist.classes=java.time.Instant,com.myclass.Entity

// Regex expression
-Dinfinispan.deserialization.whitelist.regexps=.*</code></pre> </div> </div> </div> </div> <div class="sect2"> <h3 id="upgrading_from_9_0_to_9_1"><a class="anchor" href="#upgrading_from_9_0_to_9_1"></a>2.44. Upgrading from 9.0 to 9.1</h3> <div class="sect3"> <h4 id="kubernetes_ping_changes"><a class="anchor" href="#kubernetes_ping_changes"></a>2.44.1. Kubernetes Ping changes</h4> <div class="paragraph"> <p>The latest version of Kubernetes Ping uses unified environmental variables for both Kubernetes and OpenShift. Some of them were shortened for example <code>OPENSHIFT_KUBE_PING_NAMESPACE</code> was changed to <code>KUBERNETES_NAMESPACE</code>. Please refer to <a href="https://github.com/jgroups-extras/jgroups-kubernetes/blob/master/README.adoc">Kubernetes Ping documentation</a>.</p> </div> </div> <div class="sect3"> <h4 id="stat_changes_2"><a class="anchor" href="#stat_changes_2"></a>2.44.2. Stat Changes</h4> <div class="paragraph"> <p>Average values for read, write and removals are now returned in Nanoseconds, opposed to Milliseconds.</p> </div> </div> <div class="sect3"> <h4 id="finegrainedatomicmap_reimplemented"><a class="anchor" href="#finegrainedatomicmap_reimplemented"></a>2.44.3. (FineGrained)AtomicMap reimplemented</h4> <div class="paragraph"> <p>Infinispan now contains a new implementation of both <code>AtomicMap</code> and <code>FineGrainedAtomicMap</code>, but the semantics has been preserved. The new implementation does not use <code>DeltaAware</code> interface but the Functional API instead.</p> </div> <div class="paragraph"> <p>There are no changes needed for <code>AtomicMap</code>, but it now supports non-transactional use case as well.</p> </div> <div class="paragraph"> <p><code>FineGrainedAtomicMap</code> now uses the Grouping API and therefore you need to enable groups in configuration. Also it holds entries as regular cache entries, plus one cache entry for cached key set (the map itself). Therefore the cache size or iteration/streaming results may differ. Note that fine grained atomic maps are still supported on transactional caches only.</p> </div> </div> <div class="sect3"> <h4 id="remotecache_keysetentrysetvalues"><a class="anchor" href="#remotecache_keysetentrysetvalues"></a>2.44.4. RemoteCache keySet/entrySet/values</h4> <div class="paragraph"> <p>RemoteCache now implements all of the collection backed methods from <code>Map</code> interface. Previously <code>keySet</code> was implemented, however it was a deep copy. This has now changed and it is a backing set. That is that the set retrieves the updated values on each invocation or updates to the backing remote cache for writes. The entrySet and values methods are also now supported as backing variants as well.</p> </div> <div class="paragraph"> <p>If you wish to have a copy like was provided before it is recommended to copy the contents into a in memory local set such as</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Set</span>&lt;K&gt; keysCopy = remoteCache.keySet().stream().collect(Collectors.toSet());</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="deltaaware_deprecated"><a class="anchor" href="#deltaaware_deprecated"></a>2.44.5. DeltaAware deprecated</h4> <div class="paragraph"> <p>Interfaces <code>DeltaAware</code>, <code>Delta</code> and <code>CopyableDeltaAware</code> have been deprecated. Method <code>AdvancedCache.applyDelta()</code> has been deprecated and the implementation does not allow custom set of locked keys. <code>ApplyDeltaCommand</code> and its uses in interceptor stack are deprecated.</p> </div> <div class="paragraph"> <p>Any partial updates to an entry should be replaced using the Functional API.</p> </div> </div> <div class="sect3"> <h4 id="infinispan_query_configuration"><a class="anchor" href="#infinispan_query_configuration"></a>2.44.6. Infinispan Query Configuration</h4> <div class="paragraph"> <p>The configuration property <code>directory_provider</code> now accepts a new value <code>local-heap</code>. This value replaces the now deprecated <code>ram</code>, and as its predecessor will cause the index to be stored in a <code>org.apache.lucene.store.RAMDirectory</code>.</p> </div> <div class="paragraph"> <p>The configuration value <code>ram</code> is still accepted and will have the same effect, but failing to replace <code>ram</code> with <code>local-heap</code> will cause a warning to be logged. We suggest to perform this replacement, as the <code>ram</code> value will no longer be recognised by Infinispan in a future version.</p> </div> <div class="paragraph"> <p>This change was made as the team believes the <code>local-heap</code> name better expresses the storage model, especially as this storage method will not allow real-time replication of the index across multiple nodes. This index storage option is mostly useful for single node integration testing of the query functionality.</p> </div> </div> <div class="sect3"> <h4 id="store_batch_size_changes"><a class="anchor" href="#store_batch_size_changes"></a>2.44.7. Store Batch Size Changes</h4> <div class="paragraph"> <p>TableManipulation::batchSize and JpaStoreConfiguration::batchSize have been deprecated and replaced by the higher level AbstractStoreConfiguration::maxBatchSize.</p> </div> </div> <div class="sect3"> <h4 id="partition_handling_changes"><a class="anchor" href="#partition_handling_changes"></a>2.44.8. Partition Handling changes</h4> <div class="paragraph"> <p>In Infinispan 9.1 partition handling has been improved to allow for automatic conflict resolution on partition merges. Consequently, PartitionHandlingConfiguration::enabled has been deprecated in favour of PartitionHandlingConfiguration::whenSplit. Configuring whenSplit to the DENY_READ_WRITES strategy is equivalent to setting enabled to true, whilst specifying ALLOW_READ_WRITES is equivalent to disabling partition handling (default).</p> </div> <div class="paragraph"> <p>Furthermore, during a partition merge with ALLOW_READ_WRITES, the default EntryMergePolicy is MergePolicies.PREFERRED_ALWAYS which provides a deterministic way of tie-breaking CacheEntry conflicts. If you require the old behaviour, simply set the merge-policy to null.</p> </div> </div> </div> <div class="sect2"> <h3 id="upgrading_from_8_x_to_9_0"><a class="anchor" href="#upgrading_from_8_x_to_9_0"></a>2.45. Upgrading from 8.x to 9.0</h3> <div class="sect3"> <h4 id="default_transaction_mode_changed"><a class="anchor" href="#default_transaction_mode_changed"></a>2.45.1. Default transaction mode changed</h4> <div class="paragraph"> <p>The default configuration for transactional caches changed from <code>READ_COMMITTED</code> and <code>OPTIMISTIC</code> locking to <code>REPEATABLE_READ</code> and <code>OPTIMISTIC</code> locking with <code>write-skew</code> enabled.</p> </div> <div class="paragraph"> <p>Also, using the <code>REPEATABLE_READ</code> isolation level and <code>OPTIMISTIC</code> locking without <code>write-skew</code> enabled is no longer allowed. To help with the upgrade, <code>write-skew</code> will be automatically enabled in this case.</p> </div> <div class="paragraph"> <p>The following configuration has been deprecated:</p> </div> <div class="ulist"> <ul> <li> <p><code>write-skew</code>: as said, it is automatically enabled.</p> </li> <li> <p><code>&lt;versioning&gt;</code> and its attributes. It is automatically enabled and configured when needed.</p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="removed_eagerlocking_and_eagerlockingsinglenode_configuration_settings"><a class="anchor" href="#removed_eagerlocking_and_eagerlockingsinglenode_configuration_settings"></a>2.45.2. Removed eagerLocking and eagerLockingSingleNode configuration settings</h4> <div class="paragraph"> <p>Both were deprecated since version 5.1. <code>eagerLocking(true)</code> can be replaced with <code>lockingMode(LockingMode.PESSIMISTIC)</code>, and <code>eagerLockingSingleNode()</code> does not need a replacement because it was a no-op.</p> </div> </div> <div class="sect3"> <h4 id="removed_async_transaction_support"><a class="anchor" href="#removed_async_transaction_support"></a>2.45.3. Removed async transaction support</h4> <div class="paragraph"> <p>Asynchronous mode is no longer supported in transactional caches and it will automatically use the synchronous cache mode. In addition, the second phase of a transaction commit is done synchronously. The following methods (and related) are deprecated:</p> </div> <div class="ulist"> <ul> <li> <p><code>TransactionConfigurationBuilder.syncCommitPhase(boolean)</code></p> </li> <li> <p><code>TransactionConfigurationBuilder.syncRollbackPhase(boolean)</code></p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="deprecated_all_the_dummy_related_transaction_classes"><a class="anchor" href="#deprecated_all_the_dummy_related_transaction_classes"></a>2.45.4. Deprecated all the dummy related transaction classes.</h4> <div class="paragraph"> <p>The following classes have been deprecated and they will be removed in the future:</p> </div> <div class="ulist"> <ul> <li> <p><code>DummyBaseTransactionManager</code>: replaced by <code>EmbeddedBasedTransactionManager</code>;</p> </li> <li> <p><code>DummyNoXaXid</code> and <code>DummyXid</code>: replaced by <code>EmbeddedXid</code>;</p> </li> <li> <p><code>DummyTransaction</code>: replaced by <code>EmbeddedTransaction</code>;</p> </li> <li> <p><code>DummyTransactionManager</code>: replaced by <code>EmbeddedTransactionManager</code>;</p> </li> <li> <p><code>DummyTransactionManagerLookup</code> and <code>RecoveryDummyTransactionManagerLookup</code>: replaced by <code>EmbeddedTransactionManagerLookup</code>;</p> </li> <li> <p><code>DummyUserTransaction</code>: replaced by <code>EmbeddedUserTransaction</code>;</p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="clustering_configuration_changes"><a class="anchor" href="#clustering_configuration_changes"></a>2.45.5. Clustering configuration changes</h4> <div class="paragraph"> <p>The <code>mode</code> attribute in the XML declaration of clustered caches is no longer mandatory. It defaults to SYNC.</p> </div> </div> <div class="sect3"> <h4 id="default_cache_changes"><a class="anchor" href="#default_cache_changes"></a>2.45.6. Default Cache changes</h4> <div class="paragraph"> <p>Up to Infinispan 8.x, the default cache always implicitly existed, even if not declared in the XML configuration. Additionally, the default cache configuration affected all other cache configurations, acting as some kind of base template. Since 9.0, the default cache only exists if it has been explicitly configured. Additionally, even if it has been specified, it will never act as base template for other caches.</p> </div> </div> <div class="sect3"> <h4 id="marshalling_enhancements_and_store_compatibility"><a class="anchor" href="#marshalling_enhancements_and_store_compatibility"></a>2.45.7. Marshalling Enhancements and Store Compatibility</h4> <div class="paragraph"> <p>Internally Infinispan 9.x has introduced many improvements to its marshalling codebase in order to improve performance and allow for greater flexibility. Consequently, data marshalled and persisted by Infinispan 8.x is no longer compatible with Infinispan 9.0. To aid you in migrating your existing stores to 9.0, we have provided a Store Migrator, however at present this only allows the migration of JDBC stores.</p> </div> </div> <div class="sect3"> <h4 id="new_cloud_module_for_library_mode"><a class="anchor" href="#new_cloud_module_for_library_mode"></a>2.45.8. New Cloud module for library mode</h4> <div class="paragraph"> <p>In Infinispan 8.x, cloud related configuration were added to <code>infinispan-core</code> module. Since 9.0 they were moved to <code>infinispan-cloud</code> module.</p> </div> </div> <div class="sect3"> <h4 id="entry_retriever_is_now_removed"><a class="anchor" href="#entry_retriever_is_now_removed"></a>2.45.9. Entry Retriever is now removed</h4> <div class="paragraph"> <p>The entry retriever feature has been removed. Please update to use the new Streams feature detailed in the User Guide. The <code>org.infinispan.filter.CacheFilters</code> class can be used to convert <code>KeyValueFilter</code> and <code>Converter</code> instances into proper Stream operations that are able to be marshalled.</p> </div> </div> <div class="sect3"> <h4 id="map_reduce_is_now_removed"><a class="anchor" href="#map_reduce_is_now_removed"></a>2.45.10. Map / Reduce is now removed</h4> <div class="paragraph"> <p>Map reduce has been removed in favor of the new Streams feature which should provide more features and performance. There are no bridge classes to convert to the new streams and all references must be rewritten.</p> </div> </div> <div class="sect3"> <h4 id="spring_4_support_is_now_removed"><a class="anchor" href="#spring_4_support_is_now_removed"></a>2.45.11. Spring 4 support is now removed</h4> <div class="paragraph"> <p>Spring 4 is no longer supported.</p> </div> </div> <div class="sect3"> <h4 id="function_classes_have_moved_packages"><a class="anchor" href="#function_classes_have_moved_packages"></a>2.45.12. Function classes have moved packages</h4> <div class="paragraph"> <p>The class <code>SerializableSupplier</code> has moved from the <code>org.infinispan.stream</code> package to the <code>org.infinispan.util.function</code> package.</p> </div> <div class="paragraph"> <p>The class <code>CloseableSupplier</code> has moved from the <code>org.infinispan.util</code> package to the <code>org.infinispan.util.function</code> package.</p> </div> <div class="paragraph"> <p>The classes <code>TriConsumer</code>, <code>CloseableSupplier</code>, <code>SerializableRunnable</code>, <code>SerializableFunction</code> &amp; <code>SerializableCallable</code> have all been moved from the <code>org.infinispan.util</code> package to the <code>org.infinispan.util.function</code> package.</p> </div> </div> <div class="sect3"> <h4 id="segmentcompletionlistener_interface_has_moved"><a class="anchor" href="#segmentcompletionlistener_interface_has_moved"></a>2.45.13. SegmentCompletionListener interface has moved</h4> <div class="paragraph"> <p>The interface <code>SegmentCompletionListener</code> has moved from the interface <code>org.infinispan.CacheStream</code> to the new <code>org.infinispan.BaseCacheStream</code>.</p> </div> </div> <div class="sect3"> <h4 id="spring_module_dependency_changes"><a class="anchor" href="#spring_module_dependency_changes"></a>2.45.14. Spring module dependency changes</h4> <div class="paragraph"> <p>All Infinispan, Spring and Logger dependencies are now in the <code>provided</code> scope. One can decide whether to use small jars or uber jars but they need to be added to the classpath of the application. It also gives one freedom in choosing Spring (or Spring Boot) version.</p> </div> <div class="paragraph"> <p>Here is an example:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencies&gt;</span>
   <span class="tag">&lt;dependency&gt;</span>
      <span class="tag">&lt;groupId&gt;</span>org.infinispan<span class="tag">&lt;/groupId&gt;</span>
      <span class="tag">&lt;artifactId&gt;</span>infinispan-embedded<span class="tag">&lt;/artifactId&gt;</span>
   <span class="tag">&lt;/dependency&gt;</span>
   <span class="tag">&lt;dependency&gt;</span>
      <span class="tag">&lt;groupId&gt;</span>org.infinispan<span class="tag">&lt;/groupId&gt;</span>
      <span class="tag">&lt;artifactId&gt;</span>infinispan-spring5-embedded<span class="tag">&lt;/artifactId&gt;</span>
   <span class="tag">&lt;/dependency&gt;</span>
   <span class="tag">&lt;dependency&gt;</span>
      <span class="tag">&lt;groupId&gt;</span>org.springframework<span class="tag">&lt;/groupId&gt;</span>
      <span class="tag">&lt;artifactId&gt;</span>spring-context<span class="tag">&lt;/artifactId&gt;</span>
   <span class="tag">&lt;/dependency&gt;</span>
   <span class="tag">&lt;dependency&gt;</span>
      <span class="tag">&lt;groupId&gt;</span>org.springframework.session<span class="tag">&lt;/groupId&gt;</span>
      <span class="tag">&lt;artifactId&gt;</span>spring-session<span class="tag">&lt;/artifactId&gt;</span>
   <span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;/dependencies&gt;</span></code></pre> </div> </div> <div class="paragraph"> <p>Additionally there is no Logger implementation specified (since this may vary depending on use case).</p> </div> </div> <div class="sect3"> <h4 id="total_order_executor_is_now_removed"><a class="anchor" href="#total_order_executor_is_now_removed"></a>2.45.15. Total order executor is now removed</h4> <div class="paragraph"> <p>The total order protocol now uses the <code>remote-command-executor</code>. The attribute <code>total-order-executor</code> in <code>&lt;container&gt;</code> tag is removed.</p> </div> </div> <div class="sect3"> <h4 id="hikaricp_is_now_the_default_implementation_for_jdbc_pooledconnectionfactory"><a class="anchor" href="#hikaricp_is_now_the_default_implementation_for_jdbc_pooledconnectionfactory"></a>2.45.16. HikariCP is now the default implementation for JDBC PooledConnectionFactory</h4> <div class="paragraph"> <p><a href="https://github.com/brettwooldridge/HikariCP">HikariCP</a> offers superior performance to c3p0 and is now the default implementation. Additional properties for HikariCP can be provided by placing a <code>hikari.properties</code> file on the classpath or by specifying the path to the file via <code>PooledConnectionFactoryConfiguration.propertyFile</code> or <code>properties-file</code> in the connection pool&#8217;s xml config. N.B. a properties file specified explicitly in the configuration is loaded instead of the <code>hikari.properties</code> file on the class path and Connection pool characteristics which are explicitly set in PooledConnectionFactoryConfiguration always override the values loaded from a properties file.</p> </div> <div class="paragraph"> <p>Support for c3p0 has been deprecated and will be removed in a future release. Users can force c3p0 to be utilised as before by providing the system property <code>-Dinfinispan.jdbc.c3p0.force=true</code>.</p> </div> </div> <div class="sect3"> <h4 id="rocksdb_in_place_of_leveldb"><a class="anchor" href="#rocksdb_in_place_of_leveldb"></a>2.45.17. RocksDB in place of LevelDB</h4> <div class="paragraph"> <p>The LevelDB cache store was replaced with a <a href="http//rocksdb.org">RocksDB</a>. RocksDB is a fork of LevelDB which provides superior performance in high concurrency scenarios. The new cache store can parse old LevelDB configurations but will always use the RocksDB implementation.</p> </div> </div> <div class="sect3"> <h4 id="jdbc_mixed_and_binary_stores_removed"><a class="anchor" href="#jdbc_mixed_and_binary_stores_removed"></a>2.45.18. JDBC Mixed and Binary stores removed</h4> <div class="paragraph"> <p>The JDBC Mixed and Binary stores have been removed due to the poor performance associated with storing entries in buckets. Storing entries in buckets is non-optimal as each read/write to the store requires an existing bucket for a given hash to be retrieved, deserialised, updated, serialised and then re-inserted back into the db. If you were previously using one of the removed stores, we have provided a migrator tool to assist in migrating data from an existing binary table to a JDBC string based store.</p> </div> </div> <div class="sect3"> <h4 id="store_annotation_introduced"><a class="anchor" href="#store_annotation_introduced"></a>2.45.19. @Store Annotation Introduced</h4> <div class="paragraph"> <p>A new annotation, <code>@Store</code>, has been added for persistence stores. This allows a store&#8217;s properties to be explicitly defined and validated against the provided store configuration. Existing stores should be updated to use this annotation and the store&#8217;s configuration class should also declare the <code>@ConfigurationFor</code> annotation. If neither of these annotations are present on the store or configuration class, then a your store will continue to function as before, albeit with a warning that additional store validation cannot be completed.</p> </div> </div> <div class="sect3"> <h4 id="server_authentication_changes"><a class="anchor" href="#server_authentication_changes"></a>2.45.20. Server authentication changes</h4> <div class="paragraph"> <p>The no-anonymous policy is now automatically enabled for Hot Rod authentication unless explicitly specified.</p> </div> </div> <div class="sect3"> <h4 id="package_org_infinispan_util_concurrent_jdk8backported_has_been_removed"><a class="anchor" href="#package_org_infinispan_util_concurrent_jdk8backported_has_been_removed"></a>2.45.21. Package org.infinispan.util.concurrent.jdk8backported has been removed</h4> <div class="sect4"> <h5 id="moved_classes"><a class="anchor" href="#moved_classes"></a>Moved classes</h5> <div class="paragraph"> <p>Classes regarding EntrySizeCalculator have now been moved down to the org.infinispan.util package.</p> </div> </div> <div class="sect4"> <h5 id="removed_classes"><a class="anchor" href="#removed_classes"></a>Removed classes</h5> <div class="paragraph"> <p>The *ConcurrentHashMapV8 classes and their supporting classes have all been removed. The CollectionFactory#makeBoundedConcurrentMap method should be used if you desire to have a bounded ConcurrentMap.</p> </div> </div> </div> <div class="sect3"> <h4 id="store_as_binary_is_deprecated"><a class="anchor" href="#store_as_binary_is_deprecated"></a>2.45.22. Store as Binary is deprecated</h4> <div class="paragraph"> <p>Store as Binary configuration is now deprecated and will be removed in a future release. This is replaced by the new memory configuration.</p> </div> </div> <div class="sect3"> <h4 id="datacontainer_collection_methods_are_deprecated"><a class="anchor" href="#datacontainer_collection_methods_are_deprecated"></a>2.45.23. DataContainer collection methods are deprecated</h4> <div class="paragraph"> <p>The keySet, entrySet and values methods on DataContainer have been deprecated. These behavior of these methods are very inconsistent and will be removed later. It is recommended to update references to use iterator or iteratorIncludingExpired methods intead.</p> </div> </div> </div> <div class="sect2"> <h3 id="upgrading_from_8_1_to_8_2"><a class="anchor" href="#upgrading_from_8_1_to_8_2"></a>2.46. Upgrading from 8.1 to 8.2</h3> <div class="sect3"> <h4 id="entry_retriever_is_deprecated"><a class="anchor" href="#entry_retriever_is_deprecated"></a>2.46.1. Entry Retriever is deprecated</h4> <div class="paragraph"> <p>Entry Retriever is now deprecated and will be removed in Infinispan 9. This is replaced by the new Streams feature.</p> </div> </div> <div class="sect3"> <h4 id="map_reduce_is_deprecated"><a class="anchor" href="#map_reduce_is_deprecated"></a>2.46.2. Map / Reduce is deprecated</h4> <div class="paragraph"> <p>Map reduce is now deprecated and will be removed in Infinispan 9. This is replaced by the new Streams feature.</p> </div> </div> </div> <div class="sect2"> <h3 id="upgrading_from_8_x_to_8_1"><a class="anchor" href="#upgrading_from_8_x_to_8_1"></a>2.47. Upgrading from 8.x to 8.1</h3> <div class="sect3"> <h4 id="packaging_changes"><a class="anchor" href="#packaging_changes"></a>2.47.1. Packaging changes</h4> <div class="sect4"> <h5 id="cdi_module_split"><a class="anchor" href="#cdi_module_split"></a>CDI module split</h5> <div class="paragraph"> <p>CDI module (GroupId:ArtifactId <code>org.infinispan:infinispan-cdi</code>) has been split into <code>org.infinispan:infinispan-cdi-embedded</code> and <code>org.infinispan:infinispan-cdi-remote</code>. Please make sure that you use proper artifact.</p> </div> </div> <div class="sect4"> <h5 id="spring_module_split"><a class="anchor" href="#spring_module_split"></a>Spring module split</h5> <div class="paragraph"> <p>Spring module (GroupId:ArtifactId <code>org.infinispan:infinispan-spring5</code>) has been split into <code>org.infinispan:infinispan-spring5-embedded</code> and <code>org.infinispan:infinispan-spring5-remote</code>. Please make sure that you use proper artifact.</p> </div> </div> </div> <div class="sect3"> <h4 id="spring_3_support_is_deprecated"><a class="anchor" href="#spring_3_support_is_deprecated"></a>2.47.2. Spring 3 support is deprecated</h4> <div class="paragraph"> <p>Spring 3 support (GroupId:ArtifactId <code>org.infinispan:infinispan-spring</code>) is deprecated. Please consider migrating into Spring 4 support.</p> </div> </div> </div> <div class="sect2"> <h3 id="upgrading_from_7_x_to_8_0"><a class="anchor" href="#upgrading_from_7_x_to_8_0"></a>2.48. Upgrading from 7.x to 8.0</h3> <div class="sect3"> <h4 id="configuration_changes"><a class="anchor" href="#configuration_changes"></a>2.48.1. Configuration changes</h4> <div class="sect4"> <h5 id="removal_of_async_marshalling"><a class="anchor" href="#removal_of_async_marshalling"></a>Removal of Async Marshalling</h5> <div class="paragraph"> <p>Async marshalling has been entirely dropped since it was never reliable enough. The "async-marshalling" attribute has been removed from the 8.0 XML schema and will be ignored when parsing 7.x configuration files. The programmatic configuration methods related to asyncMarshalling/syncMarshalling are now deprecated and have no effect aside from producing a WARN message in the logs.</p> </div> </div> <div class="sect4"> <h5 id="reenabling_of_isolation_level_configurations_in_server"><a class="anchor" href="#reenabling_of_isolation_level_configurations_in_server"></a>Reenabling of isolation level configurations in server</h5> <div class="paragraph"> <p>Because of the inability to configure write skew in the server, the isolation level attribute was ignored and defaulted to READ_COMMITTED. Now, when enabling REPEATABLE_READ together with optimistic locking, write skew is enabled by default in local and synchronous configurations.</p> </div> </div> <div class="sect4"> <h5 id="subsystem_renaming_in_server"><a class="anchor" href="#subsystem_renaming_in_server"></a>Subsystem renaming in server</h5> <div class="paragraph"> <p>In order to avoid conflict and confusion with the similar subsystems in WildFly, we have renamed the following subsystems in server: * infinispan &#8594; datagrid-infinispan * jgroups &#8594; datagrid-jgroups * endpoint &#8594; datagrid-infinispan-endpoint</p> </div> </div> <div class="sect4"> <h5 id="server_domain_mode"><a class="anchor" href="#server_domain_mode"></a>Server domain mode</h5> <div class="paragraph"> <p>We no longer support the use of standalone mode for running clusters of servers. Domain mode (bin/domain.sh) should be used instead.</p> </div> </div> </div> </div> <div class="sect2"> <h3 id="upgrading_from_6_0_to_7_0"><a class="anchor" href="#upgrading_from_6_0_to_7_0"></a>2.49. Upgrading from 6.0 to 7.0</h3> <div class="sect3"> <h4 id="api_changes"><a class="anchor" href="#api_changes"></a>2.49.1. API Changes</h4> <div class="sect4"> <h5 id="cache_loader"><a class="anchor" href="#cache_loader"></a>Cache Loader</h5> <div class="paragraph"> <p>To be more inline with JCache and java.util.collections interfaces we have changed the first argument type for the CacheLoader.load &amp; CacheLoader.contains methods to be Object from type K.</p> </div> </div> <div class="sect4"> <h5 id="cache_writer"><a class="anchor" href="#cache_writer"></a>Cache Writer</h5> <div class="paragraph"> <p>To be more inline with JCache and java.util.collections interfaces we have changed the first argument type for the CacheWriter.delete method to be Object from type K.</p> </div> </div> <div class="sect4"> <h5 id="filters"><a class="anchor" href="#filters"></a>Filters</h5> <div class="paragraph"> <p>Over time Infinispan added 2 interfaces with identical names and almost identical methods. The org.infinispan.notifications.KeyFilter and org.infinispan.persistence.spi.AdvancedCacheLoader$KeyFilter interfaces.</p> </div> <div class="paragraph"> <p>Both of these interfaces are used for the sole purpose of filtering an entry by it&#8217;s given key. Infinispan 7.0 has also introduced the KeyValueFilter which is similar to both but also can filter on the entries value and/or metadata.</p> </div> <div class="paragraph"> <p>As such all of these classes have been moved into a new package org.infinispan.filter and all of their related helper classes.</p> </div> <div class="paragraph"> <p>The new org.infinispan.filter.KeyFilter interface has replaced both of the previous interfaces and all previous references use the new interface.</p> </div> </div> </div> <div class="sect3"> <h4 id="declarative_configuration"><a class="anchor" href="#declarative_configuration"></a>2.49.2. Declarative configuration</h4> <div class="paragraph"> <p>The XML schema for the embedded configuration has changed to more closely follow the server configuration. Use the <code>config-converter.sh</code> or <code>config-converter.bat</code> scripts to convert an Infinispan 6.0 to the current format.</p> </div> </div> </div> <div class="sect2"> <h3 id="upgrading_from_5_3_to_6_0"><a class="anchor" href="#upgrading_from_5_3_to_6_0"></a>2.50. Upgrading from 5.3 to 6.0</h3> <div class="sect3"> <h4 id="declarative_configuration_2"><a class="anchor" href="#declarative_configuration_2"></a>2.50.1. Declarative configuration</h4> <div class="paragraph"> <p>In order to use all of the latest features, make sure you change the namespace declaration at the top of your XML configuration files as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;infinispan</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:6.0 http://www.infinispan.org/schemas/infinispan-config-6.0.xsd</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:6.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   ...
<span class="tag">&lt;/infinispan&gt;</span></code></pre> </div> </div> </div> <div class="sect3"> <h4 id="deprecated_api_removal"><a class="anchor" href="#deprecated_api_removal"></a>2.50.2. Deprecated API removal</h4> <div class="ulist"> <ul> <li> <p>Class <code>org.infinispan.persistence.remote.wrapperEntryWrapper</code>.</p> </li> <li> <p>Method <code>ObjectOutput startObjectOutput(OutputStream os, boolean isReentrant)</code> from class <code>org.infinispan.commons.marshall.StreamingMarshaller</code>.</p> </li> <li> <p>Method <code>CacheEntry getCacheEntry(Object key, EnumSet&lt;Flag&gt; explicitFlags, ClassLoader explicitClassLoader)</code> from class <code>org.infinispan.AdvancedCache</code>. Please use instead: <code>AdvanceCache.withFlags(Flag&#8230;&#8203; flags).with(ClassLoader classLoader).getCacheEntry(K key)</code>.</p> </li> <li> <p>Method <code>AtomicMap&lt;K, V&gt; getAtomicMap(Cache&lt;MK, ?&gt; cache, MK key, FlagContainer flagContainer)</code> from class <code>org.infinispan.atomic.AtomicMapLookup</code>. Please use instead <code>AtomicMapLookup.getAtomicMap(cache.getAdvancedCache().withFlags(Flag&#8230;&#8203; flags), MK key)</code>.</p> </li> <li> <p>Package <code>org.infinispan.config</code> (and all methods involving the old configuration classes). All methods removed has an overloaded method which receives the new configuration classes as parameters. Please refer to <a href="#_configuration">[_configuration]</a> for more information about the new configuration classes.</p> </li> </ul> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> This only affects the programmatic configuration. </td> </tr> </table> </div> <div class="ulist"> <ul> <li> <p>Class <code>org.infinispan.context.FlagContainer</code>.</p> </li> <li> <p>Method <code>boolean isLocal(Object key)</code> from class <code>org.infinispan.distribution.DistributionManager</code>. Please use instead <code>DistributionManager.getLocality(Object key)</code>.</p> </li> <li> <p>JMX operation <code>void setStatisticsEnabled(boolean enabled)</code> from class <code>org.infinispan.interceptors.TxInterceptor</code> Please use instead the <code>statisticsEnabled</code> attribute.</p> </li> <li> <p>Method <code>boolean delete(boolean synchronous)</code> from class <code>org.infinispan.io.GridFile</code>. Please use instead <code>GridFile.delete()</code>.</p> </li> <li> <p>JMX attribute <code>long getLocallyInterruptedTransactions()</code> from class <code>org.infinispan.util.concurrent.locks.DeadlockDetectingLockManager</code>.</p> </li> </ul> </div> </div> </div> <div class="sect2"> <h3 id="upgrading_from_5_2_to_5_3"><a class="anchor" href="#upgrading_from_5_2_to_5_3"></a>2.51. Upgrading from 5.2 to 5.3</h3> <div class="sect3"> <h4 id="declarative_configuration_3"><a class="anchor" href="#declarative_configuration_3"></a>2.51.1. Declarative configuration</h4> <div class="paragraph"> <p>In order to use all of the latest features, make sure you change the namespace declaration at the top of your XML configuration files as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;infinispan</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:5.2 http://www.infinispan.org/schemas/infinispan-config-5.2.xsd</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:5.3</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   ...
<span class="tag">&lt;/infinispan&gt;</span></code></pre> </div> </div> </div> </div> <div class="sect2"> <h3 id="upgrading_from_5_1_to_5_2"><a class="anchor" href="#upgrading_from_5_1_to_5_2"></a>2.52. Upgrading from 5.1 to 5.2</h3> <div class="sect3"> <h4 id="declarative_configuration_4"><a class="anchor" href="#declarative_configuration_4"></a>2.52.1. Declarative configuration</h4> <div class="paragraph"> <p>In order to use all of the latest features, make sure you change the namespace declaration at the top of your XML configuration files as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;infinispan</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:5.2 http://www.infinispan.org/schemas/infinispan-config-5.2.xsd</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:5.2</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   ...
<span class="tag">&lt;/infinispan&gt;</span></code></pre> </div> </div> </div> <div class="sect3"> <h4 id="transaction"><a class="anchor" href="#transaction"></a>2.52.2. Transaction</h4> <div class="paragraph"> <p>The default transaction enlistment model has changed ( <a href="https://issues.jboss.org/browse/ISPN-1284">ISPN-1284</a> ) from <a href="https://docs.oracle.com/javase/8/docs/api/javax/transaction/xa/XAResource.html"><code>XAResource</code></a> to <a href="https://docs.oracle.com/javase/8/docs/api/javax/transaction/Synchronization.html"><code>Synchronization</code></a>. Also now, if the <code>XAResource</code> enlistment is used, then recovery is enabled by default.</p> </div> <div class="paragraph"> <p>In practical terms, if you were using the default values, this should not cause any backward compatibility issues but an increase in performance of about 5-7%. However in order to use the old configuration defaults, you need to configure the following:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;transaction</span> <span class="attribute-name">useSynchronization</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;recovery</span> <span class="attribute-name">enabled</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/transaction&gt;</span></code></pre> </div> </div> <div class="paragraph"> <p>or the programmatic configuration equivalent:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java">ConfigurationBuilder builder = <span class="keyword">new</span> ConfigurationBuilder();
builder.transaction().useSynchronization(<span class="predefined-constant">false</span>).recovery().enabled(<span class="predefined-constant">false</span>)</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="cache_loader_and_store_configuration"><a class="anchor" href="#cache_loader_and_store_configuration"></a>2.52.3. Cache Loader and Store configuration</h4> <div class="paragraph"> <p>Cache Loader and Store configuration has changed greatly in Infinispan 5.2.</p> </div> </div> <div class="sect3"> <h4 id="virtual_nodes_and_segments"><a class="anchor" href="#virtual_nodes_and_segments"></a>2.52.4. Virtual Nodes and Segments</h4> <div class="paragraph"> <p>The concept of Virtual Nodes doesn&#8217;t exist anymore in Infinispan 5.2 and has been replaced by Segments.</p> </div> </div> </div> <div class="sect2"> <h3 id="upgrading_from_5_0_to_5_1"><a class="anchor" href="#upgrading_from_5_0_to_5_1"></a>2.53. Upgrading from 5.0 to 5.1</h3> <div class="sect3"> <h4 id="api"><a class="anchor" href="#api"></a>2.53.1. API</h4> <div class="paragraph"> <p>The cache and cache manager hierarchies have changed slightly in 5.1 with the introduction of <a href="https://docs.jboss.org/infinispan/5.1/apidocs/org/infinispan/api/BasicCache.html"><code>BasicCache</code></a> and <a href="https://docs.jboss.org/infinispan/5.1/apidocs/org/infinispan/api/BasicCacheContainer.html"><code>BasicCacheContainer</code></a> , which are parent classes of existing <a href="https://docs.jboss.org/infinispan/5.1/apidocs/org/infinispan/Cache.html"><code>Cache</code></a> and <a href="https://docs.jboss.org/infinispan/5.1/apidocs/org/infinispan/manager/CacheContainer.html"><code>CacheContainer</code></a> classes respectively. What&#8217;s important is that Hot Rod clients must now code against <code>BasicCache</code> and <code>BasicCacheContainer</code> rather than <code>Cache</code> and <code>CacheContainer</code>. So previous code that was written like this will no longer compile.</p> </div> <div class="listingblock"> <div class="title">WontCompile.java</div> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.infinispan.Cache</span>;
<span class="keyword">import</span> <span class="include">org.infinispan.manager.CacheContainer</span>;
<span class="keyword">import</span> <span class="include">org.infinispan.client.hotrod.RemoteCacheManager</span>;
...
CacheContainer cacheContainer = <span class="keyword">new</span> RemoteCacheManager();
Cache cache = cacheContainer.getCache();</code></pre> </div> </div> <div class="paragraph"> <p>Instead, if Hot Rod clients want to continue using interfaces higher up the hierarchy from the remote cache/container classes, they&#8217;ll have to write:</p> </div> <div class="listingblock"> <div class="title">Correct.java</div> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.infinispan.BasicCache</span>;
<span class="keyword">import</span> <span class="include">org.infinispan.manager.BasicCacheContainer</span>;
<span class="keyword">import</span> <span class="include">org.infinispan.client.hotrod.RemoteCacheManager</span>;
...
BasicCacheContainer cacheContainer = <span class="keyword">new</span> RemoteCacheManager();
BasicCache cache = cacheContainer.getCache();</code></pre> </div> </div> <div class="paragraph"> <p>However, previous code that interacted against the <code>RemoteCache</code> and <code>RemoteCacheManager</code> will work as it used to:</p> </div> <div class="listingblock"> <div class="title">AlsoCorrect.java</div> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.infinispan.client.hotrod.RemoteCache</span>;
<span class="keyword">import</span> <span class="include">org.infinispan.client.hotrod.RemoteCacheManager</span>;
...
RemoteCacheManager cacheContainer = <span class="keyword">new</span> RemoteCacheManager();
RemoteCache cache = cacheContainer.getCache();</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="eviction_and_expiration"><a class="anchor" href="#eviction_and_expiration"></a>2.53.2. Eviction and Expiration</h4> <div class="ulist"> <ul> <li> <p>The eviction XML element no longer defines the <code>wakeUpInterval</code> attribute. This is now configured via the <code>expiration</code> element:</p> </li> </ul> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;expiration</span> <span class="attribute-name">wakeUpInterval</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">60000</span><span class="delimiter">&quot;</span></span><span class="attribute-name">...</span> <span class="tag">/&gt;</span></code></pre> </div> </div> <div class="paragraph"> <p>Eviction&#8217;s <code>maxEntries</code> is used as guide for the entire cache, but eviction happens on a per cache segment, so when the segment is full, the segment is evicted. That&#8217;s why <code>maxEntries</code> is a theoretical limit but in practical terms, it&#8217;ll be a bit less than that. This is done for performance reasons.</p> </div> </div> <div class="sect3"> <h4 id="transactions"><a class="anchor" href="#transactions"></a>2.53.3. Transactions</h4> <div class="ulist"> <ul> <li> <p>A cache marked as <code>TRANSACTIONAL</code> cannot be accessed outside of a transaction, and a <code>NON_TRANSACTIONAL</code> cache cannot be accessed within a transaction. In 5.0, a transactional cache would support non-transactional calls as well. This change was done to be in-line with expectations set out in <a href="https://github.com/jsr107">JSR-107</a> as well as to provide more consistent behavior.</p> </li> <li> <p>In 5.0, commit and rollback phases were asynchronous by default. Starting with 5.1, these are now synchronous by default, to provide the guarantees required by a single lock-owner model.</p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="state_transfer"><a class="anchor" href="#state_transfer"></a>2.53.4. State transfer</h4> <div class="paragraph"> <p>One of the big changes we made in 5.1 was to use the same push-based state transfer we introduced in 5.0 both for rehashing in distributed mode and for state retrieval in replicated mode. We even borrow the consistent hash concept in replicated mode to transfer state from all previous cache members at once in order to speed up transfer.</p> </div> <div class="paragraph"> <p>As a consequence we&#8217;ve unified the state transfer configuration as well, there is now a <code>stateTransfer</code> element containing a simplified state transfer configuration. The corresponding attributes in the <code>stateRetrieval</code> and <code>hash</code> elements have been deprecated, as have been some attributes that are no longer used.</p> </div> </div> <div class="sect3"> <h4 id="configuration_2"><a class="anchor" href="#configuration_2"></a>2.53.5. Configuration</h4> <div class="paragraph"> <p>If you use XML to configure Infinispan, you shouldn&#8217;t notice any change, except a much faster startup, courtesy of the <a href="http://en.wikipedia.org/wiki/StAX">StAX</a> based parser. However, if you use programmatic configuration, read on for the important differences.</p> </div> <div class="paragraph"> <p>Configuration is now packaged in <code>org.infinispan.configuration</code>, and you must use a fluent, builder style:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Configuration</span> c1 = <span class="keyword">new</span> ConfigurationBuilder()
   <span class="comment">// Adjust any configuration defaults you want</span>
   .clustering()
      .l1()
         .disable()
      .mode(DIST_SYNC)
      .hash()
         .numOwners(<span class="integer">5</span>)
   .build();</code></pre> </div> </div> <div class="ulist"> <ul> <li> <p>The old javabean style configuration is now deprecated and will be removed in a later version.</p> </li> <li> <p>Configuration properties which can be safely changed at runtime are mutable, and all others are immutable.</p> </li> <li> <p>To copy a configuration, use the <code>read()</code> method on the builder, for example:</p> </li> </ul> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Configuration</span> c2 = <span class="keyword">new</span> ConfigurationBuilder()
   <span class="comment">// Read in C1 to provide defaults</span>
   .read(c1)
   .clustering()
      .l1()
         .enable()
   <span class="comment">// This cache is DIST_SYNC, will have 5 owners, with L1 cache enabled</span>
   .build();</code></pre> </div> </div> <div class="paragraph"> <p>This completely replaces the old system of defining a set of overrides on bean properties. Note that this means the behaviour of Infinispan configuration is somewhat different when used programmatically. Whilst before, you could define a default configuration, and any overrides would be applied on top of <em>your</em> defaults when defined, now you must explicitly read in your defaults to the builder. This allows for much greater flexibility in your code (you can have a as many "default" configurations as you want), and makes your code more explicit and type safe (finding references works).</p> </div> <div class="paragraph"> <p>The schema is unchanged from before. Infinispan 4.0 configurations are currently not being parsed. To upgrade, just change the schema definition from:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;infinispan</span>
     <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
     <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:4.1 http://www.infinispan.org/schemas/infinispan-config-4.1.xsd</span><span class="delimiter">&quot;</span></span>
     <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:4.1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span></code></pre> </div> </div> <div class="paragraph"> <p>to</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;infinispan</span>
     <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
     <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:5.1 http://www.infinispan.org/schemas/infinispan-config-5.1.xsd</span><span class="delimiter">&quot;</span></span>
     <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">urn:infinispan:config:5.1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span></code></pre> </div> </div> <div class="paragraph"> <p>The schema documentation has changed format, as it is now produced using the standard tool <code>xsddoc</code>. This should be a significant improvement, as better navigation is offered. Some elements and attributes are missing docs right now, we are working on adding this. As an added benefit, your IDE should now show documentation when an xsd referenced (as above)</p> </div> <div class="paragraph"> <p>We are in the process of adding in support for this configuration style for modules (such as cache stores). In the meantime, please use the old configuration or XML if you require support for cache store module configuration.</p> </div> </div> <div class="sect3"> <h4 id="flags_and_classloaders"><a class="anchor" href="#flags_and_classloaders"></a>2.53.6. Flags and ClassLoaders</h4> <div class="paragraph"> <p>The <code>Flags</code> and <code>ClassLoader</code> API has changed. In the past, the following would work:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java"> cache.withFlags(f1, f2); cache.withClassLoader(cl); cache.put(k, v);</code></pre> </div> </div> <div class="paragraph"> <p>In 5.1.0, these <code>withX()</code> methods return a new instance and not the cache itself, so thread locals are avoided and the code above will not work. If used in a fluent manner however, things still work:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="java">cache.withFlags(f1, f2).withClassLoader(cl).put(k, v);</code></pre> </div> </div> <div class="paragraph"> <p>The above pattern has always been the intention of this API anyway.</p> </div> </div> <div class="sect3"> <h4 id="jgroups_bind_address"><a class="anchor" href="#jgroups_bind_address"></a>2.53.7. JGroups Bind Address</h4> <div class="paragraph"> <p>Since upgrading to JGroups 3.x, <code>-Dbind.address</code> is ignored. This should be replaced with <code>-Djgroups.bind_addr</code>.</p> </div> </div> </div> </div> </div> </div> <div id="footer"> <div id="footer-text"> Last updated 2019-09-15 07:35:22 UTC </div> </div> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8601422-1', 'auto');
  ga('send', 'pageview');

</script> <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
});
</script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script> </body> </html>