<!DOCTYPE html>
<html>

<head>
  <title>In Memory Data Grid Patterns Demos from Devoxx France!</title>
  <!-- <script id="adobe_dtm" src="//www.redhat.com/dtm.js" type="text/javascript"></script> -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Infinispan is a distributed in-memory key/value data store with optional schema, available under the Apache License 2.0.">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/assets/css/main.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="stylesheet"
        href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.3.2/styles/github.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.3.2/highlight.min.js"></script>
  <script charset="UTF-8"
          src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.3.2/languages/java.min.js"></script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
<!--   <script async src="https://www.googletagmanager.com/gtag/js?id=UA-125236544-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
 
    gtag('config', 'UA-125236544-1');
  </script> -->


</head>

<body class="blog">
  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
  <div class="container">
    <div class="logo-wrapper">
        <a href="/"><img src="/assets/images/infinispan-logo-white.png" class="project-logo" title="Infinispan Logo"></a>
    </div>
    <label class="nav-toggle" for="checkbox">
      <i class="fa fa-bars"></i>
    </label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="/learn/">Learn <i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/introduction" class="">Introduction</a></li>
          <li><a href="/features" class="">Features</a></li>
          <li><a href="/documentation" class="">Documentation</a></li>
          <li><a href="/tutorials" class="">Tutorials</a></li>
          <li><a href="/videos" class="">Videos</a></li>
          <li><a href="/references" class="">References</a></li>
          <li><a href="/experiments" class="">Experiments</a></li>
          <li><a href="/roadmap" class="">Roadmap</a></li>
        </ul>
      </li>
      <li>
        <a href="/use-cases/" class="">Use Cases</a>
      </li>
      <li>
        <a href="/community/" class="">Community</a>
      </li>
      <li>
        <a href="/blog/" class="active">Blog</a>
      </li>
      <li>
        <a href="/download/" class="">Download</a>
      </li>
    </ul>
  </div>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    
<div class="component-slim full-width-bg dark-bg light-blue">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <a href="/blog">Blogs</a>  <i class="fas fa-chevron-right"></i> In Memory Data Grid Patterns Demos from Devoxx France!
    </div>
  </div>
</div>

<div class="post-page grid-wrapper">
  <div class="grid__item width-10-12 width-12-12-m doc-content">
    <h1>In Memory Data Grid Patterns Demos from Devoxx France!</h1>
    <div class="post-date">April 07, 2017
      Tags: <a href="/blog/tag/ conference"> conference</a> <a href="/blog/tag/devoxx">devoxx</a> <a href="/blog/tag/demo">demo</a> <a href="/blog/tag/streams">streams</a> <a href="/blog/tag/query">query</a> 
    </div>
    <div class="grid-wrapper">
      <div class="grid__item width-8-12 width-12-12-m margin-tb-sm">
        <div class="grid-wrapper">
          <div class="width-2-12 justify-self-center align-self-center">
            <img src="/assets/images/blog/authors/galder.jpg">
          </div>
          <div class="width-10-12 align-self-center">
            <p class="byline">By Galder Zamarreño</p>
          </div>
        </div>
      </div>
      <div class="grid__item width-12-12">
          <div class="paragraph">
<p><a href="http://devoxx.fr/">Devoxx France 2017</a> was a blast!! Emmanuel and I would
like to thank all attendees to our
<a href="http://cfp.devoxx.fr/2017/talk/UKK-0693/Architecture_par_la_pratique:_patterns_d%E2%80%99utilisation_de_systemes_in-memory_-_WD-40_entre_vos_donnees_et_vos_applis">in-memory
data grids patterns</a> talk. The room was full and we thoroughly enjoyed
the experience!</p>
</div>
<div class="paragraph">
<p>During the talk we presented a couple of small demos that showcased some
in-memory data grid use cases. The demos are located
<a href="https://github.com/galderz/datagrid-patterns">here</a>, but I thought it&#8217;d
be useful to provide some
<a href="https://github.com/galderz/datagrid-patterns">step-by-step</a> here so that
you can get them running as quickly as possible.</p>
</div>
<div class="paragraph">
<p>Before we start with any of the demos, it&#8217;s necessary to run some set up
steps:</p>
</div>
<div class="paragraph">
<p>  1. Check out git repository:</p>
</div>
<div class="paragraph">
<p>    git clone <a href="https://github.com/galderz/datagrid-patterns" class="bare">https://github.com/galderz/datagrid-patterns</a></p>
</div>
<div class="paragraph">
<p>  2. Download
<a href="http://downloads.jboss.org/infinispan/9.0.0.Final/infinispan-server-9.0.0.Final-bin.zip">Infinispan
Server 9.0.0.Final</a> and at the same level as the git repository.</p>
</div>
<div class="paragraph">
<p>  3. Go into the datagrid-patterns directory, start the servers and wait
until they&#8217;ve started:</p>
</div>
<div class="paragraph">
<p>    cd datagrid-patterns
    ./run-servers.sh</p>
</div>
<div class="paragraph">
<p>  4. Install <a href="https://www.continuum.io/downloads">Anaconda for Python 3</a>,
this is required to run Jupyter notebook for plotting.</p>
</div>
<div class="paragraph">
<p>  5. Install <a href="https://maven.apache.org/download.cgi">Maven 3</a>.</p>
</div>
<div class="paragraph">
<p>Once the set up is complete, it&#8217;s time to start with the individual
demos.</p>
</div>
<div class="paragraph">
<p>Both demos shown below work with the same application domain: rail
transport systems. In this domain, we differentiate between physical
stations, trains, station boards which are located in stations, and
finally stops, which are individual entries in station boards.</p>
</div>
<div class="sect2">
<h3 id="analytics-demo">Analytics Demo</h3>
<div class="paragraph">
<p>The first demo is focused on how you can use Infinispan for doing
offline analytics. In particular, this demo tries to answer the
following question:</p>
</div>
<div class="paragraph">
<p><em>Q. What is the time of the day when there is the biggest ratio of
delayed trains?</em></p>
</div>
<div class="paragraph">
<p>To answer this question, Infinispan data grid will be loaded with 3
weeks worth of data from station boards. Once the data is loaded, we
will execute a remote server task which will use
<a href="http://infinispan.org/docs/stable/user_guide/user_guide.html#streams">Infinispan
Distributed Java Streams</a> to calculate the two pieces of information
required to answer the question: per hour, how many trains are going
through the system, and out of those, how many are delayed.</p>
</div>
<div class="paragraph">
<p>An important aspect to bear in mind about this server tasks is that it
will only be executed in one of the nodes in the cluster. It does not
matter which one. In turn, this node will will ship the lambdas required
to do the computation to each of the nodes so that they can executed
against their local data. The other nodes will reply with the results
and the node where the server task was invoked will aggregate the
results.</p>
</div>
<div class="paragraph">
<p>Then, these results are sent back to the client, which in turn, stores
the results as JSON in an intermediate cache. Once the results are in
place, we will use a Jupyter notebook to read those results and plot the
result.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see these steps in action:</p>
</div>
<div class="paragraph">
<p>  1. First, we need to install the server tasks in the running servers
above:</p>
</div>
<div class="paragraph">
<p>    cd datagrid-patterns/analytics</p>
</div>
<div class="paragraph">
<p>    mvn clean install package -am -pl analytics-server</p>
</div>
<div class="paragraph">
<p>    mvn wildfly:deploy -pl analytics-server</p>
</div>
<div class="paragraph">
<p>    </p>
</div>
<div class="paragraph">
<p>  2. Open the datagrid-pattern repo with your favourite IDE and run
<strong>delays.java.stream.InjectApp</strong> class located in
analytics/analytics-server project. This command will inject the data
into the cache. On my environment, it takes between 1 and 2 minutes.</p>
</div>
<div class="paragraph">
<p>  3. With the data loaded, we need to run the remote task that will
calculate the total number of trains per hour and how many of those are
delayed. To do that, execute <strong>delays.java.stream.AnalyticsApp</strong> class
located in analytics/analytics-server project from your IDE.</p>
</div>
<div class="paragraph">
<p>  4. You can verify that the results have been calculating by going to
the following address:</p>
</div>
<div class="paragraph">
<p>    <a href="http://localhost:8180/rest/analytics-results/results" class="bare">http://localhost:8180/rest/analytics-results/results</a></p>
</div>
<div class="paragraph">
<p>  5. With the results in place, it&#8217;s time to start the Jupyter notebook:</p>
</div>
<div class="paragraph">
<p>    cd datagrid-patterns/analytics/analytics-jupyter</p>
</div>
<div class="paragraph">
<p>    ~/anaconda/bin/jupyter notebook</p>
</div>
<div class="paragraph">
<p>  6. Once the notebook opens, click open <strong>live-demo.ipynb</strong> notebook and
execute each of the cells in order. You should end up seeing a plot like
this:</p>
</div>
<div class="paragraph">
<p><a href="https://1.bp.blogspot.com/-0WwGpCjfU1g/WOdG4rNJ8QI/AAAAAAAAE10/L0bV9eq8RZgIDw-C51UyukbZRuZJUyPCQCLcB/s1600/Screen%2BShot%2B2017-04-07%2Bat%2B09.58.56.png"><span class="image"><img src="https://1.bp.blogspot.com/-0WwGpCjfU1g/WOdG4rNJ8QI/AAAAAAAAE10/L0bV9eq8RZgIDw-C51UyukbZRuZJUyPCQCLcB/s320/Screen%2BShot%2B2017-04-07%2Bat%2B09.58.56.png" alt="image" width="320" height="240"></span></a></p>
</div>
<div class="paragraph">
<p>So, the answer to the question:</p>
</div>
<div class="paragraph">
<p><em>Q. What is the time of the day when there is the biggest ratio of
delayed trains?</em></p>
</div>
<div class="paragraph">
<p>is <strong>2am</strong>! That&#8217;s because last connecting trains of the day wait for each
other to avoid leaving passengers stranded.</p>
</div>
</div>
<div class="sect2">
<h3 id="real-time-demo">Real Time Demo</h3>
<div class="paragraph">
<p>The second demo that we presented uses the same application domain as
above, but this time we&#8217;re trying to use our data grid as a way of
storing the station board state of each station at a given point in
time. So, the idea is to use Infinispan as an in memory data grids for
working with real time data.</p>
</div>
<div class="paragraph">
<p>So, what can we do with this type of data? In our demo, we will create a
centralised dashboard of delayed trains around the country. To do that,
we will take advantage of
<a href="http://infinispan.org/docs/stable/user_guide/user_guide.html#query.continuous">Infinispan&#8217;s
Continuous Query</a> functionality which allows us to find those station
boards which contain stops that are delayed, and as new delayed trains
appeared these will be pushed to our dashboard.</p>
</div>
<div class="paragraph">
<p>To run this demo, keep the same servers running as above and do the
following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run <strong>delays.query.continuous.FxApp</strong> application located in real-time
project inside the datagrid-patterns demo. This app will inject some
live station board data and will launch a JavaFX dashboard that shows
delayed trains as they appear. It should look something like this:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a href="https://2.bp.blogspot.com/-vyFHhzmswQg/WOdJ1PnoOJI/AAAAAAAAE2A/Ui1YS1T93JIxPKpwbS6u0p1whsok3nxfwCLcB/s1600/Screen%2BShot%2B2017-04-07%2Bat%2B10.11.40.png"><span class="image"><img src="https://2.bp.blogspot.com/-vyFHhzmswQg/WOdJ1PnoOJI/AAAAAAAAE2A/Ui1YS1T93JIxPKpwbS6u0p1whsok3nxfwCLcB/s320/Screen%2BShot%2B2017-04-07%2Bat%2B10.11.40.png" alt="image" width="320" height="248"></span></a></p>
</div>
</div>
<div class="sect2">
<h3 id="conclusion">Conclusion</h3>
<div class="paragraph">
<p>This has been a summary of the demos that we run in our talk at Devoxx
France with the intention of getting you running these demos as quickly
as possible. The repository contains more detailed information of these
demos. If there&#8217;s anything unclear or any of the instructions above are
not working, please let us know!</p>
</div>
<div class="paragraph">
<p>Thanks to Emmanuel Bernard for partnering with me for this Devoxx France
talk and for the continuous feedback while developing the demos. Thanks
as well to Tristan Tarrant for the input in the demos and many thanks to
all Devoxx France attendees who attended our talk :)</p>
</div>
<div class="paragraph">
<p>A very special thanks to <strong>Alexandre Masselot</strong> whose
<a href="https://www.slideshare.net/alexmass/swiss-transport-in-real-time-tribulations-in-the-big-data-stack">"Swiss
Transport in Real Time: Tribulations in the Big</a> Data Stack" talk at
Soft-Shake 2016 was the inspiration for these demos. @Alex, thanks a lot
for sharing the demos and data with me and the rest of the community!!</p>
</div>
<div class="paragraph">
<p>In a just a few weeks I&#8217;ll be at
<a href="http://www.developermarch.com/developersummit/">Great Indian Developer
Summit</a> presenting these demos and much more! Stay tuned :)</p>
</div>
<div class="paragraph">
<p>Cheers,</p>
</div>
<div class="paragraph">
<p>Galder</p>
</div>
</div>
          
      </div>
      <div class="grid__item width-12-12">
        <h2>Get it, Use it, Ask us! </h2>
We’re hard at work on new features, improvements and fixes, so watch this space for more announcements!
<div class="paragraph">
    <p>Please, <a href="/download" target="_blank">download</a> and test the latest release.</p>
</div>
<div class="paragraph">
    <p>The source code is hosted on <a href="" target="_blank">GitHub</a>.
        If you need to report a bug or request a new feature, look for a similar one on our <a href="https://jira.jboss.org/browse/ISPN" target="_blank">JIRA issues tracker</a>.
        If you don’t find any, <a href="https://jira.jboss.org/browse/ISPN" target="_blank">create a new issue</a>.</p>
</div>
<div class="paragraph">
    <p>If you have questions, are experiencing a bug or want advice on using Infinispan,
        you can use <a href="https://stackoverflow.com/questions/tagged/?tagnames=infinispan&sort=newest"
                       target="_blank">StackOverflow</a>.
        We will do our best to answer you as soon as we can.</p>
</div>
<div class="paragraph">
    <p>The Infinispan community uses <a href="https://zulipchat.com/"
                                        target="_blank">Zulip</a> for real-time communications.
        Join us using either a web-browser or a <a href="https://infinispan.zulipchat.com/apps/" target="_blank">dedicated
            application</a> on the <a href="https://infinispan.zulipchat.com/" target="_blank">Infinispan chat</a>.</p>
</div>
      </div>
      
    </div>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/infinispan-logo.png" class="project-logo" title="Infinispan Logo"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Infinispan is released under the Apache 2.0 open source license. Learn more about the <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a>.<br/><br/>This website built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a> is hosted on <a href='https://pages.github.com/' target='_blank'>Github Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/infinispan/infinispan.github.io' target='_blank'>fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <b>Navigation</b>
        <ul class="footer-links width-1-12">
          
            <li><a href="/">Home</a></li>
          
            <li><a href="/features">Features</a></li>
          
            <li><a href="/documentation">Docs</a></li>
          
            <li><a href="/tutorials">Tutorials</a></li>
          
            <li><a href="/videos">Videos</a></li>
          
            <li><a href="/use-cases">Use Cases</a></li>
          
            <li><a href="/community">Community</a></li>
          
            <li><a href="/download">Download</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <b>Contribute</b>
        <ul class="footer-links width-1-12">
          
            <li><a href="https://issues.jboss.org/browse/ISPN">Submit a Bug</a></li>
          
            <li><a href="https://github.com/infinispan">Write Code</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <b>Follow Us</b>
        <ul class="footer-links width-1-12">
          
            <li><a href="/blog">Blog</a></li>
          
            <li><a href="https://twitter.com/infinispan">Twitter</a></li>
          
        </ul>
      </div>
    

    <div class="width-6-12 more-links">
      <div class="grid-wrapper">
        <div class="width-6-12">
          <b>A Member of</b><br/>
          <a href="http://www.cloudtm.eu/" target="_blank"><img src="/assets/images/footer/cloud-tm.png"></a>
          <img src="/assets/images/footer/leads.png">
          <br/>
          <a href="http://cloudbutton.eu/" target="_blank"><img src="/assets/images/footer/cloud-button.png"></a>

        </div>
        <div class="width-6-12">

          <b>Thanks to</b><br/>
          <a href="https://www.jetbrains.com/idea/" target="_blank">JetBrains Intellj IDEA</a><br/>
          <a href="https://www.jetbrains.com/idea/" target="_blank"><img src="/assets/images/footer/jetbrains.png">
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
  <div class="content-slim redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a>
      | <a href="https://www.redhat.com/en/about/privacy-policy">Red Hat Privacy Policy</a>
    </span>
    <span class="redhat">
      a Red Hat sponsored project   
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/truncate-list.js"></script>

<!--   <script type="text/javascript">
    if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
        _satellite.pageBottom();
    }
  </script> -->
</body>

</html>
