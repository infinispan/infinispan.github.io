<!DOCTYPE html> <html lang="en"> <head> <title>Blog: Infinispan's new image - Infinispan</title> <meta charset="utf-8"> <meta content="width=device-width, initial-scale=1.0" name="viewport"> <meta content="DENY" http-equiv="X-Frame-Options"> <meta content="1; mode=block" http-equiv="X-XSS-Protection"> <meta content="nosniff" http-equiv="X-Content-Type-Options"> <link href="https://static.jboss.org/theme/css/bootstrap-community/3.2.0.2/bootstrap-community.min.css" media="screen" rel="stylesheet"> <link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" rel="stylesheet"> <script crossorigin="anonymous" src="https://kit.fontawesome.com/4167a38cfa.js"></script> <script id="dpal" src="https://www.redhat.com/dtm.js" type="text/javascript"></script> <link href="/images/favicon.png" rel="shortcut icon" type="image/png"> <link href="//static.jboss.org/images/example/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144"> <link href="//static.jboss.org/images/example/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114"> <link href="//static.jboss.org/images/example/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72"> <link href="//static.jboss.org/images/example/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed"> <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" rel="stylesheet"> <link href="https://static.jboss.org/css/rhbar.css" media="screen" rel="stylesheet"> <link href="/feed.atom" rel="alternate" type="application/atom+xml"> <style>
      .jumbotron {
        padding: 0.5em 0.1em 0.5em 0.1em;
        background-image: none;
        background-color: #ffec9f;
      }
      .jumbotron p, 
      .jumbotron h1 {
        color: #656565;
      }
      .dropup {
        z-index: 1032;
      }
      .navbar {
        font-size: x-large;
      }
      .navbar ul {
        padding-top: 0.7em;
      }
      .navbar-brand {
        height: 80px;
      }
      .navbar-default {
        background-color: white;
      }
      .navbar-default .navbar-nav > li > a {
        color: #336699;
      }
      .navbar-default .navbar-nav > li > a:hover {
        color: #204060;
      }
      .navbar-default .navbar-nav > .open > a,
      .navbar-default .navbar-nav > .open > a:hover,
      .navbar-default .navbar-nav > .open > a:focus {
        background-color: #4a5d75;
      }
      h3.well {
        border-color: #ffd630;
        background-color: #ffec9f;
      }
      .panel-sidebar {
        border-color: #f5f5f5;
      }
      .panel-sidebar > .panel-heading {
        border-color: #e3e3e3;
        background-color: #f5f5f5;
        color: #656565;
      }
      .btn-primary {
        border-color: #ffd630;
        background-color: #ffec9f;
        color: #656565;
      }
      footer.container {
        background-color: white;
      }
      footer.container h1, footer.container h2, footer.container h3, footer.container h4, footer.container h5, footer.container h6, footer.container p, footer.container a {
        color: #656565;
      }
      footer.container ul {
        padding: 0;
      }
      i.enormous-icon {
        margin-top: 0.3em;
      }
      .home-examples {
        font-size: 16px;
      }
    </style> <script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.min.js"></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script> <script>
      hljs.initHighlightingOnLoad();
    </script> <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
     
    ga('create', 'UA-8601422-1', 'auto');
    ga('send', 'pageview');
    
    </script> </head> <body> <div id=""> <ul class="visuallyhidden" id="top"> <li> <a accesskey="n" href="#nav" title="Skip to navigation">Skip to navigation</a> </li> <li> <a accesskey="c" href="#page" title="Skip to content">Skip to content</a> </li> </ul> <div id="rhbar"> <a class="jbdevlogo" href="http://www.jboss.org/projects/about"></a> <a class="rhlogo" href="http://www.redhat.com/"></a> </div> <div class="container" id="content"> <nav class="navbar navbar-default navbar-fixed-top"> <div class="container"> <div class="navbar-header"> <button aria-expanded="false" class="navbar-toggle collapsed" data-target="#thenavbar" data-toggle="collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/"> <img alt="Infinispan" src="/images/infinispan_nav_brand.png"> </a> </div> <div class="navbar-collapse collapse" id="thenavbar"> <ul class="nav navbar-nav"> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/about">About <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/about">Introduction</a></li> <li><a href="/features">Features</a></li> <li><a href="/release-notes">Release notes</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/references">References</a></li> <li><a href="/experiments/">Experiments</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/documentation">Learn <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/documentation">Documentation</a></li> <li><a href="/tutorials">Tutorials</a></li> <li><a href="/videos">Videos</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/download">Download <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/download">Infinispan Releases</a></li> <li><a href="/cache-store-implementations">Cache Store Implementations</a></li> <li><a href="/hotrod-clients">Hot Rod Clients</a></li> <li><a href="/integrations">Integrations</a></li> <li><a href="/download-archive">Archive</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/community">Community <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/community">Ask for Help</a></li> <li><a href="/getinvolved">Get Involved</a></li> </ul> </li> <li class=""><a href="/roadmap">Road Map</a></li> <li class="divider"></li> </ul> </div> </div> </nav> <ul class="breadcrumb"> <li> <a href="/blog">Blog</a> <span class="divider"></span> </li> <li class="active"> Infinispan's new image</li> </ul> <h3></h3> <h1>Infinispan's new image</h1> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan 10 introduced a <a href="https://infinispan.org/blog/2019/11/11/serverng/">new server</a>, which does not utilise the same launch commands and configuration as the legacy 9.4 wildfly based server. Therefore, we decided that this was an excellent opportunity to rewrite our container image from scratch to better suite the capabilities of the new server and to provide all the functionality required by the <a href="https://infinispan.org/blog/2019/11/25/infinispan-operator-1/">Infinispan Operator</a>.</p> </div> <div class="paragraph"> <p>This post focuses on the server image&#8217;s architecture. Future blog posts will focus on more advanced configurations, as well as example usage and deployment scenarios such as deploying a cluster using Kubernetes StatefulSets.</p> </div> </div> </div> <div class="sect1"> <h2 id="_show_me_the_code"><a class="anchor" href="#_show_me_the_code"></a>Show me the code!</h2> <div class="sectionbody"> <div class="paragraph"> <p>The source code for the Infinispan image has a new home. The image can be found at <a href="https://github.com/infinispan/infinispan-images" class="bare">https://github.com/infinispan/infinispan-images</a>. Currently this repository only contains the server image, however our intention is for this to also be the home for all future Infinispan related images.</p> </div> <div class="sect2"> <h3 id="_wheres_the_dockerfile"><a class="anchor" href="#_wheres_the_dockerfile"></a>Where&#8217;s the Dockerfile?</h3> <div class="paragraph"> <p>The most noticable change when looking at the repository is that there is no <code>Dockerfile</code> in the source tree. This is because we decided to utilise the open-source tool <a href="https://cekit.io/">CEKit</a> to build our images. CEKit is an image creation tool that allows container images to be created using multiple build engines (e.g. docker, <a href="https://buildah.io/">Buildah</a>, <a href="https://podman.io/">Podman</a>) with a single configuration. Installation instructions can be found <a href="https://docs.cekit.io/en/latest/handbook/installation/instructions.html">here</a>, but the basic command to create a Docker based image is as follows.</p> </div> <div class="listingblock"> <div class="content"> <pre>cekit build docker</pre> </div> </div> <div class="paragraph"> <p>CEKit leverages <code>.yaml</code> files for all configuration, opposed to a Dockerfile, as this allows for build time overriding of image properties. For example, with CEKit it&#8217;s possible to override the server artifact version without modifying any files, instead the following is passed as a build parameter.</p> </div> <div class="listingblock"> <div class="content"> <pre>cekit build --overrides '{"artifacts": [{"name": "server.zip", "path": "infinispan-server-10.0.0-SNAPSHOT.zip"}]}' docker</pre> </div> </div> <div class="paragraph"> <p>More detailed instructions about how to build the server image from source can be found in the <a href="https://github.com/infinispan/infinispan-images/tree/10.0.x#creating-images">image&#8217;s documentation</a>.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_ok_so_where_can_i_get_a_pre_built_image"><a class="anchor" href="#_ok_so_where_can_i_get_a_pre_built_image"></a>Ok so where can I get a pre-built image?</h2> <div class="sectionbody"> <div class="paragraph"> <p>Previously the Infinispan images were deployed exclusively under the <code>jboss</code> namespace at <a href="https://hub.docker.com/r/jboss/infinispan-server/">jboss/infinispan-server</a>, however this repository has now been deprecated and will be removed eventually.</p> </div> <div class="paragraph"> <p>Instead, all Infinispan images will now be released under the <code>infinispan</code> namespace and are hosted at both <a href="https://quay.io/infinispan/server">Quay.io</a> and <a href="https://hub.docker.com/r/infinispan/server">Docker Hub</a>, as <code>quay.io/infinispan/server</code> and <code>infinispan/server</code>.</p> </div> </div> </div> <div class="sect1"> <h2 id="_getting_started"><a class="anchor" href="#_getting_started"></a>Getting Started</h2> <div class="sectionbody"> <div class="paragraph"> <p>To get started with infinispan server on your local machine simply execute:</p> </div> <div class="listingblock"> <div class="content"> <pre>docker run -p 11222:11222 infinispan/server</pre> </div> </div> <div class="paragraph"> <p>By default the image has authentication enabled on all exposed endpoints. When executing the above command the image automatically generates a username/password combo, prints the values to stdout and then starts the Infinispan server with the authenticated Hotrod and Rest endpoints exposed on port 11222. Therefore, it&#8217;s necessary to utilise the printed credentials when attempting to access the exposed endpoints via clients.</p> </div> <div class="paragraph"> <p>It&#8217;s also possible to provide a username/password combination via environment variables like so:</p> </div> <div class="listingblock"> <div class="content"> <pre>docker run -p 11222:11222 -e USER="Titus Bramble" -e PASS="Shambles" infinispan/server</pre> </div> </div> <div class="sect2"> <h3 id="_connecting_via_hotrod"><a class="anchor" href="#_connecting_via_hotrod"></a>Connecting via Hotrod</h3> <div class="paragraph"> <p>Using the credentials passed in the command above, it is now possible to connect via the HotRod client using the following <code>hotrod-client.properties</code> file. Note, that the following SASL properties must be configured on your client, with the username and password properties changed as required, otherwise the connection will fail:</p> </div> <div class="listingblock"> <div class="content"> <pre>infinispan.remote.auth-realm=default&#x000A;infinispan.remote.auth-server-name=infinispan&#x000A;infinispan.remote.auth-username=Titus Bramble&#x000A;infinispan.remote.auth-password=Shambles</pre> </div> </div> </div> <div class="sect2"> <h3 id="_connecting_via_rest"><a class="anchor" href="#_connecting_via_rest"></a>Connecting via REST</h3> <div class="paragraph"> <p>The REST endpoint is configured to utilise the DIGEST protocol, therefore it&#8217;s necessary for the HTTP client to authenticate requests. For example, the name of all caches can be retrieved via the following curl command:</p> </div> <div class="listingblock"> <div class="content"> <pre> curl --digest -u "Titus Bramble:Shambles" http://localhost:11222/rest/v2/cache</pre> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_further_reading"><a class="anchor" href="#_further_reading"></a>Further Reading</h2> <div class="sectionbody"> <div class="paragraph"> <p>For more detailed information abou how to use the image, please consult the <a href="https://github.com/infinispan/infinispan-images/blob/10.0.x/README.md">official documentation</a>.</p> </div> <div class="paragraph"> <p>In the next blog post we will look at how the server can be configured for more advanced use-cases by supplying configuration and identity <code>.yaml</code> files.</p> </div> </div> </div> <div class="sect1"> <h2 id="_get_it_use_it_ask_us"><a class="anchor" href="#_get_it_use_it_ask_us"></a>Get it, Use it, Ask us!</h2> <div class="sectionbody"> <div class="paragraph"> <p>Please <a href="http://infinispan.org/download/">download</a>, <a href="https://issues.jboss.org/projects/ISPN">report bugs</a>, <a href="https://infinispan.zulipchat.com/">chat with us</a>, ask questions on <a href="https://stackoverflow.com/questions/tagged/?tagnames=infinispan&amp;sort=newest">StackOverflow</a>.</p> </div> </div> </div> <em>Posted by Ryan Emerson on 2019-12-02</em> <br> <em>Tags:</em> <a href="/blog/tags/docker/"> docker </a> </div> <footer class="container"> <hr> <div class="row"> <div class="col-md-2 col-md-offset-1"> <h4>Navigate</h4> <ul> <li> <a href="/about" title="About">About</a> </li> <li> <a href="/documentation" title="Learn">Learn</a> </li> <li> <a href="/community" title="Community">Community</a> </li> <li> <a href="/getinvolved" title="Get Involved">Get Involved</a> </li> <li> <a href="/download" title="Download">Download</a> </li> </ul> </div> <div class="col-md-2"> <h4>Contribute</h4> <ul> <li> <a href="https://issues.jboss.org/browse/ISPN" title="Submit a bug">Submit a bug</a> </li> <li> <a href="https://github.com/infinispan" title="Write code">Write Code</a> </li> </ul> <h4>Follow Us</h4> <ul> <li> <a href="https://infinispan.org/blog/" title="Blog">Blog</a> </li> <li> <a href="https://twitter.com/infinispan" title="Twitter">Twitter</a> </li> </ul> </div> <div class="col-md-2"> <h4>Open Source</h4> <p> Infinispan is released under the <b>Apache 2.0 open source license.</b> Learn more about the Apache 2.0 license <a href="https://www.apache.org/licenses/LICENSE-2.0">here.</a> </p> </div> <div class="col-md-2"> <h4>A member of</h4> <a alt="CloudTM" href="http://www.cloudtm.eu/" target="_NEW"> <img src="/images/cloudtm.png"> </a> <a alt="LEADS" href="http://leads-project.eu/" target="_NEW"> <img src="/images/leads.png"> </a> <a alt="CloudButton" href="http://cloudbutton.eu/" target="_NEW"> <img src="/images/cloudbutton.png"> </a> </div> <div class="col-md-2"> <h4>Thanks to</h4> <p>JetBrains Intellij IDEA</p> <a alt="JetBrains Intellij IDEA" href="https://www.jetbrains.com/idea/" target="_NEW"> <img src="/images/icon_IntelliJIDEA.png"> </a> </div> </div> <div class="col-md-10"> <p style="margin-top: 5px; font-size: 80%;"> © Copyright 2009-2019 Red Hat, Inc. <br> <i class="icon-fire"></i> Made with <a href="https://github.com/jbossorg/bootstrap-community" style="text-decoration: underline;" target="_NEW">JBoss Community Bootstrap</a> and <a href="http://awestruct.org/" style="text-decoration: underline;" target="_NEW">Awestruct</a> <br> <i class="icon-globe"></i> This website is open source! If you want to improve it, <a href="https://github.com/infinispan/infinispan.github.io" style="text-decoration: underline;" target="_NEW">fork the project,</a> and hack on it, then send a pull request. You can also view the <a href="https://www.seethestats.com/site/infinispan.org" style="text-decoration: underline;" target="_NEW">visitor stats.</a> <br> <i class="icon-share"></i> Website and documentation released under <a href="https://creativecommons.org/licenses/by/3.0/" style="text-decoration: underline;" target="_NEW">CC BY 3.0.</a> </p> </div> </footer> <div class="container" id="companyfooter"> <div class="redhatlogo"> <div id="logospacer"></div> <a href="http://www.redhat.com/"><img src="//static.jboss.org/theme/images/common/redhat_logo.png"></a> </div> </div> <span class="backToTop"> <a href="#top">back to top</a> </span> <script src="//static.jboss.org/theme/js/libs/bootstrap-community/3.2.0.2/bootstrap-community.min.js"></script> <script>
        if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
          _satellite.pageBottom();
        }
      </script> </div> </body> </html>