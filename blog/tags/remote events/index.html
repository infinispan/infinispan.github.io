<!DOCTYPE html> <html lang="en"> <head> <title> Blog - Infinispan</title> <meta charset="utf-8"> <meta content="width=device-width, initial-scale=1.0" name="viewport"> <meta content="DENY" http-equiv="X-Frame-Options"> <meta content="1; mode=block" http-equiv="X-XSS-Protection"> <meta content="nosniff" http-equiv="X-Content-Type-Options"> <link href="https://static.jboss.org/theme/css/bootstrap-community/3.2.0.2/bootstrap-community.min.css" media="screen" rel="stylesheet"> <link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" rel="stylesheet"> <script crossorigin="anonymous" src="https://kit.fontawesome.com/4167a38cfa.js"></script> <script id="dpal" src="https://www.redhat.com/dtm.js" type="text/javascript"></script> <link href="/images/favicon.png" rel="shortcut icon" type="image/png"> <link href="//static.jboss.org/images/example/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144"> <link href="//static.jboss.org/images/example/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114"> <link href="//static.jboss.org/images/example/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72"> <link href="//static.jboss.org/images/example/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed"> <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" rel="stylesheet"> <link href="https://static.jboss.org/css/rhbar.css" media="screen" rel="stylesheet"> <style>
      .jumbotron {
        padding: 0.5em 0.1em 0.5em 0.1em;
        background-image: none;
        background-color: #ffec9f;
      }
      .jumbotron p, 
      .jumbotron h1 {
        color: #656565;
      }
      .dropup {
        z-index: 1032;
      }
      .navbar {
        font-size: x-large;
      }
      .navbar ul {
        padding-top: 0.7em;
      }
      .navbar-brand {
        height: 80px;
      }
      .navbar-default {
        background-color: white;
      }
      .navbar-default .navbar-nav > li > a {
        color: #336699;
      }
      .navbar-default .navbar-nav > li > a:hover {
        color: #204060;
      }
      .navbar-default .navbar-nav > .open > a,
      .navbar-default .navbar-nav > .open > a:hover,
      .navbar-default .navbar-nav > .open > a:focus {
        background-color: #4a5d75;
      }
      h3.well {
        border-color: #ffd630;
        background-color: #ffec9f;
      }
      .panel-sidebar {
        border-color: #f5f5f5;
      }
      .panel-sidebar > .panel-heading {
        border-color: #e3e3e3;
        background-color: #f5f5f5;
        color: #656565;
      }
      .btn-primary {
        border-color: #ffd630;
        background-color: #ffec9f;
        color: #656565;
      }
      footer.container {
        background-color: white;
      }
      footer.container h1, footer.container h2, footer.container h3, footer.container h4, footer.container h5, footer.container h6, footer.container p, footer.container a {
        color: #656565;
      }
      footer.container ul {
        padding: 0;
      }
      i.enormous-icon {
        margin-top: 0.3em;
      }
      .home-examples {
        font-size: 16px;
      }
    </style> <script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.min.js"></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script> <script>
      hljs.initHighlightingOnLoad();
    </script> <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
     
    ga('create', 'UA-8601422-1', 'auto');
    ga('send', 'pageview');
    
    </script> </head> <body> <div id=""> <ul class="visuallyhidden" id="top"> <li> <a accesskey="n" href="#nav" title="Skip to navigation">Skip to navigation</a> </li> <li> <a accesskey="c" href="#page" title="Skip to content">Skip to content</a> </li> </ul> <div id="rhbar"> <a class="jbdevlogo" href="http://www.jboss.org/projects/about"></a> <a class="rhlogo" href="http://www.redhat.com/"></a> </div> <div class="container" id="content"> <nav class="navbar navbar-default navbar-fixed-top"> <div class="container"> <div class="navbar-header"> <button aria-expanded="false" class="navbar-toggle collapsed" data-target="#thenavbar" data-toggle="collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/"> <img alt="Infinispan" src="/images/infinispan_nav_brand.png"> </a> </div> <div class="navbar-collapse collapse" id="thenavbar"> <ul class="nav navbar-nav"> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/about">About <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/about">Introduction</a></li> <li><a href="/features">Features</a></li> <li><a href="/release-notes">Release notes</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/references">References</a></li> <li><a href="/experiments/">Experiments</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/documentation">Learn <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/documentation">Documentation</a></li> <li><a href="/tutorials">Tutorials</a></li> <li><a href="/videos">Videos</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/download">Download <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/download">Infinispan Releases</a></li> <li><a href="/cache-store-implementations">Cache Store Implementations</a></li> <li><a href="/hotrod-clients">Hot Rod Clients</a></li> <li><a href="/integrations">Integrations</a></li> <li><a href="/download-archive">Archive</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/community">Community <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/community">Ask for Help</a></li> <li><a href="/getinvolved">Get Involved</a></li> </ul> </li> <li class=""><a href="/roadmap">Road Map</a></li> <li class="divider"></li> </ul> </div> </div> </nav> <div class="post"></div> <h3> Friday, 17 March 2017 </h3> <h1> <a href="/blog/2017/03/17/event-listener-with-c/">Event Listener with C++</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Dear Infinispan community,</p> </div> <div class="paragraph"> <p>as announced in a previous <a href="http://blog.infinispan.org/2016/11/hotrod-clients-cc-810alpha2-released.html">post</a>, starting from version 8.1.0 also the C++/C# clients can receive and process Infinispan events.</p> </div> <div class="paragraph"> <p>Here&#8217;s an example of usage of C++ event listeners that, with a good dose of imagination, pretends to be a customer behavior tracking system for our store chain (don&#8217;t take this too seriously, we&#8217;re just trying to add some fiction).</p> </div> <div class="paragraph"> <p>As a first requirement our tracking system will record every single purchase made in our stores. How many stores we have? 1, 100, millions? It doesn&#8217;t matter: we&#8217;re backed with an Infinispan data grid. This is version 0.x and hence the checker must use the keyboard to enter all the needed information.</p> </div> <div class="paragraph"> <p>As you can see our entry key is a concatenation of the product name and the timestamp and the entry value is an unstructured string, maybe too simply but it could work for now. Seems we are at a good point: we have the data and we can do analytics on it, so far so good but now our boss makes a new request: he wants a runtime monitor on how&#8217;s the sales performance. That&#8217;s a perfect request to be fulfilled with event listener: the monitor application will be an Hotrod C++ client that registers a client listener on the server and receives and show on the boss&#8217;s laptop the data flow. A client listener, once registered on the server, can receive events related to: creation, modification, deletion, expiration of cache entries; in our example only the creation and expiration events are processed (expired events can be useful to do some moving average statistics?). Following a snip of code that creates and registers a listener that writes the events key on the stdout.</p> </div> <div class="paragraph"> <p>You can git this quickstart here [<a href="https://www.blogger.com/blogger.g?blogID=5717179571414330874#fn1">1</a>]. On startup a multiple choice menu is shown with all the available operations. Running several instances you can act as the checker (data entry) or the boss (installing the listener and seeing the events flow).</p> </div> </div> </div> <div class="sect1"> <h2 id="_filters"><a class="anchor" href="#_filters"></a><strong>Filters</strong></h2> <div class="sectionbody"> <div class="paragraph"> <p>Again so far so good, but then the marketing department ask support to do targeted advertising like: soliciting customers that bought product Y to buy product X. Let&#8217;s suppose that X="harmonica" and Y="hiking boots" (it&#8217;s a well known fact of life that in the high mountains you feel the desire to play an harmonica).</p> </div> <div class="paragraph"> <p>To do that we register on the server another listener, but this time we&#8217;re not interested in the whole flow of purchase data: to run our marketing campaign, we only interested in cache entries having the key starting with "hiking". The Infinispan server can filter out events for us, if we pass in the AddClientListener operation the name of the wanted filter along with any configuration arguments.</p> </div> <div class="paragraph"> <p>Filter are java classes that must be deployed into the Infinispan server (more here [<a href="https://www.blogger.com/blogger.g?blogID=5717179571414330874#fn2">2</a>])</p> </div> </div> </div> <div class="sect1"> <h2 id="_and_converters"><a class="anchor" href="#_and_converters"></a><strong>and converters</strong></h2> <div class="sectionbody"> <div class="paragraph"> <p>Predefined events contain very few information: basically the event type and the entry key, this to prevent to flood the network spreading around very long entry values. Users can override this limitation using a converter, that is a java class deployed into the server, that can create custom events containing every data needed by the application.</p> </div> <div class="paragraph"> <p>As in the previous case, we pass into the add operation the name of the converter and the configuration arguments, any.</p> </div> <div class="paragraph"> <p>That&#8217;s all guys, let us know your feedback: do you like it? Could be better? Tell us how it can be improved creating an issue [<a href="https://www.blogger.com/blogger.g?blogID=5717179571414330874#fn3">3</a>], or fork and improve it yourself [<a href="https://www.blogger.com/blogger.g?blogID=5717179571414330874#fn4">4</a>]<strong>!</strong></p> </div> <div class="paragraph"> <p>Thanks for reading and enjoy! The Infinispan Team</p> </div> <div id="ref1[1]" class="paragraph blogger com/blogger g?blogID=5717179571414330874"> <p><a href="https://github.com/rigazilla/infinispan-simple-tutorials/tree/new_event_tutorial/c%2B%2B/events" class="bare">https://github.com/rigazilla/infinispan-simple-tutorials/tree/new_event_tutorial/c%2B%2B/events</a></p> </div> <div id="ref2[2]" class="paragraph blogger com/blogger g?blogID=5717179571414330874"> <p><a href="http://blog.infinispan.org/2014/08/hot-rod-remote-events-1-getting-started.html" class="bare">http://blog.infinispan.org/2014/08/hot-rod-remote-events-1-getting-started.html</a></p> </div> <div id="ref2[2]" class="paragraph blogger com/blogger g?blogID=5717179571414330874"> <p><a href="http://blog.infinispan.org/2014/08/hot-rod-remote-events-2-filtering-events.html" class="bare">http://blog.infinispan.org/2014/08/hot-rod-remote-events-2-filtering-events.html</a></p> </div> <div id="ref2[2]" class="paragraph blogger com/blogger g?blogID=5717179571414330874"> <p><a href="http://blog.infinispan.org/2014/09/hot-rod-remote-events-3-customizing.html" class="bare">http://blog.infinispan.org/2014/09/hot-rod-remote-events-3-customizing.html</a></p> </div> <div id="ref3[3]" class="paragraph blogger com/blogger g?blogID=5717179571414330874"> <p><a href="https://issues.jboss.org/projects/HRCPP/issues" class="bare">https://issues.jboss.org/projects/HRCPP/issues</a></p> </div> <div id="ref4[4]" class="paragraph blogger com/blogger g?blogID=5717179571414330874"> <p><a href="https://github.com/infinispan/cpp-client" class="bare">https://github.com/infinispan/cpp-client</a></p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Monday, 15 December 2014 </h3> <h1> <a href="/blog/2014/12/15/hot-rod-remote-events-4-clustering-and/">Hot Rod Remote Events #4: Clustering and Failover</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>This blog post is the last in a series that looks at the forthcoming Hot Rod Remote Events functionality included in Infinispan 7.0. <a href="http://blog.infinispan.org/2014/08/hot-rod-remote-events-1-getting-started.html">First article</a> focused on how to get started receiving remote events from Hot Rod servers. The <a href="http://blog.infinispan.org/2014/08/hot-rod-remote-events-2-filtering-events.html">second article</a> looked at how Hot Rod remote events can be filtered, and the <a href="http://blog.infinispan.org/2014/09/hot-rod-remote-events-3-customizing.html">third one</a> showed how to customize contents of events.</p> </div> <div class="paragraph"> <p>In this last article, we&#8217;ll be focusing on how remote events are fired in a clustered environment and how failover situations are dealt with.</p> </div> <div class="paragraph"> <p>The most important thing to know about remote events in a clustered environment is that <strong>when a client adds a remote listener, this is installed in a single node in the cluster and that this node is in charge of sending events back to the client for all affected operations happening cluster wide</strong>.</p> </div> <div class="paragraph"> <p>As a result of this, when filtering or event customization is applied, the org.infinispan.notifications.cachelistener.filter.CacheEventFilter and/or org.infinispan.notifications.cachelistener.filter.CacheEventConverter instances must be somehow marshallable. This is necessary because when the client listener is installed in a cluster, the filter and/or converter instances are sent to other nodes in the cluster so that filtering and conversion can happen right where the event originates, hence improving efficiency. These classes can be made marshallable by making them extend Serializable, or <a href="http://infinispan.org/docs/7.0.x/user_guide/user_guide.html#_plugging_infinispan_with_user_defined_externalizers">providing and registering a custom Externalizer for them</a>.</p> </div> <div class="paragraph"> <p>Under normal circumstances, the code and examples showed in previous blog posts work the same way in clustered environment. However, in a clustered environment, a decision needs to be made with regards to how to deal with situations where nodes go down: If a node goes down that does not have the client listener installed, nothing happens. However, when the node containing the client listener goes down, the Hot Rod client implementation transparently fails over the client listener registration to a different node. As a result of this failover, there could be a gap in the event consumption. This gap is solved using one of these solutions:</p> </div> </div> </div> <div class="sect3"> <h4 id="_state_delivery"><a class="anchor" href="#_state_delivery"></a>State Delivery</h4> <div class="paragraph"> <p>The @ClientListener annotation has an optional parameter called includeCurrentState. When this is enabled and the client listener is registered, before receiving any events for on-going operations, the server sends ClientCacheEntryCreatedEvent event instances (for methods annotated with @ClientCacheEntryCreated) for all existing cache entries to the client. This offers the client an opportunity to construct some state or computation based on the contents of the clustered cache. When the Hot Rod client transparently fails over registered listeners, it re-registers them in a different node and if includeCurrentState is enabled, clients can recompute their state or computation to reinstate it to what it was before the failover. The downside of includeCurrentState is that it&#8217;s performance is heavily dependant on the cache size, and hence it&#8217;s disabled by default.</p> </div> </div> <div class="sect3"> <h4 id="_clientcachefailover"><a class="anchor" href="#_clientcachefailover"></a>@ClientCacheFailover</h4> <div class="paragraph"> <p>Alternatively, instead of relying on receiving state, users can define a method with @ClientCacheFailover annotation that receives ClientCacheFailoverEvent as parameter inside the client listener implementation:</p> </div> <div class="paragraph"> <p>This method would be called back whenever the node that had this client listener has gone down. This can be handy for situations when the end users just wants to clear up some local state as a result of the failover, e.g. clear a near or L1 cache. When events are received again, the near or L1 cache could be repopulated again.</p> </div> <div class="paragraph"> <p>This callback method of dealing with client listener failover offers a simple, efficient solution to dealing with cluster topology changes affecting client listeners. Depending on the remote event use case, this method might be better suited that state delivery.</p> </div> </div> <div class="sect2"> <h3 id="_final_words"><a class="anchor" href="#_final_words"></a>Final Words</h3> <div class="paragraph"> <p>This post marks the end of the remote event series. In future Infinispan versions, we&#8217;ll continue improving the technology adding some extra features, and more importantly, we&#8217;ll start building higher level abstractions on top of remote events, such as Hot Rod client Near Caches.</p> </div> <div class="paragraph"> <p>Cheers, Galder</p> </div> </div> </div> <hr> <div class="post"></div> <h3> Wednesday, 17 September 2014 </h3> <h1> <a href="/blog/2014/09/17/hot-rod-remote-events-3-customizing/">Hot Rod Remote Events #3: Customizing events</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>This blog post is the third in a series that looks at the forthcoming Hot Rod Remote Events functionality included in Infinispan 7.0. In the <a href="http://blog.infinispan.org/2014/08/hot-rod-remote-events-1-getting-started.html">first article</a> we looked at how to get started receiving remote events from Hot Rod servers. In the <a href="http://blog.infinispan.org/2014/08/hot-rod-remote-events-2-filtering-events.html">second article</a>, we saw how Hot Rod remote events can be filtered providing key/value filter factories that can create instances that filter which events are sent to clients, and how these filters can act on client provided information.</p> </div> <div class="paragraph"> <p>This time we are going to focus on how to customize events sent to clients. Events generated by default contain just enough information to make the event relevant but avoid cramming too much information in order to reduce the cost of sending them. Normally, this information consists of key and type of event.</p> </div> <div class="paragraph"> <p>Optionally, the information shipped in these events can be customized in order to contain more information, such as values, or to contain even less information. This customization is done with org.infinispan.notifications.cachelistener.filter.CacheEventConverter instances which are created by implementing a org.infinispan.notifications.cachelistener.filter.CacheEventConverterFactory class. Each factory must have a name associated to it via the org.infinispan.filter.NamedFactory annotation.</p> </div> <div class="paragraph"> <p>When a listener is added, we can provide the name of a converter factory to use with this listener, and when the listener is added, the server will look up the factory and invoke getConverter method to get a org.infinispan.notifications.cachelistener.filter.CacheEventConverter class instance to customize events server side.</p> </div> <div class="paragraph"> <p>Here&#8217;s a sample implementation which will send custom events containing value information back to clients for a cache of Integers and Strings:</p> </div> <div class="paragraph"> <p>In the example above, the converter generates a new custom event which includes the value as well as the key in the event. This will result in bigger event payloads compared with default events, but if combined with filtering, it can reduce its network bandwidth cost.</p> </div> <div class="paragraph"> <p>In another converter implementation, the user could decide to send back an event that contains no key or event type information. This would result in extremely lightweight events at the expense of richness of information provided by the event itself.</p> </div> <div class="paragraph"> <p>Plugging the server with this converter requires deploying this converter factory (and associated converter class) within a jar file including a service definition inside the META-INF/services/org.infinispan.notifications.cachelistener.filter.CacheEventConverterFactory file:</p> </div> <div class="paragraph"> <p>With the server plugged with the converter, the next step is adding a remote client listener that will use this converter. How to implement a listener for custom events is slightly different to the listeners we&#8217;ve seen in the last couple of blog posts because we know have to deal with customised events as opposed to the default ones. To do so, the same annotations are used as previous blog posts, but the callbacks receive instances of org.infinispan.client.hotrod.event.ClientCacheEntryCustomEvent&lt;T&gt;, where T is the type of custom event we are sending from the server:</p> </div> <div class="paragraph"> <p>Now it&#8217;s time to write a simple main java class which adds the remote event listener and executes some operations against the remote cache:</p> </div> <div class="paragraph"> <p>Once executed, we should see a console console output similar to this:</p> </div> <div class="paragraph"> <p>Similar to events, converters can also act on client provided information, enabling converter instances to customize events depending on the information given when the listener was added. The API provides an extra parameter to pass in converter parameters when the listener is added. Given the similarities with filtering, this part is not covered by this blog post.</p> </div> <div class="paragraph"> <p>A final note on the marshalling aspects of this example. In order to facilitate both server and client writing against type safe APIs, both the client and server need to be aware of custom event type and be able to marshall it. Client side, this is done by an optional marshaller configurable via the RemoteCacheManager. Server side, this is done by a marshaller recently added to the Hot Rod server configuration.</p> </div> <div class="paragraph"> <p>In the next blog post in the Hot Rod remote events series, we will look at how to receive remote events in a clustered environment, how to deal with failover situations&#8230;&#8203;etc.</p> </div> <div class="paragraph"> <p>Cheers, Galder</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Wednesday, 20 August 2014 </h3> <h1> <a href="/blog/2014/08/20/hot-rod-remote-events-2-filtering-events/">Hot Rod Remote Events #2: Filtering events</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>This blog post is the second in a series that looks at the forthcoming Hot Rod Remote Events functionality included in Infinispan 7.0. In the <a href="http://blog.infinispan.org/2014/08/hot-rod-remote-events-1-getting-started.html">first blog post</a> we looked at how to get started receiving remote events from Hot Rod servers. This time we are going to focus on how to filter events directly in the server.</p> </div> <div class="paragraph"> <p>Sending events to remote clients has a cost which increases as the number of clients. The more clients register remote listeners, the more events the server has to send. This cost also goes up as the number of modifications are executed against the cache. The more cache modifications, the more events that need to be sent.</p> </div> <div class="paragraph"> <p>A way to reduce this cost is by filtering the events to send server-side. If at the server level custom code decides that clients are not interested in a particular event, the event does not even need to leave the server, improving the overall performance of the system.</p> </div> <div class="paragraph"> <p>Remote event filters are created by implementing a org.infinispan.notifications.cachelistener.filter.CacheEventFilterFactory class. Each factory must have a name associated to it via the org.infinispan.notifications.cachelistener.filter.NamedFactory annotation.</p> </div> <div class="paragraph"> <p>When a listener is added, we can provide the name of a key value filter factory to use with this listener, and when the listener is added, the server will look up the factory and invoke getFilter method to get a org.infinispan.notifications.cachelistener.filter.CacheEventFilterFactory class instance to filter events server side.</p> </div> <div class="paragraph"> <p>Filtering can be done based on key or value information, and even based on cached entry metadata. Here&#8217;s a sample implementation which will filter key "2" out of the events sent to clients:</p> </div> <div class="paragraph"> <p>Plugging the server with this key value filter requires deploying this filter factory (and associated filter class) within a jar file including a service definition inside the META-INF/services/org.infinispan.notifications.cachelistener.filter.CacheEventFilterFactory file:</p> </div> <div class="paragraph"> <p>With the server plugged with the filter, the next step is adding a remote client listener that will use this filter. For this example, we&#8217;ll extend the EventLogListener implementation provided in the <a href="http://blog.infinispan.org/2014/08/hot-rod-remote-events-1-getting-started.html">first blog post</a> in the series and we override the @ClientListener annotation to indicate the filter factory to use with this listener:</p> </div> <div class="paragraph"> <p>Next, we add the listener via the RemoteCache API and we execute some operations against the remote cache:</p> </div> <div class="paragraph"> <p>If we checkout the system output we&#8217;ll see that the client receives events for all keys except those that have been filtered:</p> </div> <div class="paragraph"> <p>Finally, with Hot Rod remote events we have tried to provide additional flexibility at the client side, which is why when adding client listeners, users can provide parameters to the filter factory so that filter instances with different behaviours can be generated out of a single filter factory based on client side information. To show this in action, we are going to enhance the filter factory above so that instead of filtering on a statically given key, it can filter dynamically based on the key provided when adding the listener. Here&#8217;s the revised version:</p> </div> <div class="paragraph"> <p>Finally, here&#8217;s how we can now filter by "3" instead of "2":</p> </div> <div class="paragraph"> <p>And the output:</p> </div> <div class="paragraph"> <p>To summarise, we&#8217;ve seen how Hot Rod remote events can be filtered providing key/value filter factories that can create instances that filter which events are sent to clients, and how these filters can act on client provided information.</p> </div> <div class="paragraph"> <p>In the next blog post, we&#8217;ll look at how to customize remote events in order to reduce the amount of information sent to the clients, or on the contrary, provide even more information to our clients.</p> </div> <div class="paragraph"> <p>Cheers, Galder</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Tuesday, 12 August 2014 </h3> <h1> <a href="/blog/2014/08/12/hot-rod-remote-events-1-getting-started/">Hot Rod Remote Events #1: Getting started</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Shortly after the first Hot Rod server implementation was released in 2010, <a href="https://issues.jboss.org/browse/ISPN-374">ISPN-374</a> was created requesting cache events to be forwarded back to connected clients. Even though embedded caches have had access to these events since Infinispan&#8217;s first release, propagating them to remote clients has taken a while, due to the increased complexity involved.</p> </div> <div class="paragraph"> <p>For Infinispan 7.0, we&#8217;ve finally addressed this. This is the first post in a series that looks at Hot Rod Remote Events and the different functionality we&#8217;ve implemented for this release. On this first post, we show you how to get started with Hot Rod Remote Events with the most basic of examples:</p> </div> <div class="paragraph"> <p>Start by downloading the Server distribution for the latest 7.0 (or higher) release from <a href="http://infinispan.org/download/">Infinispan&#8217;s download page</a>. The server contains the Hot Rod server with which the client will communicate. Once downloaded, start it up running the following from the root of the server:</p> </div> <div class="paragraph"> <div class="title">/bin/standalone.sh</div> <p>Next up, we need to write a little application that interacts with the Hot Rod server. If you&#8217;re using Maven, create an application with this dependency, changing version to 7.0.0.Beta1 or higher:</p> </div> <div class="paragraph"> <p>If not using Maven, adjust according to your chosen build tool or download the all distribution with all Infinispan jars.</p> </div> <div class="paragraph"> <p>With the application dependencies in place, we need to start to write the client application. We&#8217;ll start with a simple remote event listener that simply logs all events received:</p> </div> <div class="paragraph"> <p>Now it&#8217;s time to write a simple main java class which adds the remote event listener and executes some operations against the remote cache:</p> </div> <div class="paragraph"> <p>Once executed, we should see a console console output similar to this:</p> </div> <div class="paragraph"> <p>As you can see from the output, by default events come with the key and the internal data version associated with the current value. The actual value is not shipped back to the client for performance reasons. Clearly, receiving remote events has a cost, and as the cache size increases and more operations are executed, more events will be generated. To avoid inundating Hot Rod clients, remote events can either be filtered server side, or the event contents can be customised. In the next blog post in this series, we will see this functionality in action.</p> </div> <div class="paragraph"> <p>Cheers, Galder</p> </div> </div> </div> </div> <hr> <div class="pagination-links"><span class="current-page">1</span> </div> </div> <footer class="container"> <hr> <div class="row"> <div class="col-md-2 col-md-offset-1"> <h4>Navigate</h4> <ul> <li> <a href="/about" title="About">About</a> </li> <li> <a href="/documentation" title="Learn">Learn</a> </li> <li> <a href="/community" title="Community">Community</a> </li> <li> <a href="/getinvolved" title="Get Involved">Get Involved</a> </li> <li> <a href="/download" title="Download">Download</a> </li> </ul> </div> <div class="col-md-2"> <h4>Contribute</h4> <ul> <li> <a href="https://issues.jboss.org/browse/ISPN" title="Submit a bug">Submit a bug</a> </li> <li> <a href="https://github.com/infinispan" title="Write code">Write Code</a> </li> </ul> <h4>Follow Us</h4> <ul> <li> <a href="https://blog.infinispan.org" title="Blog">Blog</a> </li> <li> <a href="https://twitter.com/infinispan" title="Twitter">Twitter</a> </li> </ul> </div> <div class="col-md-2"> <h4>Open Source</h4> <p> Infinispan is released under the <b>Apache 2.0 open source license.</b> Learn more about the Apache 2.0 license <a href="https://www.apache.org/licenses/LICENSE-2.0">here.</a> </p> </div> <div class="col-md-2"> <h4>A member of</h4> <a alt="CloudTM" href="http://www.cloudtm.eu/" target="_NEW"> <img src="/images/cloudtm.png"> </a> <a alt="LEADS" href="http://leads-project.eu/" target="_NEW"> <img src="/images/leads.png"> </a> <a alt="CloudButton" href="http://cloudbutton.eu/" target="_NEW"> <img src="/images/cloudbutton.png"> </a> </div> <div class="col-md-2"> <h4>Thanks to</h4> <p>JetBrains Intellij IDEA</p> <a alt="JetBrains Intellij IDEA" href="https://www.jetbrains.com/idea/" target="_NEW"> <img src="/images/icon_IntelliJIDEA.png"> </a> </div> </div> <div class="col-md-10"> <p style="margin-top: 5px; font-size: 80%;"> © Copyright 2009-2019 Red Hat, Inc. <br> <i class="icon-fire"></i> Made with <a href="https://github.com/jbossorg/bootstrap-community" style="text-decoration: underline;" target="_NEW">JBoss Community Bootstrap</a> and <a href="http://awestruct.org/" style="text-decoration: underline;" target="_NEW">Awestruct</a> <br> <i class="icon-globe"></i> This website is open source! If you want to improve it, <a href="https://github.com/infinispan/infinispan.github.io" style="text-decoration: underline;" target="_NEW">fork the project,</a> and hack on it, then send a pull request. You can also view the <a href="https://www.seethestats.com/site/infinispan.org" style="text-decoration: underline;" target="_NEW">visitor stats.</a> <br> <i class="icon-share"></i> Website and documentation released under <a href="https://creativecommons.org/licenses/by/3.0/" style="text-decoration: underline;" target="_NEW">CC BY 3.0.</a> </p> </div> </footer> <div class="container" id="companyfooter"> <div class="redhatlogo"> <div id="logospacer"></div> <a href="http://www.redhat.com/"><img src="//static.jboss.org/theme/images/common/redhat_logo.png"></a> </div> </div> <span class="backToTop"> <a href="#top">back to top</a> </span> <script src="//static.jboss.org/theme/js/libs/bootstrap-community/3.2.0.2/bootstrap-community.min.js"></script> <script>
        if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
          _satellite.pageBottom();
        }
      </script> </div> </body> </html>