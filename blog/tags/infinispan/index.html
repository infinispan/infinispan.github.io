<!DOCTYPE html> <html lang="en"> <head> <title>Blog - Infinispan</title> <meta charset="utf-8"> <meta content="width=device-width, initial-scale=1.0" name="viewport"> <meta content="DENY" http-equiv="X-Frame-Options"> <meta content="1; mode=block" http-equiv="X-XSS-Protection"> <meta content="nosniff" http-equiv="X-Content-Type-Options"> <link href="https://static.jboss.org/theme/css/bootstrap-community/3.2.0.2/bootstrap-community.min.css" media="screen" rel="stylesheet"> <link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" rel="stylesheet"> <script id="dpal" src="https://www.redhat.com/dtm.js" type="text/javascript"></script> <link href="/images/favicon.png" rel="shortcut icon" type="image/png"> <link href="//static.jboss.org/images/example/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144"> <link href="//static.jboss.org/images/example/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114"> <link href="//static.jboss.org/images/example/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72"> <link href="//static.jboss.org/images/example/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed"> <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" rel="stylesheet"> <link href="https://static.jboss.org/css/rhbar.css" media="screen" rel="stylesheet"> <style>
      .jumbotron {
        padding: 0.5em 0.1em 0.5em 0.1em;
        background-image: none;
        background-color: #ffec9f;
      }
      .jumbotron p, 
      .jumbotron h1 {
        color: #656565;
      }
      .dropup {
        z-index: 1032;
      }
      .navbar {
        font-size: x-large;
      }
      .navbar ul {
        padding-top: 0.7em;
      }
      .navbar-brand {
        height: 80px;
      }
      .navbar-default {
        background-color: white;
      }
      .navbar-default .navbar-nav > li > a {
        color: #336699;
      }
      .navbar-default .navbar-nav > li > a:hover {
        color: #204060;
      }
      .navbar-default .navbar-nav > .open > a,
      .navbar-default .navbar-nav > .open > a:hover,
      .navbar-default .navbar-nav > .open > a:focus {
        background-color: #4a5d75;
      }
      h3.well {
        border-color: #ffd630;
        background-color: #ffec9f;
      }
      .panel-sidebar {
        border-color: #f5f5f5;
      }
      .panel-sidebar > .panel-heading {
        border-color: #e3e3e3;
        background-color: #f5f5f5;
        color: #656565;
      }
      .btn-primary {
        border-color: #ffd630;
        background-color: #ffec9f;
        color: #656565;
      }
      footer.container {
        background-color: white;
      }
      footer.container h1, footer.container h2, footer.container h3, footer.container h4, footer.container h5, footer.container h6, footer.container p, footer.container a {
        color: #656565;
      }
      footer.container ul {
        padding: 0;
      }
      i.enormous-icon {
        margin-top: 0.3em;
      }
      .home-examples {
        font-size: 16px;
      }
    </style> <script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.min.js"></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script> <script>
      hljs.initHighlightingOnLoad();
    </script> <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
     
    ga('create', 'UA-8601422-1', 'auto');
    ga('send', 'pageview');
    
    </script> </head> <body> <div id=""> <ul class="visuallyhidden" id="top"> <li> <a accesskey="n" href="#nav" title="Skip to navigation">Skip to navigation</a> </li> <li> <a accesskey="c" href="#page" title="Skip to content">Skip to content</a> </li> </ul> <div id="rhbar"> <a class="jbdevlogo" href="http://www.jboss.org/projects/about"></a> <a class="rhlogo" href="http://www.redhat.com/"></a> </div> <div class="container" id="content"> <nav class="navbar navbar-default navbar-fixed-top"> <div class="container"> <div class="navbar-header"> <button aria-expanded="false" class="navbar-toggle collapsed" data-target="#thenavbar" data-toggle="collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/"> <img alt="Infinispan" src="/images/infinispan_nav_brand.png"> </a> </div> <div class="navbar-collapse collapse" id="thenavbar"> <ul class="nav navbar-nav"> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/about">About <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/about">Introduction</a></li> <li><a href="/features">Features</a></li> <li><a href="/release-notes">Release notes</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/references">References</a></li> <li><a href="/experiments/">Experiments</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/documentation">Learn <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/documentation">Documentation</a></li> <li><a href="/tutorials">Tutorials</a></li> <li><a href="/videos">Videos</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/download">Download <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/download">Infinispan Releases</a></li> <li><a href="/cache-store-implementations">Cache Store Implementations</a></li> <li><a href="/hotrod-clients">Hot Rod Clients</a></li> <li><a href="/integrations">Integrations</a></li> <li><a href="/download-archive">Archive</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/community">Community <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/community">Ask for Help</a></li> <li><a href="/getinvolved">Get Involved</a></li> </ul> </li> <li class=""><a href="/roadmap">Road Map</a></li> <li class="divider"></li> </ul> </div> </div> </nav> <div class="post"></div> <h3> Tuesday, 15 January 2019 </h3> <h1> <a href="/blog/2019/01/15/infinispan-spring-boot-starter-212final/">Infinispan Spring Boot Starter 2.1.2.Final is out!</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Dear Infinispan and Spring Boot users,</p> </div> <div class="paragraph"> <p>We have just released <a href="https://github.com/infinispan/infinispan-spring-boot">Infinispan Spring Boot</a> <strong>2.1.2.Final</strong>.</p> </div> <div class="paragraph"> <p><strong>2.1.2.Final</strong> is using <strong>Spring Boot 2.1.2.RELEASE</strong> and contains some bug fixes related to JCache and Actuator integration.</p> </div> <div class="paragraph"> <p>The starter is now using Infinispan&#8217;s last stable release: <strong>9.4.5.Final</strong>.</p> </div> <div class="paragraph"> <p>You can find this release in the maven central repository.</p> </div> <div class="paragraph"> <p>Please report any issues in our <a href="https://issues.jboss.org/projects/ISPN">issue tracker</a> and join the conversation in our <a href="https://infinispan.zulipchat.com/">Zulip Chat</a> to shape up our next release.</p> </div> <div class="paragraph"> <p>Enjoy,</p> </div> <div class="paragraph"> <p>The Infinispan Team</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Friday, 09 November 2018 </h3> <h1> <a href="/blog/2018/11/09/infinispan-941final-and-infinispan/">Infinispan 9.4.1.Final and Infinispan Spring Boot Starter 2.1.0.Final are out!</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Dear Infinispan and Spring Boot users,</p> </div> <div class="paragraph"> <p>We have just released <a href="https://github.com/infinispan/infinispan">Infinispan</a> <strong>9.4.1.Final</strong> and <a href="https://github.com/infinispan/infinispan-spring-boot">Infinispan Spring Boot</a> <strong>2.1.0.Final</strong>.</p> </div> <div class="paragraph"> <p>Highlights of the <strong>Infinispan</strong> release include:</p> </div> <div class="ulist"> <ul> <li> <p>Export Data Grid stats to <a href="https://prometheus.io/">Prometheus</a> (<a href="https://issues.jboss.org/browse/ISPN-9558">ISPN-9558</a>)</p> </li> <li> <p>Upgrade <a href="https://rocksdb.org/">RocksDB</a> version (<a href="https://issues.jboss.org/browse/ISPN-9603">ISPN-9603</a>)</p> </li> <li> <p>Upgrade <a href="http://narayana.io/">Narayana</a> to version 5.9.0.Final (<a href="https://issues.jboss.org/browse/ISPN-9639">ISPN-9639</a>)</p> </li> <li> <p>Upgrade to <a href="https://github.com/infinispan/protostream">protostream-4.2.2.Final</a> (<a href="https://issues.jboss.org/browse/ISPN-9654">ISPN-9654</a>)</p> </li> <li> <p>Update Cassandra Store to Infinispan 9.4(<a href="https://issues.jboss.org/browse/ISPN-9595">ISPN-9595</a>)</p> </li> <li> <p>Handle ClientCacheEntryExpired into InvalidatedNearCacheListener (<a href="https://issues.jboss.org/browse/ISPN-7087">ISPN-7087</a>)</p> </li> <li> <p>Bug fixes</p> </li> <li> <p>Additional <a href="https://github.com/infinispan/infinispan-simple-tutorials">code simple examples</a> such as remote multimap or near caching </p> </li> </ul> </div> <div class="paragraph"> <p>Complete release notes can be read <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12339377">here</a>.</p> </div> <div class="paragraph"> <p>Highlights of the <strong>Infinispan-Spring-Boot</strong> release include:</p> </div> <div class="ulist"> <ul> <li> <p>Upgrade <strong>Spring-Boot</strong> version to <a href="https://spring.io/blog/2018/10/30/spring-boot-2-1-0">2.1.0</a></p> </li> <li> <p>Upgrade <strong>Infinispan</strong> version to 9.4.1</p> </li> <li> <p>Integration with Spring Actuator, to expose production ready metrics (<a href="https://issues.jboss.org/browse/ISPN-9668">ISPN-9668</a>)</p> </li> <li> <p>Bug fixes</p> </li> <li> <p>Additional <a href="https://github.com/infinispan/infinispan-spring-boot/tree/master/infinispan-spring-boot-samples">code examples</a></p> </li> </ul> </div> <div class="paragraph"> <p>You can find these releases in the maven central repository.</p> </div> <div class="paragraph"> <p>Please report any issues in our <a href="https://issues.jboss.org/projects/ISPN">issue tracker</a> and join the conversation in our <a href="https://infinispan.zulipchat.com/">Zulip Chat</a> to shape up our next release.</p> </div> <div class="paragraph"> <p>Enjoy,</p> </div> <div class="paragraph"> <p>The Infinispan Team</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Friday, 02 November 2018 </h3> <h1> <a href="/blog/2018/11/02/near-caching-with-spring-boot-and/">Near caching with Spring-Boot and Infinispan</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>We have recently released <a href="https://github.com/infinispan/infinispan-spring-boot">infinispan-spring-boot-starter</a> <strong>2.0.0.Final</strong>. This version supports <a href="https://spring.io/projects/spring-boot">Spring Boot 2.1</a> and <a href="http://infinispan.org/">Infinispan 9.4.0.Final</a>.</p> </div> <div class="paragraph"> <p>Before this release, some important features - such as near caching - were only configurable by code. From now on, we can set all of the Hot Rod client configuration using the <strong>hotrod.properties</strong> file or the <a href="https://issues.jboss.org/browse/ISPN-9437">Spring application YAML</a>. The latter is an important community requirement we had.</p> </div> <div class="paragraph"> <p>Let&#8217;s see how to speed up our applications performance with <a href="http://infinispan.org/docs/stable/user_guide/user_guide.html#near_caching">near caching</a>!</p> </div> <div class="paragraph"> <p>==</p> </div> <div class="paragraph"> <p>==</p> </div> </div> </div> <div class="sect1"> <h2 id="_hot_rod"><a class="anchor" href="#_hot_rod"></a>Hot Rod</h2> <div class="sectionbody"> <div class="sect2"> <h3 id=""><a class="anchor" href="#"></a> </h3> <div class="paragraph"> <p>Just as a quick reminder, Infinispan can be used embedded in your application or in <strong>client/server</strong> mode. To connect you application to a server you can use an <a href="http://infinispan.org/hotrod-clients/">Infinispan Client</a> and the Infinispan <a href="http://infinispan.org/docs/stable/user_guide/user_guide.html#hot_rod_server_usage">“Hot Rod Protocol”</a>. Other protocols are available, such as REST, but Hot Rod is the most recommended way since it is the one that supports most of the Infinispan functionalities.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_near_cache"><a class="anchor" href="#_near_cache"></a>Near cache</h2> <div class="sectionbody"> <div class="paragraph"> <p>From the Infinispan <a href="http://infinispan.org/docs/stable/user_guide/user_guide.html#near_caching">documentation</a>: Hot Rod client can keep a local cache that stores recently used data. Enabling near caching can significantly improve the performance of read operations <strong>get</strong> and <strong>getVersioned</strong> since data can potentially be located locally within the Hot Rod client instead of having to go remote.</p> </div> </div> </div> <div class="sect1"> <h2 id="_when_should_i_use_it"><a class="anchor" href="#_when_should_i_use_it"></a>When should I use it? </h2> <div class="sectionbody"> <div class="paragraph"> <p>Near caching can improve the performance of an application when most of the accesses to a given cache are read-only and the accessed dataset is relatively small. When an application is doing lots of writes to a cache, invalidations, evictions and updates to the near cache need to happen. In this scenario we won&#8217;t probably get much benefit.</p> </div> <div class="paragraph"> <p>As I said in the introduction, the good news is that <strong>this feature can be activated just by configuration</strong>. Code doesn&#8217;t change, so we can measure the benefits, if such exist, in a very straightforward way.</p> </div> </div> </div> <div class="sect1"> <h2 id="_spring_boot"><a class="anchor" href="#_spring_boot"></a>Spring-Boot</h2> <div class="sectionbody"> <div class="paragraph"> <p>I have created a very simple application, available <a href="https://github.com/infinispan-demos/infinispan-near-cache">here</a>. Maven, Java 8 and an Infinispan server are required to run it. You can <a href="http://downloads.jboss.org/infinispan/9.4.0.Final/infinispan-server-9.4.0.Final.zip">download the server</a> or use <a href="https://hub.docker.com/r/jboss/infinispan-server/">docker</a>.</p> </div> <div class="paragraph"> <p>Docker: docker run -it -p 11222:11222 jboss/infinispan-server:9.4.0.Final</p> </div> <div class="paragraph"> <p>Standalone: PATH/infinispan-server-9.4.0.Final/bin/standalone.sh</p> </div> <div class="paragraph"> <p>Once the server is up and running, build the application using maven </p> </div> <div class="paragraph"> <p>&gt;&gt; infinispan-near-cache: mvn clean install</p> </div> <div class="sect2"> <h3 id="_writer"><a class="anchor" href="#_writer"></a>Writer </h3> <div class="paragraph"> <p>This application loads the required data to a remote cache: a list of some of the Infinispan contributors over the last decade.</p> </div> <div class="paragraph"> <p>&gt;&gt; writer: mvn spring-boot:run</p> </div> </div> <div class="sect2"> <h3 id="_reader"><a class="anchor" href="#_reader"></a>Reader </h3> <div class="paragraph"> <p>The reader application does 10.000 accesses to the contributors cache. Using a random id, I call 10.000 times the get method. The job gets done in my laptop in ~4000 milliseconds.</p> </div> <div class="paragraph"> <p>&gt;&gt; reader-no-near-cache: mvn spring-boot:run</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_activating_the_near_cache"><a class="anchor" href="#_activating_the_near_cache"></a>Activating the near cache</h2> <div class="sectionbody"> <div class="paragraph"> <p>I need to configure two properties:</p> </div> <div class="ulist"> <ul> <li> <p><strong>Near Cache Mode:</strong> DISABLED or INVALIDATED. Default value is DISABLED, so I turn it on with <strong>INVALIDATED</strong>.</p> </li> <li> <p><strong>Max Entries:</strong> Integer value that sets the max size of the near caches. There is no default value, so I set up one.</p> </li> </ul> </div> <div class="paragraph"> <p>The hotrod client configuration is <span class="underline">for each client</span>, <span class="underline">not for each cache</span> (this might change in the future). With that in mind, note that configuring the previous properties will activate near caching <strong>for all the caches</strong>. If you need to activate it just for <strong>some of them</strong>, add the following property:</p> </div> <div class="ulist"> <ul> <li> <p><strong>Cache Name Pattern:</strong>  String pattern. For example "i8n-.*" will activate the near caching for all the caches whose name starts by "i8n-".</p> </li> </ul> </div> <div class="paragraph"> <p>Configuration can be placed in the <strong>hotrod-client.properties</strong>, <strong>Spring-boot configuration</strong> or <strong>code</strong>.</p> </div> <div class="sect2"> <h3 id="_hotrod_client_properties"><a class="anchor" href="#_hotrod_client_properties"></a>hotrod-client.properties</h3> <div class="paragraph"> <p><strong>infinispan.client.hotrod.near_cache.mode=</strong>INVALIDATED</p> </div> <div class="paragraph"> <p><strong>infinispan.client.hotrod.near_cache.max_entries=</strong>40</p> </div> <div class="paragraph"> <p><strong>infinispan.client.hotrod.near_cache.cache_name_pattern=*i8n-.</strong></p> </div> </div> <div class="sect2"> <h3 id="_application_yaml_or_properties"><a class="anchor" href="#_application_yaml_or_properties"></a>application.yaml (or properties)</h3> <div class="paragraph"> <p><strong>infinispan:</strong>    <strong>remote:</strong>      <strong>near-cache-mode:</strong> INVALIDATED      <strong>near-cache-max-entries:</strong> 10      <strong>near-cache-cache-name-pattern:</strong> i8n-.*</p> </div> <div class="sect4"> <h5 id="_code"><a class="anchor" href="#_code"></a>code </h5> <div class="paragraph"> <p>With the Infinispan Spring-Boot Starter, I can add custom configuration using the <strong>InfinispanRemoteCacheCustomizer</strong>.</p> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_results"><a class="anchor" href="#_results"></a>Results</h2> <div class="sectionbody"> <div class="paragraph"> <p>My dataset contains 25 contributors. If I activate the near cache with max 12 entries and I run my reader again, I get the job done in ~1900 milliseconds, which is already an improvement. If I configure it to hold the complete dataset, I get it done in ~220 milliseconds, which is a big one!</p> </div> <div class="sect2"> <h3 id="_conclusions"><a class="anchor" href="#_conclusions"></a>Conclusions</h3> <div class="paragraph"> <p>Near caching can help us speed up our client applications if configured properly. We can test our tuning easily because we only need to add some configuration to the client. Finally, the <a href="https://github.com/infinispan/infinispan-spring-boot">Spring-Boot Infinispan Starter</a> helps us build services with Spring-Boot and Infinispan. </p> </div> <div class="paragraph"> <p>Further work will be done to help Spring-Boot users work with Infinispan, so stay tuned! Any feedback on the starter or any requirement from the community is more that welcome. Find us in <a href="https://infinispan.zulipchat.com/">Zulip Chat</a> for direct contact or post your questions in <a href="https://stackoverflow.com/questions/tagged/?tagnames=infinispan&amp;sort=newest">StackOverflow</a>!</p> </div> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Wednesday, 21 March 2018 </h3> <h1> <a href="/blog/2018/03/21/clustering-vertx-with-infinispan/">Clustering Vert.x with Infinispan</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Welcome to the third in a multi-part series of blog posts about creating Eclipse Vert.x applications with Infinispan. In the previous blog posts we have seen how to create <a href="http://blog.infinispan.org/2017/12/first-steps-with-vertx-and-infinispan-rest-api.html">REST</a> and <a href="http://blog.infinispan.org/2017/12/first-steps-with-vertx-and-infinispan-push-api.html">PUSH</a> APIs using the <a href="http://infinispan.org/docs/stable/server_guide/server_guide.html">Infinispan Server</a>. The purpose of this tutorial is to showcase how to create clustered <a href="http://vertx.io/">Vert.x</a> applications using Infinispan in embedded mode.</p> </div> </div> </div> <div class="sect1"> <h2 id="_why_infinispan"><a class="anchor" href="#_why_infinispan"></a>Why Infinispan ?</h2> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan can be used for <a href="http://infinispan.org/about/">several use cases</a>. Among them we find that it can be used as the underlying framework to cluster your applications. Infinispan uses peer-to-peer communication between nodes, so the architecture is not based on master/slave mode and there is no single point of failure. Infinispan supports replication and resilience across data centers, is fast and reliable. All the <a href="http://infinispan.org/features/">features</a> that make this datagrid a great product, make it a great cluster manager. If you need to create clustered applications or microservices, this can be achieved with <a href="http://vertx.io/docs/#clustering">Vert.x</a> using the <a href="http://vertx.io/docs/vertx-infinispan/java/">Vert.x-Infinispan cluster manager</a>.</p> </div> </div> </div> <div class="sect1"> <h2 id="_creating_a_clustered_application"><a class="anchor" href="#_creating_a_clustered_application"></a>Creating a clustered application</h2> <div class="sectionbody"> <div class="paragraph"> <p>The code of this tutorial is available <a href="https://github.com/infinispan-demos/vertx-api/tree/master/clustered">here</a>.</p> </div> <div class="sect2"> <h3 id="_dummy_application"><a class="anchor" href="#_dummy_application"></a>Dummy Application</h3> <div class="paragraph"> <p>Let’s start with a dummy clustered system with 3 verticles.</p> </div> <div class="paragraph"> <p><a href="https://4.bp.blogspot.com/-wNPoumRNOZU/WqqNdMdm6mI/AAAAAAAACNM/Nvrirnuw-ok_BfS8Gh7DaomoTGhdEwk-ACLcBGAs/s1600/dummyApp.png"><span class="image"><img src="https://4.bp.blogspot.com/-wNPoumRNOZU/WqqNdMdm6mI/AAAAAAAACNM/Nvrirnuw-ok_BfS8Gh7DaomoTGhdEwk-ACLcBGAs/s640/dummyApp.png" alt="image" width="640" height="275"></span></a></p> </div> <div class="sect3"> <h4 id="_webservice_status_producer"><a class="anchor" href="#_webservice_status_producer"></a>WebService Status Producer</h4> <div class="paragraph"> <p>Produces randomly [0,1,2] values every 1000 milliseconds and sends them to the event bus <strong>"ids"</strong> address.</p> </div> </div> <div class="sect3"> <h4 id="_reboot_consumer"><a class="anchor" href="#_reboot_consumer"></a>Reboot Consumer</h4> <div class="paragraph"> <p>Consumes messages from the event bus <strong>"ids"</strong> address, and launches a <strong>"reboot"</strong> that lasts for 3000 milliseconds whenever the value is 0. If a reboot is already happening, we don’t need to relaunch any new reboot. When a reboot starts or ends, a message is sent to the event bus to the <strong>"reboot"</strong> address.</p> </div> <div class="paragraph"> <p>Notice that:</p> </div> <div class="ulist"> <ul> <li> <p>We use a simple boolean to check if there is a reboot going on. This is safe because every verticle is executed from a single event loop thread, so there won’t be multiple threads executing the code at the same time.</p> </li> <li> <p>An ID is generated to identify the Verticle. The message sent to the event bus is a JsonObject</p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="_monitoring"><a class="anchor" href="#_monitoring"></a>Monitoring</h4> <div class="paragraph"> <p>Consumes monitoring messages from the event bus <strong>"reboot"</strong> address and logs them.</p> </div> </div> </div> <div class="sect2"> <h3 id="_clustering_the_dummy_application"><a class="anchor" href="#_clustering_the_dummy_application"></a>Clustering the dummy Application</h3> <div class="paragraph"> <p>To create a cluster of these applications, we just need to do 2 things:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Add the cluster manager maven dependency.  </p> </li> <li> <p>Run and deploy each verticle in cluster mode. Each Verticle class has a main method that deploys each verticle separetly. Example for the Monitoring verticle.</p> </li> </ol> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 100%;"> </colgroup> <thead> <tr> <th class="tableblock halign-center valign-top"><a href="https://2.bp.blogspot.com/-GjOWQzixVq8/Wpgynw-A8OI/AAAAAAAACLQ/EUz57xgYcjcve1jXrARPEufaOLfLErUDwCEwYBhgL/s1600/Monitoring.png"><span class="image"><img src="https://2.bp.blogspot.com/-GjOWQzixVq8/Wpgynw-A8OI/AAAAAAAACLQ/EUz57xgYcjcve1jXrARPEufaOLfLErUDwCEwYBhgL/s320/Monitoring.png" alt="image" width="320" height="296"></span></a></th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-center valign-top"><p class="tableblock">Running the application, we can monitor the logs</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Each clustered application contains - or embeds - an Infinispan instance. Under the hood, the 3 Infinispan instances will form a cluster.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_what_if_i_need_to_scale"><a class="anchor" href="#_what_if_i_need_to_scale"></a>What if I need to scale</h2> <div class="sectionbody"> <div class="paragraph"> <p>Imagine you need to scale the Reboot Consumer application. We can run it multiple times, let’s say 2 more times. The two new instances will join the cluster. In this case, we have “ID-93EB” ”ID-45B8” and “ID-247A”, so now we have a cluster of 5. It&#8217;s very simple but if we have a look to the monitoring console, we will notice reboots are now happening in parallel.</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 100%;"> </colgroup> <thead> <tr> <th class="tableblock halign-center valign-top"><a href="https://3.bp.blogspot.com/-YTja7FV8S4k/Wpg6YuIstTI/AAAAAAAACL4/xH2N4erfgfk_ZUcICwmyp_2WQQNKlPpqQCLcBGAs/s1600/MultipleReboots.png"><span class="image"><img src="https://3.bp.blogspot.com/-YTja7FV8S4k/Wpg6YuIstTI/AAAAAAAACL4/xH2N4erfgfk_ZUcICwmyp_2WQQNKlPpqQCLcBGAs/s400/MultipleReboots.png" alt="image" width="400" height="245"></span></a></th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-center valign-top"><p class="tableblock">3 Reboot Consumers</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>As I mentioned before, this example is a dummy application. But in real life you could need to trigger a process from a verticle that runs multiple times and need to be sure this process is happening just once at a time. How can we fix this ? We can use Vert.x Shared Data structures API.</p> </div> <div class="sect2"> <h3 id="_shared_data_api_to_rescue"><a class="anchor" href="#_shared_data_api_to_rescue"></a>Shared data API to rescue</h3> <div class="paragraph"> <p>In this particular case, we are going to use a clustered lock. Using the lock, we can now synchronise the reboots among the 3 nodes.</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 100%;"> </colgroup> <thead> <tr> <th class="tableblock halign-center valign-top"><a href="https://2.bp.blogspot.com/--calcYXn5l4/WplAZEu4f8I/AAAAAAAACMU/eFrivRZMsHE8XUZr-BAvAuUikZ9-_k3DACLcBGAs/s1600/MonitoringUsingLock.png"><span class="image"><img src="https://2.bp.blogspot.com/--calcYXn5l4/WplAZEu4f8I/AAAAAAAACMU/eFrivRZMsHE8XUZr-BAvAuUikZ9-_k3DACLcBGAs/s400/MonitoringUsingLock.png" alt="image" width="400" height="256"></span></a></th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-center valign-top"><p class="tableblock">Using Shared Data API, one reboot at a time</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Vert.x clustered lock in this example is using an emulated version of the new Clustered Lock API of Infinispan introduced in 9.2 which has been freshly released. I will come back to share about this API in particular in further blog posts. You can read about it on the <a href="http://infinispan.org/docs/stable/user_guide/user_guide.html#clustered_lock">documentation</a> or run the <a href="https://github.com/infinispan/infinispan-simple-tutorials/tree/master/lock">infinispan-simple-tutorial</a>.</p> </div> </div> <div class="sect2"> <h3 id="_one_node_at_a_time"><a class="anchor" href="#_one_node_at_a_time"></a>One node at a time</h3> <div class="paragraph"> <p>When clustering applications with Vert.x, there is something you need to take care of. It is important to understand that each node contains an instance of the datagrid. This means that scaling up and down needs to be done one at a time. Infinispan, as other datagrids, reshuffles the data when a new node joins or leaves a cluster. This process is done following a distributed hashing algorithm, so not every data is moved around, just the data that is supposed to live in the new node, or the data owned by a leaving node. If we just kill a bunch of nodes without taking care of the cluster, consequences can be harming! This is something quite obvious when dealing with databases : we just don’t kill a bunch of database instances without taking care of every instance at a time. Even when Infinispan data is only in memory we need to take care about it in the same way. <a href="http://vertx.io/docs/vertx-infinispan/java/#_configuring_for_kubernetes_or_openshift_3">Openshift, which is built on top of Kubernetes</a>, helps dealing properly and safely with these scale up and down operations.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_conclusions"><a class="anchor" href="#_conclusions"></a>Conclusions</h2> <div class="sectionbody"> <div class="paragraph"> <p>As you have seen, creating clustered applications with Vert.x and Infinispan is very straightforward. The clustered event bus is very powerful. In this example we have seen how to use a clustered lock, but other <a href="http://vertx.io/docs/apidocs/io/vertx/core/shareddata/SharedData.html">shared data structures</a> built on top of <a href="http://infinispan.org/docs/stable/user_guide/user_guide.html#the_code_strongcounter_code_interface_when_the_consistency_or_bounds_matters">Counters</a> are available.</p> </div> </div> </div> <div class="sect1"> <h2 id="_about_the_vert_x_infinispan_cluster_manager_status"><a class="anchor" href="#_about_the_vert_x_infinispan_cluster_manager_status"></a>About the Vert.x Infinispan Cluster Manager status</h2> <div class="sectionbody"> <div class="paragraph"> <p>At the time of this writing, <a href="http://blog.infinispan.org/2018/02/infinispan-920final.html">Infinspan 9.2.0.Final</a> has been released. From vert.x-infinispan cluster manager point of view, before Vert.x 3.6 (which is not out yet) the cluster manager is using Infinispan 9.1.6.final and it’s using an emulation layer for locks and counters. In this tutorial we are using Vert.x 3.5.1 version.</p> </div> <div class="paragraph"> <p>This tutorial will be updated with the version using Infinispan 9.2 as soon as the next <a href="https://github.com/vert-x3/vertx-infinispan/">vert.x-infinispan</a> will be released, which will happen in a few months. Meanwhile, stay tuned!</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Monday, 22 January 2018 </h3> <h1> <a href="/blog/2018/01/22/infinispan-coming-to-snowcamp-2018/">Infinispan coming to Snowcamp 2018</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p><a href="http://www.alpesjug.fr/wp-content/uploads/2016/01/alpes-snow-full-illustration.png"><span class="image"><img src="http://www.alpesjug.fr/wp-content/uploads/2016/01/alpes-snow-full-illustration.png" alt="image" width="200" height="200"></span></a></p> </div> <div class="paragraph"> <p>This week, the 25th of January, I will be presenting a talk about <a href="http://infinispan.org/docs/dev/user_guide/user_guide.html#clustered_lock">Clustered Locks</a> at the <a href="http://snowcamp.io/en/">Snowcamp 2018 conference</a> in Grenoble (France). During the live-coding talk, I will share the design and code I&#8217;ve been working on to create this first version of the clustered locks. These locks will be used by the <a href="http://vertx.io/docs/vertx-infinispan/java/">Vert.x Cluster Manager</a>, but they can be useful to any Infinispan user since version 9.2 (final release coming very soon!!). If you are planning to use this API, we would love to hear from you to give us some feedback and keep us posted on your use case!</p> </div> <div class="paragraph"> <p>If you are attending the conference, fell free to reach me to discuss about Infinispan+Vert.x, locks, <a href="http://infinispan.org/docs/dev/user_guide/user_guide.html#multimap_cache">Multimap</a>, <a href="http://blog.infinispan.org/2017/12/first-steps-with-vertx-and-infinispan-rest-api.html">cute names</a> or any other topic that you care about!</p> </div> <div class="paragraph"> <p>See you!</p> </div> <div class="paragraph"> <p>Katia</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Thursday, 14 December 2017 </h3> <h1> <a href="/blog/2017/12/14/first-steps-with-vertx-and-infinispan-push-api/">First steps with Vert.x and Infinispan - PUSH API (Part 2)</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Welcome to the second in a multi-part series of blog posts about creating <a href="http://vertx.io/">Eclipse Vert.x</a> applications with <a href="http://infinispan.org/">Infinispan</a>. In the <a href="http://blog.infinispan.org/2017/12/first-steps-with-vertx-and-infinispan-rest-api.html">previous blog post</a> we have seen how to create a REST API. The purpose of this tutorial is to showcase how to create a PUSH API implemented with Vert.x and using Infinispan as a server.</p> </div> <div class="quoteblock"> <blockquote> <div class="paragraph"> <p><em>All the code of this tutorial is available in this <a href="https://github.com/karesti/cute-names">GitHub repository</a>. The backend is a Java project using Maven, so all the needed dependencies can be found in the pom.xml. The front is a super simple react application.</em></p> </div> </blockquote> </div> <div class="paragraph"> <p>* *</p> </div> </div> </div> <div class="sect1"> <h2 id="_push_api"><a class="anchor" href="#_push_api"></a>PUSH API</h2> <div class="sectionbody"> <div class="paragraph"> <p>Creating a REST API is very straightforward. But today, even if we are heavily using REST, we don&#8217;t always want to use request/response or polling, but instead we want to push directly from the server to the client. In this example, we are going to create an API that pushes every new value inserted in the default cache of Infinispan. These values are cute names, as we did in the REST API example.</p> </div> <div class="paragraph"> <p>We are using two features here :</p> </div> <div class="ulist"> <ul> <li> <p>Infinispan client listeners</p> </li> <li> <p>Vert.x bridge between the <a href="http://vertx.io/docs/vertx-core/java/#event_bus">Event Bus</a> and the browser</p> </li> </ul> </div> <div class="paragraph"> <p><a href="http://infinispan.org/docs/stable/user_guide/user_guide.html#_Listeners_and_notifications_section">Infinispan Listeners</a> provide a way to the client get notified when something happens in a cache.</p> </div> <div class="paragraph"> <p>The <a href="http://vertx.io/docs/vertx-web/java/#_sockjs_event_bus_bridge">Event Bus Bridge</a> that connects to the browser, uses <a href="http://sockjs.org/">SockJS</a>. SockJS is a JavaScript library that provides a WebSocket API, but it can be used with browsers that don&#8217;t support web-sockets (see the website of the project for more detailed information). Vert.x supports this library and creates a bridge between your browser and your back-end easily through the Event Bus.</p> </div> <div class="sect2"> <h3 id="_creating_an_event_bus_bridge"><a class="anchor" href="#_creating_an_event_bus_bridge"></a>Creating an Event Bus bridge</h3> <div class="paragraph"> <p>Vert.x is a reactive framework, which means that uses <a href="https://github.com/ReactiveX/RxJava">RxJava</a> too, and provides a fancy API on top of it.</p> </div> <div class="paragraph"> <p>First, we are going to create a new verticle called SendCuteNamesAPI. This verticle extends the CacheAccessVerticle we created in the <a href="http://blog.infinispan.org/2017/12/first-steps-with-vertx-and-infinispan-rest-api.html">previous blog post</a>. CacheAccessVerticle initialises the connection with Infinispan using the <a href="http://infinispan.org/docs/dev/user_guide/user_guide.html#using_hot_rod_server">Hot Rod protocol.</a></p> </div> <div class="paragraph"> <p>Now we need to create a SocketJSHandler. This handler has a method called bridge, where we configure some BridgeOptions. Obviously <strong>we don&#8217;t want the client to be able to read everything</strong> traveling on the event bus, and this won&#8217;t happen. We <strong>configure an address</strong>, <strong>'cute-names'</strong>, and we add the permission to read and write to this address.</p> </div> <div class="paragraph"> <p>This handler is passed to the event bus route, where the path is /eventbus/*.</p> </div> <div class="paragraph"> <p>Finally, we create a http server as we did in the REST API example. The difference is that instead of calling listen method, we call <strong>rxListen</strong> and <strong>subscribe</strong>.</p> </div> </div> <div class="sect2"> <h3 id="_getting_notified_and_publishing"><a class="anchor" href="#_getting_notified_and_publishing"></a>Getting notified and publishing</h3> <div class="paragraph"> <p>Using <a href="http://infinispan.org/docs/stable/user_guide/user_guide.html#_Listeners_and_notifications_section">Infinispan listeners</a> is very easy.</p> </div> <div class="paragraph"> <p>First, we are going to create a class that has the @ClientListener annotation. The client listener has to be added to the cache client configuration. We add a protected method called addConfigToCache that will be called just after the initialisation of the defaultCache in the abstract CacheAccessVerticle. Verticles extending the abstract class can now add custom configuration to the client.</p> </div> <div class="paragraph"> <p>We want to be notified when a new entry is created. In this case, our listener has to contain a method with the @ClientCacheEntryCreated annotation on it. The signature of the method has to include a ClientCacheEntryCreatedEvent&lt;String&gt; parameter. This parameter will hold the 'key' of the entry that has been created.</p> </div> <div class="paragraph"> <p>Finally, we use the key to retrieve the name using the getAsync method and then <strong>publish</strong> the value in the<strong> Vert.x event bus</strong> to the <strong>address </strong>where the <strong>socket listener</strong> is permitted to read <strong>: cute-names</strong>.</p> </div> <div class="paragraph"> <p>Now we can run the main method and whenever we post a new name, we will see in the logs that the client listener is notified!</p> </div> </div> <div class="sect2"> <h3 id="_client_code"><a class="anchor" href="#_client_code"></a>Client code</h3> <div class="paragraph"> <p>We are going to create a super simple react application that will just display hello. React community is <strong>huge</strong>, so there are lot&#8217;s of tutorials out there to create a hello world client application. This application has a single component that displays "Hello".</p> </div> <div class="paragraph"> <p>The react application runs calling npm install and npm start  in <a href="http://localhost:9000/" class="bare">http://localhost:9000/</a>.</p> </div> <div class="paragraph"> <p>Now we need to connect the client to the backend with <strong>SockJS</strong>.<strong> </strong>Vert.x provides a JavaScript library for that: <a href="https://www.npmjs.com/package/vertx3-eventbus-client">vertx3-eventbus-client</a>, built on top of SockJS. We create an EventBus object that will connect to <strong><a href="http://localhost:8082/eventbus" class="bare">http://localhost:8082/eventbus</a></strong> as we configured in the SendCuteNamesAPI. We register a handler on the <strong>'cute-names'</strong> address. The body of the message will contain the new cute name published in the event bus. Every time the handler is called, we update the component&#8217;s state, and it will be rendered.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_wrap_up"><a class="anchor" href="#_wrap_up"></a>Wrap up</h2> <div class="sectionbody"> <div class="paragraph"> <p>We have learned how to create PUSH APIs with Vert.x, powered by Infinispan. The repository has some unit tests. Feedback is more than welcome to improve the code and the provided examples. I hope you enjoyed this tutorial ! On the next tutorials we will talk about <a href="https://github.com/vert-x3/vertx-infinispan">Infinispan as the cluster manager for Vert.x</a>. Stay tuned !</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Tuesday, 12 December 2017 </h3> <h1> <a href="/blog/2017/12/12/first-steps-with-vertx-and-infinispan-rest-api/">First steps with Vert.x and Infinispan - REST API (Part 1)</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Welcome to the first in a multi-part series of blog posts about creating <a href="http://vertx.io/">Eclipse Vert.x</a> applications with <a href="http://infinispan.org/">Infinispan</a>. The purpose of this first tutorial is to showcase how to create a REST API.</p> </div> <div class="quoteblock"> <blockquote> <div class="paragraph"> <p><em>All the code of this tutorial is available in this <a href="https://github.com/infinispan-demos/vertx-api">GitHub repository</a>. The backend is a Java project using <a href="https://maven.apache.org/">Maven</a>, so all the needed dependencies can be found in the pom.xml.</em></p> </div> </blockquote> </div> <div class="paragraph"> <p>==</p> </div> </div> </div> <div class="sect1"> <h2 id="_what_is_vert_x"><a class="anchor" href="#_what_is_vert_x"></a>What is Vert.x ?</h2> <div class="sectionbody"> <div class="paragraph"> <p><a href="http://vertx.io/">Vert.x</a> is a tool-kit for building reactive applications on the JVM. It’s an event driven and non blocking tool-kit. It is based on the <a href="http://vertx.io/docs/vertx-core/java/#_reactor_and_multi_reactor">Reactor Pattern</a>, like Node.js, but unlike Node it can easily use all the cores of your machine so you can create highly concurrent and performant applications. Code examples can be found <a href="https://github.com/vert-x3/vertx-examples">in this repository</a>.</p> </div> <div class="paragraph"> <p>==</p> </div> </div> </div> <div class="sect1"> <h2 id="_rest_api"><a class="anchor" href="#_rest_api"></a>REST API</h2> <div class="sectionbody"> <div class="paragraph"> <p>Let’s start creating a simple endpoint that will display a welcome message on '/'. In Vert.x this is done by creating a <strong><a href="http://vertx.io/docs/vertx-core/java/#_verticles">Verticle</a></strong>. A verticle is a unit of deployment and processes incoming events over an event-loop. <a href="https://en.wikipedia.org/wiki/Event_loop">Event-loops</a> are used in asynchronous programming models. I won&#8217;t spend more time here explaining these concepts as this is very well done in this <a href="https://www.youtube.com/watch?v=qL5BGHPXrac">Devoxx Vert.x talk</a> or in the documentation available <a href="http://vertx.io/docs/guide-for-java-devs/">here</a>.</p> </div> <div class="paragraph"> <p>We need to override the start method, create a 'router' so '/' requests can be handled, and finally create a http server.</p> </div> <div class="paragraph"> <p>The most important thing to remember about vert.x, is that <strong>we can NEVER EVER call blocking code</strong> (we will see how to deal with blocking API&#8217;s just after). If we do so, we will <a href="http://vertx.io/docs/vertx-core/java/#golden_rule">block the event loop</a> and we won&#8217;t be able to serve incoming requests properly.</p> </div> <div class="paragraph"> <p>Run the main method, go to your browser to <a href="http://localhost:8081/ and" class="bare">http://localhost:8081/ and</a> we see the welcome message !</p> </div> <div class="sect2"> <h3 id="_connecting_with_infinispan"><a class="anchor" href="#_connecting_with_infinispan"></a>Connecting with Infinispan</h3> <div class="paragraph"> <p>Now we are going to create a <strong>REST API</strong> that uses Infinispan. The purpose here is to post and get names by id. We are going to use the default cache in Infinispan for this example, and we will connect to it remotely. To do that, we are going to use the <a href="http://infinispan.org/hotrod-clients/">Infinispan hotrod protocol</a>, which is the recommended way to do it (but we could use <a href="http://infinispan.org/docs/9.0.x/infinispan_server_guide/infinispan_server_guide.html#_rest">REST</a> or <a href="http://infinispan.org/docs/9.0.x/infinispan_server_guide/infinispan_server_guide.html#_memcached">Memcached</a> protocol too)</p> </div> <div class="sect3"> <h4 id="_start_infinispan_locally"><a class="anchor" href="#_start_infinispan_locally"></a>Start Infinispan locally</h4> <div class="paragraph"> <p>The first thing we are going to do is to run an Infinispan Server locally. We download the Infinispan Server from <a href="http://downloads.jboss.org/infinispan/9.1.3.Final/infinispan-server-9.1.3.Final-bin.zip">here</a>, unzip the downloaded file and run ./bin/standalone.sh. </p> </div> <div class="quoteblock"> <blockquote> <div class="paragraph"> <p><em>If you are using Docker on Linux, you can use the Ihttps://hub.docker.com/r/jboss/infinispan-server/[nfinispan Docker Image Available] easily. If you are using Docker for Mac, at the time of this writing there is an issue with internal IP addresses and they can&#8217;t be called externally. Different workarounds exist to solve the problem, but the easiest thing for this example is simply downloading and running the standalone server locally. We will see how to use the docker image in Openshift just after.</em></p> </div> </blockquote> </div> <div class="paragraph"> <p>The hotrod server is listening in localhost:11222.</p> </div> </div> <div class="sect3"> <h4 id="_connect_the_client_to_the_server"><a class="anchor" href="#_connect_the_client_to_the_server"></a>Connect the client to the server</h4> <div class="paragraph"> <p>The code we need to connect with Infinispan from our java application is the following :</p> </div> <div class="paragraph"> <p>This code <strong>is blocking</strong>. As I said before, <strong>we can&#8217;t block the event loop</strong> and this will happen if we directly call these API&#8217;s from a verticle. The code must be called using <a href="http://vertx.io/docs/vertx-core/java/#blocking_code">vertx.executeBlocking</a> method, and passing a Handler. The code in the handler will be executed from a worker thread pool and will pass the result back asynchronously. Instead of overriding the start method, we are going to override start(Future&lt;Void&gt; startFuture). This way, we are going to be able to handle errors.</p> </div> <div class="paragraph"> <p>To stop the client, the API supplies a non blocking method that can be called when the verticle is stopped, so we are safe on that.</p> </div> <div class="paragraph"> <p>We are going to create an abstract CacheAccessVerticle where we will initialise the manager and get default cache. When everything is correct and the defautCache variable is initialised, we will log a message and execute the initSuccess abstract method.</p> </div> </div> </div> <div class="sect2"> <h3 id="_rest_api_to_create_names"><a class="anchor" href="#_rest_api_to_create_names"></a>REST API to create names</h3> <div class="paragraph"> <p>We are going to add 3 new endpoints.</p> </div> <div class="ulist"> <ul> <li> <p>GET /api displays the API name</p> </li> <li> <p>POST /api/cutenames creates a new name</p> </li> <li> <p>GET /api/cutenames/id displays a name by id</p> </li> </ul> </div> <div class="paragraph"> <p>CuteNamesRestAPI verticle can now extend this class and override the initSuccess method instead of the start method.</p> </div> <div class="sect3"> <h4 id="_post"><a class="anchor" href="#_post"></a>POST</h4> <div class="paragraph"> <p>Our goal is to use a curl to create a name like this :</p> </div> <div class="paragraph"> <p>curl -X POST \  -H "Content-Type: application/json" \ -d '\{"name":"Oihana"}' "http://localhost:8081/api/cutenames"</p> </div> <div class="literalblock"> <div class="content"> </div> </div> <div class="quoteblock"> <blockquote> <div class="paragraph"> <p><em>For those that are not familiar with basques names, Oihana means 'rainforest' and is a super cute name. Those who know me will confirm that I&#8217;m absolutely not biased making this statement.</em></p> </div> </blockquote> </div> <div class="paragraph"> <p>To read the body content, we need to <strong>add a body handler</strong> to the route, otherwise the body won&#8217;t be parsed. This is done by calling router.route().handler(BodyHandler.create()).</p> </div> <div class="paragraph"> <p>The handler that will handle the post method in '/api/cutenames' is a RoutingContext handler. We want to create a new name in the default cache. For that, we will call putAsync method from the <strong>defaultCache</strong>.</p> </div> <div class="paragraph"> <p>The server responds 201 when the name is correctly created, and 400 when the request is not correct.</p> </div> </div> <div class="sect3"> <h4 id="_get_by_id"><a class="anchor" href="#_get_by_id"></a>GET by id</h4> <div class="paragraph"> <p>To create a get endpoint by id, we need to declare a route that will take a parameter :id. In the route handler, we are going to call getAsync method.</p> </div> <div class="paragraph"> <p>If we run the main, we can POST and GET names using curl !</p> </div> <div class="paragraph"> <p> curl -X POST -H "Content-Type: application/json" \  -d '\{"id":"42", "name":"Oihana"}' \  "http://localhost:8081/api/cutenames" </p> </div> <div class="paragraph"> <p><strong>Cute name added </strong></p> </div> <div class="paragraph"> <p> curl -X GET -H "Content-Type: application/json" \  "http://localhost:8081/api/cutenames/42" * \{"name":"Oihana"}*</p> </div> <div class="paragraph"> <p>==</p> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_wrap_up"><a class="anchor" href="#_wrap_up"></a>Wrap up</h2> <div class="sectionbody"> <div class="paragraph"> <p>We have learned how to create a REST API with Vert.x, powered by Infinispan. The repository has some unit tests using the <a href="http://vertx.io/docs/vertx-web-client/java/">web client</a>. Feedback is more than welcome to improve the code and the provided examples. I hope you enjoyed this tutorial ! On the next tutorial you will learn how to create a <a href="http://blog.infinispan.org/2017/12/first-steps-with-vertx-and-infinispan-push-api.html">PUSH API</a>.</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Wednesday, 22 November 2017 </h3> <h1> <a href="/blog/2017/11/22/infinispan-and-vertx-coming-to/">Infinispan and Vert.x coming to Codemotion Spain and Madrid JUG</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>I&#8217;m happy to announce that <a href="http://infinispan.org/">Infinispan</a> and <a href="http://vertx.io/">Eclipse Vert.x</a> team members are in Madrid (Spain) this week!</p> </div> <div class="paragraph"> <p>The 23th of November, <a href="https://twitter.com/galderz">Galder</a> (Infinispan) and <a href="https://twitter.com/tsegismont">Thomas</a> (Vert.x) will be presenting at <a href="https://www.meetup.com/fr-FR/MadridJUG/">Madrid Java User Group</a> two talks about Infinispan and Ver.x. From <a href="https://twitter.com/karesti">my side</a>, I&#8217;ve been invited to give a talk about programming career path to Computer Science and Engineering students in the Universidad San Pablo CEU. </p> </div> <div class="paragraph"> <p><a href="https://2.bp.blogspot.com/-VgmjO-qz3XM/WhW-bIxFNnI/AAAAAAAACEc/ezt2bWCNGEYAsTYDHOB9VoonSjSav-RTQCLcBGAs/s1600/MadridJUG.png"><span class="image"><img src="https://2.bp.blogspot.com/-VgmjO-qz3XM/WhW-bIxFNnI/AAAAAAAACEc/ezt2bWCNGEYAsTYDHOB9VoonSjSav-RTQCLcBGAs/s200/MadridJUG.png" alt="image" width="200" height="189"></span></a></p> </div> <div class="paragraph"> <p>The following days, 24th and 25th of November, <a href="https://2017.codemotion.e/">Codemotion</a> Spain will take place in Madrid. Codemotion is the biggest developer centric conference in Spain. More than 1.500 people will be attending this year. The conference does not focus on any particular technical stack. You can learn about mobile, web, front-end, back-end, devops and there are some inspirational tracks too during the two days of the conference.</p> </div> <div class="paragraph"> <p><span class="image"><img src="https://4.bp.blogspot.com/-NnkUIMBPvPA/WhW9eU7xAAI/AAAAAAAACEI/m_caRrwXOkQBIbFq7LRdLoNECFGKcAbEQCLcBGAs/s400/codemotion.png" alt="image" width="400" height="70"></span><span id="goog_607202256"><a href="https://www.blogger.com/" class="bare">https://www.blogger.com/</a>[#goog_607202257]</span></p> </div> <div class="paragraph"> <p>On Friday, Galder will be presenting a talk about <a href="https://2017.codemotion.es/agenda.html#5649626120060928/5146610086445056">Streaming and BigData architecture</a>. Thomas will be presenting <a href="https://2017.codemotion.es/agenda.html#5649626120060928/5166851730440192">"Better performance on server side with HTTP/2"</a> and I will join a debate around <a href="https://2017.codemotion.es/agenda.html#5649626120060928/5769677032652800">Enterprise Culture</a>, where I will give my insights about <a href="http://brand.redhat.com/foundations/culture/">RedHat&#8217;s Culture</a>. On Saturday we will run our <a href="https://2017.codemotion.es/agenda.html#5693168230072320/5176901953912832">Streaming Data Workshop</a>: a hands on lab that showcases a simplified streaming architecture built on top of <a href="http://infinispan.org/">Infinispan</a> and <a href="http://vertx.io/">Vert.x</a> and running on <a href="https://www.openshift.com/">OpenShift</a>. If you cannot attend any of these events, you can always do the <a href="https://github.com/infinispan-demos/streaming-data-workshop">workshop</a> at your self peace.</p> </div> <div class="paragraph"> <p>We hope to see you in Madrid, or anywhere else in 2018!!</p> </div> <div class="paragraph"> <p>Cheers, Katia </p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Tuesday, 06 December 2016 </h3> <h1> <a href="/blog/2016/12/06/distributed-stream-quality-of-life/">Distributed Stream Quality of Life Improvements</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>As I hope most people reading this already know, since Infinispan 8 you can utilize the entire Java 8 Stream API and have it be distributed across your cluster.  This performs the various intermediate and terminal operations on the data local to the node it lives on, providing for extreme performance.  There are some limitations and things to know as was explained at <a href="http://blog.infinispan.org/2015/09/distributed-streams.html">distributed-streams</a>.</p> </div> <div class="paragraph"> <p>The problem with the API up to now was that, if you wanted to use lambdas, it was quite an ugly scene.  Take for example the following code snippet:</p> </div> </div> </div> <div class="sect1"> <h2 id="_8_0_distributed_streams_example"><a class="anchor" href="#_8_0_distributed_streams_example"></a>8.0 Distributed Streams Example</h2> <div class="sectionbody"> <div class="paragraph"> <p>However, for Infinispan 9 we utilize a little syntax feature added with Java 8</p> </div> <div id="jls-15" class="paragraph oracle com/javase/specs/jls/se8/html/jls-15 html 12 2 5[1]"> <p>to add some much needed quality of life improvements.  This allows the most specific interface to be chosen when a method is overloaded.  This allows for a neat interaction when we add some new interfaces that implement Serializable and the various function interfaces (SerializableFunction, SerializablePredicate, SerializableSupplier, etc).  All of the Stream methods have been overridden on the <a href="https://docs.jboss.org/infinispan/9.0/apidocs/org/infinispan/CacheStream.html">CacheStream</a> interface to take these arguments.</p> </div> <div class="paragraph"> <p>This allows for the code to be much cleaner as we can see here:</p> </div> </div> </div> <div class="sect1"> <h2 id="_9_0_distributed_streams_example"><a class="anchor" href="#_9_0_distributed_streams_example"></a>9.0 Distributed Streams Example</h2> <div class="sectionbody"> <div class="paragraph"> <p>Extra Methods</p> </div> <div class="paragraph"> <p>This is not the only benefit of providing the <strong>CacheStream</strong> interface: we can also provide new methods that aren&#8217;t available on the standard <a href="https://docs.oracle.com/javase/8/docs/api/?java/util/stream/Stream.html">Stream</a> interface.  One example is the <a href="https://docs.jboss.org/infinispan/9.0/apidocs/org/infinispan/CacheStream.html#forEach-org.infinispan.util.function.SerializableBiConsumer-">forEach</a> method which allows the user to more easily provide a Cache that is injected on each node as required.  This way you don&#8217;t have to use the clumsy <a href="https://docs.jboss.org/infinispan/9.0/apidocs/org/infinispan/stream/CacheAware.html">CacheAware</a> interface and can directly use lambdas as desired.</p> </div> <div class="paragraph"> <p>Here is an example of the new <strong>forEach</strong> method in action:</p> </div> <div class="paragraph"> <p>In this example we take a cache and, based on the keys in it, write those values into another cache. Since <strong>forEach</strong> doesn&#8217;t have to be side effect free, you can do whatever you want inside here.</p> </div> <div class="paragraph"> <p>All in all these improvements should make using Distributed Streams with Infinispan much easier.  The extra methods could be extended further if users have use cases they would love to suggest.  Just let us know, and I hope you enjoy using Infinispan!</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Monday, 02 November 2015 </h3> <h1> <a href="/blog/2015/11/02/jboss-clustering-team-jug-berlin/">JBoss Clustering Team @ JUG Berlin Brandenburg</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>The entire JBoss Clustering Team will be at the Berlin-Brandenburg JUG on Thursday, 19th November <a href="http://www.jug-berlin-brandenburg.de/blog/2015/jgroups.html">talking about JGroups, Infinispan and WildFly clustering</a>. If you are around, please come over to meet the team and share your thoughts and ideas.</p> </div> <div class="paragraph"> <p>The meetup is advertised <a href="http://www.meetup.com/de/eposttechtalk/events/226439709/">here</a></p> </div> </div> </div> </div> <hr> <div class="pagination-links"><span class="current-page">1</span> <a href="/blog/tags/infinispan/page/2/" class="page-link">2</a> <a href="/blog/tags/infinispan/page/3/" class="page-link">3</a> <a href="/blog/tags/infinispan/page/4/" class="page-link">4</a> <a href="/blog/tags/infinispan/page/2/" class="next-link">Next</a> </div> </div> <footer class="container"> <hr> <div class="row"> <div class="col-md-2 col-md-offset-1"> <h4>Navigate</h4> <ul> <li> <a href="/about" title="About">About</a> </li> <li> <a href="/documentation" title="Learn">Learn</a> </li> <li> <a href="/community" title="Community">Community</a> </li> <li> <a href="/getinvolved" title="Get Involved">Get Involved</a> </li> <li> <a href="/download" title="Download">Download</a> </li> </ul> </div> <div class="col-md-2"> <h4>Contribute</h4> <ul> <li> <a href="https://issues.jboss.org/browse/ISPN" title="Submit a bug">Submit a bug</a> </li> <li> <a href="https://github.com/infinispan" title="Write code">Write Code</a> </li> </ul> <h4>Follow Us</h4> <ul> <li> <a href="https://blog.infinispan.org" title="Blog">Blog</a> </li> <li> <a href="https://twitter.com/infinispan" title="Twitter">Twitter</a> </li> </ul> </div> <div class="col-md-2"> <h4>Open Source</h4> <p> Infinispan is released under the <b>Apache 2.0 open source license.</b> Learn more about the Apache 2.0 license <a href="https://www.apache.org/licenses/LICENSE-2.0">here.</a> </p> </div> <div class="col-md-2"> <h4>A member of</h4> <a alt="CloudTM" href="http://www.cloudtm.eu/" target="_NEW"> <img src="/images/cloudtm.png"> </a> <a alt="LEADS" href="http://leads-project.eu/" target="_NEW"> <img src="/images/leads.png"> </a> <a alt="CloudButton" href="http://cloudbutton.eu/" target="_NEW"> <img src="/images/cloudbutton.png"> </a> </div> <div class="col-md-2"> <h4>Thanks to</h4> <p>JetBrains Intellij IDEA</p> <a alt="JetBrains Intellij IDEA" href="https://www.jetbrains.com/idea/" target="_NEW"> <img src="/images/icon_IntelliJIDEA.png"> </a> </div> </div> <div class="col-md-10"> <p style="margin-top: 5px; font-size: 80%;"> © Copyright 2009-2019 Red Hat, Inc. <br> <i class="icon-fire"></i> Made with <a href="https://github.com/jbossorg/bootstrap-community" style="text-decoration: underline;" target="_NEW">JBoss Community Bootstrap</a> and <a href="http://awestruct.org/" style="text-decoration: underline;" target="_NEW">Awestruct</a> <br> <i class="icon-globe"></i> This website is open source! If you want to improve it, <a href="https://github.com/infinispan/infinispan.github.io" style="text-decoration: underline;" target="_NEW">fork the project,</a> and hack on it, then send a pull request. You can also view the <a href="https://www.seethestats.com/site/infinispan.org" style="text-decoration: underline;" target="_NEW">visitor stats.</a> <br> <i class="icon-share"></i> Website and documentation released under <a href="https://creativecommons.org/licenses/by/3.0/" style="text-decoration: underline;" target="_NEW">CC BY 3.0.</a> </p> </div> </footer> <div class="container" id="companyfooter"> <div class="redhatlogo"> <div id="logospacer"></div> <a href="http://www.redhat.com/"><img src="//static.jboss.org/theme/images/common/redhat_logo.png"></a> </div> </div> <span class="backToTop"> <a href="#top">back to top</a> </span> <script src="//static.jboss.org/theme/js/libs/bootstrap-community/3.2.0.2/bootstrap-community.min.js"></script> <script>
        if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
          _satellite.pageBottom();
        }
      </script> </div> </body> </html>