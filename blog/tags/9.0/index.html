<!DOCTYPE html> <html lang="en"> <head> <title>Blog - Infinispan</title> <meta charset="utf-8"> <meta content="width=device-width, initial-scale=1.0" name="viewport"> <meta content="DENY" http-equiv="X-Frame-Options"> <meta content="1; mode=block" http-equiv="X-XSS-Protection"> <meta content="nosniff" http-equiv="X-Content-Type-Options"> <link href="https://static.jboss.org/theme/css/bootstrap-community/3.2.0.2/bootstrap-community.min.css" media="screen" rel="stylesheet"> <link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" rel="stylesheet"> <script id="dpal" src="https://www.redhat.com/dtm.js" type="text/javascript"></script> <link href="/images/favicon.png" rel="shortcut icon" type="image/png"> <link href="//static.jboss.org/images/example/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144"> <link href="//static.jboss.org/images/example/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114"> <link href="//static.jboss.org/images/example/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72"> <link href="//static.jboss.org/images/example/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed"> <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" rel="stylesheet"> <link href="https://static.jboss.org/css/rhbar.css" media="screen" rel="stylesheet"> <style>
      .jumbotron {
        padding: 0.5em 0.1em 0.5em 0.1em;
        background-image: none;
        background-color: #ffec9f;
      }
      .jumbotron p, 
      .jumbotron h1 {
        color: #656565;
      }
      .dropup {
        z-index: 1032;
      }
      .navbar {
        font-size: x-large;
      }
      .navbar ul {
        padding-top: 0.7em;
      }
      .navbar-brand {
        height: 80px;
      }
      .navbar-default {
        background-color: white;
      }
      .navbar-default .navbar-nav > li > a {
        color: #336699;
      }
      .navbar-default .navbar-nav > li > a:hover {
        color: #204060;
      }
      .navbar-default .navbar-nav > .open > a,
      .navbar-default .navbar-nav > .open > a:hover,
      .navbar-default .navbar-nav > .open > a:focus {
        background-color: #4a5d75;
      }
      h3.well {
        border-color: #ffd630;
        background-color: #ffec9f;
      }
      .panel-sidebar {
        border-color: #f5f5f5;
      }
      .panel-sidebar > .panel-heading {
        border-color: #e3e3e3;
        background-color: #f5f5f5;
        color: #656565;
      }
      .btn-primary {
        border-color: #ffd630;
        background-color: #ffec9f;
        color: #656565;
      }
      footer.container {
        background-color: white;
      }
      footer.container h1, footer.container h2, footer.container h3, footer.container h4, footer.container h5, footer.container h6, footer.container p, footer.container a {
        color: #656565;
      }
      footer.container ul {
        padding: 0;
      }
      i.enormous-icon {
        margin-top: 0.3em;
      }
      .home-examples {
        font-size: 16px;
      }
    </style> <script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.min.js"></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script> <script>
      hljs.initHighlightingOnLoad();
    </script> <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
     
    ga('create', 'UA-8601422-1', 'auto');
    ga('send', 'pageview');
    
    </script> </head> <body> <div id=""> <ul class="visuallyhidden" id="top"> <li> <a accesskey="n" href="#nav" title="Skip to navigation">Skip to navigation</a> </li> <li> <a accesskey="c" href="#page" title="Skip to content">Skip to content</a> </li> </ul> <div id="rhbar"> <a class="jbdevlogo" href="http://www.jboss.org/projects/about"></a> <a class="rhlogo" href="http://www.redhat.com/"></a> </div> <div class="container" id="content"> <nav class="navbar navbar-default navbar-fixed-top"> <div class="container"> <div class="navbar-header"> <button aria-expanded="false" class="navbar-toggle collapsed" data-target="#thenavbar" data-toggle="collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/"> <img alt="Infinispan" src="/images/infinispan_nav_brand.png"> </a> </div> <div class="navbar-collapse collapse" id="thenavbar"> <ul class="nav navbar-nav"> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/about">About <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/about">Introduction</a></li> <li><a href="/features">Features</a></li> <li><a href="/release-notes">Release notes</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/references">References</a></li> <li><a href="/experiments/">Experiments</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/documentation">Learn <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/documentation">Documentation</a></li> <li><a href="/tutorials">Tutorials</a></li> <li><a href="/videos">Videos</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/download">Download <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/download">Infinispan Releases</a></li> <li><a href="/cache-store-implementations">Cache Store Implementations</a></li> <li><a href="/hotrod-clients">Hot Rod Clients</a></li> <li><a href="/integrations">Integrations</a></li> <li><a href="/download-archive">Archive</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/community">Community <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/community">Ask for Help</a></li> <li><a href="/getinvolved">Get Involved</a></li> </ul> </li> <li class=""><a href="/roadmap">Road Map</a></li> <li class="divider"></li> </ul> </div> </div> </nav> <div class="post"></div> <h3> Wednesday, 24 January 2018 </h3> <h1> <a href="/blog/2018/01/24/what-happened-to-replication-queue/">What happened to the replication queue?</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Recently I saw an Infinispan user that was having issues using the replication queue, a clustering functionality that had been part of Infinispan since it&#8217;s first release. Looking at the latest Infinispan codebase I realised it wasn&#8217;t there any more, what happened to it?</p> </div> <div class="paragraph"> <p>The aim of the replication queue was to batch individual cache operations and send them as one to other nodes, rather than sending them each operation individually.</p> </div> <div class="paragraph"> <p>Over time we started considering whether the replication queue could be removed:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>The replication queue was duplicating functionality: JGroups, which manages the group communication layer, already bundles messages and the network stack can do it too.</p> </li> <li> <p>Using the replication queue was not more efficient because when the message is delivered in the remote node, the messages are processed sequentially. If processing first message blocks, the other commands are not processed until it finishes.</p> </li> <li> <p>It can add complexity if messages with different order requirements come in same batch, e.g. no order, FIFO or total.</p> </li> </ol> </div> <div class="paragraph"> <p>In essence, Infinispan&#8217;s replication queue was doing the same as JGroups' message bundler. Whereas JGroups' message bundler had been evolving and different options had been developed, Infinispan&#8217;s replication queue was still using same algorithm as in its first release.</p> </div> <div class="paragraph"> <p>So in Infinispan 8.2 the replication queue was deprecated and in 9.0 it was finally removed. If you ever find the need to batch your changes, configure <a href="http://www.jgroups.org/manual/html/user-advanced.html#MessageBundling">JGroups' message bundler</a>.</p> </div> <div class="paragraph"> <p>Cheers, Galder</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Friday, 31 March 2017 </h3> <h1> <a href="/blog/2017/03/31/infinispan-9/">Infinispan 9</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan 9 is the culmination of nearly a year of work. It is codenamed "Ruppaner" in honor of the city of Konstanz, where we designed many of the improvements we&#8217;ve made. Prost!</p> </div> </div> </div> <div class="sect1"> <h2 id="_performance"><a class="anchor" href="#_performance"></a>Performance</h2> <div class="sectionbody"> <div class="paragraph"> <p>We decided it was time to revisit Infinispan&#8217;s performance and scalability. So we went back to our internals design and we made a number of improvements. Infinispan 9.0 is faster than any previous release by quite a sizeable margin in a number of key aspects:</p> </div> <div class="ulist"> <ul> <li> <p>distributed writes, thanks to a new algorithm which reduces the number of RPCs required to write to the owners</p> </li> <li> <p>distributed reads, which scale much better under load</p> </li> <li> <p>replicated writes, also with better scalability under load</p> </li> <li> <p>eviction, thanks to a new in-memory container</p> </li> <li> <p>internal marshalling, which was completely rewritten</p> </li> </ul> </div> <div class="paragraph"> <p>We will have a post dedicated to benchmarks detailing the difference against previous versions and in various scenarios.</p> </div> </div> </div> <div class="sect1"> <h2 id="_marshalling"><a class="anchor" href="#_marshalling"></a>Marshalling</h2> <div class="sectionbody"> <div class="paragraph"> <p>We&#8217;ve made several improvements in the cluster and persistent storage marshalling layer which has resulted in increased performance and smaller payloads. Also, the new marshaller layer makes JBoss Marshalling an optional component, which is only used when no Infinispan Externalizers (or AdvancedExternalizers) are available for a given type, hence relying on standard JDK Serializable/Externalizable capabilities to be marshalled.</p> </div> </div> </div> <div class="sect1"> <h2 id="_remote_hot_rod_clients"><a class="anchor" href="#_remote_hot_rod_clients"></a>Remote Hot Rod Clients</h2> <div class="sectionbody"> <div class="paragraph"> <p>We now ship alternate marshallers for remote clients based on Kryo and ProtoStuff.</p> </div> <div class="paragraph"> <p>Additionally, the Hot Rod protocol now supports streaming operations for dealing with large objects.</p> </div> </div> </div> <div class="sect1"> <h2 id="_off_heap_and_data_container_changes"><a class="anchor" href="#_off_heap_and_data_container_changes"></a>Off-Heap and data-container changes</h2> <div class="sectionbody"> <div class="paragraph"> <p>An In-Memory Data Grid likes to eat through your memory (because you want it to be fast!), but in the world of the JVM that is not ideal: that huge chunk of data gives Garbage Collectors a hard time when the heap goes into double-digit gigabyte territory. Long GC pauses can make individual nodes unresponsive, compromising the stability of your cluster.</p> </div> <div class="paragraph"> <p>Infinispan 9 introduces an improved data container which can optionally store entries off-heap.</p> </div> <div class="paragraph"> <p>Additionally, our bounded container has been replaced with Ben Manes' excellent Caffeine which provides much better performance. Check out Ben&#8217;s benchmarks where he compares, among other things, against Infinispan&#8217;s old bounded container.</p> </div> <div class="paragraph"> <p>Configuration-wise, the previously separate concepts of eviction, store-as-binary and data-container have been merged into a single 'memory' configuration element.</p> </div> </div> </div> <div class="sect1"> <h2 id="_persistence"><a class="anchor" href="#_persistence"></a>Persistence</h2> <div class="sectionbody"> <div class="paragraph"> <p>The JDBC cache store received quite an overhaul:</p> </div> <div class="ulist"> <ul> <li> <p>The internal connection pool is now based on HikariCP, for improved performance</p> </li> <li> <p>Writes will now use database-specific upsert functionality when available</p> </li> <li> <p>Transactional writes to the cache translate to transactional writes to the database</p> </li> <li> <p>The JdbcBinaryStore and JdbcMixedStore have been removed as detailed here</p> </li> </ul> </div> <div class="paragraph"> <p>We have also replaced the LevelDB cache store with the better-maintained and faster RocksDB cache store.</p> </div> </div> </div> <div class="sect1"> <h2 id="_ickle_our_new_query_language"><a class="anchor" href="#_ickle_our_new_query_language"></a>Ickle, our new query language</h2> <div class="sectionbody"> <div class="paragraph"> <p>We decided it was time for Infinispan to have a proper query language, which would take full advantage of our query capabilities. We have therefore grafted Lucene&#8217;s full-text operators on top of a subset of JP-QL to obtain Ickle. We have already started describing Ickle in a recent blog post. For a taste of Ickle, the following query shows how to combine a traditional boolean clause with a full-text term query:</p> </div> <div class="paragraph"> <p>select transactionId, amount, description from com.acme.Transaction where amount &gt; 10 and description : "coffee"</p> </div> </div> </div> <div class="sect1"> <h2 id="_cloud_integrations"><a class="anchor" href="#_cloud_integrations"></a>Cloud integrations</h2> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan continues to play nicely in cloud environments thanks to a number of improvements that have been made to discovery (such as KUBE_PING for Kubernetes/OpenShift), health probes and our pre-built Docker images.</p> </div> </div> </div> <div class="sect1"> <h2 id="_multi_tenant_server_and_sni_support"><a class="anchor" href="#_multi_tenant_server_and_sni_support"></a>Multi-tenant server and SNI support</h2> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan Server is now capable of exposing multiple cache containers through a single Hot Rod or REST endpoint. The selection of the container is performed via SNI. This allows you to have a single cluster serve all your applications while maintaining each one&#8217;s data isolated.</p> </div> </div> </div> <div class="sect1"> <h2 id="_administration_console"><a class="anchor" href="#_administration_console"></a>Administration Console</h2> <div class="sectionbody"> <div class="paragraph"> <p>The adminstration console has been completely rewritten in a more modular fashion using TypeScript to allow for greater extensibility and ease of maintanence. In addition to this refactor, the console now supports the following:</p> </div> <div class="ulist"> <ul> <li> <p>Stateless views</p> </li> <li> <p>HTTP Digest Authentication</p> </li> <li> <p>Management of individual and clustered Standalone server instances</p> </li> <li> <p>Internet Explorer</p> </li> </ul> </div> </div> </div> <div class="sect1"> <h2 id="_documentation_overhaul"><a class="anchor" href="#_documentation_overhaul"></a>Documentation overhaul</h2> <div class="sectionbody"> <div class="paragraph"> <p>Our <a href="http://infinispan.org/docs/stable/index.html">documentation</a> has been completely overhauled with entire chapters being added or rewritten for readability and consistency.</p> </div> </div> </div> <div class="sect1"> <h2 id="_whats_coming"><a class="anchor" href="#_whats_coming"></a>What&#8217;s coming</h2> <div class="sectionbody"> <div class="paragraph"> <p>We will be blogging in more detail about some of the things above, so watch out for more content coming soon !</p> </div> <div class="paragraph"> <p>We&#8217;ve already started working on Infinispan 9.1 which will bring a number of new features and improvements, such as clustered counters, consistency checker with merge policies, a new distributed cache for even better write performance, and more.</p> </div> </div> </div> <div class="sect1"> <h2 id="_get_it_now"><a class="anchor" href="#_get_it_now"></a>Get it now !</h2> <div class="sectionbody"> <div class="paragraph"> <p>Head over to our <a href="http://infinispan.org/download/">download</a> page to get binaries, sources, clients, etc.</p> </div> <div class="paragraph"> <p>Please <a href="http://infinispan.org/community/">join us</a> to let us know what you think about this release.</p> </div> <div class="paragraph"> <p>The Infinispan team</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Wednesday, 22 March 2017 </h3> <h1> <a href="/blog/2017/03/22/infinispan-900cr4/">Infinispan 9.0.0.CR4</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>==</p> </div> <div class="paragraph"> <p>Dear Infinispan users, we thought CR3 was going to be the last candidate release before Final&#8230;&#8203; but we were mistaken!</p> </div> <div class="paragraph"> <p>The reason for yet another CR is that we decided to make some changes which affect some default behaviours:</p> </div> <div class="ulist"> <ul> <li> <p>enabling optimistic transactions with repeatable read now turns on write-skew by default</p> </li> <li> <p>retrieving an already configured cache by passing in a template doesn&#8217;t redefine that cache&#8217;s configuration</p> </li> </ul> </div> <div class="paragraph"> <p>Other important changes:</p> </div> <div class="ulist"> <ul> <li> <p>big improvements to the client/server rolling upgrade process</p> </li> <li> <p>allow indexes to be stored in off-heap caches</p> </li> <li> <p>lots of bug fixes</p> </li> </ul> </div> <div class="paragraph"> <p>For the full list of changes check the <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12334143">release notes</a>, <a href="http://infinispan.org/download/">download</a> the 9.0.0.CR4 release and <a href="http://infinispan.org/community/">let us know</a> if you have any questions or suggestions.</p> </div> <div class="paragraph"> <p>Cheers, The Infinispan team</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Wednesday, 08 March 2017 </h3> <h1> <a href="/blog/2017/03/08/infinispan-900cr3-is-out/">Infinispan 9.0.0.CR3 is out!</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Dear users, the last release candidate for Infinispan 9 is out!</p> </div> <div class="paragraph"> <p>This milestone contains mostly bug fixes and documentation improvements ahead of 9.0.0.Final. Noteworthy changes:</p> </div> <div class="ulist"> <ul> <li> <p>Kubernetes Rolling Updates are fully supported</p> </li> <li> <p>Infinispan Rolling Upgrades on Kubernetes is fully supported</p> </li> <li> <p>Library updates: JGroups 4.0.1, Protostream 4.0.0.Alpha9, Log4j2 2.8.1</p> </li> <li> <p>The deadlock detection hasn&#8217;t keep up with the improvements of our locking algorithm and has been removed.</p> </li> <li> <p>Support for authentication in the Rest endpoint</p> </li> </ul> </div> <div class="paragraph"> <p>For the full list of changes check the <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12334065">release notes</a>, <a href="http://infinispan.org/download/">download</a> the 9.0.0.CR3 release and <a href="http://stg-ispn.rhcloud.com/community/">let us know</a> if you have any questions or suggestions.</p> </div> <div class="paragraph"> <p>Cheers, The Infinispan team</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Thursday, 23 February 2017 </h3> <h1> <a href="/blog/2017/02/23/infinispan-90-cr2-is-out/">Infinispan 9.0 CR2 is out!</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Dear community.</p> </div> <div class="paragraph"> <p>We are one step closer to the final release of Infinispan 9: we gladly announce the release of Infinispan 9.0.0.CR2.</p> </div> </div> </div> <div class="sect1"> <h2 id="_the_highlights_of_this_release_are"><a class="anchor" href="#_the_highlights_of_this_release_are"></a>The highlights of this release are:</h2> <div class="sectionbody"> <div class="paragraph"> <p>Many dependencies have been upgraded to the latest and greatest:</p> </div> <div class="ulist"> <ul> <li> <p>JGroups 4.0.0.Final</p> </li> <li> <p>Apache Lucene 5.5.4</p> </li> <li> <p>Hibernate Search 5.7.0.Final</p> </li> <li> <p>Protostream 4.0.0.Alpha7 </p> </li> </ul> </div> <div class="paragraph"> <p>Transactional caches changes:</p> </div> <div class="ulist"> <ul> <li> <p>Removed asynchronous configuration since it won&#8217;t be supported anymore.</p> </li> <li> <p>Introduced EmbeddedTransactionManager: a basic transaction manager implementation.</p> </li> </ul> </div> <div class="paragraph"> <p>Query now supports java.time.Instant natively</p> </div> <div class="paragraph"> <p>Changes in the configuration;</p> </div> <div class="paragraph"> <p>Significant performance improvements for embedded and client/server mode;</p> </div> <div class="paragraph"> <p>And finally, quite a few bug fixes preparing us for the final release !</p> </div> <div class="paragraph"> <p>You can read all about these in the <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12330030">release notes.</a></p> </div> <div class="paragraph"> <p>Keep an eye on the <a href="http://infinispan.org/docs/dev/upgrading/upgrading.html">upgrade guide</a> and start prepare your project for the final Infinispan 9 release.</p> </div> <div class="paragraph"> <p>So, please head over to the <a href="http://infinispan.org/download/">download page</a> and try it out. If you have an issue, please report it in our <a href="https://issues.jboss.org/projects/ISPN/summary">bug tracker</a>, ask us on the <a href="https://developer.jboss.org/en/infinispan/content">forum</a>, or join us for a friendly chat on the #infinispan IRC channel on <a href="http://webchat.freenode.net/">Freenode.</a></p> </div> <div class="paragraph"> <p>Regards, Infinispan Team.</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Friday, 10 February 2017 </h3> <h1> <a href="/blog/2017/02/10/infinispan-900cr1/">Infinispan 9.0.0.CR1</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Those busy hackers over in the Infinispan dungeon have brewed up a new release, and it is the first candidate on the road to the final 9. Infinispan 9.0.0.CR1 (codenamed "https://www.ruppaner-bodensee.de/die-brauerei/[Ruppaner]") includes a number of fixes and component upgrades over the last Beta release. You can read all about these in the <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12330027">fixed issues</a></p> </div> <div class="paragraph"> <p> </p> </div> <div class="paragraph"> <p>We have also done a lot of work to restructure the <a href="http://infinispan.org/docs/dev/user_guide/user_guide.html">user guide</a>, <a href="http://infinispan.org/docs/dev/upgrading/upgrading.html">upgrade guide</a> and <a href="http://infinispan.org/docs/dev/server_guide/server_guide.html">server admin guide</a> to make it easier to find the answers you need.</p> </div> <div class="paragraph"> <p>So, please head over to the <a href="http://infinispan.org/download/">download page</a> and try it out. If you have an issue, please report it in our <a href="https://issues.jboss.org/projects/ISPN/summary">bug tracker</a>, ask us on the <a href="https://developer.jboss.org/en/infinispan/content">forum</a>, or join us for a friendly chat on the #infinispan IRC channel on <a href="http://webchat.freenode.net/">Freenode.</a></p> </div> <div class="paragraph"> <p>Prost,</p> </div> <div class="paragraph"> <p>Your friendly Infinispan team</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Thursday, 08 December 2016 </h3> <h1> <a href="/blog/2016/12/08/meet-ickle/">Meet Ickle!</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div id="docs-internal-guid-04619441-de6b-024f-1a8e-a4977a23b5c6" class="paragraph"> <p>As you’ve already learned from an earlier post this week, Infinispan 9 is on its final approach to landing and is bringing a new query language. Hurray! But wait, was there something wrong with the old one(s)? Not wrong really &#8230;&#8203;  I’ll explain.</p> </div> <div class="paragraph"> <p>Infinispan is a data grid of several query languages. Historically, it has offered search support early in its existence by integrating with Hibernate Search which provides a powerful Java-based DSL enabling you to build Lucene queries and run them on top of your Java domain model living in the data grid. Usage of this integration is confined to embedded mode, but that still succeeds in making Java users happy.</p> </div> <div class="paragraph"> <p>While the Hibernate Search combination is neat and very appealing to Java users it completely leaves non-JVM languages accessing Infinispan via remote protocols out in the cold.</p> </div> <div class="paragraph"> <p>Enter Remote Query. Infinispan 6.0 starts to address the need of searching the grid remotely via Hot Rod. The internals are still built on top of Lucene and Hibernate Search bedrock but these technologies are now hidden behind a new query API, the <a href="https://docs.jboss.org/infinispan/9.0/apidocs/org/infinispan/query/dsl/QueryBuilder.html">QueryBuilder</a>, an internal DSL resembling JPA criteria query. The QueryBuilder has implementations for both embedded mode and Hot Rod. This new API provides all relational operators you can think of, but no full-text search initially, we planned to add that later.</p> </div> <div class="paragraph"> <p>Creating a new internal DSL was fun. However, having a long term strategy for evolving it while keeping complete backward compatibility and also doing so uniformly across implementations in multiple languages proved to be a difficult challenge. So while we were contemplating adding new full-text operators to this DSL we decided on making a long leap forward and adopt a more flexible alternative by having our own string based query language instead, another DSL really, albeit an external one this time.</p> </div> <div class="paragraph"> <p>So after the long ado, let me introduce Ickle, Infinispan’s new query language, conspicuously resembling JP-QL.</p> </div> <div class="paragraph"> <p>Ickle:</p> </div> <div class="paragraph"> <p>is a light and small subset of JP-QL, hence the lovely name</p> </div> <div class="paragraph"> <p>queries Java classes and supports Protocol Buffers too</p> </div> <div class="paragraph"> <p>queries can target a single entity type</p> </div> <div class="paragraph"> <p>queries can filter on properties of embedded objects too, including collections</p> </div> <div class="paragraph"> <p>supports projections, aggregations, sorting, named parameters</p> </div> <div class="paragraph"> <p>supports indexed and non-indexed execution</p> </div> <div class="paragraph"> <p>supports complex boolean expressions</p> </div> <div class="paragraph"> <p>does not support computations in expressions (eg. user.age &gt; sqrt(user.shoeSize + 3) is not allowed but user.age &gt;= 18 is fine)</p> </div> <div class="paragraph"> <p>does not support joins</p> </div> <div class="ulist"> <ul> <li> <p>but, navigations along embedded entities are implicit joins and are allowed</p> </li> <li> <p>joining on embedded collections is allowed</p> </li> <li> <p>other join types not supported</p> </li> </ul> </div> <div class="paragraph"> <p>subqueries are not supported</p> </div> <div class="paragraph"> <p>besides the normal relational operators it offers full-text operators, similar to Lucene’s  query parser</p> </div> <div class="paragraph"> <p>is now supported across various Infinispan APIs, wherever a Query produced by the QueryBuilder is accepted (even for continuous queries or in event filters for listeners!)</p> </div> <div class="paragraph"> <p>That is to say we squeezed JP-QL to the bare minimum and added full-text predicates that closely follow the syntax of <a href="https://lucene.apache.org/core/6_2_1/queryparser/org/apache/lucene/queryparser/classic/package-summary.html#package.description">Lucene’s query parser</a>.</p> </div> <div class="paragraph"> <p>If you are familiar with JPA/JP-QL then the following example will speak for itself:</p> </div> <div class="paragraph"> <p>select accountId, sum(amount) from com.acme.Transaction     where amount &lt; 20.0     group by accountId     having sum(amount) &gt; 1000.0     order by accountId</p> </div> <div class="paragraph"> <p>The same query can be written using the QueryBuilder:</p> </div> <div class="paragraph"> <p>Query query = queryFactory.from(Transaction.class) .select(Expression.property("accountId"), Expression.sum("amount")) .having("amount").lt(20.0) .groupBy("accountId") .having(Expression.sum("amount")).gt(1000.0) .orderBy("accountId").build();</p> </div> <div class="paragraph"> <p>Both examples look nice but I hope you will agree the first one is better.</p> </div> <div class="paragraph"> <p>Ickle supports several new predicates for full-text matching that the QueryBuilder is missing. These predicates use the : operator that you are probably familiar from Lucene’s own query language.  This example demonstrates a simple full-text term query:</p> </div> <div class="paragraph"> <p>select transactionId, amount, description from com.acme.Transaction where amount &gt; 10 and description : "coffee"</p> </div> <div class="paragraph"> <p>As you can see, relational predicates and full-text predicates can be combined with boolean operators at will.</p> </div> <div class="paragraph"> <p>The only important thing to remark here is relational predicates are applicable to non-analyzed fields while full-text predicates can be applied to analyzed field only. How does indexing work, what is analysis and how do I turn it on/off for my fields? That’s the topic of a future post, so please be patient or start readinghttps://docs.jboss.org/hibernate/search/5.6/reference/en-US/html_single/#_analysis[ here].</p> </div> <div class="paragraph"> <p>Besides term queries we support several more:</p> </div> <div class="ulist"> <ul> <li> <p>Term                     description : "coffee"</p> </li> <li> <p>Fuzzy                    description : "cofee"~2</p> </li> <li> <p>Range                   amount : [40 to 90}</p> </li> <li> <p>Phrase                  description : "hello world"</p> </li> <li> <p>Proximity               description : "canceling fee"~3</p> </li> <li> <p>Wildcard                description : "te?t"</p> </li> <li> <p>Regexp                 description : /[mb]oat/</p> </li> <li> <p>Boosting                description : "beer"^3 and description : "books"</p> </li> </ul> </div> <div class="paragraph"> <p>You can read all about them starting from <a href="https://lucene.apache.org/core/6_2_1/queryparser/org/apache/lucene/queryparser/classic/package-summary.html#package.description">here</a>.</p> </div> <div class="paragraph"> <p>But is Ickle really new? Not really. The name is new, the full-text features are new, but a JP-QL-ish query string was always internally present in the Query objects produced by the QueryBuilder since the beginning of Remote Query. That language was never exposed and specified until now. It evolved significantly over time and now it is ready for you to use it. The QueryBuilder / criteria-like API is still there as a convenience but it might go out of favor over time. It will be limited to non-full-text functionality only. As Ickle grows we’ll probably not be able to include some of the additions in the QueryBuilder in a backward compatible manner. If growing will cause too much pain we might consider deprecating it in favor of Ickle or if there is serious demand for it we might continue to evolve the QueryBuilder in a non compatible manner.</p> </div> <div class="paragraph"> <p>Being a string based query language, Ickle is very convenient for our REST endpoint, the CLI, and the administration console allowing you to quickly inspect the contents of the grid. You’ll be able to use it there pretty soon. We’ll also continue to expand Ickle with more advanced full-text features like spatial queries and faceting, but that’s a subject for another major version. Until then, why not grab the current 9.0 Beta1 and test drive the new query language yourself? We’d love to hear your feedback on thehttps://developer.jboss.org/en/infinispan/content[ forum], on ourhttps://issues.jboss.org/projects/ISPN[ issue tracker] or on IRC on the #infinispan channel onhttp://webchat.freenode.net/?channels=%23infinispan[ Freenode].</p> </div> <div class="paragraph"> <p>Happy coding!</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Tuesday, 06 December 2016 </h3> <h1> <a href="/blog/2016/12/06/distributed-stream-quality-of-life/">Distributed Stream Quality of Life Improvements</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>As I hope most people reading this already know, since Infinispan 8 you can utilize the entire Java 8 Stream API and have it be distributed across your cluster.  This performs the various intermediate and terminal operations on the data local to the node it lives on, providing for extreme performance.  There are some limitations and things to know as was explained at <a href="http://blog.infinispan.org/2015/09/distributed-streams.html">distributed-streams</a>.</p> </div> <div class="paragraph"> <p>The problem with the API up to now was that, if you wanted to use lambdas, it was quite an ugly scene.  Take for example the following code snippet:</p> </div> </div> </div> <div class="sect1"> <h2 id="_8_0_distributed_streams_example"><a class="anchor" href="#_8_0_distributed_streams_example"></a>8.0 Distributed Streams Example</h2> <div class="sectionbody"> <div class="paragraph"> <p>However, for Infinispan 9 we utilize a little syntax feature added with Java 8</p> </div> <div id="jls-15" class="paragraph oracle com/javase/specs/jls/se8/html/jls-15 html 12 2 5[1]"> <p>to add some much needed quality of life improvements.  This allows the most specific interface to be chosen when a method is overloaded.  This allows for a neat interaction when we add some new interfaces that implement Serializable and the various function interfaces (SerializableFunction, SerializablePredicate, SerializableSupplier, etc).  All of the Stream methods have been overridden on the <a href="https://docs.jboss.org/infinispan/9.0/apidocs/org/infinispan/CacheStream.html">CacheStream</a> interface to take these arguments.</p> </div> <div class="paragraph"> <p>This allows for the code to be much cleaner as we can see here:</p> </div> </div> </div> <div class="sect1"> <h2 id="_9_0_distributed_streams_example"><a class="anchor" href="#_9_0_distributed_streams_example"></a>9.0 Distributed Streams Example</h2> <div class="sectionbody"> <div class="paragraph"> <p>Extra Methods</p> </div> <div class="paragraph"> <p>This is not the only benefit of providing the <strong>CacheStream</strong> interface: we can also provide new methods that aren&#8217;t available on the standard <a href="https://docs.oracle.com/javase/8/docs/api/?java/util/stream/Stream.html">Stream</a> interface.  One example is the <a href="https://docs.jboss.org/infinispan/9.0/apidocs/org/infinispan/CacheStream.html#forEach-org.infinispan.util.function.SerializableBiConsumer-">forEach</a> method which allows the user to more easily provide a Cache that is injected on each node as required.  This way you don&#8217;t have to use the clumsy <a href="https://docs.jboss.org/infinispan/9.0/apidocs/org/infinispan/stream/CacheAware.html">CacheAware</a> interface and can directly use lambdas as desired.</p> </div> <div class="paragraph"> <p>Here is an example of the new <strong>forEach</strong> method in action:</p> </div> <div class="paragraph"> <p>In this example we take a cache and, based on the keys in it, write those values into another cache. Since <strong>forEach</strong> doesn&#8217;t have to be side effect free, you can do whatever you want inside here.</p> </div> <div class="paragraph"> <p>All in all these improvements should make using Distributed Streams with Infinispan much easier.  The extra methods could be extended further if users have use cases they would love to suggest.  Just let us know, and I hope you enjoy using Infinispan!</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Monday, 05 December 2016 </h3> <h1> <a href="/blog/2016/12/05/infinispan-900beta1-ruppaner/">Infinispan 9.0.0.Beta1 "Ruppaner"</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p><a href="http://design.jboss.org/infinispan/infinispan9/logo/final/infinispan9_pixelsizes_600.gif"><span class="image"><img src="http://design.jboss.org/infinispan/infinispan9/logo/final/infinispan9_pixelsizes_600.gif" alt="image" width="320" height="77"></span></a></p> </div> <div class="paragraph"> <p>It took us quite a bit to get here, but we&#8217;re finally ready to announce Infinispan 9.0.0.Beta1, which comes loaded with a ton of goodies.</p> </div> <div class="paragraph"> <p>Performance improvements</p> </div> <div class="ulist"> <ul> <li> <p>JGroups 4</p> </li> <li> <p>A new algorithm for non-transactional writes (aka the Triangle) which reduces the number of RPCs required when performing writes </p> </li> <li> <p>A new faster internal marshaller which produced smaller payloads. </p> </li> <li> <p>A new asynchronous interceptor core</p> </li> </ul> </div> <div class="paragraph"> <p>Off-Heap support</p> </div> <div class="ulist"> <ul> <li> <p>Avoid the size of the data in the caches affecting your GC times</p> </li> </ul> </div> <div class="paragraph"> <p><a href="https://github.com/ben-manes/caffeine">CaffeineMap</a>-based bounded data container</p> </div> <div class="ulist"> <ul> <li> <p>Superior performance</p> </li> <li> <p>More reliable eviction</p> </li> </ul> </div> <div class="paragraph"> <p>Ickle, Infinispan&#8217;s new query language</p> </div> <div class="ulist"> <ul> <li> <p>A limited yet powerful subset of JPQL</p> </li> <li> <p>Supports full-text predicates</p> </li> </ul> </div> <div class="paragraph"> <p>The Server Admin console now supports both Standalone and Domain modes</p> </div> <div class="paragraph"> <p>Pluggable marshallers for Kryo and ProtoStuff</p> </div> <div class="paragraph"> <p>The LevelDB cache store has been replaced with the better-maintained and faster <a href="http://rocksdb.org/">RocksDB</a> </p> </div> <div class="paragraph"> <p>Spring Session support</p> </div> <div class="paragraph"> <p>Upgraded Spring to 4.3.4.RELEASE</p> </div> <div class="paragraph"> <p>We will be blogging about the above in detail over the coming weeks, including benchmarks and tutorials.</p> </div> <div class="paragraph"> <p>The following improvements were also present in our previous Alpha releases:</p> </div> <div class="paragraph"> <p>Graceful clustered shutdown / restart with persistent state</p> </div> <div class="paragraph"> <p>Support for streaming values over Hot Rod, useful when you are dealing with very large entries</p> </div> <div class="paragraph"> <p>Cloud and Containers</p> </div> <div class="ulist"> <ul> <li> <p>Out-of-the box support for Kubernetes discovery</p> </li> </ul> </div> <div class="paragraph"> <p>Cache store improvements</p> </div> <div class="ulist"> <ul> <li> <p>The JDBC cache store now use transactions and upserts. Also the internal connection pool is now based on <a href="https://brettwooldridge.github.io/HikariCP/">HikariCP</a></p> </li> </ul> </div> <div class="paragraph"> <p>Also, our documentation has received a big overhaul and we believe it is vastly superior than before.</p> </div> <div class="paragraph"> <p>There will be one more Beta including further performance improvements as well as additional features, so stay tuned.</p> </div> <div class="paragraph"> <p>Infinispan 9 is codenamed "Ruppaner" in honor of the <a href="http://www.ruppaner-bodensee.de/die-brauerei/">Konstanz brewery</a>, since many of the improvements of this release have been brewed on the shores of the Bodensee !</p> </div> <div class="paragraph"> <p>Prost!</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Monday, 28 November 2016 </h3> <h1> <a href="/blog/2016/11/28/spring-as-spec/">Spring as a Spec?</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>We&#8217;ve been maintaining Spring integrations bits in Infinispan for quite a while. Our development version, Infinispan 9, contains a set of changes in those modules which deserve some explanation&#8230;&#8203;</p> </div> </div> </div> <div class="sect1"> <h2 id="_versions_versions_everywhere"><a class="anchor" href="#_versions_versions_everywhere"></a>Versions&#8230;&#8203; versions everywhere&#8230;&#8203;</h2> <div class="sectionbody"> <div class="paragraph"> <p><a href="https://1.bp.blogspot.com/-RaDzYHbGJIw/WDggizSIitI/AAAAAAAAHy0/KsU26P5tphgZ87cmUpOMFYML3ERttCaAACLcB/s1600/versions.jpg"><span class="image"><img src="https://1.bp.blogspot.com/-RaDzYHbGJIw/WDggizSIitI/AAAAAAAAHy0/KsU26P5tphgZ87cmUpOMFYML3ERttCaAACLcB/s320/versions.jpg" alt="image" width="320" height="243"></span></a></p> </div> <div class="paragraph"> <p>When you use Infinispan, you rely on some, very specific version. The same applies to Spring. Before Infinispan 9 our integration modules had a compile-time dependency to a very specific version of Spring. In practice, we imposed this specific version to each project which used our integration bits. The question is - what to do to use some other version of Spring or Spring Boot? Till Infinispan 9, the simplest solution was to exclude Spring from <em>infinispan-spring4-embedded</em> (or <em>infinispan-spring4-remote</em>) artifact using <a href="https://maven.apache.org/guides/introduction/introduction-to-optional-and-excludes-dependencies.html">Maven exclusions</a>. Not a very nice and intuitive solution was it?</p> </div> <div class="paragraph"> <p>==</p> </div> <div class="paragraph"> <p>==</p> </div> <div class="paragraph"> <p>==</p> </div> </div> </div> <div class="sect1"> <h2 id="_how_about_treating_spring_as_a_spec_or_api"><a class="anchor" href="#_how_about_treating_spring_as_a_spec_or_api"></a>How about treating Spring as a Spec or API</h2> <div class="sectionbody"> <div class="paragraph"> <p>You probably noticed, when you use JPA you don&#8217;t care about underlying implementation. Is it Hibernate, OpenJPA&#8230;&#8203; it doesn&#8217;t matter?</p> </div> <div class="paragraph"> <p>If you think carefully about Spring for a while, it&#8217;s a bit similar. All core classes might be delivered using standard dependency mechanism (adding spring-beans, spring-context manually), using Spring Boot (adding spring-boot-starter) or even using 3rd party integration tools like DropWizard. In case of a bigger project, a decision whether or not use any of those solutions needs to be taken long before Infinispan is chosen as a Distributed Store or Cache.</p> </div> <div class="paragraph"> <p>At this point, we can do a mental experiment - treat Spring classes as a Spec or API and those delivery mechanisms treat as implementations.</p> </div> <div class="paragraph"> <p>===</p> </div> <div class="paragraph"> <p>===</p> </div> <div class="paragraph"> <p>===</p> </div> <div class="sect2"> <h3 id="_scope_provided_of_course"><a class="anchor" href="#_scope_provided_of_course"></a>Scope? Provided, of course!</h3> <div class="paragraph"> <p>From Infinispan integration perspective we need the Spring API (the classes) and we don&#8217;t care about the implementation (delivery mechanism). Having this in mind we <a href="https://github.com/infinispan/infinispan/commit/76a584bce3566fd855a9629cb3ad9164461c3c45">decided to change Spring&#8217;s scope in Infinispan modules to provided</a>.</p> </div> <div class="paragraph"> <p>===</p> </div> <div class="paragraph"> <p>===</p> </div> <div class="paragraph"> <p>===</p> </div> </div> <div class="sect2"> <h3 id="_i_use_infinispan_and_spring_what_shall_i_do"><a class="anchor" href="#_i_use_infinispan_and_spring_what_shall_i_do"></a>I use Infinispan and Spring, what shall I do?</h3> <div class="paragraph"> <p>Starting from Infinispan 9, you can stop using exclusions. You probably already use Spring and your favorite delivery mechanism (Spring Boot for example). Then add <em>infinispan-spring4-embedded</em> or <em>infinispan-spring4-remote</em> artifact. Finally, you need to decide how would you like to use Infinispan - via Uber Jars (<em>infinispan-embedded</em> and <em>infinispan-remote</em>) or using Small Jars (<em>infinispan-core</em> for example).</p> </div> <div class="paragraph"> <p>That&#8217;s it! Have fun!</p> </div> </div> </div> </div> </div> <hr> <div class="pagination-links"><span class="current-page">1</span> <a href="/blog/tags/9.0/page/2/" class="page-link">2</a> <a href="/blog/tags/9.0/page/2/" class="next-link">Next</a> </div> </div> <footer class="container"> <hr> <div class="row"> <div class="col-md-2 col-md-offset-1"> <h4>Navigate</h4> <ul> <li> <a href="/about" title="About">About</a> </li> <li> <a href="/documentation" title="Learn">Learn</a> </li> <li> <a href="/community" title="Community">Community</a> </li> <li> <a href="/getinvolved" title="Get Involved">Get Involved</a> </li> <li> <a href="/download" title="Download">Download</a> </li> </ul> </div> <div class="col-md-2"> <h4>Contribute</h4> <ul> <li> <a href="https://issues.jboss.org/browse/ISPN" title="Submit a bug">Submit a bug</a> </li> <li> <a href="https://github.com/infinispan" title="Write code">Write Code</a> </li> </ul> <h4>Follow Us</h4> <ul> <li> <a href="https://blog.infinispan.org" title="Blog">Blog</a> </li> <li> <a href="https://twitter.com/infinispan" title="Twitter">Twitter</a> </li> </ul> </div> <div class="col-md-2"> <h4>Open Source</h4> <p> Infinispan is released under the <b>Apache 2.0 open source license.</b> Learn more about the Apache 2.0 license <a href="https://www.apache.org/licenses/LICENSE-2.0">here.</a> </p> </div> <div class="col-md-2"> <h4>A member of</h4> <a alt="CloudTM" href="http://www.cloudtm.eu/" target="_NEW"> <img src="/images/cloudtm.png"> </a> <a alt="LEADS" href="http://leads-project.eu/" target="_NEW"> <img src="/images/leads.png"> </a> <a alt="CloudButton" href="http://cloudbutton.eu/" target="_NEW"> <img src="/images/cloudbutton.png"> </a> </div> <div class="col-md-2"> <h4>Thanks to</h4> <p>JetBrains Intellij IDEA</p> <a alt="JetBrains Intellij IDEA" href="https://www.jetbrains.com/idea/" target="_NEW"> <img src="/images/icon_IntelliJIDEA.png"> </a> </div> </div> <div class="col-md-10"> <p style="margin-top: 5px; font-size: 80%;"> © Copyright 2009-2019 Red Hat, Inc. <br> <i class="icon-fire"></i> Made with <a href="https://github.com/jbossorg/bootstrap-community" style="text-decoration: underline;" target="_NEW">JBoss Community Bootstrap</a> and <a href="http://awestruct.org/" style="text-decoration: underline;" target="_NEW">Awestruct</a> <br> <i class="icon-globe"></i> This website is open source! If you want to improve it, <a href="https://github.com/infinispan/infinispan.github.io" style="text-decoration: underline;" target="_NEW">fork the project,</a> and hack on it, then send a pull request. You can also view the <a href="https://www.seethestats.com/site/infinispan.org" style="text-decoration: underline;" target="_NEW">visitor stats.</a> <br> <i class="icon-share"></i> Website and documentation released under <a href="https://creativecommons.org/licenses/by/3.0/" style="text-decoration: underline;" target="_NEW">CC BY 3.0.</a> </p> </div> </footer> <div class="container" id="companyfooter"> <div class="redhatlogo"> <div id="logospacer"></div> <a href="http://www.redhat.com/"><img src="//static.jboss.org/theme/images/common/redhat_logo.png"></a> </div> </div> <span class="backToTop"> <a href="#top">back to top</a> </span> <script src="//static.jboss.org/theme/js/libs/bootstrap-community/3.2.0.2/bootstrap-community.min.js"></script> <script>
        if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
          _satellite.pageBottom();
        }
      </script> </div> </body> </html>