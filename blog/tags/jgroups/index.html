<!DOCTYPE html> <html lang="en"> <head> <title>Blog - Infinispan</title> <meta charset="utf-8"> <meta content="width=device-width, initial-scale=1.0" name="viewport"> <meta content="DENY" http-equiv="X-Frame-Options"> <meta content="1; mode=block" http-equiv="X-XSS-Protection"> <meta content="nosniff" http-equiv="X-Content-Type-Options"> <link href="https://static.jboss.org/theme/css/bootstrap-community/3.2.0.2/bootstrap-community.min.css" media="screen" rel="stylesheet"> <link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" rel="stylesheet"> <script id="dpal" src="https://www.redhat.com/dtm.js" type="text/javascript"></script> <link href="/images/favicon.png" rel="shortcut icon" type="image/png"> <link href="//static.jboss.org/images/example/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144"> <link href="//static.jboss.org/images/example/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114"> <link href="//static.jboss.org/images/example/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72"> <link href="//static.jboss.org/images/example/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed"> <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" rel="stylesheet"> <link href="https://static.jboss.org/css/rhbar.css" media="screen" rel="stylesheet"> <style>
      .jumbotron {
        padding: 0.5em 0.1em 0.5em 0.1em;
        background-image: none;
        background-color: #ffec9f;
      }
      .jumbotron p, 
      .jumbotron h1 {
        color: #656565;
      }
      .dropup {
        z-index: 1032;
      }
      .navbar {
        font-size: x-large;
      }
      .navbar ul {
        padding-top: 0.7em;
      }
      .navbar-brand {
        height: 80px;
      }
      .navbar-default {
        background-color: white;
      }
      .navbar-default .navbar-nav > li > a {
        color: #336699;
      }
      .navbar-default .navbar-nav > li > a:hover {
        color: #204060;
      }
      .navbar-default .navbar-nav > .open > a,
      .navbar-default .navbar-nav > .open > a:hover,
      .navbar-default .navbar-nav > .open > a:focus {
        background-color: #4a5d75;
      }
      h3.well {
        border-color: #ffd630;
        background-color: #ffec9f;
      }
      .panel-sidebar {
        border-color: #f5f5f5;
      }
      .panel-sidebar > .panel-heading {
        border-color: #e3e3e3;
        background-color: #f5f5f5;
        color: #656565;
      }
      .btn-primary {
        border-color: #ffd630;
        background-color: #ffec9f;
        color: #656565;
      }
      footer.container {
        background-color: white;
      }
      footer.container h1, footer.container h2, footer.container h3, footer.container h4, footer.container h5, footer.container h6, footer.container p, footer.container a {
        color: #656565;
      }
      footer.container ul {
        padding: 0;
      }
      i.enormous-icon {
        margin-top: 0.3em;
      }
      .home-examples {
        font-size: 16px;
      }
    </style> <script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.min.js"></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script> <script>
      hljs.initHighlightingOnLoad();
    </script> <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
     
    ga('create', 'UA-8601422-1', 'auto');
    ga('send', 'pageview');
    
    </script> </head> <body> <div id=""> <ul class="visuallyhidden" id="top"> <li> <a accesskey="n" href="#nav" title="Skip to navigation">Skip to navigation</a> </li> <li> <a accesskey="c" href="#page" title="Skip to content">Skip to content</a> </li> </ul> <div id="rhbar"> <a class="jbdevlogo" href="http://www.jboss.org/projects/about"></a> <a class="rhlogo" href="http://www.redhat.com/"></a> </div> <div class="container" id="content"> <nav class="navbar navbar-default navbar-fixed-top"> <div class="container"> <div class="navbar-header"> <button aria-expanded="false" class="navbar-toggle collapsed" data-target="#thenavbar" data-toggle="collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/"> <img alt="Infinispan" src="/images/infinispan_nav_brand.png"> </a> </div> <div class="navbar-collapse collapse" id="thenavbar"> <ul class="nav navbar-nav"> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/about">About <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/about">Introduction</a></li> <li><a href="/features">Features</a></li> <li><a href="/release-notes">Release notes</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/references">References</a></li> <li><a href="/experiments/">Experiments</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/documentation">Learn <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/documentation">Documentation</a></li> <li><a href="/tutorials">Tutorials</a></li> <li><a href="/videos">Videos</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/download">Download <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/download">Infinispan Releases</a></li> <li><a href="/cache-store-implementations">Cache Store Implementations</a></li> <li><a href="/hotrod-clients">Hot Rod Clients</a></li> <li><a href="/integrations">Integrations</a></li> <li><a href="/download-archive">Archive</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/community">Community <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/community">Ask for Help</a></li> <li><a href="/getinvolved">Get Involved</a></li> </ul> </li> <li class=""><a href="/roadmap">Road Map</a></li> <li class="divider"></li> </ul> </div> </div> </nav> <div class="post"></div> <h3> Tuesday, 05 March 2019 </h3> <h1> <a href="/blog/2019/03/05/enhanced-jgroups-configuration/">Enhanced JGroups configuration</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan uses <a href="http://www.jgroups.org/">JGroups</a> as its underlying clustering layer. In order to configure the finer details of clustering (discovery, flow control, cross-site, etc) you have to provide a separate XML file with the desired configuration and reference it from your Infinispan XML file as follows:</p> </div> <div class="paragraph"> <p>For simple configurations this is usually fine, but configuring complex setups, such as cross-site replication, means juggling multiple files (one for the local stack, one for the cross-site stack and one for the relay configuration).</p> </div> <div class="paragraph"> <p>Starting with Infinispan 10 Alpha2 we have introduced a number of changes to make your life with JGroups configurations a lot easier.</p> </div> </div> </div> <div class="sect1"> <h2 id="_default_stacks"><a class="anchor" href="#_default_stacks"></a>Default stacks</h2> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan now comes with two pre-declared stacks: <code>tcp</code> and <code>udp</code>. Using them is as simple as just referencing their names in the <code>&lt;transport&gt;</code> element.</p> </div> </div> </div> <div class="sect1"> <h2 id="_inline_stacks"><a class="anchor" href="#_inline_stacks"></a>Inline stacks</h2> <div class="sectionbody"> <div class="paragraph"> <p>Inlining a stack means you can put the JGroups configuration inside the Infinispan one as follows:</p> </div> <div class="paragraph"> <p>You can use the full JGroups schema, and by using XML namespaces you get full validation.</p> </div> </div> </div> <div class="sect1"> <h2 id="_stack_inheritance"><a class="anchor" href="#_stack_inheritance"></a>Stack inheritance</h2> <div class="sectionbody"> <div class="paragraph"> <p>Most of the time you want to reuse one of the pre-declared stacks but just override some of the parameters (e.g. discovery) to suit your environment. The following example creates a new <code>tcpgossip</code> stack which is based on the default tcp stack but replaces the discovery protocol with <code>TCPGOSSIP</code>:</p> </div> <div class="paragraph"> <p>In the above example you can see that we have enhanced the JGroups protocol declarations with two new attributes: <code>ispn:stack.combine</code> and <code>ispn:stack.position</code> which affect how and where protocol changes are applied on the parent configuration to obtain a new configuration. <code>stack.combine</code> can be one of <code>COMBINE</code> (the default, possibly overriding any specified attributes), <code>REPLACE</code> (which completely replaces the protocol and resets all attributes), <code>REMOVE</code> (removes the protocol) and <code>INSERT_AFTER</code> (which places this protocol in the stack immediately after the protocol specified by <code>stack.position</code>).</p> </div> </div> </div> <div class="sect1"> <h2 id="_multiple_stacks_and_cross_site"><a class="anchor" href="#_multiple_stacks_and_cross_site"></a>Multiple stacks and Cross-site</h2> <div class="sectionbody"> <div class="paragraph"> <p>The inline configuration really shows its usefulness in cross-site configurations. In fact, the JGroups stack declaration has been extended with a special element which replaces the need for a separate relay XML file and can reference other stacks just by name. The following configuration uses the default <code>udp</code> stack for the local cluster transport and uses the default <code>tcp</code> stack for connecting to a remote site:</p> </div> <div class="paragraph"> <p>Having the entire configuration in a single place greatly simplifies management. Of course you can combine all of the above features to obtain the configuration you need for your environment. You can find more details and examples in the <a href="http://infinispan.org/docs/dev/user_guide/user_guide.html#cache_configuration_clustered">documentation</a>. Enjoy ! Tristan</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Wednesday, 27 September 2017 </h3> <h1> <a href="/blog/2017/09/27/jgroups-workshops-in-rome-and-berlin-in/"> JGroups workshops in Rome and Berlin in November</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>I&#8217;m happy to announce that I&#8217;ve revamped the JGroups workshop and I&#8217;ll be teaching 2 workshops in November: Rome Nov 7-10 and Berlin Nov 21-24.</p> </div> <div class="paragraph"> <p>The new workshop is 4 days (TUE-FRI). I&#8217;ve updated the workshop to use the latest version of JGroups (4.0.x), removed a few sections and added sections on troubleshooting/diagnosis and handling of network partitions (split brain).</p> </div> <div class="paragraph"> <p>Should be a fun and hands-on workshop!</p> </div> <div class="paragraph"> <p>To register and for the table of contents, navigate to <a href="http://www.jgroups.org/workshops.html" class="bare">http://www.jgroups.org/workshops.html</a></p> </div> <div class="paragraph"> <p>To get the early-bird discount, use code EARLYBIRD.</p> </div> <div class="paragraph"> <p>Cheers,</p> </div> <div class="paragraph"> <p>Bela</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Tuesday, 23 May 2017 </h3> <h1> <a href="/blog/2017/05/23/kubeping-093-released/">KUBE_PING 0.9.3 released</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>I&#8217;m happy to announce that JGroups KUBE_PING 0.9.3 was released. The major changes include:</p> </div> <div class="ulist"> <ul> <li> <p>Fixed releasing connections for embedded HTTP Server</p> </li> <li> <p>Fixed JGroups 3/4 compatibility issues</p> </li> <li> <p>Fixed test suite</p> </li> <li> <p>Fixed <code>Message.setSrc</code> compatibility issues</p> </li> <li> <p>Updated documentation</p> </li> </ul> </div> <div class="paragraph"> <p>The bits might be downloaded from <a href="https://repository.jboss.org/nexus/content/repositories/public-jboss/org/jgroups/kubernetes/kubernetes/0.9.3/">JBoss Repository</a> as soon as the sync completes. Please download them from <a href="https://origin-repository.jboss.org/nexus/content/repositories/public-jboss/org/jgroups/kubernetes/kubernetes/0.9.3/">here</a> in the meantime. </p> </div> <div class="paragraph"> <p>I would also like to recommend you <a href="http://belaban.blogspot.com/2017/05/running-infinispan-cluster-with.html">recent blog post created by Bela Ban</a>. KUBE_PING was completely revamped (no embedded HTTP Server, reduced dependencies) and we plan to use new, 1.0.0 version in Infinispan soon! If you&#8217;d like to try it out, grab it from <a href="https://repository.jboss.org/nexus/content/repositories/public-jboss/org/jgroups/kubernetes/kubernetes/1.0.0-SNAPSHOT/">here</a>.</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Wednesday, 15 March 2017 </h3> <h1> <a href="/blog/2017/03/15/kubeping-092-released/">KUBE_PING 0.9.2 released!</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>I&#8217;m happy to announce a new release of <em>KUBE_PING</em> JGroups protocol.</p> </div> <div class="paragraph"> <p>Since this is a minor maintenance release, there are no ground breaking changes but we fixed a couple of issues that prevented our users from using JGroups 3.6.x and KUBE_PING 0.9.1.</p> </div> <div class="paragraph"> <p>Have a look at the <a href="https://github.com/jgroups-extras/jgroups-kubernetes/releases">release page</a> to learn more details.</p> </div> <div class="paragraph"> <p>The artifacts should be available in Maven Central as soon as the sync completes. In the meantime grab them from <a href="https://origin-repository.jboss.org/nexus/content/repositories/public-jboss/org/jgroups/kubernetes/parent/0.9.2/">JBoss Repository</a>.</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Wednesday, 20 July 2016 </h3> <h1> <a href="/blog/2016/07/20/improved-infinispan-docker-image/">Improved Infinispan Docker image available</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p><a href="https://www.docker.com/sites/default/files/Engine.png"><span class="image"><img src="https://www.docker.com/sites/default/files/Engine.png" alt="image" width="200" height="196"></span></a></p> </div> <div class="paragraph"> <p>The <a href="https://hub.docker.com/r/jboss/infinispan-server/">Infinispan Docker image</a> has been improved, making it easier to run Infinispan Servers in clustered, domain and standalone modes, with different protocol stacks.</p> </div> <div class="paragraph"> <p>In this blog post we&#8217;ll show a few usage scenarios and how to combine it with the <a href="https://hub.docker.com/r/jboss/jgroups-gossip/">jgroups-gossip</a> image to create Infinispan Server clusters in docker based environments.</p> </div> <div class="exampleblock"> <div class="content"> <div class="exampleblock"> <div class="content"> <div class="paragraph"> <p>==== Getting started</p> </div> </div> </div> <div class="paragraph"> <p>By default the container runs in clustered mode, and to start a node simply execute:</p> </div> <div class="paragraph"> <p>Bringing a second container will cause it to form a cluster.The membership can be verified by running a command directly in the newly launched container:</p> </div> <div class="paragraph"> <p>Example output:</p> </div> <div class="exampleblock"> <div class="content"> <div class="paragraph"> <p>==== Using a different JGroups stack</p> </div> </div> </div> <div class="paragraph"> <p>The command above creates a cluster with the default JGroups stack (UDP), but it&#8217;s possible to pick another one provided it&#8217;s supported by the server. For example, to use TCP:</p> </div> <div class="paragraph"> <p>==== Running on cloud environments</p> </div> <div class="paragraph"> <p>We recently dockerized the JGroups Gossip Router to be used as an alternative discovery mechanism in environments where multicast is not enabled, such as cloud environments.</p> </div> <div class="paragraph"> <p>Employing  a gossip router will enable discovery via TCP, where the router acts as a registry: each member will register itself in this registry upon start and also discover other members.</p> </div> <div class="paragraph"> <p>The gossip router container can be launched by:     </p> </div> <div class="paragraph"> <p>Take note of the address where the router will bind to, it&#8217;s needed by the Infinispan nodes. The address can be easily obtained by:    </p> </div> <div class="paragraph"> <p>Finally we can now launch our cluster specifying the tcp-gossip stack with the location of the gossip router:</p> </div> <div class="paragraph"> <p>==== Launching Standalone mode</p> </div> <div class="paragraph"> <p>Passing an extra parameter allows to run a server in standalone (non-clustered) mode:</p> </div> <div class="exampleblock"> <div class="content"> <div class="paragraph"> <p>==== Server Management Console in Domain mode</p> </div> </div> </div> <div class="paragraph"> <p>Domain mode is a special case of clustered mode (and currently a requirement to use the Server Management Console), that involves launching a domain controller process plus one or more host controller processes. The domain controller does not hold data, it is used as a centralized management process that can replicate configuration and provision servers on the host controllers.</p> </div> <div class="paragraph"> <p>Running a domain controller is easily achievable with a parameter:</p> </div> <div class="paragraph"> <p>Once the domain controller is running, it&#8217;s possible to start one or more host controllers. In the default configuration, each host controller has two Infinispan server instances:</p> </div> <div class="paragraph"> <p>The command line interface can be used to verify the hosts managed in the domain:</p> </div> <div class="paragraph"> <p>It should output all the host names that are part of the domain, including the master (domain controller):</p> </div> <div class="paragraph"> <p>To get access to the Management console, use credentials admin/admin and go to port 9990 of the domain controller, for example: <a href="http://172.17.0.2:9990/">http://172.17.0.2:9990/</a></p> </div> <div class="paragraph"> <p>==== Versions</p> </div> <div class="paragraph"> <p>The image is built on <a href="https://hub.docker.com/r/jboss/infinispan-server/">Dockerhub</a> shortly after each Infinispan release (stable and unstable), and the improvements presented in this post are available for Infinispan 9.0.0.Alpha3 and Infinispan 8.2.3.Final. As a reminder, make sure to pick the right version when launching containers:</p> </div> <div class="paragraph"> <p>Getting involved</p> </div> <div class="paragraph"> <p>The image was created to be flexible and easy to use, but if something is not working for you or if you have any suggestions to improve it, please report it at <a href="https://github.com/jboss-dockerfiles/infinispan/issues/" class="bare">https://github.com/jboss-dockerfiles/infinispan/issues/</a></p> </div> <div class="paragraph"> <p>Enjoy!</p> </div> </div> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Monday, 02 November 2015 </h3> <h1> <a href="/blog/2015/11/02/jboss-clustering-team-jug-berlin/">JBoss Clustering Team @ JUG Berlin Brandenburg</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>The entire JBoss Clustering Team will be at the Berlin-Brandenburg JUG on Thursday, 19th November <a href="http://www.jug-berlin-brandenburg.de/blog/2015/jgroups.html">talking about JGroups, Infinispan and WildFly clustering</a>. If you are around, please come over to meet the team and share your thoughts and ideas.</p> </div> <div class="paragraph"> <p>The meetup is advertised <a href="http://www.meetup.com/de/eposttechtalk/events/226439709/">here</a></p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Friday, 13 March 2015 </h3> <h1> <a href="/blog/2015/03/13/infinispan-on-openshift-v3/">Infinispan on Openshift v3</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Openshift v3 is the open source next generation of Paas, where applications run on <a href="https://www.docker.com/">Docker</a> containers and are orchestrated/controlled/scheduled by <a href="http://kubernetes.io/">Kubernetes</a>.</p> </div> <div class="paragraph"> <p>In this post I&#8217;ll show how to create an Infinispan cluster on Openshift v3 and resize it with a snap of a finger.</p> </div> </div> </div> <div class="sect3"> <h4 id="_installing_openshift_v3"><a class="anchor" href="#_installing_openshift_v3"></a>Installing Openshift v3</h4> </div> <div class="sect3"> <h4 id=""><a class="anchor" href="#"></a> </h4> <div class="paragraph"> <p>Openshift v3 has not been released yet, so I&#8217;m going to use the code from <a href="https://github.com/openshift/origin">origin</a>. There are <a href="http://docs.openshift.org/latest/getting_started/installation.html">many ways</a> to install Openshift v3, but for simplicity, I&#8217;ll run a full multinode cluster locally on top of VirtualBoxes using the provided <a href="https://www.vagrantup.com/">Vagrant</a> scripts.</p> </div> <div class="paragraph"> <p>Let&#8217;s start by checking out and building the sources:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="line-pre"></code></pre> </div> </div> <div class="paragraph"> <p>To boot Openshift, it&#8217;s a simple matter of starting up the desired number of nodes:</p> </div> <div class="paragraph"> <p>Grab a beer while the cluster is being provisioned, after a while you should be able to see 3 instances running:</p> </div> </div> <div class="sect3"> <h4 id="_2"><a class="anchor" href="#_2"></a> </h4> </div> <div class="sect3"> <h4 id="_creating_the_infinispan_template"><a class="anchor" href="#_creating_the_infinispan_template"></a>Creating the Infinispan template</h4> <div class="paragraph"> <p>The following template defines a 2 node Infinispan cluster communicating via TCP, and discovery done using the <a href="http://www.jgroups.org/javadoc/org/jgroups/stack/GossipRouter.html">JGroups gossip router</a>:</p> </div> <div class="paragraph"> <p>There are few different components declared in this template:</p> </div> <div class="ulist"> <ul> <li> <p>A service with id <em>jgroups-gossip-service</em> that will expose a JGroups gossip router service on port 11000, around the <a href="https://registry.hub.docker.com/u/gustavonalle/jgroups-gossip/">JGroups Gossip container</a></p> </li> <li> <p>A ReplicationController with id <em>jgroups-gossip-controller</em>. Replication Controllers are used to ensure that, at any moment, there will be a certain number of replicas of a pod (a group of related docker containers) running. If for some reason a node crashes, the ReplicationController will instantiate a new pod elsewhere, keeping the service endpoint address unchanged.</p> </li> <li> <p>Another ReplicationController with id <em>infinispan-controller</em>. This controller will start 2 replicas of the <em>infinispan-pod</em>. As it happens with the <em>jgroups-pod</em>, the <em>infinispan-pod</em> has only one container defined: the infinispan-server container (based on <a href="https://registry.hub.docker.com/u/jboss/infinispan-server/">jboss/infinispan-server</a>) , that is started with the 'clustered.xml' profile and configured with the 'jgroups-gossip-service' address. By defining the gossip router as a service, Openshift guarantees that environment variables such as[.pl-s1]# JGROUPS_GOSSIP_SERVICE_SERVICE_HOST are# available to other pods (consumers).</p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="_applying_the_template"><a class="anchor" href="#_applying_the_template"></a>Applying the template</h4> <div class="paragraph"> <p>To apply the template via cmd line:</p> </div> <div class="paragraph"> <p>Grab another beer, it can take a while since in this case the docker images need to be fetched on each of the minions from the public registry. In the meantime, to inspect the pods, along with their containers and statuses:</p> </div> </div> <div class="sect3"> <h4 id="_resizing_the_cluster"><a class="anchor" href="#_resizing_the_cluster"></a>Resizing the cluster</h4> <div class="paragraph"> <p>Changing the number of pods (and thus the number of nodes in the Infinispan cluster) is a simple matter of manipulating the number of replicas in the Replication Controller. To increase the number of nodes to 4:</p> </div> <div class="paragraph"> <p>This should take only a few seconds, since the docker images are already present in all the minions.</p> </div> <div class="paragraph"> <p>And this concludes the post, be sure to check other cool features of Openshift in the <a href="http://docs.openshift.org/latest/welcome/index.html#">project documentation</a> and try out other <a href="https://github.com/openshift/origin/tree/master/examples">samples</a>.</p> </div> </div> </div> <hr> <div class="post"></div> <h3> Friday, 22 June 2012 </h3> <h1> <a href="/blog/2012/06/22/infinispan-52-alpha-out-now-with/">Infinispan 5.2 alpha out now with Command Line Inteface!</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan 5.2.0.ALPHA1 has just been released and it comes with a load of new goodies, here&#8217;s a summary:</p> </div> <div class="ulist"> <ul> <li> <p>Command Line Interface! See <a href="http://infinispan.blogspot.ch/2012/06/infinispan-cli.html">Tristan&#8217;s blog post</a> for more information.</p> </li> <li> <p>Infinispan based Lucene directory has been upgraded to Apache Lucene 3.6.</p> </li> <li> <p><a href="https://issues.jboss.org/browse/ISPN-2084">Lucene Index can be used as a cache loader source</a>.</p> </li> <li> <p><a href="https://issues.jboss.org/browse/ISPN-1949">Allow non-indexed values in indexed caches</a>.</p> </li> <li> <p>Make @ProvidedId annotation on @Indexed objects optional.</p> </li> <li> <p>Upgrade to JGroups 3.1.x.</p> </li> <li> <p>Upgrade to Berkeley DB 5.x</p> </li> <li> <p>HBase cache store plugin</p> </li> </ul> </div> <div class="paragraph"> <p>Full details of all the rest enhancements can be found <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12318882">here</a>. If you have feedback, please visit our <a href="http://community.jboss.org/en/infinispan?view=discussions">forums</a>. Finally, as always, you can download the release from here.</p> </div> <div class="paragraph"> <p>Cheers,</p> </div> <div class="paragraph"> <p>Galder</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Thursday, 31 May 2012 </h3> <h1> <a href="/blog/2012/05/31/infinispan-515-goes-final/">Infinispan 5.1.5 goes FINAL!</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan <em>'Brahma'</em> 5.1.5.FINAL has now been released fixing a whole bunch of issues around <a href="https://issues.jboss.org/browse/ISPN-1964">cache store preloading of distributed caches</a>, <a href="https://issues.jboss.org/browse/ISPN-2053">Memcached server</a>, <a href="https://issues.jboss.org/browse/ISPN-2036">tree module</a> and <a href="https://issues.jboss.org/browse/ISPN-2067">Hot Rod client performance</a>. We&#8217;ve also updated several libraries such as Netty (to 3.4.6) and JGroups (to 3.0.10).</p> </div> <div class="paragraph"> <p>Full details of what has been fixed can be found <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12319540">here</a>, and if you have feedback, please visit our <a href="http://community.jboss.org/en/infinispan?view=discussions">forums</a>. Finally, as always, you can download the release from <a href="http://www.jboss.org/infinispan/downloads">here</a>.</p> </div> <div class="paragraph"> <p>Cheers, Galder</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Tuesday, 25 May 2010 </h3> <h1> <a href="/blog/2010/05/25/infinispan-ec2-demo/">Infinispan EC2 Demo</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan&#8217;s distributed mode is well suited to handling large datasets and scaling the clustered cache by adding nodes as required. These days when inexpensive scaling is thought of, cloud computing immediately comes to mind.</p> </div> <div class="paragraph"> <p>One of the largest providers of cloud computing is Amazon with its Amazon Web Services (AWS) offering. AWS provides computing capacity on demand with its EC2 services and storage on demand with its S3 and EBS offerings. EC2 provides just an operating system to run on and it is a relatively straightforward process to get an Infinispan cluster running on EC2. However there is one gotcha, EC2 does not support UDP multicasting at this time and this is the default node discovery approach used by Infinispan to detect nodes running in a cluster.</p> </div> <div class="paragraph"> <p>Some background on network communications</p> </div> <div class="paragraph"> <p>Infinispan uses the JGroups library to handle all network communications. JGroups enables cluster node detection, a process called discovery, and reliable data transfer between nodes. JGroups also handles the process of nodes entering and exiting the cluster and master node determination for the cluster.</p> </div> <div class="paragraph"> <p><strong>Configuring JGroups in Infinispan</strong> The JGroups configuration details are passed to Infinispan in the infinispan configuration file</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;transport</span> <span class="attribute-name">clusterName</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">infinispan-cluster</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">distributedSyncTimeout</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">50000</span><span class="delimiter">&quot;</span></span>&#x000A;          <span class="attribute-name">transportClass</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.infinispan.remoting.transport.jgroups.JGroupsTransport</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>&#x000A;      <span class="tag">&lt;properties&gt;</span>&#x000A;         <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">configurationFile</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jgroups-s3_ping-aws.xml</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>&#x000A;      <span class="tag">&lt;/properties&gt;</span>&#x000A;   <span class="tag">&lt;/transport&gt;</span></code></pre> </div> </div> <div class="paragraph"> <p><strong>Node Discovery</strong></p> </div> <div class="paragraph"> <p>JGroups has three discovery options which can be used for node discovery on EC2.</p> </div> <div class="paragraph"> <p>The first is to statically configure the address of each node in the cluster in each of the nodes peers. This simplifies discovery but is not suitable when the IP addresses of each node is dynamic or nodes are added and removed on demand.</p> </div> <div class="paragraph"> <p>The second method is to use a Gossip Router. This is an external Java process which runs and waits for connections from potential cluster nodes. Each node in the cluster needs to be configured with the ip address and port that the Gossip Router is listening on. At node initialization, the node connects to the gossip router and retrieves the list of other nodes in the cluster.</p> </div> <div class="paragraph"> <p>Example JGroups gossip router configuration</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;config&gt;</span>&#x000A;     <span class="tag">&lt;TCP</span> <span class="attribute-name">bind_port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">7800</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>&#x000A;     <span class="tag">&lt;TCPGOSSIP</span> <span class="attribute-name">timeout</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3000</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">initial_hosts</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">192.168.1.20[12000]</span><span class="delimiter">&quot;</span></span>&#x000A;                    <span class="attribute-name">num_initial_members</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>&#x000A;     <span class="tag">&lt;MERGE2</span> <span class="attribute-name">max_interval</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">30000</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">min_interval</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">10000</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>&#x000A;     <span class="tag">&lt;FD_SOCK</span> <span class="attribute-name">start_port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">9777</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>&#x000A;     ...&#x000A;  <span class="tag">&lt;/config&gt;</span></code></pre> </div> </div> <div class="paragraph"> <p>The <code>infinispan-4.1.0-SNAPSHOT/etc/config-samples/</code> directory has sample configuration files for use with the Gossip Router. The approach works well but the dependency on an external process can be limiting.</p> </div> <div class="paragraph"> <p>The third method is to use the new <code>S3_PING</code> protocol that has been added to JGroups. Using this the user configures a S3 bucket (location) where each node in the cluster will store its connection details and upon startup each node will see the other nodes in the cluster. This avoids having to have a separate process for node discovery and gets around the static configuration of nodes.</p> </div> <div class="paragraph"> <p>Example JGroups configuration using the <code>S3_PING</code> protocol:</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;config&gt;</span>&#x000A;      <span class="tag">&lt;TCP</span> <span class="attribute-name">bind_port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">7800</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>&#x000A;      <span class="tag">&lt;S3_PING</span> <span class="attribute-name">secret_access_key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">secretaccess_key</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">access_key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">access_key</span><span class="delimiter">&quot;</span></span>&#x000A;                  <span class="attribute-name">location</span>=<span class="attribute-value">s3_bucket_location</span><span class="error">&quot;</span> <span class="tag">/&gt;</span>&#x000A;      <span class="tag">&lt;MERGE2</span> <span class="attribute-name">max_interval</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">30000</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">min_interval</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">10000</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>&#x000A;      <span class="tag">&lt;FD_SOCK</span> <span class="attribute-name">start_port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">9777</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>&#x000A;      ...&#x000A;  <span class="tag">&lt;/config&gt;</span></code></pre> </div> </div> <div class="paragraph"> <p>EC2 demo</p> </div> <div class="paragraph"> <p>The purpose of this demo is to show how an Infinispan cache running on EC2 can easily form a cluster and retrieve data seamlessly across the nodes in the cluster. The addition of any subsequent Infinispan nodes to the cluster automatically distribute the existing data and offer higher availability in the case of node failure.</p> </div> <div class="paragraph"> <p>To demonstrate Infinispan, data is required to be added to nodes in the cluster. We will use one of the many public datasets that Amazon host on AWS, the <a href="http://developer.amazonwebservices.com/connect/entry.jspa?externalID=2419&amp;categoryID=246">influenza virus</a> dataset publicly made available by Amazon.</p> </div> <div class="paragraph"> <p>This dataset has a number components which make it suitable for the demo. First of all it is not a trivial dataset, there are over 200,000 records. Secondly there are internal relationships within the data which can be used to demonstrate retrieving data from different cache nodes. The data is made up for viruses, nucleotides and proteins, each influenza virus has a related nucleotide and each nucleotide has one or more proteins. Each are stored in their own cache instance.</p> </div> <div class="paragraph"> <p><span class="image"><img src="http://3.bp.blogspot.com/_Ak-ywrHZki4/S_zQaw1dcqI/AAAAAAAAA7A/KOxIqwwmzhw/s320/infib1.png" alt="image"></span></p> </div> <div class="paragraph"> <p>The caches are populated as follows :</p> </div> <div class="ulist"> <ul> <li> <p><strong>InfluenzaCache</strong> - populated with data read from the <code>Influenza.dat</code> file, approx 82,000 entries</p> </li> <li> <p><strong>ProteinCache</strong> - populated with data read from the <code>Influenza_aa.dat</code> file, approx 102,000 entries</p> </li> <li> <p><strong>NucleotideCache</strong> - populated with data read from the <code>Influenza_na.dat</code> file, approx 82,000 entries</p> </li> </ul> </div> <div class="paragraph"> <p>The demo requires 4 small EC2 instances running Linux, one instance for each cache node and one for the Jboss application server which runs the UI. Each node has to have <a href="http://java.sun.com/javase/6/">Sun JDK 1.6</a> installed in order to run the demos. In order to use the Web-based GUI, <a href="http://www.jboss.org/jbossas/downloads.html">JBoss AS 5</a> should also be installed on one node.</p> </div> <div class="paragraph"> <p>In order for the nodes to communicate with each other the EC2 firewall needs to be modified. Each node should have the following ports open:</p> </div> <div class="ulist"> <ul> <li> <p>TCP 22 – For SSH access</p> </li> <li> <p>TCP 7800 to TCP 7810 – used for JGroups cluster communications</p> </li> <li> <p>TCP 8080 – Only required for the node running the AS5 instance in order to access the Web UI.</p> </li> <li> <p>TCP 9777 - Required for FD_SOCK, the socket based failure detection module of the JGroups stack.</p> </li> </ul> </div> <div class="paragraph"> <p>To run the demo, <a href="http://sourceforge.net/projects/infinispan/files/">download</a> the Infinispan "all" distribution, (<code>infinispan-xxx-all.zip</code>) to a directory on each node and unzip the archive.</p> </div> <div class="paragraph"> <p>Edit the <code>etc/config-samples/ec2-demo/jgroups-s3_ping-aws.xml</code> file to add the correct AWS S3 security credentials and bucket name.</p> </div> <div class="paragraph"> <p>Start the one of the cache instances on each node using one of the following scripts from the <code>bin</code> directory:</p> </div> <div class="ulist"> <ul> <li> <p><code>runEC2Demo-influenza.sh</code></p> </li> <li> <p><code>runEC2Demo-nucleotide.sh</code></p> </li> <li> <p><code>runEC2Demo-protein.sh</code></p> </li> </ul> </div> <div class="paragraph"> <p>Each script will startup and display the following information :</p> </div> <div class="literalblock"> <div class="content"> <pre>[tmp\] ./runEC2Demo-nucleotide.shCacheBuilder called with /opt/infinispan-4.1.0-SNAPSHOT/etc/config-samples/ec2-demo/infinispan-ec2-config.xml&#x000A;  -------------------------------------------------------------------&#x000A;  GMS: address=redlappie-37477, cluster=infinispan-cluster, physical address=192.168.122.1:7800&#x000A;  -------------------------------------------------------------------&#x000A;  Caches created....&#x000A;  Starting CacheManagerCache&#x000A;  Address=redlappie-57930Cache&#x000A;  Address=redlappie-37477Cache&#x000A;  Address=redlappie-18122&#x000A;  Parsing files....Parsing [/opt/infinispan-4.1.0-SNAPSHOT/etc/Amazon-TestData/influenza_na.dat]&#x000A;  About to load 81904 nucleotide elements into NucleiodCache&#x000A;  Added 5000 Nucleotide records&#x000A;  Added 10000 Nucleotide records&#x000A;  Added 15000 Nucleotide records&#x000A;  Added 20000 Nucleotide records&#x000A;  Added 25000 Nucleotide records&#x000A;  Added 30000 Nucleotide records&#x000A;  Added 35000 Nucleotide records&#x000A;  Added 40000 Nucleotide records&#x000A;  Added 45000 Nucleotide records&#x000A;  Added 50000 Nucleotide records&#x000A;  Added 55000 Nucleotide records&#x000A;  Added 60000 Nucleotide records&#x000A;  Added 65000 Nucleotide records&#x000A;  Added 70000 Nucleotide records&#x000A;  Added 75000 Nucleotide records&#x000A;  Added 80000 Nucleotide records&#x000A;  Loaded 81904 nucleotide elements into NucleotidCache&#x000A;  Parsing files....Done&#x000A;  Protein/Influenza/Nucleotide Cache Size--&gt;9572/10000/81904&#x000A;  Protein/Influenza/Nucleotide Cache Size--&gt;9572/20000/81904&#x000A;  Protein/Influenza/Nucleotide Cache Size--&gt;9572/81904/81904&#x000A;  Protein/Influenza/Nucleotide Cache Size--&gt;9572/81904/81904</pre> </div> </div> <div class="paragraph"> <p>Items of interest in the output are the <strong>Cache Address</strong> lines which display the address of the nodes in the cluster. Also of note is the <strong>Protein/Influenza/Nucleotide</strong> line which displays the number of entries in each cache. As other caches are starting up these numbers will change as cache entries are dynamically moved around through out the Infinispan cluster.</p> </div> <div class="paragraph"> <p>To use the web based UI we first of all need to let the server know where the Infinispan configuration files are kept. To do this edit the <code>jboss-5.1.0.GA/bin/run.conf</code> file and add the line</p> </div> <div class="listingblock"> <div class="content"> <pre class="CodeRay highlight"><code data-lang="sh">JAVA_OPTS=&quot;$JAVA_OPTS -DCFGPath=/opt/infinispan-4.1.0-SNAPSHOT/etc/config-samples/ec2-demo/&quot;</code></pre> </div> </div> <div class="paragraph"> <p>at the bottom. Replace the path as appropriate.</p> </div> <div class="paragraph"> <p>Now start the Jboss application server using the default profile e.g. <code>run.sh -c default -b xxx.xxx.xxx.xxx</code>, where “xxx.xxx.xxx.xxx” is the public IP address of the node that the AS is running on.</p> </div> <div class="paragraph"> <p>Then drop the <code>infinispan-ec2-demoui.war</code> into the jboss-5.1.0.GA <code>/server/default/deploy</code> directory.</p> </div> <div class="paragraph"> <p>Finally point your web browser to <code><a href="http://public-ip-address:8080/infinispan-ec2-demoui" class="bare">http://public-ip-address:8080/infinispan-ec2-demoui</a></code> and the following page will appear.</p> </div> <div class="paragraph"> <p><a href="http://2.bp.blogspot.com/_Ak-ywrHZki4/S_zRHqENE-I/AAAAAAAAA7I/Ovii36qX3vU/s1600/Screenshot2.png"><span class="image"><img src="http://2.bp.blogspot.com/_Ak-ywrHZki4/S_zRHqENE-I/AAAAAAAAA7I/Ovii36qX3vU/s320/Screenshot2.png" alt="image"></span></a></p> </div> <div class="paragraph"> <p>The search criteria is the values in the first column of the <code>/etc/Amazon-TestData/influenza.dat</code> file e.g. <code>AB000604</code>, <code>AB000612</code>, etc.</p> </div> <div class="paragraph"> <p><a href="http://1.bp.blogspot.com/_Ak-ywrHZki4/S_zRrJHi2nI/AAAAAAAAA7Q/F-JHBC08yWw/s1600/Screenshot1.png"><span class="image"><img src="http://1.bp.blogspot.com/_Ak-ywrHZki4/S_zRrJHi2nI/AAAAAAAAA7Q/F-JHBC08yWw/s320/Screenshot1.png" alt="image"></span></a></p> </div> <div class="paragraph"> <p>Note that this demo will be available in Infinispan 4.1.0.BETA2 onwards. If you are impatient, you can always build it yourself from Infinispan&#8217;s source code repository.</p> </div> <div class="paragraph"> <p>Enjoy, Noel</p> </div> </div> </div> </div> <hr> <div class="pagination-links"><span class="current-page">1</span> </div> </div> <footer class="container"> <hr> <div class="row"> <div class="col-md-2 col-md-offset-1"> <h4>Navigate</h4> <ul> <li> <a href="/about" title="About">About</a> </li> <li> <a href="/documentation" title="Learn">Learn</a> </li> <li> <a href="/community" title="Community">Community</a> </li> <li> <a href="/getinvolved" title="Get Involved">Get Involved</a> </li> <li> <a href="/download" title="Download">Download</a> </li> </ul> </div> <div class="col-md-2"> <h4>Contribute</h4> <ul> <li> <a href="https://issues.jboss.org/browse/ISPN" title="Submit a bug">Submit a bug</a> </li> <li> <a href="https://github.com/infinispan" title="Write code">Write Code</a> </li> </ul> <h4>Follow Us</h4> <ul> <li> <a href="https://blog.infinispan.org" title="Blog">Blog</a> </li> <li> <a href="https://twitter.com/infinispan" title="Twitter">Twitter</a> </li> </ul> </div> <div class="col-md-2"> <h4>Open Source</h4> <p> Infinispan is released under the <b>Apache 2.0 open source license.</b> Learn more about the Apache 2.0 license <a href="https://www.apache.org/licenses/LICENSE-2.0">here.</a> </p> </div> <div class="col-md-2"> <h4>A member of</h4> <a alt="CloudTM" href="http://www.cloudtm.eu/" target="_NEW"> <img src="/images/cloudtm.png"> </a> <a alt="LEADS" href="http://leads-project.eu/" target="_NEW"> <img src="/images/leads.png"> </a> <a alt="CloudButton" href="http://cloudbutton.eu/" target="_NEW"> <img src="/images/cloudbutton.png"> </a> </div> <div class="col-md-2"> <h4>Thanks to</h4> <p>JetBrains Intellij IDEA</p> <a alt="JetBrains Intellij IDEA" href="https://www.jetbrains.com/idea/" target="_NEW"> <img src="/images/icon_IntelliJIDEA.png"> </a> </div> </div> <div class="col-md-10"> <p style="margin-top: 5px; font-size: 80%;"> © Copyright 2009-2019 Red Hat, Inc. <br> <i class="icon-fire"></i> Made with <a href="https://github.com/jbossorg/bootstrap-community" style="text-decoration: underline;" target="_NEW">JBoss Community Bootstrap</a> and <a href="http://awestruct.org/" style="text-decoration: underline;" target="_NEW">Awestruct</a> <br> <i class="icon-globe"></i> This website is open source! If you want to improve it, <a href="https://github.com/infinispan/infinispan.github.io" style="text-decoration: underline;" target="_NEW">fork the project,</a> and hack on it, then send a pull request. You can also view the <a href="https://www.seethestats.com/site/infinispan.org" style="text-decoration: underline;" target="_NEW">visitor stats.</a> <br> <i class="icon-share"></i> Website and documentation released under <a href="https://creativecommons.org/licenses/by/3.0/" style="text-decoration: underline;" target="_NEW">CC BY 3.0.</a> </p> </div> </footer> <div class="container" id="companyfooter"> <div class="redhatlogo"> <div id="logospacer"></div> <a href="http://www.redhat.com/"><img src="//static.jboss.org/theme/images/common/redhat_logo.png"></a> </div> </div> <span class="backToTop"> <a href="#top">back to top</a> </span> <script src="//static.jboss.org/theme/js/libs/bootstrap-community/3.2.0.2/bootstrap-community.min.js"></script> <script>
        if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
          _satellite.pageBottom();
        }
      </script> </div> </body> </html>