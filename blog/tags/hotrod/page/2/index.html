<!DOCTYPE html> <html lang="en"> <head> <title>Blog - Infinispan</title> <meta charset="utf-8"> <meta content="width=device-width, initial-scale=1.0" name="viewport"> <meta content="DENY" http-equiv="X-Frame-Options"> <meta content="1; mode=block" http-equiv="X-XSS-Protection"> <meta content="nosniff" http-equiv="X-Content-Type-Options"> <link href="https://static.jboss.org/theme/css/bootstrap-community/3.2.0.2/bootstrap-community.min.css" media="screen" rel="stylesheet"> <link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" rel="stylesheet"> <script id="dpal" src="https://www.redhat.com/dtm.js" type="text/javascript"></script> <link href="/images/favicon.png" rel="shortcut icon" type="image/png"> <link href="//static.jboss.org/images/example/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144"> <link href="//static.jboss.org/images/example/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114"> <link href="//static.jboss.org/images/example/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72"> <link href="//static.jboss.org/images/example/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed"> <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" rel="stylesheet"> <link href="https://static.jboss.org/css/rhbar.css" media="screen" rel="stylesheet"> <style>
      .jumbotron {
        padding: 0.5em 0.1em 0.5em 0.1em;
        background-image: none;
        background-color: #ffec9f;
      }
      .jumbotron p, 
      .jumbotron h1 {
        color: #656565;
      }
      .dropup {
        z-index: 1032;
      }
      .navbar {
        font-size: x-large;
      }
      .navbar ul {
        padding-top: 0.7em;
      }
      .navbar-brand {
        height: 80px;
      }
      .navbar-default {
        background-color: white;
      }
      .navbar-default .navbar-nav > li > a {
        color: #336699;
      }
      .navbar-default .navbar-nav > li > a:hover {
        color: #204060;
      }
      .navbar-default .navbar-nav > .open > a,
      .navbar-default .navbar-nav > .open > a:hover,
      .navbar-default .navbar-nav > .open > a:focus {
        background-color: #4a5d75;
      }
      h3.well {
        border-color: #ffd630;
        background-color: #ffec9f;
      }
      .panel-sidebar {
        border-color: #f5f5f5;
      }
      .panel-sidebar > .panel-heading {
        border-color: #e3e3e3;
        background-color: #f5f5f5;
        color: #656565;
      }
      .btn-primary {
        border-color: #ffd630;
        background-color: #ffec9f;
        color: #656565;
      }
      footer.container {
        background-color: white;
      }
      footer.container h1, footer.container h2, footer.container h3, footer.container h4, footer.container h5, footer.container h6, footer.container p, footer.container a {
        color: #656565;
      }
      footer.container ul {
        padding: 0;
      }
      i.enormous-icon {
        margin-top: 0.3em;
      }
      .home-examples {
        font-size: 16px;
      }
    </style> <script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.min.js"></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script> <script>
      hljs.initHighlightingOnLoad();
    </script> <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
     
    ga('create', 'UA-8601422-1', 'auto');
    ga('send', 'pageview');
    
    </script> </head> <body> <div id=""> <ul class="visuallyhidden" id="top"> <li> <a accesskey="n" href="#nav" title="Skip to navigation">Skip to navigation</a> </li> <li> <a accesskey="c" href="#page" title="Skip to content">Skip to content</a> </li> </ul> <div id="rhbar"> <a class="jbdevlogo" href="http://www.jboss.org/projects/about"></a> <a class="rhlogo" href="http://www.redhat.com/"></a> </div> <div class="container" id="content"> <nav class="navbar navbar-default navbar-fixed-top"> <div class="container"> <div class="navbar-header"> <button aria-expanded="false" class="navbar-toggle collapsed" data-target="#thenavbar" data-toggle="collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/"> <img alt="Infinispan" src="/images/infinispan_nav_brand.png"> </a> </div> <div class="navbar-collapse collapse" id="thenavbar"> <ul class="nav navbar-nav"> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/about">About <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/about">Introduction</a></li> <li><a href="/features">Features</a></li> <li><a href="/release-notes">Release notes</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/references">References</a></li> <li><a href="/experiments/">Experiments</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/documentation">Learn <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/documentation">Documentation</a></li> <li><a href="/tutorials">Tutorials</a></li> <li><a href="/videos">Videos</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/download">Download <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/download">Infinispan Releases</a></li> <li><a href="/cache-store-implementations">Cache Store Implementations</a></li> <li><a href="/hotrod-clients">Hot Rod Clients</a></li> <li><a href="/integrations">Integrations</a></li> <li><a href="/download-archive">Archive</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/community">Community <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/community">Ask for Help</a></li> <li><a href="/getinvolved">Get Involved</a></li> </ul> </li> <li class=""><a href="/roadmap">Road Map</a></li> <li class="divider"></li> </ul> </div> </div> </nav> <div class="post"></div> <h3> Monday, 14 September 2015 </h3> <h1> <a href="/blog/2015/09/14/initial-support-for-apache-avro-and-gora/">Initial Support for Apache Avro and Gora</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p><a href="https://avro.apache.org/">Avro</a> and <a href="http://gora.apache.org/">Gora</a> are two Apache projects that belong to the <a href="https://hadoop.apache.org/">Hadoop</a> ecosystem. Avro is a data serialization framework that relies on JSON for defining data types and protocols, and serializes data in a compact binary format. Its primary use in Hadoop is to provide a serialization format for persistent data, and a wire format for communication between Hadoop nodes, and from client programs to the Hadoop services. Gora is an open-source software framework that provides an in-memory data model and persistence for big data. Gora supports persisting to column stores, key/value stores or databases, and analyzing the data with extensive Apache Hadoop MapReduce support.</p> </div> <div class="paragraph"> <p>As an effort to run Hadoop based applications atop Infinispan, the <a href="http://www.leads-project.eu/">LEADS</a> EU FP7 project has developed an Avro backend (<a href="https://github.com/leads-project/infinispan-avro">infinispan-avro</a>) and a Gora module (<a href="https://github.com/leads-project/gora-infinispan">gora-infinispan</a>). The former allows to store, retrieve and query Avro defined types via the HotRod protocol. The latter allows Gora-based applications to use Infinispan as a storage backend for their MapReduce jobs. In the current state of the implementation, the two modules make use of Infinispan 8.0.0.Final, Avro 1.7.6 and Gora 0.6</p> </div> <div class="paragraph"> <p><strong>What’s in it for you Infinispan user</strong></p> </div> <div class="paragraph"> <p>There are several use cases for which you can benefit from those modules.</p> </div> <div class="ulist"> <ul> <li> <p>With Infinispan’s Avro support, you can decide to persist your data in Infinispan using Avro’s portable format instead of Infinispan’s own format (or Java serialization’s format). This might help you standardize upon a common format for your data at rest. </p> </li> <li> <p>If you use Apache Gora to store/query some of your data in, or even out, of the Hadoop ecosystem, you can use Infinispan as the backend and benefit Infinispan’s features that you come to know like data distribution, partition handling, cross-site clustering. </p> </li> <li> <p>The last use case is to run legacy Hadoop applications, using Infinispan as the primary storage. For instance, it is possible to run the Apache <a href="http://nutch.apache.org/">Nutch</a> web crawler atop Infinispan. A recent paper at <a href="http://ieeexplore.ieee.org/xpl/articleDetails.jsp?arnumber=7214069&amp;filter%3DAND%28p_IS_Number%3A7212169%29%26rowsPerPage%3D100">IEEE Cloud 2015</a> gives a detailed description of such an approach in a geo-distributed environment (a preprint is available <a href="https://drive.google.com/open?id=0BwFkGepvBDQoakFGdkpKNUNCWmM&amp;authuser=0">here</a>). </p> </li> </ul> </div> </div> </div> </div> <a class="label" href="/blog/tags/marshalling/"> marshalling </a> <a class="label" href="/blog/tags/hotrod/"> hotrod </a> <a class="label" href="/blog/tags/8.0/"> 8.0 </a> <a class="label" href="/blog/tags/map reduce/"> map reduce </a> <hr> <div class="post"></div> <h3> Tuesday, 11 August 2015 </h3> <h1> <a href="/blog/2015/08/11/infinispan-724final-including-fixes-for/">Infinispan 7.2.4.Final out including fixes for async store, Hot Rod...etc</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan 7.2.4.Final is just out containing some important fixes in areas such as Hot Rod client and server, async cache store, key set iteration, as well as a Hibernate HQL parser upgrade. You can find more details about the issues fixed in our detailed <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12327543">release notes</a>.</p> </div> <div class="paragraph"> <p>Happy hacking :)</p> </div> <div class="paragraph"> <p>Galder</p> </div> </div> </div> </div> <a class="label" href="/blog/tags/7.2/"> 7.2 </a> <a class="label" href="/blog/tags/release/"> release </a> <a class="label" href="/blog/tags/hotrod/"> hotrod </a> <a class="label" href="/blog/tags/hql/"> hql </a> <a class="label" href="/blog/tags/cache store/"> cache store </a> <hr> <div class="post"></div> <h3> Friday, 17 April 2015 </h3> <h1> <a href="/blog/2015/04/17/infinispan-720cr1-released/">Infinispan 7.2.0.CR1 released</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Dear community,</p> </div> <div class="paragraph"> <p>We are proud to announce the release of Infinispan 7.2.0.CR1!</p> </div> <div class="paragraph"> <p>This is the first release candidate of 7.2, bringing some exciting new features:</p> </div> <div class="ulist"> <ul> <li> <p>Faster bulk operations, putAll and getAll, for both embedded and HotRod client (<a href="https://issues.jboss.org/browse/ISPN-2183">ISPN-2183</a>, <a href="https://issues.jboss.org/browse/ISPN-5264">ISPN-5264</a>, <a href="https://issues.jboss.org/browse/ISPN-5266">ISPN-5266</a>)</p> </li> <li> <p>Cache creation and configuration changes without the need to restart the server (<a href="https://issues.jboss.org/browse/ISPN-5147">ISPN-5147</a>)</p> </li> <li> <p>Support for defining filters using the Query DSL for event listeners (<a href="https://issues.jboss.org/browse/ISPN-5349">ISPN-5349</a> and <a href="https://issues.jboss.org/browse/ISPN-5350">ISPN-5350</a>)</p> </li> <li> <p>Lock-free clear() operation (<a href="https://issues.jboss.org/browse/ISPN-5370">ISPN-5370</a>)</p> </li> </ul> </div> <div class="paragraph"> <p>For the complete list of features and bug fixes, please refer to the <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12326575">release notes</a></p> </div> <div class="paragraph"> <p>Feel free to join us and shape the future releases on our <a href="http://www.jboss.org/infinispan/forums">forums</a>, our <a href="https://lists.jboss.org/mailman/listinfo/infinispan-dev">mailing lists</a> or our <a href="http://webchat.freenode.net/?channels=%23infinispan">#infinispan</a> IRC channel.</p> </div> </div> </div> </div> <a class="label" href="/blog/tags/7.2/"> 7.2 </a> <a class="label" href="/blog/tags/getAll/"> getAll </a> <a class="label" href="/blog/tags/hotrod/"> hotrod </a> <a class="label" href="/blog/tags/putAll/"> putAll </a> <a class="label" href="/blog/tags/listeners/"> listeners </a> <a class="label" href="/blog/tags/release candidate/"> release candidate </a> <a class="label" href="/blog/tags/DSL/"> DSL </a> <hr> <div class="post"></div> <h3> Tuesday, 17 March 2015 </h3> <h1> <a href="/blog/2015/03/17/infinispan-720beta1-released/">Infinispan 7.2.0.Beta1 released</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Dear Infinispan community,</p> </div> <div class="paragraph"> <p>We are proud to announce the release of Infinispan <a href="http://infinispan.org/download/">7.2.0.Beta1</a> today.</p> </div> <div class="paragraph"> <p>Along the usual assortment of bug fixes, this release includes a few exciting new features:</p> </div> <div class="ulist"> <ul> <li> <p>Server-side scripting with JSR-223 (<a href="https://issues.jboss.org/browse/ISPN-5013">ISPN-5013</a>)</p> </li> <li> <p>Initial support for the JCache API over HotRod (<a href="https://issues.jboss.org/browse/ISPN-4955">ISPN-4955</a>)</p> </li> <li> <p>Improved size-based eviction, implemented on top of Doug Lea&#8217;s ConcurrentHashMapV8 (<a href="https://issues.jboss.org/browse/ISPN-3023">ISPN-3023</a>)</p> </li> </ul> </div> <div class="paragraph"> <p>For a complete list of features and bug fixes included in this release, please refer to the <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12326574">release notes</a>.  </p> </div> <div class="paragraph"> <p>Feel free to join us and shape the future releases on our <a href="http://www.jboss.org/infinispan/forums">forums</a>, our <a href="https://lists.jboss.org/mailman/listinfo/infinispan-dev">mailing lists</a> or our <a href="http://webchat.freenode.net/?channels=%23infinispan">#infinispan</a> IRC channel.</p> </div> <div class="paragraph"> <p>Many thanks to everyone who contributed to this release!</p> </div> </div> </div> </div> <a class="label" href="/blog/tags/7.2/"> 7.2 </a> <a class="label" href="/blog/tags/release/"> release </a> <a class="label" href="/blog/tags/hotrod/"> hotrod </a> <a class="label" href="/blog/tags/scripting/"> scripting </a> <a class="label" href="/blog/tags/eviction/"> eviction </a> <a class="label" href="/blog/tags/jcache/"> jcache </a> <hr> <div class="post"></div> <h3> Monday, 15 December 2014 </h3> <h1> <a href="/blog/2014/12/15/hot-rod-remote-events-4-clustering-and/">Hot Rod Remote Events #4: Clustering and Failover</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>This blog post is the last in a series that looks at the forthcoming Hot Rod Remote Events functionality included in Infinispan 7.0. <a href="http://blog.infinispan.org/2014/08/hot-rod-remote-events-1-getting-started.html">First article</a> focused on how to get started receiving remote events from Hot Rod servers. The <a href="http://blog.infinispan.org/2014/08/hot-rod-remote-events-2-filtering-events.html">second article</a> looked at how Hot Rod remote events can be filtered, and the <a href="http://blog.infinispan.org/2014/09/hot-rod-remote-events-3-customizing.html">third one</a> showed how to customize contents of events.</p> </div> <div class="paragraph"> <p>In this last article, we&#8217;ll be focusing on how remote events are fired in a clustered environment and how failover situations are dealt with.</p> </div> <div class="paragraph"> <p>The most important thing to know about remote events in a clustered environment is that <strong>when a client adds a remote listener, this is installed in a single node in the cluster and that this node is in charge of sending events back to the client for all affected operations happening cluster wide</strong>.</p> </div> <div class="paragraph"> <p>As a result of this, when filtering or event customization is applied, the org.infinispan.notifications.cachelistener.filter.CacheEventFilter and/or org.infinispan.notifications.cachelistener.filter.CacheEventConverter instances must be somehow marshallable. This is necessary because when the client listener is installed in a cluster, the filter and/or converter instances are sent to other nodes in the cluster so that filtering and conversion can happen right where the event originates, hence improving efficiency. These classes can be made marshallable by making them extend Serializable, or <a href="http://infinispan.org/docs/7.0.x/user_guide/user_guide.html#_plugging_infinispan_with_user_defined_externalizers">providing and registering a custom Externalizer for them</a>.</p> </div> <div class="paragraph"> <p>Under normal circumstances, the code and examples showed in previous blog posts work the same way in clustered environment. However, in a clustered environment, a decision needs to be made with regards to how to deal with situations where nodes go down: If a node goes down that does not have the client listener installed, nothing happens. However, when the node containing the client listener goes down, the Hot Rod client implementation transparently fails over the client listener registration to a different node. As a result of this failover, there could be a gap in the event consumption. This gap is solved using one of these solutions:</p> </div> </div> </div> <div class="sect3"> <h4 id="_state_delivery"><a class="anchor" href="#_state_delivery"></a>State Delivery</h4> <div class="paragraph"> <p>The @ClientListener annotation has an optional parameter called includeCurrentState. When this is enabled and the client listener is registered, before receiving any events for on-going operations, the server sends ClientCacheEntryCreatedEvent event instances (for methods annotated with @ClientCacheEntryCreated) for all existing cache entries to the client. This offers the client an opportunity to construct some state or computation based on the contents of the clustered cache. When the Hot Rod client transparently fails over registered listeners, it re-registers them in a different node and if includeCurrentState is enabled, clients can recompute their state or computation to reinstate it to what it was before the failover. The downside of includeCurrentState is that it&#8217;s performance is heavily dependant on the cache size, and hence it&#8217;s disabled by default.</p> </div> </div> <div class="sect3"> <h4 id="_clientcachefailover"><a class="anchor" href="#_clientcachefailover"></a>@ClientCacheFailover</h4> <div class="paragraph"> <p>Alternatively, instead of relying on receiving state, users can define a method with @ClientCacheFailover annotation that receives ClientCacheFailoverEvent as parameter inside the client listener implementation:</p> </div> <div class="paragraph"> <p>This method would be called back whenever the node that had this client listener has gone down. This can be handy for situations when the end users just wants to clear up some local state as a result of the failover, e.g. clear a near or L1 cache. When events are received again, the near or L1 cache could be repopulated again.</p> </div> <div class="paragraph"> <p>This callback method of dealing with client listener failover offers a simple, efficient solution to dealing with cluster topology changes affecting client listeners. Depending on the remote event use case, this method might be better suited that state delivery.</p> </div> </div> <div class="sect2"> <h3 id="_final_words"><a class="anchor" href="#_final_words"></a>Final Words</h3> <div class="paragraph"> <p>This post marks the end of the remote event series. In future Infinispan versions, we&#8217;ll continue improving the technology adding some extra features, and more importantly, we&#8217;ll start building higher level abstractions on top of remote events, such as Hot Rod client Near Caches.</p> </div> <div class="paragraph"> <p>Cheers, Galder</p> </div> </div> </div> <a class="label" href="/blog/tags/hotrod/"> hotrod </a> <a class="label" href="/blog/tags/event/"> event </a> <a class="label" href="/blog/tags/remote events/"> remote events </a> <a class="label" href="/blog/tags/7.0/"> 7.0 </a> <a class="label" href="/blog/tags/failover/"> failover </a> <hr> <div class="post"></div> <h3> Tuesday, 28 October 2014 </h3> <h1> <a href="/blog/2014/10/28/infinispan-hotrod-net-client-700cr2/">Infinispan HotRod .NET Client 7.0.0.CR2</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Dear community,</p> </div> <div class="paragraph"> <p>Infinispan HotRod .NET Client 7.0.0.CR2 is now available.</p> </div> <div class="paragraph"> <p>This is mostly a bug-fix release.For the complete list of changes please consult the <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12314125&amp;version=12325992">release notes</a> (includes also the changes from the corresponding version of the C++ Client).   Visit our <a href="http://infinispan.org/hotrod-clients/">downloads</a> section to find the latest release. If you have any questions please check our <a href="http://infinispan.org/community/">forums</a>, our <a href="https://lists.jboss.org/mailman/listinfo/infinispan-dev">mailing lists</a> or ping us directly on <a href="irc://irc.freenode.org/infinispan">IRC</a>.</p> </div> <div class="paragraph"> <p>Thanks to everyone involved for the changes and bug reports contributed!</p> </div> </div> </div> </div> <a class="label" href="/blog/tags/hotrod/"> hotrod </a> <a class="label" href="/blog/tags/dotnet-client/"> dotnet-client </a> <a class="label" href="/blog/tags/7.0/"> 7.0 </a> <a class="label" href="/blog/tags/release candidate/"> release candidate </a> <hr> <div class="post"></div> <h3> Monday, 27 October 2014 </h3> <h1> <a href="/blog/2014/10/27/infinispan-hotrod-c-client-700cr2/">Infinispan HotRod C++ Client 7.0.0.CR2</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Dear community,</p> </div> <div class="paragraph"> <p>Infinispan HotRod C++ Client 7.0.0.CR2 is now available.</p> </div> <div class="paragraph"> <p>This is mostly a bug-fix release. I would like bring to your attention the following changes:</p> </div> <div class="ulist"> <ul> <li> <p><a href="https://issues.jboss.org/browse/HRCPP-151">HRCPP-151</a> ABI compatibilty changes</p> </li> <li> <p><a href="https://issues.jboss.org/browse/HRCPP-127">HRCPP-127</a> 32bit DLL rename</p> </li> </ul> </div> <div class="paragraph"> <p>For the complete list of changes please consult the <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12314125&amp;version=12325992">release notes</a>. Visit our <a href="http://infinispan.org/hotrod-clients/">downloads</a> section to find the latest release. If you have any questions please check our <a href="http://infinispan.org/community/">forums</a>, our <a href="https://lists.jboss.org/mailman/listinfo/infinispan-dev">mailing lists</a> or ping us directly on <a href="irc://irc.freenode.org/infinispan">IRC</a>.</p> </div> <div class="paragraph"> <p>Thanks to everyone involved for the changes and bug reports contributed!</p> </div> </div> </div> </div> <a class="label" href="/blog/tags/hotrod/"> hotrod </a> <a class="label" href="/blog/tags/cpp-client/"> cpp-client </a> <a class="label" href="/blog/tags/7.0/"> 7.0 </a> <a class="label" href="/blog/tags/release candidate/"> release candidate </a> <hr> <div class="post"></div> <h3> Wednesday, 17 September 2014 </h3> <h1> <a href="/blog/2014/09/17/hot-rod-remote-events-3-customizing/">Hot Rod Remote Events #3: Customizing events</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>This blog post is the third in a series that looks at the forthcoming Hot Rod Remote Events functionality included in Infinispan 7.0. In the <a href="http://blog.infinispan.org/2014/08/hot-rod-remote-events-1-getting-started.html">first article</a> we looked at how to get started receiving remote events from Hot Rod servers. In the <a href="http://blog.infinispan.org/2014/08/hot-rod-remote-events-2-filtering-events.html">second article</a>, we saw how Hot Rod remote events can be filtered providing key/value filter factories that can create instances that filter which events are sent to clients, and how these filters can act on client provided information.</p> </div> <div class="paragraph"> <p>This time we are going to focus on how to customize events sent to clients. Events generated by default contain just enough information to make the event relevant but avoid cramming too much information in order to reduce the cost of sending them. Normally, this information consists of key and type of event.</p> </div> <div class="paragraph"> <p>Optionally, the information shipped in these events can be customized in order to contain more information, such as values, or to contain even less information. This customization is done with org.infinispan.notifications.cachelistener.filter.CacheEventConverter instances which are created by implementing a org.infinispan.notifications.cachelistener.filter.CacheEventConverterFactory class. Each factory must have a name associated to it via the org.infinispan.filter.NamedFactory annotation.</p> </div> <div class="paragraph"> <p>When a listener is added, we can provide the name of a converter factory to use with this listener, and when the listener is added, the server will look up the factory and invoke getConverter method to get a org.infinispan.notifications.cachelistener.filter.CacheEventConverter class instance to customize events server side.</p> </div> <div class="paragraph"> <p>Here&#8217;s a sample implementation which will send custom events containing value information back to clients for a cache of Integers and Strings:</p> </div> <div class="paragraph"> <p>In the example above, the converter generates a new custom event which includes the value as well as the key in the event. This will result in bigger event payloads compared with default events, but if combined with filtering, it can reduce its network bandwidth cost.</p> </div> <div class="paragraph"> <p>In another converter implementation, the user could decide to send back an event that contains no key or event type information. This would result in extremely lightweight events at the expense of richness of information provided by the event itself.</p> </div> <div class="paragraph"> <p>Plugging the server with this converter requires deploying this converter factory (and associated converter class) within a jar file including a service definition inside the META-INF/services/org.infinispan.notifications.cachelistener.filter.CacheEventConverterFactory file:</p> </div> <div class="paragraph"> <p>With the server plugged with the converter, the next step is adding a remote client listener that will use this converter. How to implement a listener for custom events is slightly different to the listeners we&#8217;ve seen in the last couple of blog posts because we know have to deal with customised events as opposed to the default ones. To do so, the same annotations are used as previous blog posts, but the callbacks receive instances of org.infinispan.client.hotrod.event.ClientCacheEntryCustomEvent&lt;T&gt;, where T is the type of custom event we are sending from the server:</p> </div> <div class="paragraph"> <p>Now it&#8217;s time to write a simple main java class which adds the remote event listener and executes some operations against the remote cache:</p> </div> <div class="paragraph"> <p>Once executed, we should see a console console output similar to this:</p> </div> <div class="paragraph"> <p>Similar to events, converters can also act on client provided information, enabling converter instances to customize events depending on the information given when the listener was added. The API provides an extra parameter to pass in converter parameters when the listener is added. Given the similarities with filtering, this part is not covered by this blog post.</p> </div> <div class="paragraph"> <p>A final note on the marshalling aspects of this example. In order to facilitate both server and client writing against type safe APIs, both the client and server need to be aware of custom event type and be able to marshall it. Client side, this is done by an optional marshaller configurable via the RemoteCacheManager. Server side, this is done by a marshaller recently added to the Hot Rod server configuration.</p> </div> <div class="paragraph"> <p>In the next blog post in the Hot Rod remote events series, we will look at how to receive remote events in a clustered environment, how to deal with failover situations&#8230;&#8203;etc.</p> </div> <div class="paragraph"> <p>Cheers, Galder</p> </div> </div> </div> </div> <a class="label" href="/blog/tags/hotrod/"> hotrod </a> <a class="label" href="/blog/tags/event/"> event </a> <a class="label" href="/blog/tags/remote events/"> remote events </a> <a class="label" href="/blog/tags/7.0/"> 7.0 </a> <hr> <div class="post"></div> <h3> Wednesday, 20 August 2014 </h3> <h1> <a href="/blog/2014/08/20/hot-rod-remote-events-2-filtering-events/">Hot Rod Remote Events #2: Filtering events</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>This blog post is the second in a series that looks at the forthcoming Hot Rod Remote Events functionality included in Infinispan 7.0. In the <a href="http://blog.infinispan.org/2014/08/hot-rod-remote-events-1-getting-started.html">first blog post</a> we looked at how to get started receiving remote events from Hot Rod servers. This time we are going to focus on how to filter events directly in the server.</p> </div> <div class="paragraph"> <p>Sending events to remote clients has a cost which increases as the number of clients. The more clients register remote listeners, the more events the server has to send. This cost also goes up as the number of modifications are executed against the cache. The more cache modifications, the more events that need to be sent.</p> </div> <div class="paragraph"> <p>A way to reduce this cost is by filtering the events to send server-side. If at the server level custom code decides that clients are not interested in a particular event, the event does not even need to leave the server, improving the overall performance of the system.</p> </div> <div class="paragraph"> <p>Remote event filters are created by implementing a org.infinispan.notifications.cachelistener.filter.CacheEventFilterFactory class. Each factory must have a name associated to it via the org.infinispan.notifications.cachelistener.filter.NamedFactory annotation.</p> </div> <div class="paragraph"> <p>When a listener is added, we can provide the name of a key value filter factory to use with this listener, and when the listener is added, the server will look up the factory and invoke getFilter method to get a org.infinispan.notifications.cachelistener.filter.CacheEventFilterFactory class instance to filter events server side.</p> </div> <div class="paragraph"> <p>Filtering can be done based on key or value information, and even based on cached entry metadata. Here&#8217;s a sample implementation which will filter key "2" out of the events sent to clients:</p> </div> <div class="paragraph"> <p>Plugging the server with this key value filter requires deploying this filter factory (and associated filter class) within a jar file including a service definition inside the META-INF/services/org.infinispan.notifications.cachelistener.filter.CacheEventFilterFactory file:</p> </div> <div class="paragraph"> <p>With the server plugged with the filter, the next step is adding a remote client listener that will use this filter. For this example, we&#8217;ll extend the EventLogListener implementation provided in the <a href="http://blog.infinispan.org/2014/08/hot-rod-remote-events-1-getting-started.html">first blog post</a> in the series and we override the @ClientListener annotation to indicate the filter factory to use with this listener:</p> </div> <div class="paragraph"> <p>Next, we add the listener via the RemoteCache API and we execute some operations against the remote cache:</p> </div> <div class="paragraph"> <p>If we checkout the system output we&#8217;ll see that the client receives events for all keys except those that have been filtered:</p> </div> <div class="paragraph"> <p>Finally, with Hot Rod remote events we have tried to provide additional flexibility at the client side, which is why when adding client listeners, users can provide parameters to the filter factory so that filter instances with different behaviours can be generated out of a single filter factory based on client side information. To show this in action, we are going to enhance the filter factory above so that instead of filtering on a statically given key, it can filter dynamically based on the key provided when adding the listener. Here&#8217;s the revised version:</p> </div> <div class="paragraph"> <p>Finally, here&#8217;s how we can now filter by "3" instead of "2":</p> </div> <div class="paragraph"> <p>And the output:</p> </div> <div class="paragraph"> <p>To summarise, we&#8217;ve seen how Hot Rod remote events can be filtered providing key/value filter factories that can create instances that filter which events are sent to clients, and how these filters can act on client provided information.</p> </div> <div class="paragraph"> <p>In the next blog post, we&#8217;ll look at how to customize remote events in order to reduce the amount of information sent to the clients, or on the contrary, provide even more information to our clients.</p> </div> <div class="paragraph"> <p>Cheers, Galder</p> </div> </div> </div> </div> <a class="label" href="/blog/tags/hotrod/"> hotrod </a> <a class="label" href="/blog/tags/event/"> event </a> <a class="label" href="/blog/tags/remote events/"> remote events </a> <a class="label" href="/blog/tags/7.0/"> 7.0 </a> <hr> <div class="post"></div> <h3> Tuesday, 12 August 2014 </h3> <h1> <a href="/blog/2014/08/12/hot-rod-remote-events-1-getting-started/">Hot Rod Remote Events #1: Getting started</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Shortly after the first Hot Rod server implementation was released in 2010, <a href="https://issues.jboss.org/browse/ISPN-374">ISPN-374</a> was created requesting cache events to be forwarded back to connected clients. Even though embedded caches have had access to these events since Infinispan&#8217;s first release, propagating them to remote clients has taken a while, due to the increased complexity involved.</p> </div> <div class="paragraph"> <p>For Infinispan 7.0, we&#8217;ve finally addressed this. This is the first post in a series that looks at Hot Rod Remote Events and the different functionality we&#8217;ve implemented for this release. On this first post, we show you how to get started with Hot Rod Remote Events with the most basic of examples:</p> </div> <div class="paragraph"> <p>Start by downloading the Server distribution for the latest 7.0 (or higher) release from <a href="http://infinispan.org/download/">Infinispan&#8217;s download page</a>. The server contains the Hot Rod server with which the client will communicate. Once downloaded, start it up running the following from the root of the server:</p> </div> <div class="paragraph"> <div class="title">/bin/standalone.sh</div> <p>Next up, we need to write a little application that interacts with the Hot Rod server. If you&#8217;re using Maven, create an application with this dependency, changing version to 7.0.0.Beta1 or higher:</p> </div> <div class="paragraph"> <p>If not using Maven, adjust according to your chosen build tool or download the all distribution with all Infinispan jars.</p> </div> <div class="paragraph"> <p>With the application dependencies in place, we need to start to write the client application. We&#8217;ll start with a simple remote event listener that simply logs all events received:</p> </div> <div class="paragraph"> <p>Now it&#8217;s time to write a simple main java class which adds the remote event listener and executes some operations against the remote cache:</p> </div> <div class="paragraph"> <p>Once executed, we should see a console console output similar to this:</p> </div> <div class="paragraph"> <p>As you can see from the output, by default events come with the key and the internal data version associated with the current value. The actual value is not shipped back to the client for performance reasons. Clearly, receiving remote events has a cost, and as the cache size increases and more operations are executed, more events will be generated. To avoid inundating Hot Rod clients, remote events can either be filtered server side, or the event contents can be customised. In the next blog post in this series, we will see this functionality in action.</p> </div> <div class="paragraph"> <p>Cheers, Galder</p> </div> </div> </div> </div> <a class="label" href="/blog/tags/hotrod/"> hotrod </a> <a class="label" href="/blog/tags/event/"> event </a> <a class="label" href="/blog/tags/remote events/"> remote events </a> <a class="label" href="/blog/tags/7.0/"> 7.0 </a> <hr> <div class="pagination-links"><a href="/blog/tags/hotrod/" class="previous-link">Previous</a> <a href="/blog/tags/hotrod/" class="page-link">1</a> <span class="current-page">2</span> <a href="/blog/tags/hotrod/page/3/" class="page-link">3</a> <a href="/blog/tags/hotrod/page/4/" class="page-link">4</a> <a href="/blog/tags/hotrod/page/3/" class="next-link">Next</a> </div> </div> <footer class="container"> <hr> <div class="row"> <div class="col-md-2 col-md-offset-1"> <h4>Navigate</h4> <ul> <li> <a href="/about" title="About">About</a> </li> <li> <a href="/documentation" title="Learn">Learn</a> </li> <li> <a href="/community" title="Community">Community</a> </li> <li> <a href="/getinvolved" title="Get Involved">Get Involved</a> </li> <li> <a href="/download" title="Download">Download</a> </li> </ul> </div> <div class="col-md-2"> <h4>Contribute</h4> <ul> <li> <a href="https://issues.jboss.org/browse/ISPN" title="Submit a bug">Submit a bug</a> </li> <li> <a href="https://github.com/infinispan" title="Write code">Write Code</a> </li> </ul> <h4>Follow Us</h4> <ul> <li> <a href="https://blog.infinispan.org" title="Blog">Blog</a> </li> <li> <a href="https://twitter.com/infinispan" title="Twitter">Twitter</a> </li> </ul> </div> <div class="col-md-2"> <h4>Open Source</h4> <p> Infinispan is released under the <b>Apache 2.0 open source license.</b> Learn more about the Apache 2.0 license <a href="https://www.apache.org/licenses/LICENSE-2.0">here.</a> </p> </div> <div class="col-md-2"> <h4>A member of</h4> <a alt="CloudTM" href="http://www.cloudtm.eu/" target="_NEW"> <img src="/images/cloudtm.png"> </a> <a alt="LEADS" href="http://leads-project.eu/" target="_NEW"> <img src="/images/leads.png"> </a> <a alt="CloudButton" href="http://cloudbutton.eu/" target="_NEW"> <img src="/images/cloudbutton.png"> </a> </div> <div class="col-md-2"> <h4>Thanks to</h4> <p>JetBrains Intellij IDEA</p> <a alt="JetBrains Intellij IDEA" href="https://www.jetbrains.com/idea/" target="_NEW"> <img src="/images/icon_IntelliJIDEA.png"> </a> </div> </div> <div class="col-md-10"> <p style="margin-top: 5px; font-size: 80%;"> © Copyright 2009-2019 Red Hat, Inc. <br> <i class="icon-fire"></i> Made with <a href="https://github.com/jbossorg/bootstrap-community" style="text-decoration: underline;" target="_NEW">JBoss Community Bootstrap</a> and <a href="http://awestruct.org/" style="text-decoration: underline;" target="_NEW">Awestruct</a> <br> <i class="icon-globe"></i> This website is open source! If you want to improve it, <a href="https://github.com/infinispan/infinispan.github.io" style="text-decoration: underline;" target="_NEW">fork the project,</a> and hack on it, then send a pull request. You can also view the <a href="https://www.seethestats.com/site/infinispan.org" style="text-decoration: underline;" target="_NEW">visitor stats.</a> <br> <i class="icon-share"></i> Website and documentation released under <a href="https://creativecommons.org/licenses/by/3.0/" style="text-decoration: underline;" target="_NEW">CC BY 3.0.</a> </p> </div> </footer> <div class="container" id="companyfooter"> <div class="redhatlogo"> <div id="logospacer"></div> <a href="http://www.redhat.com/"><img src="//static.jboss.org/theme/images/common/redhat_logo.png"></a> </div> </div> <span class="backToTop"> <a href="#top">back to top</a> </span> <script src="//static.jboss.org/theme/js/libs/bootstrap-community/3.2.0.2/bootstrap-community.min.js"></script> <script>
        if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
          _satellite.pageBottom();
        }
      </script> </div> </body> </html>