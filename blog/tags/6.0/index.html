<!DOCTYPE html> <html lang="en"> <head> <title>Blog - Infinispan</title> <meta charset="utf-8"> <meta content="width=device-width, initial-scale=1.0" name="viewport"> <meta content="DENY" http-equiv="X-Frame-Options"> <meta content="1; mode=block" http-equiv="X-XSS-Protection"> <meta content="nosniff" http-equiv="X-Content-Type-Options"> <link href="https://static.jboss.org/theme/css/bootstrap-community/3.2.0.2/bootstrap-community.min.css" media="screen" rel="stylesheet"> <link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" rel="stylesheet"> <script id="dpal" src="https://www.redhat.com/dtm.js" type="text/javascript"></script> <link href="/images/favicon.png" rel="shortcut icon" type="image/png"> <link href="//static.jboss.org/images/example/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144"> <link href="//static.jboss.org/images/example/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114"> <link href="//static.jboss.org/images/example/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72"> <link href="//static.jboss.org/images/example/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed"> <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" rel="stylesheet"> <link href="https://static.jboss.org/css/rhbar.css" media="screen" rel="stylesheet"> <style>
      .jumbotron {
        padding: 0.5em 0.1em 0.5em 0.1em;
        background-image: none;
        background-color: #ffec9f;
      }
      .jumbotron p, 
      .jumbotron h1 {
        color: #656565;
      }
      .dropup {
        z-index: 1032;
      }
      .navbar {
        font-size: x-large;
      }
      .navbar ul {
        padding-top: 0.7em;
      }
      .navbar-brand {
        height: 80px;
      }
      .navbar-default {
        background-color: white;
      }
      .navbar-default .navbar-nav > li > a {
        color: #336699;
      }
      .navbar-default .navbar-nav > li > a:hover {
        color: #204060;
      }
      .navbar-default .navbar-nav > .open > a,
      .navbar-default .navbar-nav > .open > a:hover,
      .navbar-default .navbar-nav > .open > a:focus {
        background-color: #4a5d75;
      }
      h3.well {
        border-color: #ffd630;
        background-color: #ffec9f;
      }
      .panel-sidebar {
        border-color: #f5f5f5;
      }
      .panel-sidebar > .panel-heading {
        border-color: #e3e3e3;
        background-color: #f5f5f5;
        color: #656565;
      }
      .btn-primary {
        border-color: #ffd630;
        background-color: #ffec9f;
        color: #656565;
      }
      footer.container {
        background-color: white;
      }
      footer.container h1, footer.container h2, footer.container h3, footer.container h4, footer.container h5, footer.container h6, footer.container p, footer.container a {
        color: #656565;
      }
      footer.container ul {
        padding: 0;
      }
      i.enormous-icon {
        margin-top: 0.3em;
      }
      .home-examples {
        font-size: 16px;
      }
    </style> <script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.min.js"></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script> <script>
      hljs.initHighlightingOnLoad();
    </script> <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
     
    ga('create', 'UA-8601422-1', 'auto');
    ga('send', 'pageview');
    
    </script> </head> <body> <div id=""> <ul class="visuallyhidden" id="top"> <li> <a accesskey="n" href="#nav" title="Skip to navigation">Skip to navigation</a> </li> <li> <a accesskey="c" href="#page" title="Skip to content">Skip to content</a> </li> </ul> <div id="rhbar"> <a class="jbdevlogo" href="http://www.jboss.org/projects/about"></a> <a class="rhlogo" href="http://www.redhat.com/"></a> </div> <div class="container" id="content"> <nav class="navbar navbar-default navbar-fixed-top"> <div class="container"> <div class="navbar-header"> <button aria-expanded="false" class="navbar-toggle collapsed" data-target="#thenavbar" data-toggle="collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/"> <img alt="Infinispan" src="/images/infinispan_nav_brand.png"> </a> </div> <div class="navbar-collapse collapse" id="thenavbar"> <ul class="nav navbar-nav"> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/about">About <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/about">Introduction</a></li> <li><a href="/features">Features</a></li> <li><a href="/release-notes">Release notes</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/references">References</a></li> <li><a href="/experiments/">Experiments</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/documentation">Learn <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/documentation">Documentation</a></li> <li><a href="/tutorials">Tutorials</a></li> <li><a href="/videos">Videos</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/download">Download <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/download">Infinispan Releases</a></li> <li><a href="/cache-store-implementations">Cache Store Implementations</a></li> <li><a href="/hotrod-clients">Hot Rod Clients</a></li> <li><a href="/integrations">Integrations</a></li> <li><a href="/download-archive">Archive</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/community">Community <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/community">Ask for Help</a></li> <li><a href="/getinvolved">Get Involved</a></li> </ul> </li> <li class=""><a href="/roadmap">Road Map</a></li> <li class="divider"></li> </ul> </div> </div> </nav> <div class="post"></div> <h3> Thursday, 05 June 2014 </h3> <h1> <a href="/blog/2014/06/05/mapreduce-performance-improvements/">Map/Reduce Performance improvements between Infinispan 6 and 7</a> </h1> <div class="content"> <div class="sect1"> <h2 id="_introduction"><a class="anchor" href="#_introduction"></a>Introduction</h2> <div class="sectionbody"> <div class="paragraph"> <p>There have been a number of recent Infinispan 7.0 Map/Reduce performance related <a href="https://issues.jboss.org/browse/ISPN-4241?filter=12321790">improvements</a> that we were eager to test in our performance lab and subsequently share with you. The results are more than promising. In the word count use case, Map/Reduce task execution speed and throughput improvement is between fourfold and sixfold in certain situations that were tested.</p> </div> <div class="paragraph"> <p>We have achieved these improvements by focusing on:</p> </div> <div class="ulist"> <ul> <li> <p>Optimized mapper/reducer parallel execution on all nodes</p> </li> <li> <p>Improving the handling and processing of larger data sets</p> </li> <li> <p>Reducing the amount of memory needed for execution of MapReduceTask</p> </li> </ul> </div> </div> </div> <div class="sect1"> <h2 id="_performance_test_results"><a class="anchor" href="#_performance_test_results"></a>Performance Test Results</h2> <div class="sectionbody"> <div class="paragraph"> <p>The performance tests were run using the following parameters:</p> </div> <div class="ulist"> <ul> <li> <p>An Infinispan 7.0.0-SNAPSHOT build created after the last commits from the list were committed to the Infinispan GIT repo on May 9th vs Infinispan 6.0.1.Final </p> </li> <li> <p>OpenJDK version 1.7.0_55 with 4GB of heap and the following JVM options:</p> </li> <li> <p>Random data filled 30% of the Java heap, and 100 random words were used to create the 8 kilobyte cache values. The cache keys were generated using key affinity, so that the generated data would be distributed evenly in the cache. These values were chosen, so that a comparison to Infinispan 6 could be made. Infinispan 7 can handle a final result map with a much larger set of keys than is possible in Infinispan 6. The actual amount of heap size that is used for data will be larger due to backup copies, since the cluster is running in distributed mode.</p> </li> <li> <p>The MapReduceTask executes a word count against the cache values using <a href="https://github.com/infinispan/infinispan/blob/master/demos/distexec/src/main/java/org/infinispan/demo/mapreduce/WordCountMapperEmitPerValue.java">mapper</a>, <a href="https://github.com/infinispan/infinispan/blob/master/demos/distexec/src/main/java/org/infinispan/demo/mapreduce/WordCountReducer.java">reducer, combiner</a>, and <a href="https://github.com/infinispan/infinispan/blob/master/demos/distexec/src/main/java/org/infinispan/demo/mapreduce/WordCountCollator.java">collator</a> implementations. The collator returns the 10 most frequently occurring words in the cache data. The task used a distributed reduce phase and a shared intermediate cache. The MapReduceTask is executed 10 times against the data in the cache and the values are reported as an average of these durations.</p> </li> </ul> </div> <div class="sect2"> <h3 id="_from_1_to_8_nodes_using_a_fixed_amount_of_data_and_30_of_the_heap"><a class="anchor" href="#_from_1_to_8_nodes_using_a_fixed_amount_of_data_and_30_of_the_heap"></a>From 1 to 8 nodes using a fixed amount of data and 30% of the heap</h3> <div class="paragraph"> <p>This test executes two word count executions on each cluster with an increasing number of nodes. The first execution uses an increasing amount of data equal to 30% of the total Java heap across the cluster (i.e. With one node, the data consumes 30% of 4 GB. With two nodes, the data consumes 30% of 8 GB, etc.), and the second execution uses a fixed amount of data, (1352 MB which is approximately 30% of 4 GB). Throughput is calculated by dividing the total amount of data processed by the Map/Reduce task by the duration. The following charts show the throughput as nodes are added to the cluster for these two scenarios:</p> </div> <div class="paragraph"> <p><a href="http://3.bp.blogspot.com/-TZD4uFGgkuc/U5ApZx-8KGI/AAAAAAAAABo/VSJkbhFFnDg/s1600/ISPN_6_fixed_size_and_30%25_throughput.png"><span class="image"><img src="http://3.bp.blogspot.com/-TZD4uFGgkuc/U5ApZx-8KGI/AAAAAAAAABo/VSJkbhFFnDg/s1600/ISPN_6_fixed_size_and_30%25_throughput.png" alt="image"></span></a></p> </div> <div class="paragraph"> <p><a href="http://3.bp.blogspot.com/-pCrAYjE-GF4/U5ApZ1CkjXI/AAAAAAAAABs/5FNXfsU-eBc/s1600/ISPN_7_fixed_size_and_30%25_throughput.png"><span class="image"><img src="http://3.bp.blogspot.com/-pCrAYjE-GF4/U5ApZ1CkjXI/AAAAAAAAABs/5FNXfsU-eBc/s1600/ISPN_7_fixed_size_and_30%25_throughput.png" alt="image"></span></a></p> </div> <div class="paragraph"> <p>These charts clearly show the increase in throughput that were made in Infinispan 7. The throughput also seems to scale in an almost linear fashion for this word count scenario. With one node, Infinispan 7 processes the 30% of heap data in about 100 MB/sec, two nodes process almost 200 MB/sec, and 8 nodes process over 700 MB/sec.</p> </div> </div> <div class="sect2"> <h3 id="_from_1_to_8_nodes_using_different_heap_size_percentages"><a class="anchor" href="#_from_1_to_8_nodes_using_different_heap_size_percentages"></a>From 1 to 8 nodes using different heap size percentages</h3> <div class="paragraph"> <p>This test executes the word count task using different percentages of heap size as nodes are added to the cluster. (5%, 10%, 15%, 20%, 25%, and 30%) Here are the throughput results for this test:</p> </div> <div class="paragraph"> <p><a href="http://2.bp.blogspot.com/-exDRqNYcquI/U5AqAFGveiI/AAAAAAAAAB4/Yqn0_j6bL-w/s1600/ISPN6_multi_ram_percent_throughput.png"><span class="image"><img src="http://2.bp.blogspot.com/-exDRqNYcquI/U5AqAFGveiI/AAAAAAAAAB4/Yqn0_j6bL-w/s1600/ISPN6_multi_ram_percent_throughput.png" alt="image"></span></a>http://2.bp.blogspot.com/-fqmkYkxZtyI/U5AqS08Xk9I/AAAAAAAAACA/_wsTOmSbkdc/s1600/ISPN7_multi_ram_percent_throughput.png[<span class="image"><img src="http://2.bp.blogspot.com/-fqmkYkxZtyI/U5AqS08Xk9I/AAAAAAAAACA/_wsTOmSbkdc/s1600/ISPN7_multi_ram_percent_throughput.png" alt="image"></span>]</p> </div> <div class="paragraph"> <p>Once again, these charts show an increase in throughput when performing the same word count task using Infinispan 7. The chart for Infinispan 7 shows more fluctuation in the throughput across the different percentages of heap size. The throughput plotted in the Infinispan 6 chart is more consistent.</p> </div> </div> <div class="sect2"> <h3 id="_from_1_to_8_nodes_using_different_value_sizes"><a class="anchor" href="#_from_1_to_8_nodes_using_different_value_sizes"></a>From 1 to 8 nodes using different value sizes</h3> <div class="paragraph"> <p>This test executes the word count task using 30% of the heap size and different cache value sizes as nodes are added to the cluster. (1KB, 2KB, 4KB, 8KB, 16KB, 32KB, 64KB, 128KB, 256KB, 512KB, 1MB, and 2MB) Here are the throughput results for this test:</p> </div> <div class="paragraph"> <p><a href="http://3.bp.blogspot.com/-Roq8XeAB9Tw/U48EUKEGezI/AAAAAAAAABQ/tM3VSPv8iik/s1600/ISPN6_multi_value_size_throughput.png"><span class="image"><img src="http://3.bp.blogspot.com/-Roq8XeAB9Tw/U48EUKEGezI/AAAAAAAAABQ/tM3VSPv8iik/s1600/ISPN6_multi_value_size_throughput.png" alt="image"></span></a></p> </div> <div class="paragraph"> <p><a href="http://4.bp.blogspot.com/-GSUDu54xlXg/U48EVvvhcbI/AAAAAAAAABY/bUI1o2YFUpY/s1600/ISPN7_multi_value_size_throughput.png"><span class="image"><img src="http://4.bp.blogspot.com/-GSUDu54xlXg/U48EVvvhcbI/AAAAAAAAABY/bUI1o2YFUpY/s1600/ISPN7_multi_value_size_throughput.png" alt="image"></span></a></p> </div> <div class="paragraph"> <p>These results are more interesting. The throughput in Infinispan 7 is higher for certain cache size values, but closer to Infinispan 6 or even slower for other cache size values. The throughput peaks for 32KB cache values, but can be much lower for larger and smaller values. Smaller values require more overhead, but for larger values this behavior is not expected. This result needs to be investigated more closely.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_conclusion"><a class="anchor" href="#_conclusion"></a>Conclusion</h2> <div class="sectionbody"> <div class="paragraph"> <p>The performance tests show that Infinispan 7 Map/Reduce improvements have increased the throughput and execution speed four to sixfold in some use cases. The changes have also allowed Infinispan 7 to process data sets that include larger intermediate results and produce larger final result maps. There are still areas of the Map/Reduce algorithm that need to be improved:</p> </div> <div class="ulist"> <ul> <li> <p>The Map/Reduce algorithm should be self-tuning. The <a href="https://github.com/infinispan/infinispan/blob/master/core/src/main/java/org/infinispan/distexec/mapreduce/MapReduceTask.java#L400">maxCollectorSize</a> parameter controls the number of values that the collector holds in memory, and it is not trivial to determine the optimal value for a given scenario. The value is based on the size of the values in the cache and the size of the intermediate results. A user is likely to know the size of the cache values, but currently <a href="https://issues.jboss.org/browse/ISPN-4318">Infinispan does not report statistics</a> about the intermediate results to the user. The Map/Reduce algorithm should analyze the environment at runtime and adjust the size of the collector dynamically.</p> </li> <li> <p>The fact that the throughput results vary with different value sizes needs to be investigated more closely. This could be due to the fact that the maxCollectorSize value used for these tests is not ideal for all value sizes, but there might be other causes for this behaviour.</p> </li> </ul> </div> </div> </div> </div> <a class="label" href="/blog/tags/radargun/"> radargun </a> <a class="label" href="/blog/tags/benchmarks/"> benchmarks </a> <a class="label" href="/blog/tags/performance/"> performance </a> <a class="label" href="/blog/tags/map reduce/"> map reduce </a> <a class="label" href="/blog/tags/7.0/"> 7.0 </a> <a class="label" href="/blog/tags/6.0/"> 6.0 </a> <hr> <div class="post"></div> <h3> Wednesday, 19 March 2014 </h3> <h1> <a href="/blog/2014/03/19/infinispan-602final-includes-asl2/">Infinispan 6.0.2.Final includes ASL2-licensed JBoss Marshalling</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>We&#8217;ve just released Infinispan 6.0.2.Final to address a licensing issue we were having with JBoss Marshalling. Infinispan switched to ASL2 license when Infinispan 6.0.0 was released, but one of its dependencies, JBoss Marshalling, was still licensed under LGPL. JBoss Marshalling 1.4.4.Final, included in Infinispan 6.0.2.Final, <a href="https://github.com/dmlloyd/jboss-marshalling/blob/master/LICENSE.txt">has been licensed under ASL2</a>.</p> </div> <div class="paragraph"> <p>The release can be found in the usual places.</p> </div> <div class="paragraph"> <p>Cheers, Galder</p> </div> </div> </div> </div> <a class="label" href="/blog/tags/marshalling/"> marshalling </a> <a class="label" href="/blog/tags/6.0/"> 6.0 </a> <a class="label" href="/blog/tags/License/"> License </a> <a class="label" href="/blog/tags/asl2/"> asl2 </a> <hr> <div class="post"></div> <h3> Tuesday, 19 November 2013 </h3> <h1> <a href="/blog/2013/11/19/infinispan-600final-is-out/">Infinispan 6.0.0.Final is out!</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div id="docs-internal-guid-54debdf5-71e3-c43d-f1fc-150a34a883db" class="paragraph"> <p>Dear Infinispan community,</p> </div> <div class="paragraph"> <p>We&#8217;re pleased to announce the final release of Infinispan 6.0 "Infinium". As <a href="http://infinispan.blogspot.co.uk/2013/05/infinispan-to-adopt-apache-software.html">announced</a>, this is the first Infinispan stable version to be released under the terms of <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License v2.0</a>.</p> </div> <div class="paragraph"> <p>This release brings some highly demanded features besides many stability enhancements and bug fixes:</p> </div> <div class="ulist"> <ul> <li> <p>Support for <a href="http://blog.infinispan.org/2013/09/embedded-and-remote-query-in-infinispan.html">remote query</a>. It is now possible for the HotRod clients to query an Infinispan grid using a new expressive query DSL. This querying functionality is built on top of Apache Lucene and Google Protobuf and lays the foundation for storing information and querying an Infinispan server in a language neutral manner. The Java HotRod client has already been enhanced to support this, the soon-to-be announced C++ HotRod client will also contain this functionality (initially for write/read, then full blown querying).</p> </li> <li> <p>C HotRod client.  Allows C applications to read and write information from an Infinispan server. This is a fully fledged HotRod client that is topology (level 2) and consistent hash aware (level 3) and will be released in the following days. Some features (such as Remote Query and SSL support) will be developed during the next iteration so that it maintains feature parity with its Java counterpart.</p> </li> <li> <p>Better persistence integration. We’ve revisited the entire cache loader API and we’re quite pleased with the result: the new <a href="http://blog.infinispan.org/2013/09/new-persistence-api-in-infinispan.html">Persistence API</a> brought by Infinispan 6.0 supports parallel iteration of the stored entries, reduces the overall serialization overhead and also is aligned with the <a href="http://jcp.org/en/jsr/detail?id=107">JSR-107</a> specification, which makes implementations more portable.</p> </li> <li> <p>A more efficient FileCacheStore <a href="http://blog.infinispan.org/2013/07/faster-file-cache-store-no-extra.html">implementation</a>. This file store is built with efficiency in mind: it outperforms the existing file store with up to 2 levels of magnitude. This comes at a cost though, as keys need to be kept  in memory. Thanks to <a href="https://github.com/kblees">Karsten Blees</a> for contributing this!</p> </li> <li> <p>Support for <a href="http://blog.infinispan.org/2013/09/heterogenous-clusters-with-infinispan.html">heterogeneous clusters</a>. Up to this release, every member of the cluster owns an equal share of the cluster’s data. This doesn’t work well if one machine is more powerful than the other cluster participants. This functionality allows specifying the amount of data, compared with the average, held by a particular machine.</p> </li> <li> <p>A new set of usage and performance <a href="https://issues.jboss.org/browse/ISPN-2861">statistics</a> developed within the scope of the CloudTM projecthttps://issues.jboss.org/browse/ISPN-3234[].</p> </li> <li> <p><a href="https://issues.jboss.org/browse/ISPN-3234">JCache</a> (JSR-107) implementation upgrade. First released in Infinispan 5.3.0, the standard caching support is now upgraded to version 1.0.0-PFD.</p> </li> </ul> </div> <div class="paragraph"> <p>For a complete list of features included in this release please refer to the <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12322480">release notes</a>.</p> </div> <div class="paragraph"> <p>The user documentation for this release has been revamped and migrated to the <a href="http://infinispan.org/documentation/">new website</a> - we think it looks much better and hope you’ll like it too!</p> </div> <div class="paragraph"> <p>This release has spread over a period of 5 months: a sustained effort from the core development team, QE team and our growing community - a BIG thanks to everybody involved! Please visit our <a href="http://infinispan.org/download/">downloads</a> section to find the latest release. Also if you have any questions please check our <a href="http://infinispan.org/community/">forums</a>, our <a href="https://lists.jboss.org/mailman/listinfo/infinispan-dev">mailing lists</a> or ping us directly on <a href="irc://irc.freenode.org/infinispan">IRC</a>.</p> </div> <div class="paragraph"> <p>Cheers,</p> </div> <div class="paragraph"> <p>Adrian</p> </div> </div> </div> </div> <a class="label" href="/blog/tags/hotrod/"> hotrod </a> <a class="label" href="/blog/tags/persistence/"> persistence </a> <a class="label" href="/blog/tags/jsr 107/"> jsr 107 </a> <a class="label" href="/blog/tags/jcache/"> jcache </a> <a class="label" href="/blog/tags/Protobuf/"> Protobuf </a> <a class="label" href="/blog/tags/remote query/"> remote query </a> <a class="label" href="/blog/tags/6.0/"> 6.0 </a> <a class="label" href="/blog/tags/query/"> query </a> <hr> <div class="post"></div> <h3> Thursday, 26 September 2013 </h3> <h1> <a href="/blog/2013/09/26/embedded-and-remote-queries-in/"> Embedded and remote queries in Infinispan 6.0.0.Beta1</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>If you&#8217;re following Infinispan&#8217;s mailing lists you&#8217;ve probably caught a glimpse of the new developments in the Query land: a new DSL, remote querying via Hot Rod client, a new marshaller based on Google&#8217;s Protobuf. Time to unveil these properly!</p> </div> <div class="exampleblock"> <div class="content"> <div class="paragraph"> <p>==== The new Query DSL</p> </div> </div> </div> <div class="paragraph"> <p>Starting with version 6.0 Infinispan offers a new (experimental) way of running queries against your cached entities based on a simple filtering DSL. The aim of the new DSL is to simplify the way you write queries and to be agnostic of the underlying query mechanism(s) making it possible to provide alternative query engines in the future besides Lucene and still being able to use the same query language/API. The previous Hibernate Search &amp; Lucene based <a href="https://docs.jboss.org/author/display/ISPN/Querying+Infinispan">approach</a> is still in place and will continue to be supported and in fact the new DSL is currently implemented right on top of it. The future will surely bring index-less searching based on map-reduce and possibly other new cool search technologies.</p> </div> <div class="paragraph"> <p>Running DSL-based queries in embedded mode is almost identical to running the existing Lucene-based queries. All you need to do is have infinispan-query-dsl.jar and infinispan-query.jar in your classpath (besides Infinispan and its dependecies), enable indexing for your caches, annotate your POJO cache values and your&#8217;re ready.</p> </div> <div class="paragraph"> <p>__</p> </div> <div class="literalblock"> <div class="content"> <pre>ConfigurationBuilder cfg = new ConfigurationBuilder();&#x000A;  cfg.indexing().enable();&#x000A;  &#x000A;  DefaultCacheManager cacheManager = new DefaultCacheManager(cfg.build());&#x000A;  &#x000A;  Cache cache = cacheManager.getCache();</pre> </div> </div> <div class="paragraph"> <p>____Alternatively, indexing (and everything else) can also be configured via XML configuration, as already described in the user guide, so we&#8217;ll not delve into details here.</p> </div> <div class="paragraph"> <p>Your Hibernate Search annotated entity might look like this.</p> </div> <div class="paragraph"> <p>__</p> </div> <div class="literalblock"> <div class="content"> <pre>import org.hibernate.search.annotations.*;&#x000A;  ...&#x000A;  &#x000A;  @Indexed&#x000A;  public class User {&#x000A;  &#x000A;      @Field(store = Store.YES, analyze = Analyze.NO)&#x000A;      private String name;&#x000A;  &#x000A;      @Field(store = Store.YES, analyze = Analyze.NO, indexNullAs = Field.DEFAULT_NULL_TOKEN)&#x000A;      private String surname;&#x000A;  &#x000A;      @IndexedEmbedded(indexNullAs = Field.DEFAULT_NULL_TOKEN)&#x000A;      private List addresses;&#x000A;  &#x000A;      // .. the rest omitted for brevity&#x000A;  }</pre> </div> </div> <div class="paragraph"> <p><em>___Running a DSL based query involves obtaining a _https://github.com/infinispan/infinispan/blob/6.0.0.Beta1/query-dsl/src/main/java/org/infinispan/query/dsl/QueryFactory.java[QueryFactory]</em> from the (cache scoped) <em>SearchManager</em> and then constructing the query as follows:</p> </div> <div class="paragraph"> <p>__</p> </div> <div class="literalblock"> <div class="content"> <pre>import org.infinispan.query.Search;&#x000A;  import org.infinispan.query.dsl.QueryFactory;&#x000A;  import org.infinispan.query.dsl.Query;&#x000A;  ...&#x000A;  &#x000A;  QueryFactory qf = Search.getSearchManager(cache).getQueryFactory();&#x000A;  &#x000A;  Query q = qf.from(User.class)&#x000A;      .having("name").eq("John")&#x000A;      .toBuilder().build();&#x000A;  &#x000A;  List list = q.list();&#x000A;  &#x000A;  assertEquals(1, list.size());&#x000A;  assertEquals("John", list.get(0).getName());&#x000A;  assertEquals("Doe", list.get(0).getSurname());</pre> </div> </div> <div class="paragraph"> <p><em>___That&#8217;s it! I&#8217;m sure this raised your curiosity as to what the DSL is actually capable of so you might want to look at the list of supported filter operators in _https://github.com/infinispan/infinispan/blob/6.0.0.Beta1/query-dsl/src/main/java/org/infinispan/query/dsl/FilterConditionEndContext.java[FilterConditionEndContext]</em>. Combining multiple conditions with boolean operators, including sub-conditions, is also possible:</p> </div> <div class="literalblock"> <div class="content"> <pre>Query q = qf.from(User.class)&#x000A;      .having("name").eq("John")&#x000A;      .and().having("surname").eq("Doe")&#x000A;      .and().not(qf.having("address.street").like("%Tanzania%").or().having("address.postCode").in("TZ13", "TZ22"))&#x000A;      .toBuilder().build();</pre> </div> </div> <div class="paragraph"> <p>The DSL is pretty nifty right now and will surely be expanded in the future based on your feedback. It also provides support for result pagination, sorting, projections, embedded objects, all demonstrated in <em><a href="https://github.com/infinispan/infinispan/blob/6.0.0.Beta1/query/src/test/java/org/infinispan/query/dsl/embedded/QueryDslConditionsTest.java">QueryDslConditionsTest</a></em> which I encourage you to look at until the proper user guide is published. Still, this is not a relational database, so keep in mind that all queries are written in the scope of the <em>single</em> targeted entity (and its embedded entities). There are no joins (yet), no correlated subqueries, no grouping or aggregations.</p> </div> <div class="paragraph"> <p>Moving further, probably the most exciting thing about the new DSL is using it remotely via the Hot Rod client. But to make this leap we first had to adopt a common format for storing our cache entries and marshalling them over the wire that would also be cross-language and robust enough to support evolving object schemas. But probably most of all, this format had to have a schema rather than just being an opaque blob otherwise indexing and searching are meaningless. Enter Protocol Buffers.</p> </div> </div> </div> <div class="sect3"> <h4 id="_the_protobuf_marshaller"><a class="anchor" href="#_the_protobuf_marshaller"></a>The Protobuf marshaller</h4> <div class="paragraph"> <p>Configuring the <em>RemoteCacheManager</em> of the Java Hot Rod client to use it is straight forward: __</p> </div> <div class="literalblock"> <div class="content"> <pre>import org.infinispan.client.hotrod.configuration.ConfigurationBuilder;&#x000A;  ...&#x000A;  &#x000A;  ConfigurationBuilder clientBuilder = new ConfigurationBuilder();&#x000A;  clientBuilder.addServer()&#x000A;      .host("127.0.0.1").port(11234)&#x000A;      .marshaller(new ProtoStreamMarshaller());</pre> </div> </div> <div class="paragraph"> <p><em>___Now you&#8217;ll be able to store and get from the remote cache your _User</em> instaces encoded in protobuf format provided that:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>a Protobuf type was declared for your entity in a <em>.proto</em> <a href="https://github.com/infinispan/protostream/blob/1.0.0.Alpha6/sample-domain-definition/src/main/resources/bank.proto">file</a> which was then compiled into a <em>.protobin</em> <a href="https://developers.google.com/protocol-buffers/docs/techniques?hl=ro#self-description">binary descriptor</a></p> </li> <li> <p>the binary descriptor was registered with your <em>RemoteCacheManager</em>'s <em>ProtoStreamMarshaller</em> instance like this: __</p> </li> </ol> </div> <div class="literalblock"> <div class="content"> <pre>ProtoStreamMarshaller.getSerializationContext(remoteCacheManager)&#x000A;      .registerProtofile("my-test-schema.protobin");</pre> </div> </div> <div class="paragraph"> <p><em>__3. a per-entity marshaller was registered: </em></p> </div> <div class="literalblock"> <div class="content"> <pre>ProtoStreamMarshaller.getSerializationContext(remoteCacheManager)&#x000A;      .registerMarshaller(User.class, new UserMarshaller());</pre> </div> </div> <div class="paragraph"> <p><em>___Steps 2 and 3 are closely tied to the way <a href="https://github.com/infinispan/protostream">Protosteam</a> library works, which is pretty straight forward but cannot be detailed here. Having a look at our <a href="https://github.com/infinispan/protostream/blob/1.0.0.Alpha6/sample-domain-implementation/src/main/java/org/infinispan/protostream/sampledomain/marshallers/UserMarshaller.java">_UserMarshaller</em></a> sample should clear this up.</p> </div> <div class="paragraph"> <p>Keeping your objects stored in protobuf format has the benefit of being able to consume them with compatible clients written in other languages. But if this does not sound enticing enough probably the fact they can now be easily indexed should be more appealing.</p> </div> </div> <div class="sect3"> <h4 id="_remote_querying_via_the_hot_rod_client"><a class="anchor" href="#_remote_querying_via_the_hot_rod_client"></a>Remote querying via the Hot Rod client</h4> <div class="paragraph"> <p>Given a <em>RemoteCacheManager</em> configured as previously described the next steps to enable remote query over its caches are:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>add the DSL jar to client&#8217;s classpath, infinispan-remote-query-server.jar to server&#8217;s classpath and infinispan-remote-query-client.jar to both</p> </li> <li> <p>enable indexing in your cache configuration - same as for embedded mode</p> </li> <li> <p>register your protobuf binary descriptor by invoking the '<em>registerProtofile</em>' method of the server&#8217;s <em>ProtobufMetadataManager</em> MBean (one instance per <em>EmbeddedCacheManager</em>)</p> </li> </ol> </div> <div class="paragraph"> <p>All data placed in cache now is being indexed without the need to annotate your entities for Hibernate Search. In fact these classes are only meaningful to the Java client and do not even exist on the server.</p> </div> <div class="paragraph"> <p>Running the queries over the Hot Rod client is now very similar to embedded mode. The DSL is in fact the same. The only part that is slightly different is how you obtain the <em>QueryFactory</em>:</p> </div> <div class="paragraph"> <p>__</p> </div> <div class="literalblock"> <div class="content"> <pre>import org.infinispan.client.hotrod.Search;&#x000A;  import org.infinispan.query.dsl.QueryFactory;&#x000A;  import org.infinispan.query.dsl.Query;&#x000A;  ...&#x000A;  &#x000A;  remoteCache.put(2, new User("John", "Doe", 33));&#x000A;  &#x000A;  QueryFactory qf = Search.getQueryFactory(remoteCache);&#x000A;  &#x000A;  Query query = qf.from(User.class)&#x000A;      .having("name").eq("John")&#x000A;      .toBuilder().build();&#x000A;  &#x000A;  List list = query.list();&#x000A;  assertEquals(1, list.size());&#x000A;  assertEquals("John", list.get(0).getName());&#x000A;  assertEquals("Doe", list.get(0).getSurname());</pre> </div> </div> <div class="paragraph"> <p>__</p> </div> <div class="paragraph"> <p><em> </em> </p> </div> <div class="paragraph"> <p>Voila! The end of our journey for today! Stay tuned, keep an eye on Infinispan Query and please share your comments with us.</p> </div> </div> </div> <a class="label" href="/blog/tags/protostream/"> protostream </a> <a class="label" href="/blog/tags/hotrod/"> hotrod </a> <a class="label" href="/blog/tags/lucene/"> lucene </a> <a class="label" href="/blog/tags/Protobuf/"> Protobuf </a> <a class="label" href="/blog/tags/remote query/"> remote query </a> <a class="label" href="/blog/tags/hibernate search/"> hibernate search </a> <a class="label" href="/blog/tags/6.0/"> 6.0 </a> <a class="label" href="/blog/tags/embedded query/"> embedded query </a> <a class="label" href="/blog/tags/Infinispan Query/"> Infinispan Query </a> <a class="label" href="/blog/tags/DSL/"> DSL </a> <hr> <div class="post"></div> <h3> Thursday, 19 September 2013 </h3> <h1> <a href="/blog/2013/09/19/dear-infinispan-community-we-are-proud/">Infinispan 6.0.0.Beta1 is out!</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Dear Infinispan community,</p> </div> <div class="paragraph"> <p>We are proud to announce the first Beta release of Infinispan 6.0.0. This is an important milestone in the 6.0.0 lifecycle: it is feature and API complete.</p> </div> <div class="paragraph"> <p>Included in this release, you can find:</p> </div> <div class="ulist"> <ul> <li> <p>a complete implementation of the remote-query functionality, including <a href="https://issues.jboss.org/browse/ISPN-3172">index management through JMX </a>.  Adrian Nistor will blog on this in the following days</p> </li> <li> <p><a href="https://issues.jboss.org/browse/ISPN-3051">allow configuring</a> the number of segments per node allows one to configure an uneven load of data between the nodes int the cluster. Dan Berindei will add a blog on this shortly</p> </li> </ul> </div> <div class="paragraph"> <p>Together with this release we&#8217;re also launching our <a href="http://infinispan.org/">new website</a>:</p> </div> <div class="ulist"> <ul> <li> <p> Built with Awestruct.  Yes, it really is awesome and fun to use</p> </li> <li> <p> Hosted on <a href="https://github.com/infinispan/infinispan.github.io">GitHub Pages</a>.  Quick and easy.</p> </li> <li> <p> Styled with JBoss.org Community&#8217;s flavour of Twitter <a href="https://github.com/jbossorg/bootstrap-community">Bootstrap</a> </p> </li> <li> <p> Documentation reformatted/moved from <a href="https://github.com/infinispan/infinispan/tree/5.3.x/documentation">Confluence to AsciiDoc</a> </p> </li> </ul> </div> <div class="paragraph"> <p>Among other things, the new site reflects some changes in the way Infinispan <a href="http://infinispan.org/download/">is distributed</a> - including <a href="http://infinispan.org/cache-store-implementations/">several cache stores</a> and <a href="http://infinispan.org/hotrod-clients/">Hot Rod clients</a> being moved out to separate GitHub repositories and following their own release cycles. </p> </div> <div class="paragraph"> <p>We think it&#8217;s pretty slick and pretty sure you wouldn&#8217;t guess its written by a hardcore backed developer! Kudos to Manik Surtani for such a nice job!</p> </div> <div class="paragraph"> <p>Last but certainly not least,  a BIG thanks to our colleagues from the <a href="http://in.relation.to/Bloggers/HibernateSearch440Alpha2TheFastingBeforeTheCheese">Hibernate</a> team for their support (that is enhancements, fixes and releases and unreasonable hours) in getting the support needed for Infinispan&#8217;s remote query functionality in time!</p> </div> <div class="paragraph"> <p>For a complete list of features and fixes included in this release please refer to the <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12321858">release notes</a><span id="goog_1579863183">[#goog_1579863184]</span><a href="http://www.blogger.com/" class="bare">http://www.blogger.com/</a>. Visit our <a href="http://www.jboss.org/infinispan/downloads">downloads</a> section to find the latest release and if you have any questions please check our <a href="http://www.jboss.org/infinispan/forums">forums</a>, our <a href="https://lists.jboss.org/mailman/listinfo/infinispan-dev">mailing lists</a> or ping us directly on <a href="irc://irc.freenode.org/infinispan">IRC</a>.</p> </div> <div class="paragraph"> <p>Thanks to everyone for their involvement and contribution!</p> </div> <div class="paragraph"> <p>Cheers, Mircea</p> </div> </div> </div> </div> <a class="label" href="/blog/tags/site/"> site </a> <a class="label" href="/blog/tags/remote query/"> remote query </a> <a class="label" href="/blog/tags/6.0/"> 6.0 </a> <a class="label" href="/blog/tags/uneven load/"> uneven load </a> <hr> <div class="post"></div> <h3> Monday, 16 September 2013 </h3> <h1> <a href="/blog/2013/09/16/new-persistence-api-in-infinispan/">New persistence API in Infinispan 6.0.0.Alpha4</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>The existing CacheLoader/CacheStore API has been around since Infinispan 4.0. In this release of Infinispan we&#8217;ve taken a major step forward in both simplifying the integration with persistence and opening the door for some pretty significant performance improvements.</p> </div> </div> </div> <div class="sect1"> <h2 id="_whats_new"><a class="anchor" href="#_whats_new"></a>What&#8217;s new</h2> <div class="sectionbody"> <div class="paragraph"> <p>So here&#8217;s what the new persistence integration brings to the table:</p> </div> <div class="ulist"> <ul> <li> <p>alignment with <a href="http://jcp.org/en/jsr/detail?id=107">JSR-107</a>: now we have a <a href="http://docs.jboss.org/infinispan/6.0/apidocs/org/infinispan/persistence/spi/CacheWriter.html">CacheWriter</a> and <a href="http://docs.jboss.org/infinispan/6.0/apidocs/org/infinispan/persistence/spi/CacheLoader.html">CacheLoader</a> interface similar to the the <a href="https://github.com/jsr107/jsr107spec/blob/master/src/main/java/javax/cache/integration/CacheLoader.java">loader</a> and <a href="https://github.com/jsr107/jsr107spec/blob/master/src/main/java/javax/cache/integration/CacheWriter.java">writer</a> in JSR 107, which should considerably help writing portable stores across JCache compliant vendors</p> </li> <li> <p>simplified transaction integration: all the locking is now handled within the Infinispan layer, so implementors don&#8217;t have to be concerned coordinating concurrent access to the store (old <a href="http://docs.jboss.org/infinispan/4.1/apidocs/org/infinispan/loaders/LockSupportCacheStore.html">LockSupportCacheStore</a> is dropped for that reason).</p> </li> <li> <p>parallel iteration: it is now possible to iterate over entries in the store with multiple threads in parallel. Map/Reduce tasks immediately benefit from this, as the map/reduce  tasks now run in parallel over both the nodes in the cluster and within the same node (multiple threads)</p> </li> <li> <p><a href="https://issues.jboss.org/browse/ISPN-3512">reduced serialization</a> (translated in less CPU usage): the new API allows exposing the stored entries in serialized format. If an entry is fetched from persistent storage for the sole purpose of being sent remotely, we no longer need to deserialize it (when reading from the store) and serialize it back (when writing to the wire). Now we can write to the wire the serialized format as read fro the storage directly</p> </li> </ul> </div> </div> </div> <div class="sect1"> <h2 id="_api"><a class="anchor" href="#_api"></a>API</h2> <div class="sectionbody"> <div class="paragraph"> <p>Now let&#8217;s take a look at the API in more detail:</p> </div> <div class="paragraph"> <p><a href="http://1.bp.blogspot.com/-aqX4MDbuzy4/Ujbq-om6YsI/AAAAAAAAMkQ/taQggrqe7Kc/s1600/new_loader_API.png"><span class="image"><img src="http://1.bp.blogspot.com/-aqX4MDbuzy4/Ujbq-om6YsI/AAAAAAAAMkQ/taQggrqe7Kc/s320/new_loader_API.png" alt="image" width="320" height="305"></span></a></p> </div> <div class="paragraph"> <p>  The diagram above shows the main classes in the API:</p> </div> <div class="ulist"> <ul> <li> <p><a href="http://docs.jboss.org/infinispan/6.0/apidocs/org/infinispan/commons/io/ByteBuffer.html">ByteBuffer</a></p> <div class="ulist"> <ul> <li> <p>abstracts the serialized form on an object</p> </li> </ul> </div> </li> <li> <p><a href="http://docs.jboss.org/infinispan/6.0/apidocs/org/infinispan/persistence/spi/MarshalledEntry.html">MarshalledEntry</a> - abstracts the information held within a persistent store corresponding to a key-value added to the cache. Provides method for reading this information both in serialized (<a href="http://docs.jboss.org/infinispan/6.0/apidocs/org/infinispan/commons/io/ByteBuffer.html">ByteBuffer</a>) and deserialized (Object) format. Normally data read from the store is kept in serialized format and lazily deserialized on demand, within the <a href="http://docs.jboss.org/infinispan/6.0/apidocs/org/infinispan/persistence/spi/MarshalledEntry.html">MarshalledEntry</a> implementation</p> </li> <li> <p> <a href="http://docs.jboss.org/infinispan/6.0/apidocs/org/infinispan/persistence/spi/CacheWriter.html">CacheWriter</a> and <a href="http://docs.jboss.org/infinispan/6.0/apidocs/org/infinispan/persistence/spi/CacheLoader.html">CacheLoader</a>  provide basic methods for reading and writing to a store</p> </li> <li> <p><a href="http://docs.jboss.org/infinispan/6.0/apidocs/org/infinispan/persistence/spi/AdvancedCacheLoader.html">AdvancedCacheLoader</a> and <a href="http://docs.jboss.org/infinispan/6.0/apidocs/org/infinispan/persistence/spi/AdvancedCacheWriter.html">AdvancedCacheWriter</a> provide operations to manipulate the underlaying storage in bulk: parallel iteration and purging of expired entries, clear and size. </p> </li> </ul> </div> <div class="paragraph"> <p>A provider might choose to only implement a subset of these interfaces:</p> </div> <div class="ulist"> <ul> <li> <p>Not implementing the  <a href="http://docs.jboss.org/infinispan/6.0/apidocs/org/infinispan/persistence/spi/AdvancedCacheWriter.html">AdvancedCacheWriter</a> makes the given writer not usable for purging expired entries or clear</p> </li> <li> <p>Not implementing  the <a href="http://docs.jboss.org/infinispan/6.0/apidocs/org/infinispan/persistence/spi/AdvancedCacheLoader.html">AdvancedCacheLoader</a> makes the information stored in the given loader not used for preloading, nor for the map/reduce iteration</p> </li> </ul> </div> <div class="paragraph"> <p>If you&#8217;re looking at migrating your existing store to the new API, looking at the <a href="https://github.com/infinispan/infinispan/blob/master/core/src/main/java/org/infinispan/persistence/file/SingleFileStore.java">SingleFileStore</a>  for inspiration can be of great help.</p> </div> <div class="sect3"> <h4 id="_configuration"><a class="anchor" href="#_configuration"></a>Configuration</h4> <div class="paragraph"> <p>And finally, the way the stores are configured has changed:</p> </div> <div class="ulist"> <ul> <li> <p>the 5.x <em>loaders</em> element is now replaced with <em>persistence</em></p> </li> <li> <p>both the loaders and writers are configured through a unique <em>store</em> element  (vs <em>loader</em> and  <em>store</em>, as allowed in 5.x)</p> </li> <li> <p>the <em>preload</em> and <em>shared</em> attributes are configured at each individual store, giving more flexibility when it comes to configuring multiple chained stores </p> </li> </ul> </div> <div class="paragraph"> <p>Cheers,</p> </div> <div class="paragraph"> <p>Mircea</p> </div> </div> </div> </div> </div> <a class="label" href="/blog/tags/persistence/"> persistence </a> <a class="label" href="/blog/tags/jsr 107/"> jsr 107 </a> <a class="label" href="/blog/tags/loader/"> loader </a> <a class="label" href="/blog/tags/store/"> store </a> <a class="label" href="/blog/tags/performance/"> performance </a> <a class="label" href="/blog/tags/6.0/"> 6.0 </a> <a class="label" href="/blog/tags/API/"> API </a> <hr> <div class="post"></div> <h3> Monday, 09 September 2013 </h3> <h1> <a href="/blog/2013/09/09/infinispan-600alpha4-out-with-new/">Infinispan 6.0.0.Alpha4 out with new CacheLoader/CacheWriter API!</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan 6.0.0.Alpha4 is now with a few very important changes, particularly around cache stores. We&#8217;ve completely revamped the cache store/loader API to align it a bit better with JSR-107 (old CacheStore has become CacheWriter) and to simplify creation of new implementations. The new <a href="https://github.com/infinispan/infinispan/blob/6.0.0.Alpha4/core/src/main/java/org/infinispan/persistence/spi/CacheLoader.java">CacheLoader</a> and <a href="https://github.com/infinispan/infinispan/blob/6.0.0.Alpha4/core/src/main/java/org/infinispan/persistence/spi/CacheWriter.java">CacheWriter</a> should help implementors focus on the important operations and reduce the coding time. We&#8217;ve also created <a href="https://github.com/infinispan/infinispan/blob/6.0.0.Alpha4/core/src/main/java/org/infinispan/persistence/spi/AdvancedCacheLoader.java">AdvancedCacheLoader</a> and <a href="https://github.com/infinispan/infinispan/blob/6.0.0.Alpha4/core/src/main/java/org/infinispan/persistence/spi/AdvancedCacheWriter.java">AdvancedCacheWriter</a> in order to separate for bulk operations or purging for those implementations that wish optionally implement them. Expect a blog post from Mircea in the next few days providing many more details on this topic.</p> </div> <div class="paragraph"> <p>This new Infinispan version comes with other important goodies:</p> </div> <div class="ulist"> <ul> <li> <p>Rolling upgrades of a Infinsipan REST cluster</p> </li> <li> <p>Support for Cache-Control headers for REST operations</p> </li> <li> <p>Remote querying server modules and Hot Rod client update</p> </li> <li> <p>REST and LevelDB stores added to Infinispan Server</p> </li> <li> <p><a href="https://github.com/infinispan/infinispan/blob/6.0.0.Alpha4/core/src/main/java/org/infinispan/notifications/KeyFilter.java">KeyFilters</a> can now be applied to Cache listeners</p> </li> <li> <p>Allow Cache listener events to be invoked only on the primary data owner</p> </li> </ul> </div> <div class="paragraph"> <p>For a complete list of features and fixes included in this release please refer to the <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12321856">release notes</a>. Visit our <a href="http://www.jboss.org/infinispan/downloads">downloads</a> section to find the latest release and if you have any questions please check <a href="http://www.jboss.org/infinispan/forums">our forums</a>, our <a href="https://lists.jboss.org/mailman/listinfo/infinispan-dev">mailing lists</a> or ping us directly on <a href="irc://irc.freenode.org/infinispan">IRC</a>.</p> </div> <div class="paragraph"> <p>Cheers,</p> </div> <div class="paragraph"> <p>Galder</p> </div> </div> </div> </div> <a class="label" href="/blog/tags/release/"> release </a> <a class="label" href="/blog/tags/leveldb/"> leveldb </a> <a class="label" href="/blog/tags/listeners/"> listeners </a> <a class="label" href="/blog/tags/alpha/"> alpha </a> <a class="label" href="/blog/tags/rest/"> rest </a> <a class="label" href="/blog/tags/6.0/"> 6.0 </a> <a class="label" href="/blog/tags/cache store/"> cache store </a> <a class="label" href="/blog/tags/query/"> query </a> <hr> <div class="post"></div> <h3> Thursday, 22 August 2013 </h3> <h1> <a href="/blog/2013/08/22/infinispan-600alpha3-is-out/">Infinispan 6.0.0.Alpha3 is out!</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Dear Infinispan community,</p> </div> <div class="paragraph"> <p>We are proud to announce the last Alpha release of Infinispan 6.0.0,</p> </div> <div class="paragraph"> <p>Included in this release, we can find:</p> </div> <div class="ulist"> <ul> <li> <p>The most recent improvements from <a href="https://issues.jboss.org/browse/ISPN-3408">Hibernate</a> and <a href="https://issues.jboss.org/browse/ISPN-3394">JGroups</a> modules.</p> </li> <li> <p>A step closer toward to <a href="https://issues.jboss.org/browse/ISPN-3173">querying</a> over the Hotrod protocol.</p> </li> <li> <p>And other important fixes and enhancements.</p> </li> </ul> </div> <div class="paragraph"> <p>For a complete list of features and fixes included in this release please refer to the <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12321855">release notes</a>. Visit our <a href="http://www.jboss.org/infinispan/downloads">downloads</a> section to find the latest release and if you have any questions please check our <a href="http://www.jboss.org/infinispan/forums">forums</a>, our <a href="https://lists.jboss.org/mailman/listinfo/infinispan-dev">mailing lists</a> or ping us directly on <a href="irc://irc.freenode.org/infinispan">IRC</a>.</p> </div> <div class="paragraph"> <p>Thanks to everyone for their involvement and contribution!</p> </div> <div class="paragraph"> <p>Cheers, Pedro</p> </div> </div> </div> </div> <a class="label" href="/blog/tags/release/"> release </a> <a class="label" href="/blog/tags/infinispan/"> infinispan </a> <a class="label" href="/blog/tags/alpha/"> alpha </a> <a class="label" href="/blog/tags/6.0/"> 6.0 </a> <hr> <div class="post"></div> <h3> Monday, 05 August 2013 </h3> <h1> <a href="/blog/2013/08/05/infinispan-600alpha2-is-out/">Infinispan 6.0.0.Alpha2 is out!</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Dear Infinispan community,</p> </div> <div class="paragraph"> <p>We&#8217;re proud to announce the second Alpha release of Infinispan 6.0.0, and also the second release using the Apache Software Licence.</p> </div> <div class="paragraph"> <p>New features in this release:</p> </div> <div class="ulist"> <ul> <li> <p>A new <a href="https://issues.jboss.org/browse/ISPN-3169">query DSL</a> that is usable both in embedded/library mode and over HotRod.</p> </li> <li> <p>Support for <a href="https://issues.jboss.org/browse/ISPN-3234">JCache 0.8</a>, the Public Review Draft version of the JSR-107 specification.</p> </li> <li> <p>A slimmer distribution, thanks to moving non-core cache store implementations to <a href="https://issues.jboss.org/browse/ISPN-3377">separate repositories</a>.</p> </li> </ul> </div> <div class="paragraph"> <p>For a complete list of features and fixes included in this release please refer to the <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12321854">release notes</a>. Visit our <a href="http://www.jboss.org/infinispan/downloads">downloads</a> section to find the latest release and if you have any questions please check our <a href="http://www.jboss.org/infinispan/forums">forums</a>, our <a href="https://lists.jboss.org/mailman/listinfo/infinispan-dev">mailing lists</a> or ping us directly on <a href="http://www.blogger.com/null">IRC</a>.</p> </div> <div class="paragraph"> <p>Thanks to everyone for their involvement and contribution!</p> </div> <div class="paragraph"> <p>Cheers Dan</p> </div> </div> </div> </div> <a class="label" href="/blog/tags/release/"> release </a> <a class="label" href="/blog/tags/alpha/"> alpha </a> <a class="label" href="/blog/tags/6.0/"> 6.0 </a> <hr> <div class="post"></div> <h3> Thursday, 18 July 2013 </h3> <h1> <a href="/blog/2013/07/18/faster-file-cache-store-no-extra/">Faster file cache store (no extra dependencies!) in 6.0.0.Alpha1</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>As <a href="http://infinispan.blogspot.ch/2013/07/infinispan-600alpha1-is-out.html">announced yesterday by Adrian</a>, the brand new Infinispan 6.0.0.Alpha1 release contains a new file-based cache store which needs no extra dependencies. This is essentially a replacement of the existing FileCacheStore which didn&#8217;t perform as expected, and caused major issues due to the number of files it created.</p> </div> <div class="paragraph"> <p>The new cache store, contributed by a <a href="https://github.com/kblees">Karsten Blees</a> (who also contributed an improved asynchronous cache store), is called <a href="https://github.com/infinispan/infinispan/blob/master/core/src/main/java/org/infinispan/loaders/file/SingleFileCacheStore.java">SingleFileCacheStore</a> and it keeps all data in a single file. The way it looks up data is by keeping an in-memory index of keys and the positions of their values in this file. This design outperforms the existing FileCacheStore and even LevelDB based JNI cache store.</p> </div> <div class="paragraph"> <p>The classic case for a file based cache store is when you want to have a cache with a cache store available locally which stores data that has overflowed from memory, having exceeded size and/or time restrictions. We ran some performance tests to verify how fast different cache store implementations could deal with reading and writing overflowed data, and these are the results we got (in Ks):</p> </div> <div class="ulist"> <ul> <li> <p>FileCacheStore: 0.75k reads/s, 0.285k writes/s</p> </li> <li> <p>LevelDB-JNI impl: 46k reads/s, 15.2k writes/s</p> </li> <li> <p>SingleFileCacheStore: 458k reads/s, 137k writes/s</p> </li> </ul> </div> <div class="paragraph"> <p>The difference is quite astonishing but as already hinted, this performance increase comes at a cost. Having to maintain an index of keys and positions in the file in memory has a cost in terms of extra memory required, and potential impact on GC. That&#8217;s why the SingleFileCacheStore is not recommended for use cases where the keys are too big.</p> </div> <div class="paragraph"> <p>In order to help tame this memory consumption issues, the <a href="http://docs.jboss.org/infinispan/6.0/apidocs/org/infinispan/configuration/cache/SingleFileCacheStoreConfigurationBuilder.html#maxEntries(int)">size of the cache store can be optionally limited, providing a maximum number of entries to store in it</a>. However, setting this parameter will only work in use cases where Infinispan is used as a cache. When used as a cache, data not present in Infinispan can be recomputed or re-retrieved from the authoritative data store and stored in Infinispan cache. The reason for this limitation is because once the maximum number of entries is reached, older data in the cache store is removed, so if Infinispan was used as an authoritative data store, it would lead to data loss which is not good.</p> </div> <div class="paragraph"> <p>Existing FileCacheStore users might wonder: what is it gonna happen to the existing FileCacheStore? We&#8217;re not 100% sure yet what we&#8217;re going to do with it, but we&#8217;re looking into some ways to migrate data from the FileCacheStore to the SingleFileCacheStore. <a href="https://issues.jboss.org/browse/ISPN-3318">Some interesting ideas</a> have already been submitted which we&#8217;ll investigate in next Infinispan 6.0 pre-releases.</p> </div> <div class="paragraph"> <p>So, if you&#8217;re a FileCacheStore user, give the new SingleFileCacheStore a go and let us know how it goes! Switching from one to the other is <a href="https://github.com/infinispan/infinispan/blob/master/core/src/test/java/org/infinispan/loaders/file/SingleFileCacheStoreFunctionalTest.java#L58">easy</a> :)</p> </div> <div class="paragraph"> <p>Cheers,</p> </div> <div class="paragraph"> <p>Galder</p> </div> </div> </div> </div> <a class="label" href="/blog/tags/persistence/"> persistence </a> <a class="label" href="/blog/tags/alpha/"> alpha </a> <a class="label" href="/blog/tags/performance/"> performance </a> <a class="label" href="/blog/tags/6.0/"> 6.0 </a> <hr> <div class="pagination-links"><span class="current-page">1</span> <a href="/blog/tags/6.0/page/2/" class="page-link">2</a> <a href="/blog/tags/6.0/page/2/" class="next-link">Next</a> </div> </div> <footer class="container"> <hr> <div class="row"> <div class="col-md-2 col-md-offset-1"> <h4>Navigate</h4> <ul> <li> <a href="/about" title="About">About</a> </li> <li> <a href="/documentation" title="Learn">Learn</a> </li> <li> <a href="/community" title="Community">Community</a> </li> <li> <a href="/getinvolved" title="Get Involved">Get Involved</a> </li> <li> <a href="/download" title="Download">Download</a> </li> </ul> </div> <div class="col-md-2"> <h4>Contribute</h4> <ul> <li> <a href="https://issues.jboss.org/browse/ISPN" title="Submit a bug">Submit a bug</a> </li> <li> <a href="https://github.com/infinispan" title="Write code">Write Code</a> </li> </ul> <h4>Follow Us</h4> <ul> <li> <a href="https://blog.infinispan.org" title="Blog">Blog</a> </li> <li> <a href="https://twitter.com/infinispan" title="Twitter">Twitter</a> </li> </ul> </div> <div class="col-md-2"> <h4>Open Source</h4> <p> Infinispan is released under the <b>Apache 2.0 open source license.</b> Learn more about the Apache 2.0 license <a href="https://www.apache.org/licenses/LICENSE-2.0">here.</a> </p> </div> <div class="col-md-2"> <h4>A member of</h4> <a alt="CloudTM" href="http://www.cloudtm.eu/" target="_NEW"> <img src="/images/cloudtm.png"> </a> <a alt="LEADS" href="http://leads-project.eu/" target="_NEW"> <img src="/images/leads.png"> </a> <a alt="CloudButton" href="http://cloudbutton.eu/" target="_NEW"> <img src="/images/cloudbutton.png"> </a> </div> <div class="col-md-2"> <h4>Thanks to</h4> <p>JetBrains Intellij IDEA</p> <a alt="JetBrains Intellij IDEA" href="https://www.jetbrains.com/idea/" target="_NEW"> <img src="/images/icon_IntelliJIDEA.png"> </a> </div> </div> <div class="col-md-10"> <p style="margin-top: 5px; font-size: 80%;"> © Copyright 2009-2019 Red Hat, Inc. <br> <i class="icon-fire"></i> Made with <a href="https://github.com/jbossorg/bootstrap-community" style="text-decoration: underline;" target="_NEW">JBoss Community Bootstrap</a> and <a href="http://awestruct.org/" style="text-decoration: underline;" target="_NEW">Awestruct</a> <br> <i class="icon-globe"></i> This website is open source! If you want to improve it, <a href="https://github.com/infinispan/infinispan.github.io" style="text-decoration: underline;" target="_NEW">fork the project,</a> and hack on it, then send a pull request. You can also view the <a href="https://www.seethestats.com/site/infinispan.org" style="text-decoration: underline;" target="_NEW">visitor stats.</a> <br> <i class="icon-share"></i> Website and documentation released under <a href="https://creativecommons.org/licenses/by/3.0/" style="text-decoration: underline;" target="_NEW">CC BY 3.0.</a> </p> </div> </footer> <div class="container" id="companyfooter"> <div class="redhatlogo"> <div id="logospacer"></div> <a href="http://www.redhat.com/"><img src="//static.jboss.org/theme/images/common/redhat_logo.png"></a> </div> </div> <span class="backToTop"> <a href="#top">back to top</a> </span> <script src="//static.jboss.org/theme/js/libs/bootstrap-community/3.2.0.2/bootstrap-community.min.js"></script> <script>
        if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
          _satellite.pageBottom();
        }
      </script> </div> </body> </html>