<!DOCTYPE html> <html lang="en"> <head> <title>Blog - Infinispan</title> <meta charset="utf-8"> <meta content="width=device-width, initial-scale=1.0" name="viewport"> <meta content="DENY" http-equiv="X-Frame-Options"> <meta content="1; mode=block" http-equiv="X-XSS-Protection"> <meta content="nosniff" http-equiv="X-Content-Type-Options"> <link href="https://static.jboss.org/theme/css/bootstrap-community/3.2.0.2/bootstrap-community.min.css" media="screen" rel="stylesheet"> <link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" rel="stylesheet"> <script id="dpal" src="https://www.redhat.com/dtm.js" type="text/javascript"></script> <link href="/images/favicon.png" rel="shortcut icon" type="image/png"> <link href="//static.jboss.org/images/example/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144"> <link href="//static.jboss.org/images/example/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114"> <link href="//static.jboss.org/images/example/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72"> <link href="//static.jboss.org/images/example/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed"> <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" rel="stylesheet"> <link href="https://static.jboss.org/css/rhbar.css" media="screen" rel="stylesheet"> <style>
      .jumbotron {
        padding: 0.5em 0.1em 0.5em 0.1em;
        background-image: none;
        background-color: #ffec9f;
      }
      .jumbotron p, 
      .jumbotron h1 {
        color: #656565;
      }
      .dropup {
        z-index: 1032;
      }
      .navbar {
        font-size: x-large;
      }
      .navbar ul {
        padding-top: 0.7em;
      }
      .navbar-brand {
        height: 80px;
      }
      .navbar-default {
        background-color: white;
      }
      .navbar-default .navbar-nav > li > a {
        color: #336699;
      }
      .navbar-default .navbar-nav > li > a:hover {
        color: #204060;
      }
      .navbar-default .navbar-nav > .open > a,
      .navbar-default .navbar-nav > .open > a:hover,
      .navbar-default .navbar-nav > .open > a:focus {
        background-color: #4a5d75;
      }
      h3.well {
        border-color: #ffd630;
        background-color: #ffec9f;
      }
      .panel-sidebar {
        border-color: #f5f5f5;
      }
      .panel-sidebar > .panel-heading {
        border-color: #e3e3e3;
        background-color: #f5f5f5;
        color: #656565;
      }
      .btn-primary {
        border-color: #ffd630;
        background-color: #ffec9f;
        color: #656565;
      }
      footer.container {
        background-color: white;
      }
      footer.container h1, footer.container h2, footer.container h3, footer.container h4, footer.container h5, footer.container h6, footer.container p, footer.container a {
        color: #656565;
      }
      footer.container ul {
        padding: 0;
      }
      i.enormous-icon {
        margin-top: 0.3em;
      }
      .home-examples {
        font-size: 16px;
      }
    </style> <script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.min.js"></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script> <script>
      hljs.initHighlightingOnLoad();
    </script> <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
     
    ga('create', 'UA-8601422-1', 'auto');
    ga('send', 'pageview');
    
    </script> </head> <body> <div id=""> <ul class="visuallyhidden" id="top"> <li> <a accesskey="n" href="#nav" title="Skip to navigation">Skip to navigation</a> </li> <li> <a accesskey="c" href="#page" title="Skip to content">Skip to content</a> </li> </ul> <div id="rhbar"> <a class="jbdevlogo" href="http://www.jboss.org/projects/about"></a> <a class="rhlogo" href="http://www.redhat.com/"></a> </div> <div class="container" id="content"> <nav class="navbar navbar-default navbar-fixed-top"> <div class="container"> <div class="navbar-header"> <button aria-expanded="false" class="navbar-toggle collapsed" data-target="#thenavbar" data-toggle="collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/"> <img alt="Infinispan" src="/images/infinispan_nav_brand.png"> </a> </div> <div class="navbar-collapse collapse" id="thenavbar"> <ul class="nav navbar-nav"> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/about">About <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/about">Introduction</a></li> <li><a href="/features">Features</a></li> <li><a href="/release-notes">Release notes</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/references">References</a></li> <li><a href="/experiments/">Experiments</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/documentation">Learn <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/documentation">Documentation</a></li> <li><a href="/tutorials">Tutorials</a></li> <li><a href="/videos">Videos</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/download">Download <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/download">Infinispan Releases</a></li> <li><a href="/cache-store-implementations">Cache Store Implementations</a></li> <li><a href="/hotrod-clients">Hot Rod Clients</a></li> <li><a href="/integrations">Integrations</a></li> <li><a href="/download-archive">Archive</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/community">Community <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/community">Ask for Help</a></li> <li><a href="/getinvolved">Get Involved</a></li> </ul> </li> <li class=""><a href="/roadmap">Road Map</a></li> <li class="divider"></li> </ul> </div> </div> </nav> <div class="post"></div> <h3> Friday, 11 May 2018 </h3> <h1> <a href="/blog/2018/05/11/infinispan-930beta1/">Infinispan 9.3.0.Beta1</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan users,</p> </div> <div class="paragraph"> <p>We have just released 9.3.0.Beta1 which includes <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12337255">38 fixes</a>. Highlights of this release include:</p> </div> <div class="paragraph"> <p>Conflict Resolution Improvements</p> </div> <div class="ulist"> <ul> <li> <p>MergePolicy.NONE is now the default merge-policy</p> </li> <li> <p>Conflict Resolution during a merge is now non-blocking and tolerant of node failures</p> </li> </ul> </div> <div class="paragraph"> <p>Reactive Streams based Cache Loader SPI available</p> </div> <div class="paragraph"> <p>Infinispan can now be built and tested with Java 10/11</p> </div> <div class="paragraph"> <p>Max Idle expiration is now cluster-wide including events</p> </div> <div class="paragraph"> <p>The Java Hot Rod client can handle data in multiple formats</p> </div> <div class="paragraph"> <p>Improved merge <em>after</em> long GC pauses avoiding data loss</p> </div> <div class="paragraph"> <p>Admin console supports counters in standalone mode</p> </div> <div class="paragraph"> <p>Lots of bug fixes, test fixes, and documentation improvements</p> </div> <div class="paragraph"> <p>As usual, you can find all the bits on our <a href="http://infinispan.org/download/">website</a>. If you find any issues, don&#8217;t hesitate to report them on our <a href="https://issues.jboss.org/projects/ISPN">issue tracker.</a></p> </div> <div class="paragraph"> <p>Enjoy, The Infinispan Team</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Tuesday, 27 March 2018 </h3> <h1> <a href="/blog/2018/03/27/infinispan-921final/">Infinispan 9.2.1.Final</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan users,</p> </div> <div class="paragraph"> <p>we have just released 9.2.1.Final which includes <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12337077">65 fixes</a>. Highlights of this release include:</p> </div> <div class="paragraph"> <p>Many fixes/improvements to the REST endpoint</p> </div> <div class="ulist"> <ul> <li> <p>Configurable CORS settings</p> </li> <li> <p>HTTP/2 now works</p> </li> <li> <p>Accept-Encoding and Content-Encoding handling</p> </li> </ul> </div> <div class="paragraph"> <p>It is now possible to retrieve the list of cache names over Hot Rod</p> </div> <div class="paragraph"> <p>Substantial performance improvements when iterating over the file store</p> </div> <div class="paragraph"> <p>Lots of bug fixes, test fixes and documentation improvements</p> </div> <div class="paragraph"> <p>As usual you can find all the bits on our <a href="http://infinispan.org/download/">website</a>. If you find any issues, don&#8217;t hesitate to report them on our <a href="https://issues.jboss.org/projects/ISPN">issue tracker.</a></p> </div> <div class="paragraph"> <p>Enjoy</p> </div> <div class="paragraph"> <p>The Infinispan Team</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Wednesday, 28 February 2018 </h3> <h1> <a href="/blog/2018/02/28/infinispan-920final/">Infinispan 9.2.0.Final</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan 9.2.0.Final "Gaina" is out !</p> </div> <div class="paragraph"> <p>Our three-month time-boxing for a minor release plan got a little bit skewed this time in order to accommodate for some additional overhauls. This also means that, for a minor release, this is much meatier than usual.</p> </div> </div> </div> <div class="sect1"> <h2 id="_core_improvements"><a class="anchor" href="#_core_improvements"></a>Core improvements</h2> <div class="sectionbody"> <div class="ulist"> <ul> <li> <p><strong>Conflict resolution</strong> Automatic conflict resolution after a partition merge is now supported for all partition handling strategies and is enabled by default. Furthermore, it is now possible to deploy custom EntryMergePolicy implementations to the server</p> </li> <li> <p><strong>Reactive streams-based distributed Iteration improvements</strong> Distributed iterator now uses less threads and allows for efficient parallel retrieval providing for improved throughput</p> </li> <li> <p><strong>Biased reads for scattered caches</strong> Originator can read the ‘backup’ copy locally until the data gets overwritten again. Together with improved read performance this migrates data to nodes that use it. </p> </li> <li> <p><strong>Off-heap sizing</strong> Off-heap requires less overhead per entry and provides for more accurate sizing allowing you to maximize your memory used</p> </li> <li> <p><strong>Exception based eviction</strong>A new "eviction" that instead of removing old entries prevents new entries being inserted (supported by all memory storage and eviction types)</p> </li> </ul> </div> </div> </div> <div class="sect1"> <h2 id="_api_improvements"><a class="anchor" href="#_api_improvements"></a>API improvements</h2> <div class="sectionbody"> <div class="ulist"> <ul> <li> <p><strong>Multimap caches</strong> Available for both Embedded and for Hot Rod, these maps which can store multiple values for the same key</p> </li> <li> <p><strong>Clustered Counters</strong> Clustered counters are now available for Hot Rod and in non-clustered deployments.</p> </li> <li> <p><strong>Clustered Locks</strong> Available in embedded mode. They allow concurrent synchronization between nodes in the same cluster</p> </li> <li> <p><strong>Wildcard configurations</strong> Implicitly use a predefined configuration for all caches whose name matches a wildcard. This is particularly useful when using Infinispan through an API which doesn&#8217;t allow for additional configuration properties (such as JCache).</p> </li> <li> <p><strong>Cluster-wide cache admin with optional persistence</strong> The CacheManager API has been enhanced with methods to create/destroy caches across a cluster, in both Embedded and Hot Rod scenarios (REST will come in 9.3). Optionally, configurations can be made persistent across restarts.</p> </li> <li> <p><strong>Cache Stream</strong> Overloaded collect() method to take Supplier so that collect() in clustered environments is more user-friendly.</p> </li> </ul> </div> </div> </div> <div class="sect1"> <h2 id="_data_interoperability"><a class="anchor" href="#_data_interoperability"></a>Data Interoperability</h2> <div class="sectionbody"> <div class="paragraph"> <p>Transcoding is a powerful new feature which allows for transparent conversion between a number of formats across different endpoints. For example, it is now possible to write ProtoBuf-encoded data through the Hot Rod endpoint and retrieve that same data as a JSON document through the REST endpoint and vice versa. Additionally, such data is also indexable and queryable.</p> </div> </div> </div> <div class="sect1"> <h2 id="_indexing_and_query"><a class="anchor" href="#_indexing_and_query"></a>Indexing and Query</h2> <div class="sectionbody"> <div class="ulist"> <ul> <li> <p><strong>POJO queries over Hot Rod</strong> It is now possible to directly use Hibernate Search-annotated objects through JBoss Marshalling/Java serialization without the need for ProtoBuf over Hot Rod.</p> </li> <li> <p><strong>Broadcast queries</strong> Clustered queries have been unified with non-clustered queries under a single API, making their use transparent.</p> </li> </ul> </div> </div> </div> <div class="sect1"> <h2 id=""><a class="anchor" href="#"></a> </h2> <div class="sectionbody"> </div> </div> <div class="sect1"> <h2 id="_infinispan_server"><a class="anchor" href="#_infinispan_server"></a>Infinispan Server</h2> <div class="sectionbody"> <div class="ulist"> <ul> <li> <p><strong>Rebased on WildFly 11</strong> The server baseline has been updated to WildFly 11</p> </li> <li> <p><strong>Async Hot Rod server</strong> The Hot Rod server now uses async ops, sparing CPU cycles from context-switching and reducing the latency.</p> </li> <li> <p><strong>Queries over REST</strong> The REST endpoint now supports running Ickle queries. This is fully integrated with the above-mentioned JSON support, so your results will be returned to you as JSON documents.</p> </li> <li> <p><strong>Netty Hot Rod Client</strong> The Hot Rod Java client network layer has been completely rewritten to use Netty, bringing true asynchronous calls and some performance benefits.</p> </li> </ul> </div> </div> </div> <div class="sect1"> <h2 id="_2"><a class="anchor" href="#_2"></a> </h2> <div class="sectionbody"> </div> </div> <div class="sect1"> <h2 id="_management_monitoring_and_logging"><a class="anchor" href="#_management_monitoring_and_logging"></a>Management, monitoring and logging</h2> <div class="sectionbody"> <div class="ulist"> <ul> <li> <p>    Console support for counters</p> </li> <li> <p>    Improved remote protocol access logging</p> </li> <li> <p>    Jolokia is now integrated as a part of the server.</p> </li> </ul> </div> </div> </div> <div class="sect1"> <h2 id="_3"><a class="anchor" href="#_3"></a> </h2> <div class="sectionbody"> </div> </div> <div class="sect1"> <h2 id="_infinispan_on_openshift"><a class="anchor" href="#_infinispan_on_openshift"></a>Infinispan on OpenShift</h2> <div class="sectionbody"> <div class="paragraph"> <p>We have been doing a lot of work in making Infinispan a first-class citizen of OpenShift. Check out the OpenShift templates for more details.</p> </div> </div> </div> <div class="sect1"> <h2 id="_integrations"><a class="anchor" href="#_integrations"></a>Integrations</h2> <div class="sectionbody"> <div class="ulist"> <ul> <li> <p><strong>JCache 1.1</strong> This release is now aligned with JCache 1.1.</p> </li> <li> <p><strong>Hibernate second-level cache provider</strong> Traditionally shipped by our friends on the Hibernate ORM team, this component has now changed ownership over to us. This release includes a provider for both Hibernate 5.1 and 5.2.</p> </li> <li> <p><strong>Azure cloud discovery</strong>Courtesy of JGroups' extras, we now support discovery in Azure.</p> </li> </ul> </div> </div> </div> <div class="sect1"> <h2 id="_4"><a class="anchor" href="#_4"></a> </h2> <div class="sectionbody"> </div> </div> <div class="sect1"> <h2 id="_the_codename"><a class="anchor" href="#_the_codename"></a>The codename</h2> <div class="sectionbody"> <div class="paragraph"> <p>In the grand-old tradition of giving major and minor Infinispan releases a beer-themed codename, 9.2 is no exception.</p> </div> <div class="paragraph"> <p>"<em>Gaina</em>", which means "chicken" in the milanese dialect, also happens to be one of the great beers of the Birrificio Lambrate in Milan.</p> </div> </div> </div> <div class="sect1"> <h2 id="_5"><a class="anchor" href="#_5"></a> </h2> <div class="sectionbody"> </div> </div> <div class="sect1"> <h2 id="_onwards_to_9_3"><a class="anchor" href="#_onwards_to_9_3"></a>Onwards to 9.3</h2> <div class="sectionbody"> <div class="paragraph"> <p>We have already started working on our next release, 9.3 which should be with you at the end of May. This will continue the work to make Infinispan fully asynchronous inside out, reducing resource usage and increasing performance. We are also working on a new modular API which will improve usability, increase interoperability between embedded and remote scenarios and take advantage of reactive designs. Transactions should finally make their appearance in Hot Rod and security will be greatly enhanced, by taking advantages of the great work done by our friends over on the Elytron team. We have much more planned, so please consult our roadmap for details.</p> </div> </div> </div> <div class="sect1"> <h2 id="_6"><a class="anchor" href="#_6"></a> </h2> <div class="sectionbody"> </div> </div> <div class="sect1"> <h2 id="_download_learn_and_play"><a class="anchor" href="#_download_learn_and_play"></a>Download, learn and play</h2> <div class="sectionbody"> <div class="paragraph"> <p>You will find downloads, documentation, tutorials, quickstarts and demos over on our website.</p> </div> <div class="paragraph"> <p>Please let us know on our forum, on IRC, on our issue tracker if you have any issues with this release, if there is any feature you would like to see in the future, or just to chat.</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Wednesday, 21 February 2018 </h3> <h1> <a href="/blog/2018/02/21/infinispan-920cr3/">Infinispan 9.2.0.CR3</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>This should have been the announcement for Final, but we discovered a number of performance regressions as well as a few important bugs that needed fixing. We also slipped in a few features and improvements. So, without further ado, here&#8217;s what is new and noteworthy in Infinispan 9.2.0.CR3:</p> </div> <div class="paragraph"> <p>Various component upgrades</p> </div> <div class="ulist"> <ul> <li> <p>Netty 4.1.21</p> </li> <li> <p>Hibernate Search 5.9.0.Final</p> </li> <li> <p>Protostream to 4.2.0.CR1</p> </li> </ul> </div> <div class="paragraph"> <p>Features/Enhancements</p> </div> <div class="ulist"> <ul> <li> <p>Azure discovery</p> </li> <li> <p>Use async ops in the Hot Rod server</p> </li> <li> <p>Simplified client configuration when security is enabled</p> </li> </ul> </div> <div class="paragraph"> <p>Lots of documentation updates</p> </div> <div class="ulist"> <ul> <li> <p>REST server changes</p> </li> <li> <p>Data Encoding</p> </li> <li> <p>Server tasks</p> </li> </ul> </div> <div class="paragraph"> <p>And many bugfixes</p> </div> <div class="paragraph"> <p>Get your artifacts from maven, the distributions from our <a href="http://infinispan.org/download/">download page</a>, the <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12336887">fixed issues</a> from our issue tracker and read the updated <a href="http://infinispan.org/docs/dev/index.html">documentation</a>. Come and talk to us on IRC (#infinispan on Freenode) or ask questions on the <a href="https://developer.jboss.org/en/infinispan/content">forum</a>.</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Monday, 19 February 2018 </h3> <h1> <a href="/blog/2018/02/19/distributed-iteration-improvements/">Distributed iteration improvements</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan hasn&#8217;t always provided a way for iterating upon entries in a distributed cache. In fact the <a href="https://issues.jboss.org/browse/ISPN-4222">first iteration</a> wasn&#8217;t until Infinispan 7. Then in Infinispan 8, with the addition of Java 8, we fully integrated this into <a href="http://blog.infinispan.org/2015/09/distributed-streams.html">distributed streams</a>, which brought some minor iteration improvements in performance.</p> </div> <div class="paragraph"> <p>We are proud to announce that with Infinispan 9.2 there are even more improvements. This contains no API changes, although those will surely come in the future. This one is purely for performance and utilization.</p> </div> </div> </div> <div class="sect1"> <h2 id="_new_implementation_details"><a class="anchor" href="#_new_implementation_details"></a>New implementation details</h2> <div class="sectionbody"> <div class="sect2"> <h3 id=""><a class="anchor" href="#"></a> </h3> <div class="paragraph"> <p>There are a few different aspects that have been changed.  A lot of these revolve around the amount of entries being retrieved at once, which if you are familiar with DistributedStreams can be configured via the <a href="https://docs.jboss.org/infinispan/9.2/apidocs/org/infinispan/BaseCacheStream.html#distributedBatchSize-int-">distributedBatchSize</a> method. Note that if this is not specified it defaults to the <a href="https://docs.jboss.org/infinispan/9.2/apidocs/org/infinispan/configuration/cache/StateTransferConfigurationBuilder.html#chunkSize-int-">chunk size</a> in state transfer.</p> </div> <div class="sect3"> <h4 id="_entry_retrieval_is_now_pull_based_instead_of_push"><a class="anchor" href="#_entry_retrieval_is_now_pull_based_instead_of_push"></a>Entry retrieval is now pull based instead of push</h4> <div class="paragraph"> <p>Infinispan core (embedded) has added <a href="https://github.com/ReactiveX/RxJava/tree/2.x">rxjava2</a> and <a href="https://github.com/reactive-streams/reactive-streams-jvm">reactive streams</a> as dependencies and rewrote all of the old push style iterator code over to pull style to fully utilize the Publisher and Subscriber interfaces.</p> </div> <div class="paragraph"> <p>With this we only pull up to the batchSize in entries at a time from any set of nodes. The old style utilized push with call stack blocking, which could return up two times the amount of entries. Also since we aren&#8217;t performing call stack blocking, we don&#8217;t have to waste threads as these calls to retrieve entries are done async and finish very quickly irrespective of user interaction. The old method required multiple threads to be reserved for this purpose.</p> </div> </div> <div class="sect3"> <h4 id="_streamed_batches"><a class="anchor" href="#_streamed_batches"></a>Streamed batches</h4> <div class="paragraph"> <p>The responses from a remote node are written directly to the output stream so there are no intermediate collections allocated. This means we only have to iterate upon the data once as we retain the iterator between requests. On the originator we still have to store the batches in a collection to be enqueued for the user to pull.</p> </div> </div> <div class="sect3"> <h4 id="_rewritten_parallel_distribution"><a class="anchor" href="#_rewritten_parallel_distribution"></a>Rewritten Parallel Distribution</h4> <div class="paragraph"> <p>Great care was taken to implement parallel distribution in a way to vastly reduce contention and ensure that we properly follow the batchSize configuration.</p> </div> <div class="paragraph"> <p>When parallel distribution is in use the new implementation will start 4 remote node requests sharing the batch size (so each one gets 1/4). This way we can guarantee that we only have the desired size irrespective of the number of nodes in the cluster. The old implementation would request batchSize from all nodes at the same time. So not only did it reserve a thread for node but could easily swamp your JVM memory, causing OutOfMemoryErrors (which no one likes). The latter alone made us force the default to be sequential distribution when using an iterator.</p> </div> <div class="paragraph"> <p>The old implementation would write entries from all nodes (including local) to the same shared queue. The new implementation has a different queue for each request, which allows for faster queues with no locking to be used.</p> </div> <div class="paragraph"> <p>Due to these changes and other isolations between threads, we can now make parallel distribution the default setting for the iterator method. And as you will see this has improved performance nicely.</p> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_performance"><a class="anchor" href="#_performance"></a>Performance</h2> <div class="sectionbody"> <div class="paragraph"> <p>We have written a <a href="http://openjdk.java.net/projects/code-tools/jmh/">JMH</a> test harness specifically for this blog post, testing 9.1.5.Final <a href="https://github.com/infinispan/infinispan/releases/tag/9.1.5.Final">build</a> against latest 9.2.0.SNAPSHOT. The test runs by default with 4GB of heap with 6 nodes in a distributed cache with 2 owners. It has varying entry count, entry sizes and distributed batch sizes.</p> </div> <div class="paragraph"> <p>Due to the variance in each test a large number of tests were ran and with different permutations to make sure it covered a large amount of test cases. The JMH test that was ran can be found at <a href="https://github.com/infinispan/infinispan-benchmarks/tree/master/iteration">github</a>. All the default settings were used for the run except -t4 (runs with 4 worker threads) was provided. This was all ran on my measly laptop (i7-4810MQ and 16 GB) - maxing out the CPU was not a hard task.</p> </div> <div class="paragraph"> <p><strong>CAVEAT</strong>: The tests don&#8217;t do anything with the iterator and just try to pull them as fast as they can. Obviously if you have a lot of processing done between iterations you will likely not see as good of a performance increase.</p> </div> <div class="paragraph"> <p>The entire results can be found <a href="https://docs.google.com/spreadsheets/d/18v8e6vG-4aX8Pk-ihB3p1H5cQvsSQlFMhQSKxPhSLf0/edit?usp=sharing">here</a>. It shows each permutation and how many operations per second and finds the difference (green shows 5% or more and red shows -5% or less).</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 33.3333%;"> <col style="width: 33.3333%;"> <col style="width: 33.3334%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Operation</th> <th class="tableblock halign-left valign-top">Average Gain</th> <th class="tableblock halign-left valign-top">Code</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Specified Distribution Mode</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">3.5%</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">.entrySet().stream().sequentialDistribution.iterator()</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Default</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">11%</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">.entrySet().iterator()</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">No Rehash</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">14%</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">.entrySet().stream().disableRehashAware().iterator()</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>The above 3 rows show a few different ways you could have been invoking the iterator method. The second row is probably by far the most used case. In this case you should see around a <strong>11</strong>% increase in performance (results will vary). This is due to the new pulling method as well as parallel distribution becoming the new default running mode. It is unlikely a user was using the other 2 methods, but are provided for a more complete view.</p> </div> <div class="paragraph"> <p>If you were specifying a distribution mode manually, either sequential or distribution you will only see a few percent faster run (<strong>3.5</strong>%), but every little bit helps! Also if you can switch to parallel you may want to think about doing so.</p> </div> <div class="paragraph"> <p>Also you can see if you were running with rehash disabled prior, it has even more gains (<strong>14</strong>%). Those don&#8217;t even include the fact that no rehash was <strong>28</strong>% faster than with before (which means it is about <strong>32</strong>% faster in general now). So if you can get away with a <em>at most once</em> guarantee, disabling rehash will provide the best throughput.</p> </div> </div> </div> <div class="sect1"> <h2 id="_whats_next"><a class="anchor" href="#_whats_next"></a>Whats next? </h2> <div class="sectionbody"> <div class="paragraph"> <p>As was mentioned this is not exposed to the user directly. You still interact with the iterator as you would normally. We should remedy this at some point.</p> </div> <div class="sect2"> <h3 id="_expose_new_method"><a class="anchor" href="#_expose_new_method"></a>Expose new method</h3> <div class="paragraph"> <p>We would love to eventually expose a method to return a Publisher directly to the user so that they can get the full benefits of having a pull based implementation underneath.</p> </div> <div class="paragraph"> <p>This way any intermediate operations applied to the stream before would be distributed and anything applied to the Publisher would be done locally. And just like the iterator method this publisher would be fully rehash aware if you have it configured to do so and would make sure you get all entries delivered in an <em>exactly once</em> fashion (rehash disabled guarantees <em>at most once</em>).</p> </div> <div class="paragraph"> <p>Another side benefit is that the Subscriber methods could be called on different threads so there is no overhead required on the ISPN side for coordinating these into queue(s). Thus the Subscriber <em>should</em> be able to retrieve all entries faster than just doing an iterator.</p> </div> </div> <div class="sect2"> <h3 id="_java_9_flow"><a class="anchor" href="#_java_9_flow"></a>Java 9 Flow</h3> <div class="paragraph"> <p>Also many of you may be wondering why we aren&#8217;t using the new Flow API introduced in Java 9. Luckily the Flow API is a 1:1 conversion of reactive streams. So whenever Infinispan will start supporting Java 9 interfaces/classes, we hope to properly expose these as the JDK classes.</p> </div> </div> <div class="sect2"> <h3 id="_segment_based_iteration"><a class="anchor" href="#_segment_based_iteration"></a>Segment Based Iteration </h3> <div class="paragraph"> <p>With Infinispan 9.3, we hope to introduce <a href="https://issues.jboss.org/browse/ISPN-5451">data container</a> and <a href="https://issues.jboss.org/browse/ISPN-6026">cache store</a> segment aware iteration. This means when iterating over either we would only have to process entries that map to a given segment. This should reduce the time and processing for iteration substantially, especially for cache stores. Keep your eyes out for a future blog post detailing these as 9.3 development commences.</p> </div> </div> <div class="sect2"> <h3 id="_give_us_feedback"><a class="anchor" href="#_give_us_feedback"></a>Give us Feedback</h3> <div class="paragraph"> <p>We hope you find a bit more performance when working with your distributed iteration. Also we value any feedback on what you want our APIs to look like or find any bugs. As always let us know at any of the places listed <a href="http://infinispan.org/community/">here</a>.</p> </div> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Friday, 09 February 2018 </h3> <h1> <a href="/blog/2018/02/09/restful-queries-coming-to-infinispan-92/">RESTful queries coming to Infinispan 9.2</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>One of the interesting features in the upcoming Infinispan 9.2 release is the possibility to execute queries over the REST endpoint, enabling users to take advantage of the easy-to-use and expressiveness of the Ickle query language, that combines a subset of JP-QL with full-text features. You can learn more info about Ickle in a <a href="http://blog.infinispan.org/2016/12/meet-ickle.html">previous post</a>.</p> </div> <div class="paragraph"> <p>Besides exposing query over REST, Infinispan 9.2 also adds support for mapping between JSON and Protobuf formats, allowing an efficient storage in binary format while exposing queries, reading and writing content as JSON documents.</p> </div> <div class="paragraph"> <p>To illustrate those new capabilities, this post will walk you through a sample app from scratch!</p> </div> <div class="paragraph"> <p>=== Sample app</p> </div> <div class="exampleblock"> <div class="content"> <div class="paragraph"> <p>Running the server</p> </div> <div class="paragraph"> <p>We start by <a href="https://github.com/jboss-dockerfiles/infinispan/tree/master/server">running</a> the Infinispan Server 9.2.0.CR2 (the latest release candidate):</p> </div> <div class="paragraph"> <p>This will get you a fresh instance of Infinispan running, with login and password 'user' and the REST port 8080 mapped to localhost. TIP: if you run more than one container, they&#8217;ll form a cluster automatically.</p> </div> <div class="paragraph"> <p>===== Creating an indexed cache</p> </div> <div class="paragraph"> <p>Next step is to create an indexed cache called 'pokemon'. We make use of the CLI  (Command Line Interface) to create this cache. In the future, with <a href="https://issues.jboss.org/browse/ISPN-8529">ISPN-8529</a>, we&#8217;ll also be able to create cache with arbitrary configuration using REST, but for now we execute a CLI recipe:</p> </div> <div class="paragraph"> <p>===== Creating the schema</p> </div> <div class="paragraph"> <p>In order to be able to query, we need to define a protobuf schema for our data. The schema follows the Protobuf 2 format (Protobuf 3 support is coming) and allows for extensions to define indexing properties (analyzers, storage, etc).</p> </div> <div class="paragraph"> <p>Here&#8217;s how it looks like:</p> </div> <div class="paragraph"> <p>The protobuf schema can contain some comments on top of fields and messages with "annotations" to control indexing. Hibernate Search users will recognize some of those pseudo annotations we are using here: they resemble closely their counterpart.</p> </div> <div class="paragraph"> <p>===== Registering the schema</p> </div> <div class="paragraph"> <p>Once we have our schema, we can easily register it via REST:</p> </div> </div> </div> <div class="paragraph"> <p>Populating the cache</p> </div> <div class="paragraph"> <p>We&#8217;re now ready to put some data in the cache. As mentioned earlier, ingesting can be done by sending JSON documents directly. Once Infinispan receives those documents, it will convert them to protobuf, index and store them.</p> </div> <div class="paragraph"> <p>In order to match a particular inbound document to an entity in the schema, Infinispan uses a special meta field called <strong><em>_type</em></strong> that must be provided in the document. Here&#8217;s an example of a JSON document that conforms to our schema:</p> </div> <div class="paragraph"> <p>Writing the document is easy:</p> </div> <div class="paragraph"> <p>we can retrieve content by key as JSON:</p> </div> </div> </div> <div class="sect4"> <h5 id="_querying"><a class="anchor" href="#_querying"></a>Querying</h5> <div class="paragraph"> <p>The new query endpoint can be called with an "action" parameter named "search", after the cache name. The simplest query, which returns all data can be done with:</p> </div> <div class="paragraph"> <p><a href="http://localhost:8080/rest/pokemon?action=search&amp;query=from%20Pokemon">http://localhost:8080/rest/pokemon?action=search&amp;query=from</a></p> </div> <div class="paragraph"> <p>If you do not want to return all the fields, use a <em>Select</em> clause:</p> </div> <div class="paragraph"> <p><a href="http://localhost:8080/rest/pokemon?action=search&amp;query=Select%20name,%20speed%20from%20Pokemon">http://localhost:8080/rest/pokemon?action=search&amp;query=Select</a></p> </div> <div class="paragraph"> <p>Pagination can be controlled with the <em>offset</em>, <em>max_results</em> URL parameters:</p> </div> <div class="paragraph"> <p><a href="http://localhost:8080/rest/pokemon?action=search&amp;query=from%20Pokemon&amp;offset=2&amp;max_results=20">http://localhost:8080/rest/pokemon?action=search&amp;query=from</a></p> </div> <div class="paragraph"> <p>Grouping is also possible:</p> </div> <div class="paragraph"> <p><a href="http://localhost:8080/rest/pokemon?action=search&amp;query=select%20count(p.name)%20from%20Pokemon%20p%20group%20by%20generation">http://localhost:8080/rest/pokemon?action=search&amp;query=select</a></p> </div> <div class="paragraph"> <p>Example of a query result:</p> </div> <div class="paragraph"> <p><a href="http://localhost:8080/rest/pokemon?action=search&amp;query=select%20name,pokedex_number,against_fire%20from%20Pokemon%20order%20by%20against_fire%20asc&amp;max_results=5">http://localhost:8080/rest/pokemon?action=search&amp;query=select</a></p> </div> <div class="paragraph"> <p>Results:</p> </div> </div> <div class="sect2"> <h3 id="_conclusion"><a class="anchor" href="#_conclusion"></a>Conclusion</h3> </div> <div class="sect2"> <h3 id=""><a class="anchor" href="#"></a> </h3> <div class="paragraph"> <p>Infinispan 9.2 makes it easier to quickly ingest and query datasets using the ubiquitous JSON format, without sacrificing type safety and storage size.</p> </div> <div class="paragraph"> <p>By storing Protobuf, this will also enable other clients like the Hot Rod C#/C++ clients to query, read and write data simultaneously with REST clients.</p> </div> <div class="paragraph"> <p>The full source code for the demo, along with instructions on how to populate the whole dataset can be found at <a href="https://github.com/infinispan-demos/infinispan-pokemon">Github</a>.</p> </div> <div class="paragraph"> <p>Finally, please try out this new feature in your own dataset and let us know how it goes!</p> </div> </div> </div> <hr> <div class="post"></div> <h3> Wednesday, 07 February 2018 </h3> <h1> <a href="/blog/2018/02/07/data-container-changes-part-3/">Data Container Changes Part 3</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Just over a year ago we detailed some improvements to the data container, including the availability of Off Heap storage in <a href="http://blog.infinispan.org/2017/01/data-container-changes-part-2.html">part 2</a>. There have been quite a <a href="https://issues.jboss.org/browse/ISPN-8454?jql=project%20%3D%20ISPN%20AND%20resolution%20%3D%20Done%20AND%20component%20%3D%20%22Off%20Heap%22">few fixes</a> for Off Heap especially around memory size estimations with Infinispan 9.2. There is also a brand new "eviction" strategy that has a bit of a twist.</p> </div> </div> </div> <div class="sect1"> <h2 id="_eviction_strategy_resurrected"><a class="anchor" href="#_eviction_strategy_resurrected"></a>Eviction Strategy Resurrected</h2> <div class="sectionbody"> <div class="paragraph"> <p>Some of you may have remembered that Infinispan used to have an eviction strategy. This was originally used to decide what eviction algorithm was used, such as LRU or LIRS. This was removed when the new data container was introduced. Well&#8230;&#8203; it is back again, but it will be used for a slightly different purpose.</p> </div> <div class="paragraph"> <p>The eviction strategy still has <strong>NONE</strong> &amp; <strong>MANUAL</strong> which are exactly the same as before.</p> </div> <div class="sect2"> <h3 id="_remove_strategy"><a class="anchor" href="#_remove_strategy"></a>Remove strategy</h3> <div class="paragraph"> <p>There is a new <strong>REMOVE</strong> strategy that is configured by default if eviction size is greater than 0. This strategy essentially enables eviction and removes old entries as new ones are inserted.</p> </div> </div> <div class="sect2"> <h3 id="_exception_strategy"><a class="anchor" href="#_exception_strategy"></a>Exception strategy</h3> <div class="paragraph"> <p>We have a brand new "eviction" strategy that provides new functionality. It is unique in that it doesn&#8217;t really evict, but rather prevent entries from being inserted.  This is the <strong>EXCEPTION</strong> strategy which blocks new entries from being inserted (or updated if they exceed memory size) by throwing a ContainerFullException when the size is reached.</p> </div> <div class="paragraph"> <p>This strategy only works on transactional caches that always have 2 phase commit enabled. This can be useful if you want to always have only so many entries and to give priority to currently inserted entries. This strategy has better performance than <strong>REMOVE</strong> since it doesn&#8217;t have to bookkeep all entries to know what to remove as well.</p> </div> <div class="paragraph"> <p>Note this strategy works across all storage types: OBJECT, BINARY and OFFHEAP and works with both MEMORY and SIZE based "eviction types. This makes it just as flexible as the <strong>REMOVE</strong> eviction strategy and hope it finds some uses by people.</p> </div> </div> <div class="sect2"> <h3 id="_how_to_configure_exception_strategy"><a class="anchor" href="#_how_to_configure_exception_strategy"></a>How to Configure EXCEPTION Strategy</h3> <div class="paragraph"> <p>This is how you can enable MEMORY based EXCEPTION "eviction" using xml configuration.</p> </div> <div class="paragraph"> <p>This is how you configure the same thing but programmatically.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_off_heap_memory_size_allocations_estimations"><a class="anchor" href="#_off_heap_memory_size_allocations_estimations"></a>Off Heap Memory Size Allocations &amp; Estimations</h2> <div class="sectionbody"> <div class="paragraph"> <p>Before the off heap memory based eviction only counted the allocated memory chunks for the stored entries themselves. This unfortunately meant that the size estimate is a bit less than what it should have been. There are a few things that we improved since then, including reducing the overhead of our allocations. Note all of the below things require no configuration changes and users should just get the benefits.</p> </div> <div class="sect2"> <h3 id="_reduced_per_object_overhead"><a class="anchor" href="#_reduced_per_object_overhead"></a>Reduced per object overhead</h3> <div class="paragraph"> <p>Prior the overhead for immutable entries with eviction, Infinispan itself use to allocate 2 chunks of memory with one being 28 bytes and adding 8 bytes to the actual object. Now we only allocate an additional 16 bytes to the object memory block itself (saving the extra allocation and requiring less on the object) when using eviction. Due to memory allocation overhead this saves much more than the 20 bytes as the allocator also has its own overhead.</p> </div> <div class="paragraph"> <p>We also shaved off 4 bytes off of all entries if expiration was not used, meaning overhead for an immutable cache entry without eviction only requires 21 bytes of overhead from ISPN when using off heap (retained in the same allocation block).</p> </div> </div> <div class="sect2"> <h3 id="_per_allocation_memory_sizing_estimations"><a class="anchor" href="#_per_allocation_memory_sizing_estimations"></a>Per allocation memory sizing estimations</h3> <div class="paragraph"> <p>Internally ISPN allocates a new chunk of memory for each object. This is done currently to leverage the underlying OS allocator to handle features such as fragmentation or compaction (if the allocator does so). Unfortunately this means that each object has its own overhead from the allocator. Thus we now take that into account when estimating the memory used by adding 8 bytes overhead and aligning to 16 bytes. This seems to be a pretty common way for allocators to work. If possible we could allow for tweaking these values, but they are hard coded currently.</p> </div> </div> <div class="sect2"> <h3 id="_accounting_for_address_count"><a class="anchor" href="#_accounting_for_address_count"></a>Accounting for Address Count</h3> <div class="paragraph"> <p>As was mentioned in the prior blog post about off heap, we allocate a single block of memory to hold address counters for our lookups when using Off Heap. Unfortunately we didn&#8217;t account for that in the memory eviction count. We now account for that in the eviction mechanism, thus your memory eviction size must be greater than the address count rounded up to the nearest power of 2, multiplied by 8. What a mouthful&#8230;&#8203;</p> </div> </div> <div class="sect2"> <h3 id="_wrap_up"><a class="anchor" href="#_wrap_up"></a>Wrap up</h3> <div class="paragraph"> <p>Off heap has been overhauled quite a bit to try to reduce memory usage, fix bugs and more accurately estimate the memory used. We hope that along with the new eviction strategy are welcome additions to various applications.</p> </div> <div class="paragraph"> <p>Please make sure to contact us if you have any feedback, find any bugs or have any questions! You can get in contact with various places listed on our <a href="http://infinispan.org/community/">website</a>.</p> </div> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Monday, 29 January 2018 </h3> <h1> <a href="/blog/2018/01/29/back-from-snowcamp-2018/">Back from Snowcamp 2018</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p><span class="image"><img src="https://4.bp.blogspot.com/-koj_cQcrUCk/Wm9YqV5YfQI/AAAAAAAACHs/lG038T8Q-DIjyqgM_he_mMRDlYaVuwlcQCLcBGAs/s200/snowcamp.png" alt="image" width="200" height="200"></span></p> </div> <div class="paragraph"> <p>This week, I&#8217;m recovering from the <a href="https://snowcamp.io/">Snowcamp 2018</a> conference in Grenoble. I had an amazing time there, where I could hang-out with people from the french community, discussing tech, coding, non-blocking APIs, lifestyle and diversity!</p> </div> <div class="paragraph"> <p>My talk was on Thursday at 15:00. It was very exciting for me because I was live-coding in front of so many people for the first time! I got very valuable feedback from attendees and speakers to improve my content, live-coding skills and encouragements to submit this talk to other user groups and conferences this year.</p> </div> <div class="paragraph"> <p><a href="https://1.bp.blogspot.com/-jNPhTJ97Ta0/Wm9VWBNgApI/AAAAAAAACHk/Vgkn3mAT6ogj7OeUo2wiZql_lH4BVV0kgCEwYBhgL/s1600/livecoding-touched.jpg"><span class="image"><img src="https://1.bp.blogspot.com/-jNPhTJ97Ta0/Wm9VWBNgApI/AAAAAAAACHk/Vgkn3mAT6ogj7OeUo2wiZql_lH4BVV0kgCEwYBhgL/s320/livecoding-touched.jpg" alt="image" width="320" height="240"></span></a></p> </div> <div class="paragraph"> <p>This presentation focuses on the work we have been doing to provide a new API available in Infinispan 9.2 (final release coming very very soon!!!): <a href="http://infinispan.org/docs/dev/user_guide/user_guide.html#clustered_lock">Clustered Locks</a>. These locks are distributed and non blocking, allowing us to synchronise protected code between different Infinispan nodes across a cluster.</p> </div> <div class="paragraph"> <p>It&#8217;s a 45 minutes talk, so I&#8217;m not presenting the API just from the user point of view; instead I go deep into the actual Clustered Locks internals. We have built this first implementation on top of existing Infinispan&#8217;s APIs, which proves that they can be used to do much more than just speeding your applications and caching!</p> </div> <div class="paragraph"> <p>The first user of these locks is the <a href="https://github.com/vert-x3/vertx-infinispan">Vert.x-Infinispan Cluster Manager.</a> Before going into the implementation details, I show how to create a cluster of <a href="http://vertx.io/">Vert.x</a> applications using Infinispan and a simple example of when and how to use a <a href="http://vertx.io/docs/apidocs/io/vertx/core/shareddata/Lock.html">Vert.x Lock</a>. Underneath Vert.x Locks, the next release of the cluster manager will be using the Clustered Locks API. I&#8217;m preparing a longer article on this matter, so stay tuned! Meanwhile, enjoy the presentation slides!</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Monday, 22 January 2018 </h3> <h1> <a href="/blog/2018/01/22/infinispan-coming-to-snowcamp-2018/">Infinispan coming to Snowcamp 2018</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p><a href="http://www.alpesjug.fr/wp-content/uploads/2016/01/alpes-snow-full-illustration.png"><span class="image"><img src="http://www.alpesjug.fr/wp-content/uploads/2016/01/alpes-snow-full-illustration.png" alt="image" width="200" height="200"></span></a></p> </div> <div class="paragraph"> <p>This week, the 25th of January, I will be presenting a talk about <a href="http://infinispan.org/docs/dev/user_guide/user_guide.html#clustered_lock">Clustered Locks</a> at the <a href="http://snowcamp.io/en/">Snowcamp 2018 conference</a> in Grenoble (France). During the live-coding talk, I will share the design and code I&#8217;ve been working on to create this first version of the clustered locks. These locks will be used by the <a href="http://vertx.io/docs/vertx-infinispan/java/">Vert.x Cluster Manager</a>, but they can be useful to any Infinispan user since version 9.2 (final release coming very soon!!). If you are planning to use this API, we would love to hear from you to give us some feedback and keep us posted on your use case!</p> </div> <div class="paragraph"> <p>If you are attending the conference, fell free to reach me to discuss about Infinispan+Vert.x, locks, <a href="http://infinispan.org/docs/dev/user_guide/user_guide.html#multimap_cache">Multimap</a>, <a href="http://blog.infinispan.org/2017/12/first-steps-with-vertx-and-infinispan-rest-api.html">cute names</a> or any other topic that you care about!</p> </div> <div class="paragraph"> <p>See you!</p> </div> <div class="paragraph"> <p>Katia</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Friday, 19 January 2018 </h3> <h1> <a href="/blog/2018/01/19/easier-infinispan-clusters-on-same-jvm/">Easier Infinispan clusters on same JVM with Infinispan 9.2</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Since Infinispan 5.2.0, Infinispan <a href="https://issues.jboss.org/browse/ISPN-2290">registers JMX MBeans by default</a> even if statistics are disabled. This was done so that management related operations could be called even if statistics were disabled.</p> </div> <div class="paragraph"> <p>This change resulted in a small usability problem for those users that wanted to create a cluster of Infinispan instances on the same JVM. This is a very common use case when first starting to use Infinispan or when trying to create some unit tests.</p> </div> <div class="paragraph"> <p>When multiple Infinispan instances run on same JVM, they would all try to register JMX MBeans but unless you explicitly gave each Infinispan instance a different CacheManager name, you&#8217;d see exceptions like this:</p> </div> <div class="paragraph"> <p>Caused by: org.infinispan.jmx.JmxDomainConflictException: ISPN000034: There&#8217;s already a JMX MBean instance type=Cache,name="___defaultcache(repl_sync)",manager="DefaultCacheManager" already registered under 'org.infinispan' JMX domain&#8230;&#8203;</p> </div> <div class="paragraph"> <p>Starting with Infinispan 9.2.0, <a href="https://issues.jboss.org/browse/ISPN-8395">duplicate JMX domains are allowed by default</a>, so you won&#8217;t need to fiddle with JMX domain settings any more to create an Infinispan cluster on the same JVM :)</p> </div> <div class="paragraph"> <p>Cheers, Galder</p> </div> </div> </div> </div> <hr> <div class="pagination-links"><span class="current-page">1</span> <a href="/blog/tags/9.2/page/2/" class="page-link">2</a> <a href="/blog/tags/9.2/page/2/" class="next-link">Next</a> </div> </div> <footer class="container"> <hr> <div class="row"> <div class="col-md-2 col-md-offset-1"> <h4>Navigate</h4> <ul> <li> <a href="/about" title="About">About</a> </li> <li> <a href="/documentation" title="Learn">Learn</a> </li> <li> <a href="/community" title="Community">Community</a> </li> <li> <a href="/getinvolved" title="Get Involved">Get Involved</a> </li> <li> <a href="/download" title="Download">Download</a> </li> </ul> </div> <div class="col-md-2"> <h4>Contribute</h4> <ul> <li> <a href="https://issues.jboss.org/browse/ISPN" title="Submit a bug">Submit a bug</a> </li> <li> <a href="https://github.com/infinispan" title="Write code">Write Code</a> </li> </ul> <h4>Follow Us</h4> <ul> <li> <a href="https://blog.infinispan.org" title="Blog">Blog</a> </li> <li> <a href="https://twitter.com/infinispan" title="Twitter">Twitter</a> </li> </ul> </div> <div class="col-md-2"> <h4>Open Source</h4> <p> Infinispan is released under the <b>Apache 2.0 open source license.</b> Learn more about the Apache 2.0 license <a href="https://www.apache.org/licenses/LICENSE-2.0">here.</a> </p> </div> <div class="col-md-2"> <h4>A member of</h4> <a alt="CloudTM" href="http://www.cloudtm.eu/" target="_NEW"> <img src="/images/cloudtm.png"> </a> <a alt="LEADS" href="http://leads-project.eu/" target="_NEW"> <img src="/images/leads.png"> </a> <a alt="CloudButton" href="http://cloudbutton.eu/" target="_NEW"> <img src="/images/cloudbutton.png"> </a> </div> <div class="col-md-2"> <h4>Thanks to</h4> <p>JetBrains Intellij IDEA</p> <a alt="JetBrains Intellij IDEA" href="https://www.jetbrains.com/idea/" target="_NEW"> <img src="/images/icon_IntelliJIDEA.png"> </a> </div> </div> <div class="col-md-10"> <p style="margin-top: 5px; font-size: 80%;"> © Copyright 2009-2019 Red Hat, Inc. <br> <i class="icon-fire"></i> Made with <a href="https://github.com/jbossorg/bootstrap-community" style="text-decoration: underline;" target="_NEW">JBoss Community Bootstrap</a> and <a href="http://awestruct.org/" style="text-decoration: underline;" target="_NEW">Awestruct</a> <br> <i class="icon-globe"></i> This website is open source! If you want to improve it, <a href="https://github.com/infinispan/infinispan.github.io" style="text-decoration: underline;" target="_NEW">fork the project,</a> and hack on it, then send a pull request. You can also view the <a href="https://www.seethestats.com/site/infinispan.org" style="text-decoration: underline;" target="_NEW">visitor stats.</a> <br> <i class="icon-share"></i> Website and documentation released under <a href="https://creativecommons.org/licenses/by/3.0/" style="text-decoration: underline;" target="_NEW">CC BY 3.0.</a> </p> </div> </footer> <div class="container" id="companyfooter"> <div class="redhatlogo"> <div id="logospacer"></div> <a href="http://www.redhat.com/"><img src="//static.jboss.org/theme/images/common/redhat_logo.png"></a> </div> </div> <span class="backToTop"> <a href="#top">back to top</a> </span> <script src="//static.jboss.org/theme/js/libs/bootstrap-community/3.2.0.2/bootstrap-community.min.js"></script> <script>
        if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
          _satellite.pageBottom();
        }
      </script> </div> </body> </html>