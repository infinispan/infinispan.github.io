<!DOCTYPE html> <html lang="en"> <head> <title>Blog - Infinispan</title> <meta charset="utf-8"> <meta content="width=device-width, initial-scale=1.0" name="viewport"> <meta content="DENY" http-equiv="X-Frame-Options"> <meta content="1; mode=block" http-equiv="X-XSS-Protection"> <meta content="nosniff" http-equiv="X-Content-Type-Options"> <link href="https://static.jboss.org/theme/css/bootstrap-community/3.2.0.2/bootstrap-community.min.css" media="screen" rel="stylesheet"> <link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" rel="stylesheet"> <script id="dpal" src="https://www.redhat.com/dtm.js" type="text/javascript"></script> <link href="/images/favicon.png" rel="shortcut icon" type="image/png"> <link href="//static.jboss.org/images/example/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144"> <link href="//static.jboss.org/images/example/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114"> <link href="//static.jboss.org/images/example/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72"> <link href="//static.jboss.org/images/example/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed"> <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" rel="stylesheet"> <link href="https://static.jboss.org/css/rhbar.css" media="screen" rel="stylesheet"> <style>
      .jumbotron {
        padding: 0.5em 0.1em 0.5em 0.1em;
        background-image: none;
        background-color: #ffec9f;
      }
      .jumbotron p, 
      .jumbotron h1 {
        color: #656565;
      }
      .dropup {
        z-index: 1032;
      }
      .navbar {
        font-size: x-large;
      }
      .navbar ul {
        padding-top: 0.7em;
      }
      .navbar-brand {
        height: 80px;
      }
      .navbar-default {
        background-color: white;
      }
      .navbar-default .navbar-nav > li > a {
        color: #336699;
      }
      .navbar-default .navbar-nav > li > a:hover {
        color: #204060;
      }
      .navbar-default .navbar-nav > .open > a,
      .navbar-default .navbar-nav > .open > a:hover,
      .navbar-default .navbar-nav > .open > a:focus {
        background-color: #4a5d75;
      }
      h3.well {
        border-color: #ffd630;
        background-color: #ffec9f;
      }
      .panel-sidebar {
        border-color: #f5f5f5;
      }
      .panel-sidebar > .panel-heading {
        border-color: #e3e3e3;
        background-color: #f5f5f5;
        color: #656565;
      }
      .btn-primary {
        border-color: #ffd630;
        background-color: #ffec9f;
        color: #656565;
      }
      footer.container {
        background-color: white;
      }
      footer.container h1, footer.container h2, footer.container h3, footer.container h4, footer.container h5, footer.container h6, footer.container p, footer.container a {
        color: #656565;
      }
      footer.container ul {
        padding: 0;
      }
      i.enormous-icon {
        margin-top: 0.3em;
      }
      .home-examples {
        font-size: 16px;
      }
    </style> <script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.min.js"></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script> <script>
      hljs.initHighlightingOnLoad();
    </script> <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
     
    ga('create', 'UA-8601422-1', 'auto');
    ga('send', 'pageview');
    
    </script> </head> <body> <div id=""> <ul class="visuallyhidden" id="top"> <li> <a accesskey="n" href="#nav" title="Skip to navigation">Skip to navigation</a> </li> <li> <a accesskey="c" href="#page" title="Skip to content">Skip to content</a> </li> </ul> <div id="rhbar"> <a class="jbdevlogo" href="http://www.jboss.org/projects/about"></a> <a class="rhlogo" href="http://www.redhat.com/"></a> </div> <div class="container" id="content"> <nav class="navbar navbar-default navbar-fixed-top"> <div class="container"> <div class="navbar-header"> <button aria-expanded="false" class="navbar-toggle collapsed" data-target="#thenavbar" data-toggle="collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/"> <img alt="Infinispan" src="/images/infinispan_nav_brand.png"> </a> </div> <div class="navbar-collapse collapse" id="thenavbar"> <ul class="nav navbar-nav"> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/about">About <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/about">Introduction</a></li> <li><a href="/features">Features</a></li> <li><a href="/release-notes">Release notes</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/references">References</a></li> <li><a href="/experiments/">Experiments</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/documentation">Learn <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/documentation">Documentation</a></li> <li><a href="/tutorials">Tutorials</a></li> <li><a href="/videos">Videos</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/download">Download <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/download">Infinispan Releases</a></li> <li><a href="/cache-store-implementations">Cache Store Implementations</a></li> <li><a href="/hotrod-clients">Hot Rod Clients</a></li> <li><a href="/integrations">Integrations</a></li> <li><a href="/download-archive">Archive</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/community">Community <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/community">Ask for Help</a></li> <li><a href="/getinvolved">Get Involved</a></li> </ul> </li> <li class=""><a href="/roadmap">Road Map</a></li> <li class="divider"></li> </ul> </div> </div> </nav> <div class="post"></div> <h3> Friday, 20 October 2017 </h3> <h1> <a href="/blog/2017/10/20/cache-store-batch-operations/">Cache Store Batch Operations</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan 9.1.x introduces batch write and delete operations for cache stores. The introduction of batching should greatly improve performance when utilising write-behind cache stores, using putAll operations and committing transactions in non-transactional stores.</p> </div> <div class="paragraph"> <p>==</p> </div> <div class="paragraph"> <p>==</p> </div> <div class="paragraph"> <p>==</p> </div> </div> </div> <div class="sect1"> <h2 id="_cachewriter_interface_additions"><a class="anchor" href="#_cachewriter_interface_additions"></a>CacheWriter Interface Additions</h2> <div class="sectionbody"> <div class="paragraph"> <p>The CacheWriter interface has been extended so that it exposes two additional methods: deleteBatch and writeBatch.  For the sake of backwards compatibility a default implementation of these methods is provided, however if your cache store is able to utilise batching we strongly recommend you create your  own implementations. The additional methods and docs are show below: </p> </div> <div class="sect2"> <h3 id="_updated_stores"><a class="anchor" href="#_updated_stores"></a>Updated Stores</h3> <div class="paragraph"> <p>Currently the JDBC, JPA, RocksDB and Remote stores have all been modified to take advantage of these latest changes.</p> </div> <div class="paragraph"> <p>==</p> </div> <div class="paragraph"> <p>==</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_configuration_changes"><a class="anchor" href="#_configuration_changes"></a>Configuration Changes</h2> <div class="sectionbody"> <div class="paragraph"> <p>As each store implementations has different batching capabilities, it was necessary to introduce a max-batch-size attribute to the AbstractStoreConfiguration. This attribute defines the maximum number of entries that should be included in a single batch operation to the store. If a value less than one is provided, then the underlying store implementation should not place a upper limit on the number of entries in a batch. </p> </div> <div class="sect2"> <h3 id="_deprecated_attributes"><a class="anchor" href="#_deprecated_attributes"></a>Deprecated Attributes</h3> <div class="paragraph"> <p>Both TableManipulationConfiguration#batchSize and JpaStoreConfiguration#batchSize have been deprecated, as they serve the same purpose as AbstractStoreConfiguration#maxBatchSize.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_store_benchmark"><a class="anchor" href="#_store_benchmark"></a>Store Benchmark</h2> <div class="sectionbody"> <div class="paragraph"> <p>To measure the impact of batch writes on Cache.putAll, we created a <a href="https://github.com/ryanemerson/benchmarks/tree/master/store">simple benchmark</a> to compare the performance of Infinispan 9.1.1.Final (with batching) and 9.0.3.Final (without).  The benchmark consisted of 20 threads inserting 100000 cache entries as fast as possible into a cache via putAll; with each putAll operation containing 20 cache entries and the max-batch-size of each store being set to 20. The table below shows the average time taken for each store type after the benchmark was executed three times.</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 25%;"> <col style="width: 25%;"> <col style="width: 25%;"> <col style="width: 25%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Store Type</th> <th class="tableblock halign-left valign-top">9.0.3.Final</th> <th class="tableblock halign-left valign-top">9.1.1-Final</th> <th class="tableblock halign-left valign-top">Latency Decrease</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">JdbcStringBasedStore</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">29368ms</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">2597ms</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">91.12%</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">JPAStore</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">30798ms</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">16640ms</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">45.97%</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">RocksDBStore</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">1164ms</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">209ms</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">82.04%</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>==</p> </div> <div class="paragraph"> <p>The benchmark results above clearly show that performance is increased dramatically when utilising batch updates at the store level.</p> </div> <div class="paragraph"> <p>==</p> </div> <div class="paragraph"> <p>==</p> </div> </div> </div> <div class="sect1"> <h2 id="_conclusions"><a class="anchor" href="#_conclusions"></a>Conclusions</h2> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan 9.1.x introduces batching capabilities to the CacheWriter interface in order to improve performance. If you currently utilise a custom cache store, we strongly recommend that you provide your own implementation of the delete and write batch methods. </p> </div> <div class="paragraph"> <p>If you have any feedback on the CacheWriter changes, or would like to request some new features/optimisations, let us know via the <a href="https://developer.jboss.org/en/infinispan/content">forum</a>, <a href="https://issues.jboss.org/projects/ISPN">issue tracker</a> or the #infinispan channel onhttp://webchat.freenode.net/?channels=%23infinispan[ Freenode].</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Monday, 09 September 2013 </h3> <h1> <a href="/blog/2013/09/09/infinispan-600alpha4-out-with-new/">Infinispan 6.0.0.Alpha4 out with new CacheLoader/CacheWriter API!</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan 6.0.0.Alpha4 is now with a few very important changes, particularly around cache stores. We&#8217;ve completely revamped the cache store/loader API to align it a bit better with JSR-107 (old CacheStore has become CacheWriter) and to simplify creation of new implementations. The new <a href="https://github.com/infinispan/infinispan/blob/6.0.0.Alpha4/core/src/main/java/org/infinispan/persistence/spi/CacheLoader.java">CacheLoader</a> and <a href="https://github.com/infinispan/infinispan/blob/6.0.0.Alpha4/core/src/main/java/org/infinispan/persistence/spi/CacheWriter.java">CacheWriter</a> should help implementors focus on the important operations and reduce the coding time. We&#8217;ve also created <a href="https://github.com/infinispan/infinispan/blob/6.0.0.Alpha4/core/src/main/java/org/infinispan/persistence/spi/AdvancedCacheLoader.java">AdvancedCacheLoader</a> and <a href="https://github.com/infinispan/infinispan/blob/6.0.0.Alpha4/core/src/main/java/org/infinispan/persistence/spi/AdvancedCacheWriter.java">AdvancedCacheWriter</a> in order to separate for bulk operations or purging for those implementations that wish optionally implement them. Expect a blog post from Mircea in the next few days providing many more details on this topic.</p> </div> <div class="paragraph"> <p>This new Infinispan version comes with other important goodies:</p> </div> <div class="ulist"> <ul> <li> <p>Rolling upgrades of a Infinsipan REST cluster</p> </li> <li> <p>Support for Cache-Control headers for REST operations</p> </li> <li> <p>Remote querying server modules and Hot Rod client update</p> </li> <li> <p>REST and LevelDB stores added to Infinispan Server</p> </li> <li> <p><a href="https://github.com/infinispan/infinispan/blob/6.0.0.Alpha4/core/src/main/java/org/infinispan/notifications/KeyFilter.java">KeyFilters</a> can now be applied to Cache listeners</p> </li> <li> <p>Allow Cache listener events to be invoked only on the primary data owner</p> </li> </ul> </div> <div class="paragraph"> <p>For a complete list of features and fixes included in this release please refer to the <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12321856">release notes</a>. Visit our <a href="http://www.jboss.org/infinispan/downloads">downloads</a> section to find the latest release and if you have any questions please check <a href="http://www.jboss.org/infinispan/forums">our forums</a>, our <a href="https://lists.jboss.org/mailman/listinfo/infinispan-dev">mailing lists</a> or ping us directly on <a href="irc://irc.freenode.org/infinispan">IRC</a>.</p> </div> <div class="paragraph"> <p>Cheers,</p> </div> <div class="paragraph"> <p>Galder</p> </div> </div> </div> </div> <hr> <div class="pagination-links"><span class="current-page">1</span> </div> </div> <footer class="container"> <hr> <div class="row"> <div class="col-md-2 col-md-offset-1"> <h4>Navigate</h4> <ul> <li> <a href="/about" title="About">About</a> </li> <li> <a href="/documentation" title="Learn">Learn</a> </li> <li> <a href="/community" title="Community">Community</a> </li> <li> <a href="/getinvolved" title="Get Involved">Get Involved</a> </li> <li> <a href="/download" title="Download">Download</a> </li> </ul> </div> <div class="col-md-2"> <h4>Contribute</h4> <ul> <li> <a href="https://issues.jboss.org/browse/ISPN" title="Submit a bug">Submit a bug</a> </li> <li> <a href="https://github.com/infinispan" title="Write code">Write Code</a> </li> </ul> <h4>Follow Us</h4> <ul> <li> <a href="https://blog.infinispan.org" title="Blog">Blog</a> </li> <li> <a href="https://twitter.com/infinispan" title="Twitter">Twitter</a> </li> </ul> </div> <div class="col-md-2"> <h4>Open Source</h4> <p> Infinispan is released under the <b>Apache 2.0 open source license.</b> Learn more about the Apache 2.0 license <a href="https://www.apache.org/licenses/LICENSE-2.0">here.</a> </p> </div> <div class="col-md-2"> <h4>A member of</h4> <a alt="CloudTM" href="http://www.cloudtm.eu/" target="_NEW"> <img src="/images/cloudtm.png"> </a> <a alt="LEADS" href="http://leads-project.eu/" target="_NEW"> <img src="/images/leads.png"> </a> <a alt="CloudButton" href="http://cloudbutton.eu/" target="_NEW"> <img src="/images/cloudbutton.png"> </a> </div> <div class="col-md-2"> <h4>Thanks to</h4> <p>JetBrains Intellij IDEA</p> <a alt="JetBrains Intellij IDEA" href="https://www.jetbrains.com/idea/" target="_NEW"> <img src="/images/icon_IntelliJIDEA.png"> </a> </div> </div> <div class="col-md-10"> <p style="margin-top: 5px; font-size: 80%;"> © Copyright 2009-2019 Red Hat, Inc. <br> <i class="icon-fire"></i> Made with <a href="https://github.com/jbossorg/bootstrap-community" style="text-decoration: underline;" target="_NEW">JBoss Community Bootstrap</a> and <a href="http://awestruct.org/" style="text-decoration: underline;" target="_NEW">Awestruct</a> <br> <i class="icon-globe"></i> This website is open source! If you want to improve it, <a href="https://github.com/infinispan/infinispan.github.io" style="text-decoration: underline;" target="_NEW">fork the project,</a> and hack on it, then send a pull request. You can also view the <a href="https://www.seethestats.com/site/infinispan.org" style="text-decoration: underline;" target="_NEW">visitor stats.</a> <br> <i class="icon-share"></i> Website and documentation released under <a href="https://creativecommons.org/licenses/by/3.0/" style="text-decoration: underline;" target="_NEW">CC BY 3.0.</a> </p> </div> </footer> <div class="container" id="companyfooter"> <div class="redhatlogo"> <div id="logospacer"></div> <a href="http://www.redhat.com/"><img src="//static.jboss.org/theme/images/common/redhat_logo.png"></a> </div> </div> <span class="backToTop"> <a href="#top">back to top</a> </span> <script src="//static.jboss.org/theme/js/libs/bootstrap-community/3.2.0.2/bootstrap-community.min.js"></script> <script>
        if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
          _satellite.pageBottom();
        }
      </script> </div> </body> </html>