<!DOCTYPE html> <html lang="en"> <head> <title>Blog - Infinispan</title> <meta charset="utf-8"> <meta content="width=device-width, initial-scale=1.0" name="viewport"> <meta content="DENY" http-equiv="X-Frame-Options"> <meta content="1; mode=block" http-equiv="X-XSS-Protection"> <meta content="nosniff" http-equiv="X-Content-Type-Options"> <link href="https://static.jboss.org/theme/css/bootstrap-community/3.2.0.2/bootstrap-community.min.css" media="screen" rel="stylesheet"> <link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" rel="stylesheet"> <script id="dpal" src="https://www.redhat.com/dtm.js" type="text/javascript"></script> <link href="/images/favicon.png" rel="shortcut icon" type="image/png"> <link href="//static.jboss.org/images/example/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144"> <link href="//static.jboss.org/images/example/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114"> <link href="//static.jboss.org/images/example/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72"> <link href="//static.jboss.org/images/example/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed"> <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" rel="stylesheet"> <link href="https://static.jboss.org/css/rhbar.css" media="screen" rel="stylesheet"> <style>
      .jumbotron {
        padding: 0.5em 0.1em 0.5em 0.1em;
        background-image: none;
        background-color: #ffec9f;
      }
      .jumbotron p, 
      .jumbotron h1 {
        color: #656565;
      }
      .dropup {
        z-index: 1032;
      }
      .navbar {
        font-size: x-large;
      }
      .navbar ul {
        padding-top: 0.7em;
      }
      .navbar-brand {
        height: 80px;
      }
      .navbar-default {
        background-color: white;
      }
      .navbar-default .navbar-nav > li > a {
        color: #336699;
      }
      .navbar-default .navbar-nav > li > a:hover {
        color: #204060;
      }
      .navbar-default .navbar-nav > .open > a,
      .navbar-default .navbar-nav > .open > a:hover,
      .navbar-default .navbar-nav > .open > a:focus {
        background-color: #4a5d75;
      }
      h3.well {
        border-color: #ffd630;
        background-color: #ffec9f;
      }
      .panel-sidebar {
        border-color: #f5f5f5;
      }
      .panel-sidebar > .panel-heading {
        border-color: #e3e3e3;
        background-color: #f5f5f5;
        color: #656565;
      }
      .btn-primary {
        border-color: #ffd630;
        background-color: #ffec9f;
        color: #656565;
      }
      footer.container {
        background-color: white;
      }
      footer.container h1, footer.container h2, footer.container h3, footer.container h4, footer.container h5, footer.container h6, footer.container p, footer.container a {
        color: #656565;
      }
      footer.container ul {
        padding: 0;
      }
      i.enormous-icon {
        margin-top: 0.3em;
      }
      .home-examples {
        font-size: 16px;
      }
    </style> <script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.min.js"></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script> <script>
      hljs.initHighlightingOnLoad();
    </script> <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
     
    ga('create', 'UA-8601422-1', 'auto');
    ga('send', 'pageview');
    
    </script> </head> <body> <div id=""> <ul class="visuallyhidden" id="top"> <li> <a accesskey="n" href="#nav" title="Skip to navigation">Skip to navigation</a> </li> <li> <a accesskey="c" href="#page" title="Skip to content">Skip to content</a> </li> </ul> <div id="rhbar"> <a class="jbdevlogo" href="http://www.jboss.org/projects/about"></a> <a class="rhlogo" href="http://www.redhat.com/"></a> </div> <div class="container" id="content"> <nav class="navbar navbar-default navbar-fixed-top"> <div class="container"> <div class="navbar-header"> <button aria-expanded="false" class="navbar-toggle collapsed" data-target="#thenavbar" data-toggle="collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/"> <img alt="Infinispan" src="/images/infinispan_nav_brand.png"> </a> </div> <div class="navbar-collapse collapse" id="thenavbar"> <ul class="nav navbar-nav"> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/about">About <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/about">Introduction</a></li> <li><a href="/features">Features</a></li> <li><a href="/release-notes">Release notes</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/references">References</a></li> <li><a href="/experiments/">Experiments</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/documentation">Learn <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/documentation">Documentation</a></li> <li><a href="/tutorials">Tutorials</a></li> <li><a href="/videos">Videos</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/download">Download <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/download">Infinispan Releases</a></li> <li><a href="/cache-store-implementations">Cache Store Implementations</a></li> <li><a href="/hotrod-clients">Hot Rod Clients</a></li> <li><a href="/integrations">Integrations</a></li> <li><a href="/download-archive">Archive</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/community">Community <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/community">Ask for Help</a></li> <li><a href="/getinvolved">Get Involved</a></li> </ul> </li> <li class=""><a href="/roadmap">Road Map</a></li> <li class="divider"></li> </ul> </div> </div> </nav> <div class="post"></div> <h3> Monday, 12 September 2011 </h3> <h1> <a href="/blog/2011/09/12/infinispan-501final-is-out/">Infinispan 5.0.1.FINAL is out!</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Thanks to everyone that downloaded Infinispan 5.0.0.FINAL in the last month. We&#8217;ve had tremendous feedback and as a result of that we&#8217;ve just released Infinispan 5.0.1.FINAL to address some of the most important issues reported. These issues are primarily around <a href="https://docs.jboss.org/author/x/-4B7">distribution clustering mode</a> and rehashing. So, if you&#8217;re using any of these features, I&#8217;d strongly recommend that you upgrade as soon as possible.</p> </div> <div class="paragraph"> <p>Please keep the <a href="http://community.jboss.org/en/infinispan?view=discussions">feedback</a> coming, and as always, you can download the release from <a href="http://www.jboss.org/infinispan/downloads">here</a> and you get further details on the issues addressed in the <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12318077">changelog</a>.</p> </div> <div class="paragraph"> <p>Finally, we know have a <a href="https://docs.jboss.org/author/x/iYB7">documentation space fully dedicated to Infinispan 5.0</a>. Make sure you check it out!</p> </div> <div class="paragraph"> <p>Cheers, Galder</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Thursday, 01 September 2011 </h3> <h1> <a href="/blog/2011/09/01/javaone-2011-and-devoxx-2011/">JavaOne 2011 and Devoxx 2011</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p><a href="http://www.oracle.com/javaone/11053828-j1-imspeaking-250x250-427822.gif"><span class="image"><img src="http://www.oracle.com/javaone/11053828-j1-imspeaking-250x250-427822.gif" alt="image"></span></a>I never got around to blogging about this when my talks were accepted for <a href="http://www.oracle.com/javaone/index.html">JavaOne</a> this year, but it&#8217;s about time.</p> </div> <div class="paragraph"> <p>I have a conference session titled "https://oracleus.wingateweb.com/content/sessionDetail.do?SESSION_ID=23382[A Tale About Caching (JSR 107) and Data Grids (JSR 347) in Enterprise Java]" and a BoF session focused on JSR 347 titled "https://oracleus.wingateweb.com/content/sessionDetail.do?SESSION_ID=23380[Making Java EE Cloud-Friendly: JSR 347, Data Grids for the Java Platform]", which I will be delivering with fellow Infinispan developer, JBoss rockstar and overall nice guy <a href="http://community.jboss.org/people/petemuir">Pete Muir</a>.</p> </div> <div class="paragraph"> <p><a href="http://www.devoxx.com/download/attachments/5013581/DEVOXX-Banner120x240_V2-anim.gif?version=1&amp;modificationDate=1306928357000"><span class="image"><img src="http://www.devoxx.com/download/attachments/5013581/DEVOXX-Banner120x240_V2-anim.gif?version=1&amp;modificationDate=1306928357000" alt="image"></span></a>Later on in the year, I will also be running a University talk at <a href="http://www.devoxx.com/display/DV11/Home">Devoxx</a> in Antwerp, titled "http://www.devoxx.com/display/DV11/Real-world+deep-dive+into+Infinispan+-+the+open+source+data+grid+platform[A real-world deep-dive into Infinispan]".  This too will be with Pete and <a href="http://community.jboss.org/people/mircea.markus">Mircea Markus</a>, another core Infinispan developer.</p> </div> <div class="paragraph"> <p>This will be a great chance to learn more about Infinispan, data grids, JSR 107 and JSR 347, so if you are attending these conferences, make sure you add these talks to your agenda!  :-)</p> </div> <div class="paragraph"> <p>Cheers Manik</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Wednesday, 10 August 2011 </h3> <h1> <a href="/blog/2011/08/10/transactions-enhancements-in-50/">Transactions enhancements in 5.0</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Besides other cool features such as Map reduce and distributed executors, Infinispan 5.0.0 "Pagoa" brings some significant improvements around transactional functionality:</p> </div> <div class="ulist"> <ul> <li> <p><a href="https://docs.jboss.org/author/x/BIF7">transaction recovery</a> <a href="http://community.jboss.org/docs/DOC-16646?uniqueTitle=false" class="bare">http://community.jboss.org/docs/DOC-16646?uniqueTitle=false</a> is now supported, with a set of tools that allow state reconciliation in case the transaction fails during 2nd phase of 2PC. This is especially useful in the case of transactions spreading over Infinispan and another resource manager, e.g. a database (distributed transactions). You can find out more on how to enable and use transaction recovery <a href="https://docs.jboss.org/author/x/BIF7">here</a>.</p> </li> <li> <p><a href="http://download.oracle.com/javaee/1.3/api/javax/transaction/Synchronization.html">Synchronization</a> enlistment is another important feature in this release. This allows Infinispan to enlist in a transaction as an <a href="http://download.oracle.com/javaee/1.3/api/javax/transaction/Synchronization.html">Synchronization</a> rather than an <a href="http://download.oracle.com/javaee/1.3/api/javax/transaction/xa/XAResource.html">XAResource</a>.This enlistment allows the TransactionManager to optimize 2PC with a 1PC where only one other resource is enlisted with that transaction (<a href="http://docs.redhat.com/docs/en-US/JBoss_Enterprise_Web_Platform/5/html/Administration_And_Configuration_Guide/ch09s04.html">last resource commit optimization</a>). This is particularly important when using Infinispan as a 2nd level cache in Hibernate. You can read more about this feature <a href="https://docs.jboss.org/author/x/_YB7">here</a>.</p> </li> <li> <p>besides that several bugs were fixed particularly when it comes to the integration with a transaction manager - BIG thanks to the community for reporting and testing them!</p> </li> </ul> </div> <div class="paragraph"> <p>To summarise, Infinispan can participate in a transaction in 3 ways:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>as a fully fledged XAResource that supports recovery</p> </li> <li> <p>as an XAResource, but without recovery. This is the default configuration</p> </li> <li> <p>and as an Synchronization</p> </li> </ol> </div> <div class="paragraph"> <p>In order to analyze the performance of running Infinispan in different transactional modes I&#8217;ve <a href="https://sourceforge.net/apps/trac/radargun/wiki/BenchmarkingTransactions">enhanced</a> and used <a href="http://sourceforge.net/apps/trac/radargun/wiki/WikiStart">Radargun</a>. The diagram below shows a performance comparison between running Infinispan in all the 3 modes described. The forth plot in the chart shows the performance of running Infinispan without transactions - this gives an idea about the cost of using transactions vs. raw operations.</p> </div> <div class="paragraph"> <p><a href="http://3.bp.blogspot.com/-OBeJ5lxWquM/TgRePeHHFxI/AAAAAAAAB_g/ob6y0_gHpZ8/s1600/tx_benchmark.png"><span class="image"><img src="http://3.bp.blogspot.com/-OBeJ5lxWquM/TgRePeHHFxI/AAAAAAAAB_g/ob6y0_gHpZ8/s400/tx_benchmark.png" alt="image"></span></a></p> </div> <div class="paragraph"> <p>The benchmark was run on <a href="https://github.com/mmarkus/radargun/blob/blog_13Jun_2011/plugins/infinispan5/src/main/resources/benchmark/benchmark-tx.xml">this</a> Radargun configuration, using Infinispan 5.0.0.CR5 configured as shown <a href="https://github.com/mmarkus/radargun/blob/blog_13Jun_2011/plugins/infinispan5/src/main/resources/dist-tx-sync-commit.xml">here</a>. As a TransactionManager <a href="https://github.com/mmarkus/radargun/blob/blog_13Jun_2011/plugins/infinispan5/pom.xml#L38">JBossTS 4.15.0.FINAL</a> was used, configured with a VolatileStore as shown <a href="https://github.com/mmarkus/radargun/blob/blog_13Jun_2011/plugins/infinispan5/src/main/java/org/radargun/infinispan/JBossTMLookup.java">here</a>. Each node was an <a href="http://ark.intel.com/Product.aspx?id=47923">4-core Intel&#174; Xeon&#174; CPU E5640 @ 2.67GHz</a>, with 4GB RAM.</p> </div> <div class="paragraph"> <p>Each transaction spread over only one put operation. The chart shows the following:</p> </div> <div class="ulist"> <ul> <li> <p>a non-transactional put is about 40% faster than a transactional one</p> </li> <li> <p><a href="http://download.oracle.com/javaee/1.3/api/javax/transaction/Synchronization.html">Synchronization</a>-enlisted transactions outperform an <a href="http://download.oracle.com/javaee/1.3/api/javax/transaction/xa/XAResource.html">XAResource</a> enlisted one by about 20%</p> </li> <li> <p>A recoverable cache has about the same performance as a non-recoverable cache when it comes to transactions.</p> </li> </ul> </div> <div class="paragraph"> <p>And that&#8217;s not all! During Infinispan 5.0.0 development we&#8217;ve been thinking a lot about how we can improve transactional throughput, especially in scenarios in which multiple transactions are writing on the same key. As a result we&#8217;ve come up with some improvement suggestions summarised <a href="http://community.jboss.org/wiki/PossibleLockingImprovements">here</a>: please feel free to take a look and comment!</p> </div> <div class="paragraph"> <p>Cheers,</p> </div> <div class="paragraph"> <p>Mircea</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Friday, 05 August 2011 </h3> <h1> <a href="/blog/2011/08/05/infinispan-500final-has-hit-streets/">Infinispan 5.0.0.FINAL has hit the streets!</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>So here we have it - Infinispan 5.0 Pagoa has been released.  This is a big, big release over 4.2.x, with over 45 new features (including the much more robust <a href="https://issues.jboss.org/browse/ISPN-1000">PUSH-based rehashing</a>, <a href="https://issues.jboss.org/browse/ISPN-272">XA recovery</a>, <a href="https://issues.jboss.org/browse/ISPN-186">smart L1 invalidation</a> and <a href="https://issues.jboss.org/browse/ISPN-870">virtual nodes</a>) and over 30 bugs squashed, including several critical performance and stability related ones.  Major new programming models are supported too - from <a href="https://docs.jboss.org/author/x/AIF7">Spring</a> and <a href="https://docs.jboss.org/author/x/HYF7">CDI</a> through to OSGi, <a href="https://docs.jboss.org/author/x/CYF7">map/reduce and distributed code execution</a>.</p> </div> <div class="paragraph"> <p>Pagoa has gone through over six months of development, the first alpha being made publicly available in December 2010, and 8 whole release candidates since the end of April this year.  This is the most stable, fastest, feature-rich version of Infinispan to date.  Pagoa has been integrated in other products, projects, frameworks and services - including the lightning-fast <a href="http://www.jboss.org/as7">JBoss AS 7</a> - and we expect to see much, much more in this regard.</p> </div> <div class="paragraph"> <p>Pagoa really is a community-centric release.  I&#8217;ve seen loads of participation, from users, system integrators, extension-authors, <a href="http://www.cloudtm.eu/">researchers and academics</a>, framework authors, and PaaS providers.  This participation has taken the form of providing feedback and bug reports through to profiler analysis; from helping with documentation and demos through to contributing major new features; from suggesting ideas and improvements to participating in detailed design meetings.  It is this participation that really helps Infinispan grow and mature, and at the same time innovate, taking us one step closer to becoming the best damn data grid out there.</p> </div> <div class="paragraph"> <p>So, a big thank you to everyone who participated, this really is <em>your</em> release.</p> </div> <div class="paragraph"> <p>As usual, <a href="http://www.jboss.org/infinispan/downloads">download</a> the release, <a href="http://community.jboss.org/en/infinispan?view=discussions">provide feedback</a>, read through the <a href="https://issues.jboss.org/secure/ConfigureReport.jspa?atl_token=AQZJ-FV3A-N91S-UDEU%7C830c959e6f913e242bc3c9df8565631d3af3b0e0%7Clin&amp;versions=12313468&amp;sections=all&amp;style=none&amp;selectedProjectId=12310799&amp;reportKey=org.jboss.labs.jira.plugin.release-notes-report-plugin%3Areleasenotes&amp;Next=Next">detailed changelog</a>.  And check out our brand-new <a href="https://docs.jboss.org/author/x/iYB7">documentation site</a> too!!  :-)</p> </div> <div class="paragraph"> <p>Finally, in other news, <a href="http://infinispan.blogspot.com/2011/07/infinispan-51-has-codename.html">I recently blogged about Brahma</a>, the codename for Infinispan 5.1. Yes, work has already started here, expect Brahma to be a real firecracker.  Check out the post, vote for your most desired features.  Brahma will also form the basis of Red Hat&#8217;s Enterprise Data Grid product, which was <a href="http://infinispan.blogspot.com/2011/05/red-hat-announces-enterprise-data-grid.html">announced in May</a>.  You&#8217;ll finally have a fully supported open source data grid!</p> </div> <div class="paragraph"> <p>Enjoy!</p> </div> <div class="paragraph"> <p>Manik</p> </div> </div> </div> </div> <hr> <div class="post"></div> <h3> Wednesday, 27 July 2011 </h3> <h1> <a href="/blog/2011/07/27/infinispan-in-jboss-as7/">Infinispan in JBoss AS7</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>A couple weeks ago saw the final release of JBoss AS 7.0. Like AS6 before it, AS7 uses Infinispan as the distributed caching solution behind its clustering functionality. So what do you need to know about using Infinispan in AS7?</p> </div> </div> </div> <div class="sect1"> <h2 id="_configuration"><a class="anchor" href="#_configuration"></a>Configuration</h2> <div class="sectionbody"> <div class="paragraph"> <p>Unlike previous releases of JBoss AS, AS7 centralizes all server configuration into one location. This include Infinispan cache configurations, which are defined by the Infinispan subsystem, within domain.xml or standalone.xml:</p> </div> <div class="paragraph"> <p><a href="https://raw.github.com/jbossas/jboss-as/7.0.0.Final/build/src/main/resources/domain/configuration/domain.xml">$JBOSS_HOME/domain/configuration/domain.xml</a></p> </div> <div class="paragraph"> <p><a href="https://raw.github.com/jbossas/jboss-as/7.0.0.Final/build/src/main/resources/standalone/configuration/standalone-ha.xml">$JBOSS_HOME/standalone/configuration/standalone-ha.xml</a></p> </div> <div class="paragraph"> <p>The complete schema for the Infinispan subsystem is included in the AS7 binary distribution:</p> </div> <div class="paragraph"> <p><a href="https://raw.github.com/jbossas/jboss-as/7.0.0.Final/build/src/main/resources/docs/schema/jboss-infinispan.xsd">$JBOSS_HOME/docs/schema/jboss-infinispan.xsd</a></p> </div> <div class="paragraph"> <p>If you are familiar with Infinispan&#8217;s native configuration file format or the corresponding configuration file from AS6, you&#8217;ll notice some obvious similarities, but some noteworthy differences.</p> </div> <div class="paragraph"> <p>While a native Infinispan configuration file contains cache configurations for a single cache container, like AS6, the Infinispan subsystem configuration defines multiple cache containers, each identified by a name. As with AS6, cache containers can have 1 or more aliases.</p> </div> <div class="sect2"> <h3 id="_being_concise"><a class="anchor" href="#_being_concise"></a>Being concise</h3> <div class="paragraph"> <p>The Infinispan subsystem&#8217;s configuration schema attempts to be more concise than the equivalent configuration in AS6. This is a direct result of the following changes:</p> </div> <div class="sect3"> <h4 id="_where_is_global"><a class="anchor" href="#_where_is_global"></a>Where is &lt;global/&gt;?</h4> <div class="paragraph"> <p>Much of the global configuration contains references to other AS services. In AS7, these services are auto-injected behind the scenes. This includes things like thread pools (described below), the JGroups transport (also described below), and the mbean server.</p> </div> </div> <div class="sect3"> <h4 id="_configuration_default_values"><a class="anchor" href="#_configuration_default_values"></a>Configuration default values</h4> <div class="paragraph"> <p>AS7 supplies a set of custom default values for various configuration properties. These defaults differ depending on the cache mode. The complete set of default values can be found here:</p> </div> <div class="paragraph"> <p><a href="https://github.com/jbossas/jboss-as/blob/master/clustering/infinispan/src/main/resources/infinispan-defaults.xml" class="bare">https://github.com/jbossas/jboss-as/blob/master/clustering/infinispan/src/main/resources/infinispan-defaults.xml</a></p> </div> </div> <div class="sect3"> <h4 id="_file_based_cache_store"><a class="anchor" href="#_file_based_cache_store"></a>File-based cache store</h4> <div class="paragraph"> <p>Because clustering services use the file-based cache store frequently, we&#8217;ve simplified its definition. First, by using a distinctive element, you no longer need to specify the class name. The location of the store is defined by 2 attributes:</p> </div> <div class="quoteblock"> <blockquote> <div class="paragraph"> <p><mark>&lt;file-store relative-to="&#8230;&#8203;" path="&#8230;&#8203;"/&gt;</mark></p> </div> </blockquote> </div> <div class="paragraph"> <p>The <em>relative-to</em> attribute defines a named path, and defaults to the server&#8217;s data directory; whereas the <em>path</em> attribute specifies the directory within <em>relative-to</em>, and defaults to the cache container name.</p> </div> </div> <div class="sect3"> <h4 id="_specifying_cache_mode"><a class="anchor" href="#_specifying_cache_mode"></a>Specifying cache mode</h4> <div class="paragraph"> <p>Instead of defining the cache mode via a separate &lt;clustering mode="&#8230;&#8203;"/&gt; attribute, each cache mode uses it&#8217;s own element, the child elements of which are specific to that cache mode. For example, rehashing properties are only available within the &lt;distributed-cache/&gt; element.</p> </div> </div> <div class="sect3"> <h4 id="_where_is_default"><a class="anchor" href="#_where_is_default"></a>Where is &lt;default/&gt;?</h4> <div class="paragraph"> <p>The semantics of the default cache of a cache container are different in AS7 than in native Infinispan. In native Infinispan, the configuration within &lt;default/&gt; defines the cache returned by calls to <em>CacheContainer.getCache()</em>, while &lt;namedCache/&gt; entries inherit the configuration from the default cache. In AS7, all caches defined in the Infinispan subsystem are named caches. The <em>default-cache</em> attribute identifies which named cache should be returned by calls to <em>CacheContainer.getCache()</em>. This lets you easily modify the default cache of a cache container, without having to worry about rearranging configuration property inheritance.</p> </div> </div> </div> <div class="sect2"> <h3 id="_specifying_a_transport"><a class="anchor" href="#_specifying_a_transport"></a>Specifying a transport</h3> <div class="paragraph"> <p>The Infinispan subsystem uses with the JGroups subsystem to provide it&#8217;s JGroups channel. By default, cache containers use the <em>default-stack</em> as defined by the JGroups subsystem.</p> </div> <div class="quoteblock"> <blockquote> <div class="paragraph"> <p><mark>&lt;subsystem xmlns="urn:jboss:domain:jgroups:1.0" default-stack="udp"&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;stack name="udp"&gt;</mark></p> </div> <div class="paragraph"> <p><mark>    &lt;!-- &#8230;&#8203; -&#8594;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;/stack&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;stack name="tcp"&gt;</mark></p> </div> <div class="paragraph"> <p><mark>    &lt;!-- &#8230;&#8203; -&#8594;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;/stack&gt;</mark></p> </div> <div class="paragraph"> <p><mark>&lt;/subsystem&gt;</mark></p> </div> </blockquote> </div> <div class="paragraph"> <p>Changing the default stack for all clustering services is a simple as changing the <em>default-stack</em> attribute defined in the JGroups subsystem. An individual cache-container can opt to use a particular stack by specifying a <em>stack</em> attribute within its <em>transport</em> element.</p> </div> <div class="paragraph"> <p><mark>e.g.</mark></p> </div> <div class="quoteblock"> <blockquote> <div class="paragraph"> <p><mark>&lt;cache-container name="web" default-cache="repl"&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;transport stack="tcp"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;replicated-cache name="repl" mode="ASYNC" batching="true"&gt;</mark></p> </div> <div class="paragraph"> <p><mark>    &lt;locking isolation="REPEATABLE_READ"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>    &lt;file-store/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;/replicated-cache&gt;</mark></p> </div> <div class="paragraph"> <p><mark>&lt;/cache-container&gt;</mark></p> </div> </blockquote> </div> <div class="paragraph"> <p>JGroups channels are named using the cache container name.</p> </div> </div> <div class="sect2"> <h3 id="_defining_thread_pools"><a class="anchor" href="#_defining_thread_pools"></a>Defining thread pools</h3> <div class="paragraph"> <p>Cache containers defined by the Infinispan subsystem can reference thread pools defined by the threading subsystem. Externalizing thread pool in this way has the additional advantage of being able to manage the thread pools via native JBoss AS management mechanisms, and allows you to share thread pools across cache containers.</p> </div> <div class="paragraph"> <p>e.g.</p> </div> <div class="quoteblock"> <blockquote> <div class="paragraph"> <p><mark>&lt;cache-container name="web" default-cache="repl" listener-executor="infinispan-listener" eviction-executor="infinispan-eviction" replication-queue-executor="infinispan-repl-queue"&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;transport executor="infinispan-transport"/&gt;</mark></p> </div> <div class="paragraph"> <p># &lt;replicated-cache name="repl" mode="ASYNC" batching="true"&gt;#</p> </div> <div class="paragraph"> <p><mark>    &lt;locking isolation="REPEATABLE_READ"/&gt;</mark></p> </div> <div class="paragraph"> <p># &lt;file-store/&gt;#</p> </div> <div class="paragraph"> <p><mark>  &lt;/replicated-cache&gt;</mark></p> </div> <div class="paragraph"> <p><mark>&lt;/cache-container&gt;</mark></p> </div> <div class="paragraph"> <p># #</p> </div> <div class="paragraph"> <p><mark>&lt;subsystem xmlns="urn:jboss:domain:threads:1.0"&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;thread-factory name="infinispan-factory" priority="1"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;bounded-queue-thread-pool name="infinispan-transport"/&gt;</mark></p> </div> <div class="paragraph"> <p>#     &lt;core-threads count="1"/&gt;#</p> </div> <div class="paragraph"> <p><mark>    &lt;queue-length count="100000"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>    &lt;max-threads count="25"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>    &lt;thread-factory name="infinispan-factory"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;/bounded-queue-thread-pool&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;bounded-queue-thread-pool name="infinispan-listener"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>    &lt;core-threads count="1"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>    &lt;queue-length count="100000"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>    &lt;max-threads count="1"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>    &lt;thread-factory name="infinispan-factory"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;/bounded-queue-thread-pool&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;scheduled-thread-pool name="infinispan-eviction"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>    &lt;max-threads count="1"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>    &lt;thread-factory name="infinispan-factory"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;/scheduled-thread-pool&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;scheduled-thread-pool name="infinispan-repl-queue"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>    &lt;max-threads count="1"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>    &lt;thread-factory name="infinispan-factory"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;/scheduled-thread-pool&gt;</mark></p> </div> <div class="paragraph"> <p>#&lt;/subsystem&gt; #</p> </div> </blockquote> </div> </div> </div> </div> <div class="sect1"> <h2 id="_cache_container_lifecycle"><a class="anchor" href="#_cache_container_lifecycle"></a>Cache container lifecycle</h2> <div class="sectionbody"> <div class="paragraph"> <p>During AS6 server startup, the <em>CacheContainerRegistry</em> service would create and start all cache containers defined within its <em>infinispan-configs.xml</em> file. Individual caches were started and stopped as needed. Lifecycle control of a cache was the complete responsibility of the application or service that used it. Instead of a separate <em>CacheContainerRegistry</em>, AS7 uses the generic <em>ServiceRegistry</em> from the jboss-msc project (i.e. JBoss Modular Service Container). When AS7 starts, it creates on-demand services for each cache and cache container defined in the Infinispan subsystem. A service or deployment that needs to use a given cache or cache container simply adds a dependency on the relevant service name. When the service or deployment stops, dependent services are stopped as well, provided they are not still demanded by some other service or deployment. In this way, AS7 handles cache and cache container lifecycle for you.</p> </div> <div class="paragraph"> <p>There may be an occasion where you&#8217;d like a cache to start eagerly when the server starts, without requiring a dependency from some service or deployment. This can be achieve by using the start attribute of a cache.</p> </div> <div class="paragraph"> <p>e.g.</p> </div> <div class="quoteblock"> <blockquote> <div class="paragraph"> <p><mark>&lt;cache-container name="cluster" default-cache="default"&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;alias&gt;ha-partition&lt;/alias&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;replicated-cache name="default" mode="SYNC" batching="true" start="EAGER"&gt;</mark></p> </div> <div class="paragraph"> <p><mark>    &lt;locking isolation="REPEATABLE_READ"/&gt;</mark></p> </div> <div class="paragraph"> <p><mark>  &lt;/replicated-cache&gt;</mark></p> </div> <div class="paragraph"> <p><mark>&lt;/cache-container&gt;</mark></p> </div> </blockquote> </div> </div> </div> <div class="sect1"> <h2 id="_using_an_infinispan_cache_directly"><a class="anchor" href="#_using_an_infinispan_cache_directly"></a>Using an Infinispan cache directly</h2> <div class="sectionbody"> <div class="paragraph"> <p>AS7 adds the ability to inject an Infinispan cache into your application using standard JEE mechanisms. This is perhaps best explained by an example:</p> </div> <div class="quoteblock"> <blockquote> <div class="paragraph"> <p><mark>@ManagedBean</mark></p> </div> <div class="paragraph"> <p><mark>public class MyBean&lt;K, V&gt; \{</mark></p> </div> <div class="paragraph"> <p>#  @Resource(lookup="java:jboss/infinispan/<em>my-container-name</em>") #</p> </div> <div class="paragraph"> <p><mark>  private org.infinispan.manager.CacheContainer container;</mark></p> </div> <div class="paragraph"> <p>#  private org.infinispan.Cache&lt;K, V&gt; cache;</p> </div> <div class="paragraph"> <p>#</p> </div> <div class="paragraph"> <p><mark>  @PostConstruct</mark></p> </div> <div class="paragraph"> <p><mark>  public void start() \{</mark></p> </div> <div class="paragraph"> <p><mark>    this.cache = this.container.getCache();</mark></p> </div> <div class="paragraph"> <p><mark>  }</mark></p> </div> <div class="paragraph"> <p><mark>}</mark></p> </div> </blockquote> </div> <div class="paragraph"> <p>That&#8217;s it! No JBoss specific classes required - only standard JEE annotations. Pretty neat, no?</p> </div> <div class="paragraph"> <p>##</p> </div> <div class="paragraph"> <p>There&#8217;s only one catch - due to the AS&#8217;s use of modular classloading, Infinispan classes are not available to deployments by default. You need to explicitly tell the AS to import the Infinispan API into your application. This is most easily done by adding the following line to your application&#8217;s <em>META-INF/MANIFEST.MF</em>:</p> </div> <div class="paragraph"> <p>##</p> </div> <div class="quoteblock"> <blockquote> <div class="paragraph"> <p>Dependencies: org.infinispan export</p> </div> </blockquote> </div> <div class="paragraph"> <p>So, how does it all work? If you recall, during server startup, the AS creates and registers an on-demand service for every Infinispan cache container defined in the Infinispan subsystem. For every cache container, the Infinispan subsystem also creates and registers a JNDI binding service that depends on the associated cache container service. When the AS deployer encounters the <em>@Resource(lookup)</em> annotation, it automatically adds a dependency to the application on the JNDI binding service associated with the specified JNDI name. In the case of the Infinispan JNDI binding, the binding itself already depends on the relevant Infinispan cache container service. The net effect is, your application will include a dependency on the requested cache container. Consequently, the cache container will automatically start on deploy, and stop (including all caches) on undeploy.</p> </div> </div> </div> <div class="sect1"> <h2 id="_sounds_great_where_do_i_get_it"><a class="anchor" href="#_sounds_great_where_do_i_get_it"></a>Sounds great! Where do I get it?</h2> <div class="sectionbody"> <div class="paragraph"> <p>You can download the JBoss AS 7.0.0 Final release here:</p> </div> <div class="paragraph"> <p><mark><a href="http://www.jboss.org/jbossas" class="bare">http://www.jboss.org/jbossas</a></mark></p> </div> <div class="paragraph"> <p>User documentation can be found here:</p> </div> <div class="paragraph"> <p><mark><a href="https://docs.jboss.org/author/display/AS7/Documentation" class="bare">https://docs.jboss.org/author/display/AS7/Documentation</a></mark></p> </div> <div class="paragraph"> <p>And direct any questions to the user forums:</p> </div> <div class="paragraph"> <p><mark><a href="http://community.jboss.org/en/jbossas/as7_users?view=discussions" class="bare">http://community.jboss.org/en/jbossas/as7_users?view=discussions</a></mark></p> </div> <div class="paragraph"> <p>Keep a look out for the 7.0.1 release expected in the coming weeks, which contains a number of clustering fixes identified since the initial final release.</p> </div> </div> </div> <div class="sect1"> <h2 id="_how_can_i_contribute"><a class="anchor" href="#_how_can_i_contribute"></a>How can I contribute?</h2> <div class="sectionbody"> <div class="paragraph"> <p>Here&#8217;s the best place to start:</p> </div> <div class="paragraph"> <p><mark><a href="http://community.jboss.org/wiki/HackingOnAS7" class="bare">http://community.jboss.org/wiki/HackingOnAS7</a></mark></p> </div> </div> </div> </div> <hr> <div class="pagination-links"><a href="/blog/page/86/" class="previous-link">Previous</a> <a href="/blog/" class="page-link">1</a> <a href="/blog/page/2/" class="page-link">2</a> <span class="skip">...</span><a href="/blog/page/86/" class="page-link">86</a> <span class="current-page">87</span> <a href="/blog/page/88/" class="page-link">88</a> <span class="skip">...</span><a href="/blog/page/111/" class="page-link">111</a> <a href="/blog/page/112/" class="page-link">112</a> <a href="/blog/page/88/" class="next-link">Next</a> </div> </div> <footer class="container"> <hr> <div class="row"> <div class="col-md-2 col-md-offset-1"> <h4>Navigate</h4> <ul> <li> <a href="/about" title="About">About</a> </li> <li> <a href="/documentation" title="Learn">Learn</a> </li> <li> <a href="/community" title="Community">Community</a> </li> <li> <a href="/getinvolved" title="Get Involved">Get Involved</a> </li> <li> <a href="/download" title="Download">Download</a> </li> </ul> </div> <div class="col-md-2"> <h4>Contribute</h4> <ul> <li> <a href="https://issues.jboss.org/browse/ISPN" title="Submit a bug">Submit a bug</a> </li> <li> <a href="https://github.com/infinispan" title="Write code">Write Code</a> </li> </ul> <h4>Follow Us</h4> <ul> <li> <a href="https://blog.infinispan.org" title="Blog">Blog</a> </li> <li> <a href="https://twitter.com/infinispan" title="Twitter">Twitter</a> </li> </ul> </div> <div class="col-md-2"> <h4>Open Source</h4> <p> Infinispan is released under the <b>Apache 2.0 open source license.</b> Learn more about the Apache 2.0 license <a href="https://www.apache.org/licenses/LICENSE-2.0">here.</a> </p> </div> <div class="col-md-2"> <h4>A member of</h4> <a alt="CloudTM" href="http://www.cloudtm.eu/" target="_NEW"> <img src="/images/cloudtm.png"> </a> <a alt="LEADS" href="http://leads-project.eu/" target="_NEW"> <img src="/images/leads.png"> </a> <a alt="CloudButton" href="http://cloudbutton.eu/" target="_NEW"> <img src="/images/cloudbutton.png"> </a> </div> <div class="col-md-2"> <h4>Thanks to</h4> <p>JetBrains Intellij IDEA</p> <a alt="JetBrains Intellij IDEA" href="https://www.jetbrains.com/idea/" target="_NEW"> <img src="/images/icon_IntelliJIDEA.png"> </a> </div> </div> <div class="col-md-10"> <p style="margin-top: 5px; font-size: 80%;"> © Copyright 2009-2019 Red Hat, Inc. <br> <i class="icon-fire"></i> Made with <a href="https://github.com/jbossorg/bootstrap-community" style="text-decoration: underline;" target="_NEW">JBoss Community Bootstrap</a> and <a href="http://awestruct.org/" style="text-decoration: underline;" target="_NEW">Awestruct</a> <br> <i class="icon-globe"></i> This website is open source! If you want to improve it, <a href="https://github.com/infinispan/infinispan.github.io" style="text-decoration: underline;" target="_NEW">fork the project,</a> and hack on it, then send a pull request. You can also view the <a href="https://www.seethestats.com/site/infinispan.org" style="text-decoration: underline;" target="_NEW">visitor stats.</a> <br> <i class="icon-share"></i> Website and documentation released under <a href="https://creativecommons.org/licenses/by/3.0/" style="text-decoration: underline;" target="_NEW">CC BY 3.0.</a> </p> </div> </footer> <div class="container" id="companyfooter"> <div class="redhatlogo"> <div id="logospacer"></div> <a href="http://www.redhat.com/"><img src="//static.jboss.org/theme/images/common/redhat_logo.png"></a> </div> </div> <span class="backToTop"> <a href="#top">back to top</a> </span> <script src="//static.jboss.org/theme/js/libs/bootstrap-community/3.2.0.2/bootstrap-community.min.js"></script> <script>
        if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
          _satellite.pageBottom();
        }
      </script> </div> </body> </html>