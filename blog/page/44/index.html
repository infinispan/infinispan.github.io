<!DOCTYPE html> <html lang="en"> <head> <title> Blog - Infinispan</title> <meta charset="utf-8"> <meta content="width=device-width, initial-scale=1.0" name="viewport"> <meta content="DENY" http-equiv="X-Frame-Options"> <meta content="1; mode=block" http-equiv="X-XSS-Protection"> <meta content="nosniff" http-equiv="X-Content-Type-Options"> <link href="https://static.jboss.org/theme/css/bootstrap-community/3.2.0.2/bootstrap-community.min.css" media="screen" rel="stylesheet"> <link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" rel="stylesheet"> <script crossorigin="anonymous" src="https://kit.fontawesome.com/4167a38cfa.js"></script> <script id="dpal" src="https://www.redhat.com/dtm.js" type="text/javascript"></script> <link href="/images/favicon.png" rel="shortcut icon" type="image/png"> <link href="//static.jboss.org/images/example/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144"> <link href="//static.jboss.org/images/example/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114"> <link href="//static.jboss.org/images/example/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72"> <link href="//static.jboss.org/images/example/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed"> <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" rel="stylesheet"> <link href="https://static.jboss.org/css/rhbar.css" media="screen" rel="stylesheet"> <link href="/feed.atom" rel="alternate" type="application/atom+xml"> <style>
      .jumbotron {
        padding: 0.5em 0.1em 0.5em 0.1em;
        background-image: none;
        background-color: #ffec9f;
      }
      .jumbotron p, 
      .jumbotron h1 {
        color: #656565;
      }
      .dropup {
        z-index: 1032;
      }
      .navbar {
        font-size: x-large;
      }
      .navbar ul {
        padding-top: 0.7em;
      }
      .navbar-brand {
        height: 80px;
      }
      .navbar-default {
        background-color: white;
      }
      .navbar-default .navbar-nav > li > a {
        color: #336699;
      }
      .navbar-default .navbar-nav > li > a:hover {
        color: #204060;
      }
      .navbar-default .navbar-nav > .open > a,
      .navbar-default .navbar-nav > .open > a:hover,
      .navbar-default .navbar-nav > .open > a:focus {
        background-color: #4a5d75;
      }
      h3.well {
        border-color: #ffd630;
        background-color: #ffec9f;
      }
      .panel-sidebar {
        border-color: #f5f5f5;
      }
      .panel-sidebar > .panel-heading {
        border-color: #e3e3e3;
        background-color: #f5f5f5;
        color: #656565;
      }
      .btn-primary {
        border-color: #ffd630;
        background-color: #ffec9f;
        color: #656565;
      }
      footer.container {
        background-color: white;
      }
      footer.container h1, footer.container h2, footer.container h3, footer.container h4, footer.container h5, footer.container h6, footer.container p, footer.container a {
        color: #656565;
      }
      footer.container ul {
        padding: 0;
      }
      i.enormous-icon {
        margin-top: 0.3em;
      }
      .home-examples {
        font-size: 16px;
      }
    </style> <script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.min.js"></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script> <script>
      hljs.initHighlightingOnLoad();
    </script> <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
     
    ga('create', 'UA-8601422-1', 'auto');
    ga('send', 'pageview');
    
    </script> </head> <body> <div id=""> <ul class="visuallyhidden" id="top"> <li> <a accesskey="n" href="#nav" title="Skip to navigation">Skip to navigation</a> </li> <li> <a accesskey="c" href="#page" title="Skip to content">Skip to content</a> </li> </ul> <div id="rhbar"> <a class="jbdevlogo" href="http://www.jboss.org/projects/about"></a> <a class="rhlogo" href="http://www.redhat.com/"></a> </div> <div class="container" id="content"> <nav class="navbar navbar-default navbar-fixed-top"> <div class="container"> <div class="navbar-header"> <button aria-expanded="false" class="navbar-toggle collapsed" data-target="#thenavbar" data-toggle="collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/"> <img alt="Infinispan" src="/images/infinispan_nav_brand.png"> </a> </div> <div class="navbar-collapse collapse" id="thenavbar"> <ul class="nav navbar-nav"> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/about">About <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/about">Introduction</a></li> <li><a href="/features">Features</a></li> <li><a href="/release-notes">Release notes</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/references">References</a></li> <li><a href="/experiments/">Experiments</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/documentation">Learn <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/documentation">Documentation</a></li> <li><a href="/tutorials">Tutorials</a></li> <li><a href="/videos">Videos</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/download">Download <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/download">Infinispan Releases</a></li> <li><a href="/cache-store-implementations">Cache Store Implementations</a></li> <li><a href="/hotrod-clients">Hot Rod Clients</a></li> <li><a href="/integrations">Integrations</a></li> <li><a href="/download-archive">Archive</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/community">Community <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/community">Ask for Help</a></li> <li><a href="/getinvolved">Get Involved</a></li> </ul> </li> <li class=""><a href="/roadmap">Road Map</a></li> <li class="divider"></li> </ul> </div> </div> </nav> <div class="post"></div> <h3> Thursday, 01 October 2015 </h3> <h1> <a href="/blog/2015/10/01/hibernate-second-level-cache/">Hibernate Second Level Cache improvements</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan has been implementing <strong>Hibernate Second Level Cache</strong> for a long time, replacing the previous JBoss Cache implementation with very similar logic. The main aim of the implementation has always been to have very fast reads, keeping the overhead of cache during reads on minimum. This was achieved using local reads in invalidation-mode cache and Infinispan&#8217;s <em>putForExternalRead</em> operation, where the request to cache never blocks.</p> </div> <div class="paragraph"> <p>Recently we&#8217;ve looked on the implementation again to see whether we can speed it up even more. For a long time you could use only transactional caches to keep the cache in sync with database. However transactions come at some cost so we thought about a way to get around it. And we have found it, through custom interceptors we have managed to do two-phase updates to the cache and now the non-transactional caches are the default configuration. So, if you&#8217;re using Hibernate with your own configuration, don&#8217;t forget to update that when migrating to Hibernate ORM 5!</p> </div> <div class="paragraph"> <p>With transactions gone, our task was not over. So far entity/collection caching has been implemented for invalidation mode caches, but it&#8217;s tempting to consider replication mode, too. For replicated caches, we got rid of a special cache for <em>pending puts</em> (this local cache detects out-of-date reads, keeping the entity cache consistent). Instead, we used different technique where a logical removal from the cache is substituted by replace with a token called <em>tombstone</em>, and updates pre-invalidate the cache in a similar way. This change opened the possibility for <strong>non-transactional replicated</strong> and <strong>distributed</strong> caches (transactional mode is not supported). We were pleased to see the results of some benchmark where the high hit ratio in replicated caches has dramatically speeded up all operations.</p> </div> <div class="paragraph"> <p>There is one downside of the current implementation - in replication mode, you <strong>should not use eviction</strong>, as eviction cannot tell regular entity (which can be evicted) from the tombstone. If tombstone was evicted, there&#8217;s a risk of inconsistent reads. So when using replicated caches, you should rely on expiration to keep your cache slender. We hope that eventually we&#8217;ll remove this limitation.</p> </div> <div class="paragraph"> <p>All modes described above give us cache without any stale reads. That comes at a cost - each modification (insert, update or removal) requires 2 accesses to the cache (though, sometimes the second access can be asynchronous). Some applications do not require such strict consistency - and that&#8217;s where <em>nonstrict-read-write</em> comes to the scene. Here we guarantee that the cache will provide the same result as DB after the modifying transaction commits - between DB commit and transaction commit a stale value can be provided. If you use asynchronous cache, this may be delayed even more but unless the operation fails (e.g. due to locking timeout) the cache will eventually get into a state consistent with DB. This allows us to limit modifications to single cache access per modification.</p> </div> <div class="paragraph"> <p>Note that <em>nonstrict-read-write</em> mode is supported only for <strong>versioned</strong> entities/collections (that way we can find out which entity is actually newer). Also, you cannot use eviction in nonstrict-read-write mode, for the same reason as in tombstone-based modes. Invalidation cache mode is not supported neither.</p> </div> <div class="paragraph"> <p>If you&#8217;ll try out the most recent Hibernate ORM, you&#8217;ll find out that <strong>Infinispan 7.2.x</strong> is used there. This is because ORM 5.0.0.Final was released before Infinispan 8.0.0.Final went out and we can&#8217;t change the major version of dependency in micro-release. However, we try to keep <strong>Infinispan 8.0.x</strong> binary compatible (in parts used by Hibernate), and therefore you can just replace the dependencies on classpath and use the most recent Infinispan, if you prefer to do so.</p> </div> <div class="paragraph"> <p>To sum things up, here is the table of supported configurations:</p> </div> <div class="paragraph"> <p>Concurrency strategy</p> </div> <div class="paragraph"> <p>Cache transactions</p> </div> <div class="paragraph"> <p>Cache mode</p> </div> <div class="paragraph"> <p>Implementation</p> </div> <div class="paragraph"> <p>Eviction</p> </div> <div class="paragraph"> <p>transactional</p> </div> <div class="paragraph"> <p>transactional</p> </div> <div class="paragraph"> <p>invalidation</p> </div> <div class="paragraph"> <p>pending puts</p> </div> <div class="paragraph"> <p>yes</p> </div> <div class="paragraph"> <p>read-write</p> </div> <div class="paragraph"> <p>non-transactional</p> </div> <div class="paragraph"> <p>non-transactional</p> </div> <div class="paragraph"> <p>replicated/distributed</p> </div> <div class="paragraph"> <p>tombstones</p> </div> <div class="paragraph"> <p>no</p> </div> <div class="paragraph"> <p>nonstrict-read-write</p> </div> <div class="paragraph"> <p>versioned entries</p> </div> <div class="paragraph"> <p>There&#8217;s also the <em>read-only</em> mode - this can be used instead of both <em>transactional</em> or <em>read-write</em> modes, but at this point it does not offer any further performance gains, since we have to make sure that you don&#8217;t see a removed value. Actually, it also does not matter whether you specify transactional or read-write mode; the proper strategy will be picked according to your cache configuration (transactional vs. non-transactional).</p> </div> <div class="paragraph"> <p>We hope that you&#8217;ll try these new modes and many consistency fixes included along (you should use Hibernate ORM <strong>5.0.2.Final</strong> or later), and tell us about your experience.</p> </div> <div class="paragraph"> <p>Happy caching!</p> </div> </div> </div> </div> <em>Posted by Unknown on 2015-10-01</em> <br> <em>Tags:</em> <a href="/blog/tags/jpa/"> jpa </a> <a href="/blog/tags/hibernate/"> hibernate </a> <a href="/blog/tags/second level cache provider/"> second level cache provider </a> <hr> <div class="post"></div> <h3> Friday, 25 September 2015 </h3> <h1> <a href="/blog/2015/09/25/memory-based-eviction/">Memory based eviction</a> </h1> <div class="content"> <div class="sect1"> <h2 id="_eviction_today"><a class="anchor" href="#_eviction_today"></a>Eviction Today</h2> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan since its inception has supported a way to help users control how much memory the in memory cache entries consume in the JVM.  This has always been limited to a number of entries.  In the past users have had to estimate the average amount of bytes their entries used on the heap.  With this average you can easily calculate how many entries could safely be stored in memory without running into issues.  For users who have keys and values that are relatively similar this can work well.  However when the case requires entries that vary in size this can be problematic and you end up calculating the average size based on the worse case.</p> </div> </div> </div> <div class="sect1"> <h2 id="_enter_memory_based_eviction"><a class="anchor" href="#_enter_memory_based_eviction"></a>Enter Memory Based Eviction</h2> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan 8 introduces memory based eviction counting.  That is Infinispan will automatically keep track of how large the key, value and overhead if possible.  It can use these values then to try to limit the number of entries instead to a memory count such as 1 Gigabyte.</p> </div> <div class="sect2"> <h3 id="_keyvalue_limitations"><a class="anchor" href="#_keyvalue_limitations"></a>Key/Value limitations</h3> <div class="paragraph"> <p>Unfortunately this is currently limited to only using keys and values stored as primitives, primitive wrappers (ie. Integer), java.lang.String(s) and any of the previously mentioned stored in an array.  This means this feature cannot be used with any custom classes.  If enough feedback is provided we could provide a SPI to allow the user to plug in their own counter for their own classes, but this is not planned currently.</p> </div> <div class="paragraph"> <p>There are a couple ways to easily get around this.  One is to use <a href="http://infinispan.org/docs/8.0.x/user_guide/user_guide.html#_store_as_binary">storeAsBinary</a>, which will store your keys and/or values as byte arrays for you automatically, satisfying this limitation.  A second way is when you are using the client such as HotRod, in this case the data is stored in the serialized (byte[]) form.  Note that <a href="http://infinispan.org/docs/8.0.x/user_guide/user_guide.html#_enable_compatibility_mode">compatibility mode</a> will prevent this from occurring and you are unable to use these configurations together.</p> </div> </div> <div class="sect2"> <h3 id="_eviction_type_limitation"><a class="anchor" href="#_eviction_type_limitation"></a>Eviction Type limitation</h3> <div class="paragraph"> <p>Due to the complexity of LIRS, memory based eviction is only supported with LRU at this time. See the types <a href="http://infinispan.org/docs/8.0.x/user_guide/user_guide.html#_eviction_strategies">here</a>.  This could be enhanced at a later point, but is also not planned.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_how_to_enable"><a class="anchor" href="#_how_to_enable"></a>How to enable</h2> <div class="sectionbody"> <div class="paragraph"> <p>You can enable memory based eviction either through programmatic or declarative configuration.  Note that Infinispan added long support (limited to 2^48) for the size value which directly helps memory based eviction if users want to utilize caches larger than 2 GB.</p> </div> <div class="sect2"> <h3 id="_programmatic"><a class="anchor" href="#_programmatic"></a>Programmatic</h3> </div> <div class="sect2"> <h3 id="_declarative"><a class="anchor" href="#_declarative"></a>Declarative </h3> <div class="paragraph"> <p>==</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_supported_jvms"><a class="anchor" href="#_supported_jvms"></a>Supported JVMs</h2> <div class="sectionbody"> <div class="paragraph"> <p>This was tested and written specifically for Oracle and OpenJDK JVMs.  In testing these JVMs showed memory accuracy within 1% of desired value. Other JVMs may shown incorrect values.</p> </div> <div class="paragraph"> <p>The algorithm takes into account JVM options, such as compressed pointers and 32 bit JVM vs 64 bit JVM.  Keep in mind this is only for the data container and doesn&#8217;t take into account additional overhead such as created threads or other runtime objects.</p> </div> <div class="paragraph"> <p>Other JVMs are not handled such as the IBM JVM which was briefly tested and showed incorrect numbers greater than 10% of the desired amount.  Support for other JVMs can be added later as interest is shown for them.</p> </div> </div> </div> <div class="sect1"> <h2 id="_closing_notes"><a class="anchor" href="#_closing_notes"></a>Closing Notes</h2> <div class="sectionbody"> <div class="paragraph"> <p>I hope this feature helps people to better handle their memory constraints while using Infinispan!  Let us know if you have any <a href="http://infinispan.org/getinvolved/">feedback or concerns</a>.</p> </div> <div class="paragraph"> <p>Cheers!</p> </div> <div class="paragraph"> <p> - Will</p> </div> </div> </div> </div> <em>Posted by Unknown on 2015-09-25</em> <br> <em>Tags:</em> <a href="/blog/tags/eviction/"> eviction </a> <a href="/blog/tags/memory/"> memory </a> <hr> <div class="post"></div> <h3> Wednesday, 23 September 2015 </h3> <h1> <a href="/blog/2015/09/23/infinispan-810alpha1/">Infinispan 8.1.0.Alpha1</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Dear all,</p> </div> <div class="paragraph"> <p>release early release often ! The first Alpha release of Infinispan 8.1 is out. As is traditional, it is codenamed after a beer. This time it is "Mahou" !</p> </div> <div class="paragraph"> <p>The highlights for 8.1.0.Alpha1 are:</p> </div> <div class="paragraph"> <p><a href="https://issues.jboss.org/browse/ISPN-5781">ISPN-5781</a> - Upgrade server to WildFly 10.0.0.CR1 <a href="https://issues.jboss.org/browse/ISPN-5742">ISPN-5742</a> - Add global persistent state path configuration</p> </div> <div class="paragraph"> <p>Read the complete <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310799&amp;version=12328069">release notes </a></p> </div> <div class="paragraph"> <p>We&#8217;re working on lots of cool things for 8.1 Final due at the end of November, so be sure to check our roadmap to see what&#8217;s coming.</p> </div> <div class="paragraph"> <p><a href="http://infinispan.org/download/">Get</a> it, <a href="http://infinispan.org/tutorials/">learn</a> how to use it, <a href="http://infinispan.org/getinvolved/">help</a> us improve it.</p> </div> <div class="paragraph"> <p>Enjoy !</p> </div> <div class="paragraph"> <p>The Infinispan team</p> </div> </div> </div> </div> <em>Posted by Tristan Tarrant on 2015-09-23</em> <br> <em>Tags:</em> <a href="/blog/tags/release/"> release </a> <a href="/blog/tags/alpha/"> alpha </a> <hr> <div class="post"></div> <h3> Monday, 21 September 2015 </h3> <h1> <a href="/blog/2015/09/21/introducing-infinispan-hadoop-connector/">Introducing the Infinispan Hadoop Connector</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>The version 0.1 of the Infinispan Hadoop connector has just been made available!</p> </div> <div class="paragraph"> <p>The connector will host several integrations with Hadoop related projects, and in this first release it supports converting Infinispan server into a Hadoop compliant data source, by providing an implementation of InputFormat and OutputFormat.</p> </div> </div> </div> <div class="sect3"> <h4 id="_the_infinispaninputformat_and_infinispanoutputformat"><a class="anchor" href="#_the_infinispaninputformat_and_infinispanoutputformat"></a>The InfinispanInputFormat and InfinispanOutputFormat</h4> </div> <div class="sect3"> <h4 id=""><a class="anchor" href="#"></a> </h4> <div class="exampleblock"> <div class="content"> <div class="paragraph"> <p>A Hadoop InputFormat is a specification of how a certain data source can be partitioned and how to read data from each of the partitions. Conversely, OutputFormat is used to write.</p> </div> <div class="paragraph"> <p>Looking closely at the Hadoop&#8217;s InputFormat interface, we can see two methods:</p> </div> <div class="paragraph"> <p>    List&lt;InputSplit&gt; getSplits(JobContext context);       RecordReader&lt;K,V&gt; createRecordReader(InputSplit split,TaskAttemptContext context);</p> </div> <div class="paragraph"> <p>The first method defines essentially a data partitioner, calculating one or more InputSplits that contain information about a certain partition of the data. With possession of a InputSplit, one can use it to obtain a RecordReader to iterate over the data. These two operations allow for parallelization of data processing across multiple nodes, and that&#8217;s how Hadoop map reduce achieves a high throughput over large datasets.</p> </div> <div class="paragraph"> <p>In Infinispan terms, each partition is a set of segments on a certain server, and a record reader is a remote iterator over those segments. The default partitioner shipped with the connector will create as many partitions as servers in the cluster, and each partition will contain the segments that are associated with that specific server.</p> </div> <div class="paragraph"> <p>==== Not only map reduce</p> </div> <div class="paragraph"> <p>Although the InfinispanInputFormat and InfinispanOutputformat can be used to run traditional Hadoop map reduce jobs over Infinispan data, it is not coupled to the Hadoop map reduce runtime. It is possible to leverage the connector to integrate Infinispan with other tools that, besides supporting Hadoop I/O interfaces, are able to read and write data more efficiently. One of those tools is <a href="https://flink.apache.org/">Apache Flink</a>, that has a dataflow engine capable of doing batch and stream data processing that supersedes the classic two stage map reduce approach. </p> </div> <div class="paragraph"> <p>==== Apache Flink example</p> </div> <div class="paragraph"> <p>====  </p> </div> </div> </div> <div class="paragraph"> <p>Apache Flink supports Hadoop&#8217;s InputFormat as a data source to execute batch jobs, so to integrate with Infinispan it&#8217;s straightforward:</p> </div> <div class="paragraph"> <p>Please refer to the <a href="https://github.com/infinispan/infinispan-hadoop/tree/master/samples/flink">complete sample</a> that has docker images for both Apache Flink and Infinispan server, and detailed instructions on how to execute and customise job.</p> </div> </div> <div class="sect3"> <h4 id="_stay_tuned"><a class="anchor" href="#_stay_tuned"></a>Stay tuned</h4> <div class="paragraph"> <p>More details about the connector, maven coordinates, configuration options, sources and samples can be found at the <a href="https://github.com/infinispan/infinispan-hadoop">project repository</a></p> </div> <div class="paragraph"> <p>In upcoming versions we expect to have a tighter integration with the Hadoop platform in order to run Infinispan clusters as a YARN application (<a href="https://issues.jboss.org/browse/ISPN-5709">ISPN-5709</a>), and also support other tools from the ecosystem such as <a href="https://pig.apache.org/">Apache Pig</a> (<a href="https://issues.jboss.org/browse/ISPN-5749">ISPN-5749</a>)</p> </div> </div> </div> <em>Posted by Gustavo on 2015-09-21</em> <br> <em>Tags:</em> <a href="/blog/tags/yarn/"> yarn </a> <a href="/blog/tags/hadoop/"> hadoop </a> <a href="/blog/tags/server/"> server </a> <a href="/blog/tags/flink/"> flink </a> <hr> <div class="post"></div> <h3> Wednesday, 16 September 2015 </h3> <h1> <a href="/blog/2015/09/16/simple-cache/">Simple cache</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan <strong>local caches</strong> have several features that make it more than just a map - expiration and eviction, listeners, statistics, transactions, cache stores and so forth. However, this comes at a price - due to all the hooks and object allocation, plain ConcurrentHashMap is faster than local cache.</p> </div> <div class="paragraph"> <p>There are applications that need something in between - great performance but some of those features, too. In our case, the motivation were internal caches in Hibernate Second Level Cache. Therefore Infinispan <strong>8.0.1.Final</strong> brings the <strong>simple cache</strong> - alternative implementation of the <em>AdvancedCache</em> interface optimized for maximum performance when you need just the basics.</p> </div> <div class="paragraph"> <p>The table below shows which features are available in simple cache:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Feature</th> <th class="tableblock halign-left valign-top">Availability</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Basic map-like API</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">✔</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Cache listeners (non-clustered)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">✔</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Expiration</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">✔</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Eviction</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">✔</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Security</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">✔</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">JMX access</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">✔</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Statistics</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">✔</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Transactions</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">✘</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Invocation batching</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">✘</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Persistence (cache stores and loader)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">✘</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Map Reduce Framework</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">✘</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Distributed Executors Framework</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">✘</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Custom interceptors</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">✘</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Indexing (querying)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">✘</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Compatibility (embedded/server)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">✘</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Store as binary</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">✘</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Configuring simple cache is as simple as adding one attribute to the XML configuration:</p> </div> <div class="paragraph"> <p>While configuration schema allows to set up the unsupported features, doing so results in an exception when the cache is created.</p> </div> <div class="paragraph"> <p>You can also configure simple cache programmatically:</p> </div> <div class="paragraph"> <p>So, what kind of performance improvement can you expect? We had run basic (single-threaded) benchmark using <a href="http://openjdk.java.net/projects/code-tools/jmh/">JMH</a> and this is what we got:</p> </div> <div class="paragraph"> <p>Implementation</p> </div> <div class="paragraph"> <p>get() (operations/s)</p> </div> <div class="paragraph"> <p>put() (operations/s)</p> </div> <div class="paragraph"> <p>ConcurrentHashMap</p> </div> <div class="paragraph"> <p>128,354,135</p> </div> <div class="paragraph"> <p>±</p> </div> <div class="paragraph"> <p>2,178,755</p> </div> <div class="paragraph"> <p>33,980,088</p> </div> <div class="paragraph"> <p>±</p> </div> <div class="paragraph"> <p>28,487</p> </div> <div class="paragraph"> <p>Simple cache</p> </div> <div class="paragraph"> <p>86,969,897</p> </div> <div class="paragraph"> <p>±</p> </div> <div class="paragraph"> <p>738,935</p> </div> <div class="paragraph"> <p>14,044,642</p> </div> <div class="paragraph"> <p>±</p> </div> <div class="paragraph"> <p>14,280</p> </div> <div class="paragraph"> <p>Local cache</p> </div> <div class="paragraph"> <p>17,280,018</p> </div> <div class="paragraph"> <p>±</p> </div> <div class="paragraph"> <p>361,910</p> </div> <div class="paragraph"> <p>2,267,850</p> </div> <div class="paragraph"> <p>±</p> </div> <div class="paragraph"> <p>44,814</p> </div> <div class="paragraph"> <p>This gives us about 5✕ speedup for reads and 6✕ for writes. Your mileage may vary, but it&#8217;s certain that simple cache provides substantial performance benefits.</p> </div> <div class="paragraph"> <p>So, if your use-case allows it, try out simple cache and let us know. It&#8217;s as simple as one configuration attribute!</p> </div> </div> </div> </div> <em>Posted by Unknown on 2015-09-16</em> <br> <em>Tags:</em> <hr> <div class="pagination-links"><a href="/blog/page/43/" class="previous-link">Previous</a> <a href="/blog/" class="page-link">1</a> <a href="/blog/page/2/" class="page-link">2</a> <span class="skip">...</span><a href="/blog/page/43/" class="page-link">43</a> <span class="current-page">44</span> <a href="/blog/page/45/" class="page-link">45</a> <span class="skip">...</span><a href="/blog/page/112/" class="page-link">112</a> <a href="/blog/page/113/" class="page-link">113</a> <a href="/blog/page/45/" class="next-link">Next</a> </div> </div> <footer class="container"> <hr> <div class="row"> <div class="col-md-2 col-md-offset-1"> <h4>Navigate</h4> <ul> <li> <a href="/about" title="About">About</a> </li> <li> <a href="/documentation" title="Learn">Learn</a> </li> <li> <a href="/community" title="Community">Community</a> </li> <li> <a href="/getinvolved" title="Get Involved">Get Involved</a> </li> <li> <a href="/download" title="Download">Download</a> </li> </ul> </div> <div class="col-md-2"> <h4>Contribute</h4> <ul> <li> <a href="https://issues.jboss.org/browse/ISPN" title="Submit a bug">Submit a bug</a> </li> <li> <a href="https://github.com/infinispan" title="Write code">Write Code</a> </li> </ul> <h4>Follow Us</h4> <ul> <li> <a href="https://infinispan.org/blog/" title="Blog">Blog</a> </li> <li> <a href="https://twitter.com/infinispan" title="Twitter">Twitter</a> </li> </ul> </div> <div class="col-md-2"> <h4>Open Source</h4> <p> Infinispan is released under the <b>Apache 2.0 open source license.</b> Learn more about the Apache 2.0 license <a href="https://www.apache.org/licenses/LICENSE-2.0">here.</a> </p> </div> <div class="col-md-2"> <h4>A member of</h4> <a alt="CloudTM" href="http://www.cloudtm.eu/" target="_NEW"> <img src="/images/cloudtm.png"> </a> <a alt="LEADS" href="http://leads-project.eu/" target="_NEW"> <img src="/images/leads.png"> </a> <a alt="CloudButton" href="http://cloudbutton.eu/" target="_NEW"> <img src="/images/cloudbutton.png"> </a> </div> <div class="col-md-2"> <h4>Thanks to</h4> <p>JetBrains Intellij IDEA</p> <a alt="JetBrains Intellij IDEA" href="https://www.jetbrains.com/idea/" target="_NEW"> <img src="/images/icon_IntelliJIDEA.png"> </a> </div> </div> <div class="col-md-10"> <p style="margin-top: 5px; font-size: 80%;"> © Copyright 2009-2019 Red Hat, Inc. <br> <i class="icon-fire"></i> Made with <a href="https://github.com/jbossorg/bootstrap-community" style="text-decoration: underline;" target="_NEW">JBoss Community Bootstrap</a> and <a href="http://awestruct.org/" style="text-decoration: underline;" target="_NEW">Awestruct</a> <br> <i class="icon-globe"></i> This website is open source! If you want to improve it, <a href="https://github.com/infinispan/infinispan.github.io" style="text-decoration: underline;" target="_NEW">fork the project,</a> and hack on it, then send a pull request. You can also view the <a href="https://www.seethestats.com/site/infinispan.org" style="text-decoration: underline;" target="_NEW">visitor stats.</a> <br> <i class="icon-share"></i> Website and documentation released under <a href="https://creativecommons.org/licenses/by/3.0/" style="text-decoration: underline;" target="_NEW">CC BY 3.0.</a> </p> </div> </footer> <div class="container" id="companyfooter"> <div class="redhatlogo"> <div id="logospacer"></div> <a href="http://www.redhat.com/"><img src="//static.jboss.org/theme/images/common/redhat_logo.png"></a> </div> </div> <span class="backToTop"> <a href="#top">back to top</a> </span> <script src="//static.jboss.org/theme/js/libs/bootstrap-community/3.2.0.2/bootstrap-community.min.js"></script> <script>
        if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
          _satellite.pageBottom();
        }
      </script> </div> </body> </html>