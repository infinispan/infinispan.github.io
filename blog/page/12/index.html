<!DOCTYPE html> <html lang="en"> <head> <title> Blog - Infinispan</title> <meta charset="utf-8"> <meta content="width=device-width, initial-scale=1.0" name="viewport"> <meta content="DENY" http-equiv="X-Frame-Options"> <meta content="1; mode=block" http-equiv="X-XSS-Protection"> <meta content="nosniff" http-equiv="X-Content-Type-Options"> <link href="https://static.jboss.org/theme/css/bootstrap-community/3.2.0.2/bootstrap-community.min.css" media="screen" rel="stylesheet"> <link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" rel="stylesheet"> <script crossorigin="anonymous" src="https://kit.fontawesome.com/4167a38cfa.js"></script> <script id="dpal" src="https://www.redhat.com/dtm.js" type="text/javascript"></script> <link href="/images/favicon.png" rel="shortcut icon" type="image/png"> <link href="//static.jboss.org/images/example/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144"> <link href="//static.jboss.org/images/example/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114"> <link href="//static.jboss.org/images/example/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72"> <link href="//static.jboss.org/images/example/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed"> <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" rel="stylesheet"> <link href="https://static.jboss.org/css/rhbar.css" media="screen" rel="stylesheet"> <link href="/feed.atom" rel="alternate" type="application/atom+xml"> <style>
      .jumbotron {
        padding: 0.5em 0.1em 0.5em 0.1em;
        background-image: none;
        background-color: #ffec9f;
      }
      .jumbotron p, 
      .jumbotron h1 {
        color: #656565;
      }
      .dropup {
        z-index: 1032;
      }
      .navbar {
        font-size: x-large;
      }
      .navbar ul {
        padding-top: 0.7em;
      }
      .navbar-brand {
        height: 80px;
      }
      .navbar-default {
        background-color: white;
      }
      .navbar-default .navbar-nav > li > a {
        color: #336699;
      }
      .navbar-default .navbar-nav > li > a:hover {
        color: #204060;
      }
      .navbar-default .navbar-nav > .open > a,
      .navbar-default .navbar-nav > .open > a:hover,
      .navbar-default .navbar-nav > .open > a:focus {
        background-color: #4a5d75;
      }
      h3.well {
        border-color: #ffd630;
        background-color: #ffec9f;
      }
      .panel-sidebar {
        border-color: #f5f5f5;
      }
      .panel-sidebar > .panel-heading {
        border-color: #e3e3e3;
        background-color: #f5f5f5;
        color: #656565;
      }
      .btn-primary {
        border-color: #ffd630;
        background-color: #ffec9f;
        color: #656565;
      }
      footer.container {
        background-color: white;
      }
      footer.container h1, footer.container h2, footer.container h3, footer.container h4, footer.container h5, footer.container h6, footer.container p, footer.container a {
        color: #656565;
      }
      footer.container ul {
        padding: 0;
      }
      i.enormous-icon {
        margin-top: 0.3em;
      }
      .home-examples {
        font-size: 16px;
      }
    </style> <script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.min.js"></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script> <script>
      hljs.initHighlightingOnLoad();
    </script> <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
     
    ga('create', 'UA-8601422-1', 'auto');
    ga('send', 'pageview');
    
    </script> </head> <body> <div id=""> <ul class="visuallyhidden" id="top"> <li> <a accesskey="n" href="#nav" title="Skip to navigation">Skip to navigation</a> </li> <li> <a accesskey="c" href="#page" title="Skip to content">Skip to content</a> </li> </ul> <div id="rhbar"> <a class="jbdevlogo" href="http://www.jboss.org/projects/about"></a> <a class="rhlogo" href="http://www.redhat.com/"></a> </div> <div class="container" id="content"> <nav class="navbar navbar-default navbar-fixed-top"> <div class="container"> <div class="navbar-header"> <button aria-expanded="false" class="navbar-toggle collapsed" data-target="#thenavbar" data-toggle="collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/"> <img alt="Infinispan" src="/images/infinispan_nav_brand.png"> </a> </div> <div class="navbar-collapse collapse" id="thenavbar"> <ul class="nav navbar-nav"> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/about">About <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/about">Introduction</a></li> <li><a href="/features">Features</a></li> <li><a href="/release-notes">Release notes</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/references">References</a></li> <li><a href="/experiments/">Experiments</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/documentation">Learn <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/documentation">Documentation</a></li> <li><a href="/tutorials">Tutorials</a></li> <li><a href="/videos">Videos</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/download">Download <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/download">Infinispan Releases</a></li> <li><a href="/cache-store-implementations">Cache Store Implementations</a></li> <li><a href="/hotrod-clients">Hot Rod Clients</a></li> <li><a href="/integrations">Integrations</a></li> <li><a href="/download-archive">Archive</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="/community">Community <b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="/community">Ask for Help</a></li> <li><a href="/getinvolved">Get Involved</a></li> </ul> </li> <li class=""><a href="/roadmap">Road Map</a></li> <li class="divider"></li> </ul> </div> </div> </nav> <div class="post"></div> <h3> Wednesday, 21 March 2018 </h3> <h1> <a href="/blog/2018/03/21/clustering-vertx-with-infinispan/">Clustering Vert.x with Infinispan</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Welcome to the third in a multi-part series of blog posts about creating Eclipse Vert.x applications with Infinispan. In the previous blog posts we have seen how to create <a href="http://blog.infinispan.org/2017/12/first-steps-with-vertx-and-infinispan-rest-api.html">REST</a> and <a href="http://blog.infinispan.org/2017/12/first-steps-with-vertx-and-infinispan-push-api.html">PUSH</a> APIs using the <a href="http://infinispan.org/docs/stable/server_guide/server_guide.html">Infinispan Server</a>. The purpose of this tutorial is to showcase how to create clustered <a href="http://vertx.io/">Vert.x</a> applications using Infinispan in embedded mode.</p> </div> </div> </div> <div class="sect1"> <h2 id="_why_infinispan"><a class="anchor" href="#_why_infinispan"></a>Why Infinispan ?</h2> <div class="sectionbody"> <div class="paragraph"> <p>Infinispan can be used for <a href="http://infinispan.org/about/">several use cases</a>. Among them we find that it can be used as the underlying framework to cluster your applications. Infinispan uses peer-to-peer communication between nodes, so the architecture is not based on master/slave mode and there is no single point of failure. Infinispan supports replication and resilience across data centers, is fast and reliable. All the <a href="http://infinispan.org/features/">features</a> that make this datagrid a great product, make it a great cluster manager. If you need to create clustered applications or microservices, this can be achieved with <a href="http://vertx.io/docs/#clustering">Vert.x</a> using the <a href="http://vertx.io/docs/vertx-infinispan/java/">Vert.x-Infinispan cluster manager</a>.</p> </div> </div> </div> <div class="sect1"> <h2 id="_creating_a_clustered_application"><a class="anchor" href="#_creating_a_clustered_application"></a>Creating a clustered application</h2> <div class="sectionbody"> <div class="paragraph"> <p>The code of this tutorial is available <a href="https://github.com/infinispan-demos/vertx-api/tree/master/clustered">here</a>.</p> </div> <div class="sect2"> <h3 id="_dummy_application"><a class="anchor" href="#_dummy_application"></a>Dummy Application</h3> <div class="paragraph"> <p>Let’s start with a dummy clustered system with 3 verticles.</p> </div> <div class="paragraph"> <p><a href="https://4.bp.blogspot.com/-wNPoumRNOZU/WqqNdMdm6mI/AAAAAAAACNM/Nvrirnuw-ok_BfS8Gh7DaomoTGhdEwk-ACLcBGAs/s1600/dummyApp.png"><span class="image"><img src="https://4.bp.blogspot.com/-wNPoumRNOZU/WqqNdMdm6mI/AAAAAAAACNM/Nvrirnuw-ok_BfS8Gh7DaomoTGhdEwk-ACLcBGAs/s640/dummyApp.png" alt="image" width="640" height="275"></span></a></p> </div> <div class="sect3"> <h4 id="_webservice_status_producer"><a class="anchor" href="#_webservice_status_producer"></a>WebService Status Producer</h4> <div class="paragraph"> <p>Produces randomly [0,1,2] values every 1000 milliseconds and sends them to the event bus <strong>"ids"</strong> address.</p> </div> </div> <div class="sect3"> <h4 id="_reboot_consumer"><a class="anchor" href="#_reboot_consumer"></a>Reboot Consumer</h4> <div class="paragraph"> <p>Consumes messages from the event bus <strong>"ids"</strong> address, and launches a <strong>"reboot"</strong> that lasts for 3000 milliseconds whenever the value is 0. If a reboot is already happening, we don’t need to relaunch any new reboot. When a reboot starts or ends, a message is sent to the event bus to the <strong>"reboot"</strong> address.</p> </div> <div class="paragraph"> <p>Notice that:</p> </div> <div class="ulist"> <ul> <li> <p>We use a simple boolean to check if there is a reboot going on. This is safe because every verticle is executed from a single event loop thread, so there won’t be multiple threads executing the code at the same time.</p> </li> <li> <p>An ID is generated to identify the Verticle. The message sent to the event bus is a JsonObject</p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="_monitoring"><a class="anchor" href="#_monitoring"></a>Monitoring</h4> <div class="paragraph"> <p>Consumes monitoring messages from the event bus <strong>"reboot"</strong> address and logs them.</p> </div> </div> </div> <div class="sect2"> <h3 id="_clustering_the_dummy_application"><a class="anchor" href="#_clustering_the_dummy_application"></a>Clustering the dummy Application</h3> <div class="paragraph"> <p>To create a cluster of these applications, we just need to do 2 things:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Add the cluster manager maven dependency.  </p> </li> <li> <p>Run and deploy each verticle in cluster mode. Each Verticle class has a main method that deploys each verticle separetly. Example for the Monitoring verticle.</p> </li> </ol> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 100%;"> </colgroup> <thead> <tr> <th class="tableblock halign-center valign-top"><a href="https://2.bp.blogspot.com/-GjOWQzixVq8/Wpgynw-A8OI/AAAAAAAACLQ/EUz57xgYcjcve1jXrARPEufaOLfLErUDwCEwYBhgL/s1600/Monitoring.png"><span class="image"><img src="https://2.bp.blogspot.com/-GjOWQzixVq8/Wpgynw-A8OI/AAAAAAAACLQ/EUz57xgYcjcve1jXrARPEufaOLfLErUDwCEwYBhgL/s320/Monitoring.png" alt="image" width="320" height="296"></span></a></th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-center valign-top"><p class="tableblock">Running the application, we can monitor the logs</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Each clustered application contains - or embeds - an Infinispan instance. Under the hood, the 3 Infinispan instances will form a cluster.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_what_if_i_need_to_scale"><a class="anchor" href="#_what_if_i_need_to_scale"></a>What if I need to scale</h2> <div class="sectionbody"> <div class="paragraph"> <p>Imagine you need to scale the Reboot Consumer application. We can run it multiple times, let’s say 2 more times. The two new instances will join the cluster. In this case, we have “ID-93EB” ”ID-45B8” and “ID-247A”, so now we have a cluster of 5. It&#8217;s very simple but if we have a look to the monitoring console, we will notice reboots are now happening in parallel.</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 100%;"> </colgroup> <thead> <tr> <th class="tableblock halign-center valign-top"><a href="https://3.bp.blogspot.com/-YTja7FV8S4k/Wpg6YuIstTI/AAAAAAAACL4/xH2N4erfgfk_ZUcICwmyp_2WQQNKlPpqQCLcBGAs/s1600/MultipleReboots.png"><span class="image"><img src="https://3.bp.blogspot.com/-YTja7FV8S4k/Wpg6YuIstTI/AAAAAAAACL4/xH2N4erfgfk_ZUcICwmyp_2WQQNKlPpqQCLcBGAs/s400/MultipleReboots.png" alt="image" width="400" height="245"></span></a></th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-center valign-top"><p class="tableblock">3 Reboot Consumers</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>As I mentioned before, this example is a dummy application. But in real life you could need to trigger a process from a verticle that runs multiple times and need to be sure this process is happening just once at a time. How can we fix this ? We can use Vert.x Shared Data structures API.</p> </div> <div class="sect2"> <h3 id="_shared_data_api_to_rescue"><a class="anchor" href="#_shared_data_api_to_rescue"></a>Shared data API to rescue</h3> <div class="paragraph"> <p>In this particular case, we are going to use a clustered lock. Using the lock, we can now synchronise the reboots among the 3 nodes.</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 100%;"> </colgroup> <thead> <tr> <th class="tableblock halign-center valign-top"><a href="https://2.bp.blogspot.com/--calcYXn5l4/WplAZEu4f8I/AAAAAAAACMU/eFrivRZMsHE8XUZr-BAvAuUikZ9-_k3DACLcBGAs/s1600/MonitoringUsingLock.png"><span class="image"><img src="https://2.bp.blogspot.com/--calcYXn5l4/WplAZEu4f8I/AAAAAAAACMU/eFrivRZMsHE8XUZr-BAvAuUikZ9-_k3DACLcBGAs/s400/MonitoringUsingLock.png" alt="image" width="400" height="256"></span></a></th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-center valign-top"><p class="tableblock">Using Shared Data API, one reboot at a time</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Vert.x clustered lock in this example is using an emulated version of the new Clustered Lock API of Infinispan introduced in 9.2 which has been freshly released. I will come back to share about this API in particular in further blog posts. You can read about it on the <a href="http://infinispan.org/docs/stable/user_guide/user_guide.html#clustered_lock">documentation</a> or run the <a href="https://github.com/infinispan/infinispan-simple-tutorials/tree/master/lock">infinispan-simple-tutorial</a>.</p> </div> </div> <div class="sect2"> <h3 id="_one_node_at_a_time"><a class="anchor" href="#_one_node_at_a_time"></a>One node at a time</h3> <div class="paragraph"> <p>When clustering applications with Vert.x, there is something you need to take care of. It is important to understand that each node contains an instance of the datagrid. This means that scaling up and down needs to be done one at a time. Infinispan, as other datagrids, reshuffles the data when a new node joins or leaves a cluster. This process is done following a distributed hashing algorithm, so not every data is moved around, just the data that is supposed to live in the new node, or the data owned by a leaving node. If we just kill a bunch of nodes without taking care of the cluster, consequences can be harming! This is something quite obvious when dealing with databases : we just don’t kill a bunch of database instances without taking care of every instance at a time. Even when Infinispan data is only in memory we need to take care about it in the same way. <a href="http://vertx.io/docs/vertx-infinispan/java/#_configuring_for_kubernetes_or_openshift_3">Openshift, which is built on top of Kubernetes</a>, helps dealing properly and safely with these scale up and down operations.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_conclusions"><a class="anchor" href="#_conclusions"></a>Conclusions</h2> <div class="sectionbody"> <div class="paragraph"> <p>As you have seen, creating clustered applications with Vert.x and Infinispan is very straightforward. The clustered event bus is very powerful. In this example we have seen how to use a clustered lock, but other <a href="http://vertx.io/docs/apidocs/io/vertx/core/shareddata/SharedData.html">shared data structures</a> built on top of <a href="http://infinispan.org/docs/stable/user_guide/user_guide.html#the_code_strongcounter_code_interface_when_the_consistency_or_bounds_matters">Counters</a> are available.</p> </div> </div> </div> <div class="sect1"> <h2 id="_about_the_vert_x_infinispan_cluster_manager_status"><a class="anchor" href="#_about_the_vert_x_infinispan_cluster_manager_status"></a>About the Vert.x Infinispan Cluster Manager status</h2> <div class="sectionbody"> <div class="paragraph"> <p>At the time of this writing, <a href="http://blog.infinispan.org/2018/02/infinispan-920final.html">Infinspan 9.2.0.Final</a> has been released. From vert.x-infinispan cluster manager point of view, before Vert.x 3.6 (which is not out yet) the cluster manager is using Infinispan 9.1.6.final and it’s using an emulation layer for locks and counters. In this tutorial we are using Vert.x 3.5.1 version.</p> </div> <div class="paragraph"> <p>This tutorial will be updated with the version using Infinispan 9.2 as soon as the next <a href="https://github.com/vert-x3/vertx-infinispan/">vert.x-infinispan</a> will be released, which will happen in a few months. Meanwhile, stay tuned!</p> </div> </div> </div> </div> <em>Posted by Katia Aresti on 2018-03-21</em> <br> <em>Tags:</em> <a href="/blog/tags/ vert.x/"> vert.x </a> <hr> <div class="post"></div> <h3> Tuesday, 13 March 2018 </h3> <h1> <a href="/blog/2018/03/13/final-releases-for-hotrod-clients-c-and/">Final release for Hotrod clients C++ and C# 8.2.0 are out!</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>We&#8217;re pleased to announce the availability of the 8.2.0.Final release of the C++ and C# Hotrod clients. Here is what happened in the 8.2.0 episode:</p> </div> <div class="paragraph"> <p><strong>C++</strong></p> </div> <div class="ulist"> <ul> <li> <p>SASL: PLAIN, MD5, EXTERNAL, GSSAPI (linux only)</p> </li> <li> <p>Continuous Queries</p> </li> <li> <p>getAll operation</p> </li> <li> <p>simplified remote exec API</p> </li> </ul> </div> <div class="paragraph"> <p><strong>C#</strong></p> </div> <div class="ulist"> <ul> <li> <p>SASL: PLAIN, MD5, EXTERNAL</p> </li> <li> <p>Continuous Queries</p> </li> <li> <p>GetAll operation</p> </li> <li> <p>simplified remote exec API</p> </li> </ul> </div> <div class="paragraph"> <p>You can find more info and even the binaries at the usual places</p> </div> <div class="paragraph"> <p>In the backstage people are already working on the 8.3.0 episode, you can partecipate expressing your opinion or adding your ideas here [5][6].</p> </div> <div class="paragraph"> <p>Thank you for reading.</p> </div> <div class="paragraph"> <p>The Infinispan Team</p> </div> <div class="paragraph"> <p>[5] <a href="https://issues.jboss.org/browse/HRCPP-452">C++ Features List for 8.3.0</a> [6] <a href="https://issues.jboss.org/browse/HRCPP-453">C# Features List for 8.3.0</a></p> </div> </div> </div> </div> <em>Posted by rigazilla on 2018-03-13</em> <br> <em>Tags:</em> <a href="/blog/tags/ c++/"> c++ </a> <a href="/blog/tags/release/"> release </a> <a href="/blog/tags/final/"> final </a> <a href="/blog/tags/c#/"> c# </a> <hr> <div class="post"></div> <h3> Wednesday, 07 March 2018 </h3> <h1> <a href="/blog/2018/03/07/rest-with-http2/">REST with HTTP/2</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>HTTP has become one of the most successful and heavily used network protocols around the world. Version 1.0 was created in 1996 and received a minor update 3 years later. But it took more than a decade to create HTTP/2 (which was approved in 2015). Why did it take so long? Well, I wouldn’t tell you all the truth if I didn’t mention an <a href="https://developers.google.com/web/fundamentals/performance/http2/">experimental protocol, called SPDY</a>. SPDY was primarily focused on improving performance. The initial results were very promising and inside Google’s lab, the developers <a href="https://blog.chromium.org/2009/11/2x-faster-web.html">measured 55% speed improvement</a>. This work and experience was converted into HTTP/2 proposal back in 2012. A few years later, we can all use HTTP/2 (sometimes called h2) along with its older brother - HTTP/1.1.</p> </div> </div> </div> <div class="sect1"> <h2 id="_main_differences_between_http1_1_and_http2"><a class="anchor" href="#_main_differences_between_http1_1_and_http2"></a>Main differences between HTTP/1.1 and HTTP/2</h2> <div class="sectionbody"> <div class="paragraph"> <p><span class="image"><img src="https://lh6.googleusercontent.com/QGDSTl40Vz0ROc0koZA_QWHQ_yGB1M_rEISrd42_mQv4MA9WJCUyag6RUsfTkCx0juSiZnbGiTXLvJDr86REpdAPWDEfntqVjaXh8zN3uDf3J1qRugr9nsk3wfqCR4WkZ1jLtg-s" alt="image" width="624" height="515"></span></p> </div> <div class="paragraph"> <p>HTTP/1.1 is a text-based protocol. Sometimes this is very convenient, since you can use low level tools, such as Telnet, for hacking. But it doesn’t work very well for transporting large, binary payloads. HTTP/2 solves this problem by using a completely redesigned architecture. Each HTTP message (a request or a response) consists of one or more frames. A frame is the smallest portion of data travelling through a TCP connection. A set of messages is aggregated into a, so called stream.</p> </div> <div class="paragraph"> <p><span class="image"><img src="https://lh3.googleusercontent.com/PYdtYy6RLlUFY3pUVfg-E_5_AomfRZW9O1EHTkytWnkKDXhlCkjsf-D4N7_CiG9AndYDZ7tAYTkrMQEeDi56PvcnvPaZ-9YNqswuTtqUY0IsTzo6UtXJrInhTKTc_SzGy-Zh_u0V" alt="image" width="624" height="171"></span></p> </div> <div class="paragraph"> <p>HTTP/2 allows to lower the number of physical connections between the server and the client by multiplexing logical connections into one TCP connection. Streams allow the server to recognize, which frame belongs to which conversation.</p> </div> <div class="sect4"> <h5 id="_how_to_connect_using_http2"><a class="anchor" href="#_how_to_connect_using_http2"></a>How to connect using HTTP/2?</h5> <div class="paragraph"> <p>There are two ways for starting an HTTP/2 conversation.</p> </div> <div class="paragraph"> <p>The first one, and the most commonly used one, is <a href="https://tools.ietf.org/html/rfc7301">TLS/ALPN</a>. During TLS handshake the server and the client negotiate protocol for further communication. Unfortunately JDK below 9 doesn’t support it by default (there are a couple of workarounds but please refer to your favorite HTTP client’s manual to find some suggestions).</p> </div> <div class="paragraph"> <p>The second one, much less popular, is so called plain text upgrade. During HTTP/1.1 conversation, the client issues an HTTP/1.1 Upgrade header and proposes new conversation protocol. If the server agrees, they start using it. If not, they stick with HTTP/1.1.</p> </div> <div class="paragraph"> <p>The good news is that Infinispan supports both those upgrade paths. Thanks to the ALPN Hack Engine (the credit goes to Stuart Douglas from the Wildfly Team), we support TLS/ALPN without any bootstrap classpath modification.</p> </div> </div> <div class="sect4"> <h5 id="_configuring_infinispan_server_for_http2"><a class="anchor" href="#_configuring_infinispan_server_for_http2"></a>Configuring Infinispan server for HTTP/2</h5> <div class="paragraph"> <p>Infinispan’s REST server already supports plain text upgrades out of the box. TLS/ALPN however, requires additional configuration since the server needs to use a Keystore. In order to make it even more convenient, we support <a href="http://infinispan.org/docs/stable/server_guide/server_guide.html#security:hotrod_rest_encryption">generating keystores automatically when needed</a>. Here’s an example showing how to configure a security realm:</p> </div> <div class="paragraph"> <p>The next step is to bind the security realm to a REST endpoint:</p> </div> <div class="paragraph"> <p>You may also use one of our configuration examples. The easiest way to get it working is to use our <a href="https://github.com/jboss-dockerfiles/infinispan/tree/master/server">Docker image</a>:</p> </div> <div class="paragraph"> <p>Let’s explain a couple of things from the command above:</p> </div> <div class="ulist"> <ul> <li> <p>-e "APP_USER=test" - This is a user name we will be used for REST authentication.</p> </li> <li> <p>-e "APP_PASS=test" - Corresponding password.</p> </li> <li> <p>../../docs/examples/configs/standalone-rest-ssl.xml - Here is a ready-to-go configuration with REST and TLS/ALPN support</p> </li> </ul> </div> <div class="paragraph"> <p>Unfortunately, HTTP/2 functionality <a href="https://issues.jboss.org/browse/ISPN-8896">has been broken in 9.2.0.Final</a>. But we promise to fix it as soon as we can :) Please use 9.1.5.Final in the meantime.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_testing_using_curl"><a class="anchor" href="#_testing_using_curl"></a>Testing using CURL</h2> <div class="sectionbody"> <div class="paragraph"> <p><a href="https://linux.die.net/man/1/curl">Curl</a> is one of my favorite tools. It’s very simple, powerful, and… it supports HTTP/2. Assuming that you already started Infinispan server using <code>docker run</code> command, you can put something into the cache:</p> </div> <div class="paragraph"> <p>Once, it’s there, let’s try to get it back:</p> </div> <div class="paragraph"> <p>Let’s analyze CURL switches one by one:</p> </div> <div class="ulist"> <ul> <li> <p>-k - Ignores certificate validation. All automatically generated certificates and self-signed and not trusted by default.</p> </li> <li> <p>-v - Debug logging.</p> </li> <li> <p>-u test:test - Username and password for authentication.</p> </li> <li> <p>-d test - This is the payload when invoking HTTP POST.</p> </li> <li> <p>-H “Accept: text/plain” - This tells the server what type of data we’d like to get in return.</p> </li> </ul> </div> </div> </div> <div class="sect1"> <h2 id="_conclusions_and_links"><a class="anchor" href="#_conclusions_and_links"></a>Conclusions and links</h2> <div class="sectionbody"> <div class="paragraph"> <p>I hope you enjoyed this small tutorial about HTTP/2. I highly encourage you to have a look at the links below to learn some more things about this topic. You may also measure the performance of your app when using HTTP/1.1 and HTTP/2. You will be surprised!</p> </div> <div class="ulist"> <ul> <li> <p><a href="https://hpbn.co/">High Performance Browser Networking</a> - One of the best books about HTTP and network performance. Most of the graphics in this article has been copied from that book. I highly recommend it!</p> </li> <li> <p><a href="https://linux.die.net/man/1/curl">Curl manual</a></p> </li> <li> <p><a href="https://hub.docker.com/r/jboss/infinispan-server/">Infinispan on Docker Hub</a></p> </li> </ul> </div> </div> </div> </div> <em>Posted by Sebastian Łaskawiec on 2018-03-07</em> <br> <em>Tags:</em> <a href="/blog/tags/ docker/"> docker </a> <a href="/blog/tags/server/"> server </a> <a href="/blog/tags/http/2/"> http/2 </a> <a href="/blog/tags/rest/"> rest </a> <hr> <div class="post"></div> <h3> Tuesday, 06 March 2018 </h3> <h1> <a href="/blog/2018/03/06/accessing-infinispan-inside-docker-for/">Accessing Infinispan inside Docker for Mac</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Connecting to Infinispan instances that run inside Docker for Mac using the Java Hot Rod client can be tricky. In this blog post we&#8217;ll be analyzing what makes this environment tricky and how to get around the issue.</p> </div> <div class="paragraph"> <p>The tricky thing about Docker for Mac is that internal container IP addresses are not accessible externally. This is a <a href="https://github.com/docker/for-mac/issues/155">known issue</a> and it can be hard to workaround it. In container orchestrators such as Openshift, you can use Routes to allow external access to the containers. However, if running vanilla Docker for Mac, the simplest option is to map ports over to the local machine.</p> </div> <div class="paragraph"> <p>Why is this important? When someone connects using the Hot Rod protocol, the server returns the current topology to the client. When Infinispan runs inside of Docker, this topology by default contains internal IP addresses. Since those are not accessible externally in Docker for Mac, the client won&#8217;t be able to connect.</p> </div> <div class="paragraph"> <p>To workaround the issue, Infinispan server Hot Rod endpoint can be configured with external host/port combination, but doing this would require modifying the server&#8217;s configuration. A simpler method to get around the issue is to configure the client&#8217;s intelligence to be Basic. By doing this the server won&#8217;t send topology updates nor will the client be able to locate where keys are located using hashing. This has a negative performance impact since all requests to Infinispan single server or server cluster would need to go over the same IP+port. However, for demo or sample applications on Mac environments, this is reasonable thing to do.</p> </div> <div class="paragraph"> <p>So, how do we do all of this?</p> </div> <div class="paragraph"> <p>First, start Infinispan server and map Hot Rod&#8217;s default port 11222 to the local 11222 port:</p> </div> <div class="paragraph"> <p>docker run -it -p 11222:11222 jboss/infinispan-server:9.2.0.Final</p> </div> <div class="paragraph"> <p>Open your IDE and create a project with this dependencies:</p> </div> <div class="paragraph"> <p>Finally, create a class that connects to Infinispan and does a simple put/get sequence:</p> </div> <div class="paragraph"> <p>Cheers, Galder</p> </div> </div> </div> </div> <em>Posted by Galder Zamarreño on 2018-03-06</em> <br> <em>Tags:</em> <a href="/blog/tags/ docker/"> docker </a> <a href="/blog/tags/mac/"> mac </a> <hr> <div class="post"></div> <h3> Monday, 05 March 2018 </h3> <h1> <a href="/blog/2018/03/05/a-swig-based-framework-to-build-hotrod/">A SWIG based framework to build Hotrod client prototype in your preferred language</a> </h1> <div class="content"> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>If your are working on a non Java/C++/C#/JS application and you need to interact with Infinispan via Hotrod you may be interested in the idea behind the HotSwig[1] project.</p> </div> <div class="paragraph"> <p>Hotswig proposes a framework to build Hotrod client prototypes quickly and for a generic SWIG[2] supported language. As people familiar with C++ and C# Infinispan native clients know, SWIG plays a role in both the projects:</p> </div> <div class="ulist"> <ul> <li> <p>is used to build the base of the C# client wrapping the C++ core with a C# layer;</p> </li> <li> <p>is used in the C project to run (part of) the Java test suite against the client, in this way: a Java wrapper is built via SWIG to make the C client looks like its Java big brother so it can be tested with the Java test suite.</p> </li> </ul> </div> <div class="paragraph"> <p>The main goal was to produce for a specific language an almost complete client reusing the C++ core features and the following workflow has been setup to do that:</p> </div> <div class="ulist"> <ul> <li> <p>the whole C interface is processed by SWIG. The resulting wrapper exposes almost all the C functions;</p> </li> <li> <p>a user friendly adaptation layer is build on top of the SWIG result.</p> </li> </ul> </div> <div class="paragraph"> <p>This approach doesn&#8217;t work for the HotSwig goal, mainly because the effort need by the second step is usually not-negligible and prevents the rapid development of prototype in a generic language.</p> </div> <div class="paragraph"> <p>In the HotSwig approach, this limitation is removed moving the adaptation layer from the target language to the C++ side and then letting SWIG generate a ready to use client prototype. So the HotSwig workflow is the following:</p> </div> <div class="ulist"> <ul> <li> <p>build an adaptation facade around the C core to make it SWIG friendly (do the adaptation work once for all on the C side);</p> </li> <li> <p>explicitly define what we want in the produced SWIG wrapper (keep things simple excluding everything by default);</p> </li> <li> <p>run SWIG to produce the client.</p> </li> </ul> </div> <div class="paragraph"> <p>At the moment HotSwig is just a proof of concept, but you can try to run it and produce a ready to work Infinispan client for the language you need. Examples are already provided for python, ruby and Octave, but HotSwig should work with all the SWIG supported languages. If you get it to run in your preferred programming language, please share your experience with us.</p> </div> <div class="paragraph"> <p>I&#8217;ve listed here[3] some tasks for the roadmap, with the idea to test the flexibility of the framework trying to extend it in different directions. Maybe the idea is good and it can grow up from a PoC to something that can really help devs. You can add you ideas of course.</p> </div> <div class="paragraph"> <p>So if you need to do math against your Infinispan data set why don&#8217;t you try the Octave client? Or maybe you want to do analytics with R, or presentation with PHP. Or you just like parenthesis and you want to use Lisp. Or you&#8217;re working for the Klingon empire and you must use ylDoghQo'[4]&#8230;&#8203; well ok just joking now&#8230;&#8203;</p> </div> <div class="paragraph"> <p>Thanks for reading!</p> </div> <div class="paragraph"> <p>Cheers The Infinispan Team</p> </div> <div class="paragraph"> <p>[1] <a href="https://github.com/rigazilla/hotswig" class="bare">https://github.com/rigazilla/hotswig</a> [2] <a href="http://www.swig.org/" class="bare">http://www.swig.org/</a> [3] <a href="https://github.com/rigazilla/hotswig/issues" class="bare">https://github.com/rigazilla/hotswig/issues</a> [4] <a href="https://www.kli.org/about-klingon/klingon-phrases" class="bare">https://www.kli.org/about-klingon/klingon-phrases</a></p> </div> </div> </div> </div> <em>Posted by rigazilla on 2018-03-05</em> <br> <em>Tags:</em> <a href="/blog/tags/ hotrod/"> hotrod </a> <a href="/blog/tags/ruby/"> ruby </a> <a href="/blog/tags/cpp-client/"> cpp-client </a> <a href="/blog/tags/python/"> python </a> <hr> <div class="pagination-links"><a href="/blog/page/11/" class="previous-link">Previous</a> <a href="/blog/" class="page-link">1</a> <a href="/blog/page/2/" class="page-link">2</a> <span class="skip">...</span><a href="/blog/page/11/" class="page-link">11</a> <span class="current-page">12</span> <a href="/blog/page/13/" class="page-link">13</a> <span class="skip">...</span><a href="/blog/page/112/" class="page-link">112</a> <a href="/blog/page/113/" class="page-link">113</a> <a href="/blog/page/13/" class="next-link">Next</a> </div> </div> <footer class="container"> <hr> <div class="row"> <div class="col-md-2 col-md-offset-1"> <h4>Navigate</h4> <ul> <li> <a href="/about" title="About">About</a> </li> <li> <a href="/documentation" title="Learn">Learn</a> </li> <li> <a href="/community" title="Community">Community</a> </li> <li> <a href="/getinvolved" title="Get Involved">Get Involved</a> </li> <li> <a href="/download" title="Download">Download</a> </li> </ul> </div> <div class="col-md-2"> <h4>Contribute</h4> <ul> <li> <a href="https://issues.jboss.org/browse/ISPN" title="Submit a bug">Submit a bug</a> </li> <li> <a href="https://github.com/infinispan" title="Write code">Write Code</a> </li> </ul> <h4>Follow Us</h4> <ul> <li> <a href="https://infinispan.org/blog/" title="Blog">Blog</a> </li> <li> <a href="https://twitter.com/infinispan" title="Twitter">Twitter</a> </li> </ul> </div> <div class="col-md-2"> <h4>Open Source</h4> <p> Infinispan is released under the <b>Apache 2.0 open source license.</b> Learn more about the Apache 2.0 license <a href="https://www.apache.org/licenses/LICENSE-2.0">here.</a> </p> </div> <div class="col-md-2"> <h4>A member of</h4> <a alt="CloudTM" href="http://www.cloudtm.eu/" target="_NEW"> <img src="/images/cloudtm.png"> </a> <a alt="LEADS" href="http://leads-project.eu/" target="_NEW"> <img src="/images/leads.png"> </a> <a alt="CloudButton" href="http://cloudbutton.eu/" target="_NEW"> <img src="/images/cloudbutton.png"> </a> </div> <div class="col-md-2"> <h4>Thanks to</h4> <p>JetBrains Intellij IDEA</p> <a alt="JetBrains Intellij IDEA" href="https://www.jetbrains.com/idea/" target="_NEW"> <img src="/images/icon_IntelliJIDEA.png"> </a> </div> </div> <div class="col-md-10"> <p style="margin-top: 5px; font-size: 80%;"> © Copyright 2009-2019 Red Hat, Inc. <br> <i class="icon-fire"></i> Made with <a href="https://github.com/jbossorg/bootstrap-community" style="text-decoration: underline;" target="_NEW">JBoss Community Bootstrap</a> and <a href="http://awestruct.org/" style="text-decoration: underline;" target="_NEW">Awestruct</a> <br> <i class="icon-globe"></i> This website is open source! If you want to improve it, <a href="https://github.com/infinispan/infinispan.github.io" style="text-decoration: underline;" target="_NEW">fork the project,</a> and hack on it, then send a pull request. You can also view the <a href="https://www.seethestats.com/site/infinispan.org" style="text-decoration: underline;" target="_NEW">visitor stats.</a> <br> <i class="icon-share"></i> Website and documentation released under <a href="https://creativecommons.org/licenses/by/3.0/" style="text-decoration: underline;" target="_NEW">CC BY 3.0.</a> </p> </div> </footer> <div class="container" id="companyfooter"> <div class="redhatlogo"> <div id="logospacer"></div> <a href="http://www.redhat.com/"><img src="//static.jboss.org/theme/images/common/redhat_logo.png"></a> </div> </div> <span class="backToTop"> <a href="#top">back to top</a> </span> <script src="//static.jboss.org/theme/js/libs/bootstrap-community/3.2.0.2/bootstrap-community.min.js"></script> <script>
        if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
          _satellite.pageBottom();
        }
      </script> </div> </body> </html>